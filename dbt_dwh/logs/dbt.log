[0m18:57:51.713752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A64EC8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A63FE0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A63FE1C40>]}


============================== 18:57:51.720078 | ca395890-ad26-4b71-91ce-8344d1b8daa7 ==============================
[0m18:57:51.720078 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:57:51.721439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:51.991544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca395890-ad26-4b71-91ce-8344d1b8daa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6515C440>]}
[0m18:57:52.052659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca395890-ad26-4b71-91ce-8344d1b8daa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A64D14440>]}
[0m18:57:52.054661 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:57:52.238968 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m18:57:52.240552 [debug] [MainThread]: Command `dbt run` failed at 18:57:52.239987 after 0.73 seconds
[0m18:57:52.241100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A64ECBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6513B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6520A150>]}
[0m18:57:52.241651 [debug] [MainThread]: Flushing usage events
[0m18:58:06.241291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385EEBA1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385F7508C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385F752480>]}


============================== 18:58:06.245667 | ee8d88f8-3bf4-45c4-89d2-bf9069b70421 ==============================
[0m18:58:06.245667 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:58:06.246667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:58:06.437224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee8d88f8-3bf4-45c4-89d2-bf9069b70421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385F89AE40>]}
[0m18:58:06.471752 [debug] [MainThread]: Set downloads directory='C:\Users\d_tru\AppData\Local\Temp\dbt-downloads-buh_j7l5'
[0m18:58:06.472837 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m18:58:07.870621 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:07.871194 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m18:58:07.871746 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m18:58:07.872310 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:07.902897 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:07.903437 [debug] [MainThread]: STDERR: "b''"
[0m18:58:07.903992 [debug] [MainThread]: Checking out revision master.
[0m18:58:07.904550 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m18:58:07.942352 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:07.942891 [debug] [MainThread]: STDERR: "b''"
[0m18:58:07.943434 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m18:58:09.666731 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:09.667936 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m18:58:09.668478 [debug] [MainThread]: Executing "git tag --list"
[0m18:58:09.700117 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m18:58:09.700117 [debug] [MainThread]: STDERR: "b''"
[0m18:58:09.701503 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m18:58:09.760923 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m18:58:09.761507 [debug] [MainThread]: STDERR: "b''"
[0m18:58:09.762073 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:09.790824 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:09.790824 [debug] [MainThread]: STDERR: "b''"
[0m18:58:09.791826 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m18:58:09.791826 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:09.821124 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:09.822132 [debug] [MainThread]: STDERR: "b''"
[0m18:58:09.846117 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:58:10.404336 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:58:10.405561 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:58:10.683235 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:58:10.693847 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m18:58:10.721759 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:10.722868 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m18:58:10.723944 [debug] [MainThread]: command return code=128
[0m18:58:10.725027 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m18:58:10.725027 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:10.752890 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:10.753426 [debug] [MainThread]: STDERR: "b''"
[0m18:58:10.753965 [debug] [MainThread]: Checking out revision master.
[0m18:58:10.754505 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m18:58:10.790837 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:10.792210 [debug] [MainThread]: STDERR: "b''"
[0m18:58:10.792210 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m18:58:11.875222 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:11.875824 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m18:58:11.876887 [debug] [MainThread]: Executing "git tag --list"
[0m18:58:11.909948 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m18:58:11.911182 [debug] [MainThread]: STDERR: "b''"
[0m18:58:11.911723 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m18:58:11.958035 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m18:58:11.958582 [debug] [MainThread]: STDERR: "b''"
[0m18:58:11.959679 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:11.991361 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:11.992376 [debug] [MainThread]: STDERR: "b''"
[0m18:58:11.993375 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m18:58:11.993375 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:12.027766 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:12.028864 [debug] [MainThread]: STDERR: "b''"
[0m18:58:12.051946 [info ] [MainThread]: Updating lock file in file path: C:\Users\d_tru\Downloads\D\gruzi_suda_uchebu\FTIAD_true\DWH\DWH_hw02-main\dbt_dwh/package-lock.yml
[0m18:58:12.067995 [debug] [MainThread]: Set downloads directory='C:\Users\d_tru\AppData\Local\Temp\dbt-downloads-h22vyl9p'
[0m18:58:12.071437 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m18:58:12.072291 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m18:58:13.323772 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:13.324852 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m18:58:13.325390 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m18:58:13.325390 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:13.354796 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:13.355343 [debug] [MainThread]: STDERR: "b''"
[0m18:58:13.355343 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m18:58:13.356351 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m18:58:14.416026 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:14.417092 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m18:58:14.417619 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m18:58:14.476913 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m18:58:14.477496 [debug] [MainThread]: STDERR: "b''"
[0m18:58:14.478984 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:14.509627 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:14.510622 [debug] [MainThread]: STDERR: "b''"
[0m18:58:14.510622 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m18:58:14.510622 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:14.539874 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:14.540390 [debug] [MainThread]: STDERR: "b''"
[0m18:58:14.544627 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m18:58:14.572375 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:14.572375 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m18:58:14.573800 [debug] [MainThread]: command return code=128
[0m18:58:14.573800 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m18:58:14.574797 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:14.603407 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:14.604601 [debug] [MainThread]: STDERR: "b''"
[0m18:58:14.604601 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m18:58:14.604601 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m18:58:15.586738 [debug] [MainThread]: STDOUT: "b''"
[0m18:58:15.587269 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m18:58:15.587829 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m18:58:15.628554 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m18:58:15.629077 [debug] [MainThread]: STDERR: "b''"
[0m18:58:15.629620 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m18:58:15.658953 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m18:58:15.659482 [debug] [MainThread]: STDERR: "b''"
[0m18:58:15.660140 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m18:58:15.662304 [info ] [MainThread]: Installed from revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06
[0m18:58:15.663480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee8d88f8-3bf4-45c4-89d2-bf9069b70421', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023860D55220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385FD28A70>]}
[0m18:58:15.664023 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:58:16.592878 [info ] [MainThread]: Installed from version 1.3.0
[0m18:58:16.593658 [info ] [MainThread]: Up to date!
[0m18:58:16.594821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee8d88f8-3bf4-45c4-89d2-bf9069b70421', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385F7E0EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385F8EA4E0>]}
[0m18:58:16.596975 [debug] [MainThread]: Command `dbt deps` succeeded at 18:58:16.596440 after 10.53 seconds
[0m18:58:16.596975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385F7BA300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385F6B2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002385FA13650>]}
[0m18:58:16.597501 [debug] [MainThread]: Flushing usage events
[0m18:58:26.348963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014969939340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496D34EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496D6172F0>]}


============================== 18:58:26.354022 | e681b3d9-ae9f-40ef-8405-024ccc490cf9 ==============================
[0m18:58:26.354022 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:58:26.354993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:58:26.618070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e681b3d9-ae9f-40ef-8405-024ccc490cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496E94C6E0>]}
[0m18:58:26.692552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e681b3d9-ae9f-40ef-8405-024ccc490cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496D40A4B0>]}
[0m18:58:26.694190 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:58:26.898762 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:58:26.900775 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:58:26.905032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e681b3d9-ae9f-40ef-8405-024ccc490cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496EA57DD0>]}
[0m18:58:30.630522 [error] [MainThread]: Encountered an error:
Compilation Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  macro 'dbt_macro__link' takes no keyword argument 'src_nk'
[0m18:58:30.632165 [debug] [MainThread]: Command `dbt run` failed at 18:58:30.632165 after 4.46 seconds
[0m18:58:30.632708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014969939340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496ED27830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496EA18F50>]}
[0m18:58:30.633257 [debug] [MainThread]: Flushing usage events
[0m19:01:26.071595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9ED524F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9ECA58110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9ECA595E0>]}


============================== 19:01:26.076943 | b81152bb-3ba0-4904-9168-fe6b8b246ada ==============================
[0m19:01:26.076943 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:01:26.078015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:hub', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:01:26.325370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b81152bb-3ba0-4904-9168-fe6b8b246ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F0B84080>]}
[0m19:01:26.385890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b81152bb-3ba0-4904-9168-fe6b8b246ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9EE3E5640>]}
[0m19:01:26.387896 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:01:26.589275 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:01:26.592095 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:01:26.593707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b81152bb-3ba0-4904-9168-fe6b8b246ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F0B4F080>]}
[0m19:01:28.554655 [error] [MainThread]: Encountered an error:
Compilation Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  macro 'dbt_macro__link' takes no keyword argument 'src_nk'
[0m19:01:28.556181 [debug] [MainThread]: Command `dbt run` failed at 19:01:28.556181 after 2.67 seconds
[0m19:01:28.556181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9ED524F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F2081970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9F1EA0CB0>]}
[0m19:01:28.557201 [debug] [MainThread]: Flushing usage events
[0m19:03:26.029652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CC4A853D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCA0E6B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCA5952E0>]}


============================== 19:03:26.034863 | 6419a5d8-666b-41ca-8205-c0c903f10213 ==============================
[0m19:03:26.034863 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:03:26.035975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:03:26.282707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6419a5d8-666b-41ca-8205-c0c903f10213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCB255FD0>]}
[0m19:03:26.343838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6419a5d8-666b-41ca-8205-c0c903f10213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCB257800>]}
[0m19:03:26.346569 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:03:26.562357 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:03:26.564590 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:03:26.565699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6419a5d8-666b-41ca-8205-c0c903f10213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCB303F80>]}
[0m19:03:28.587088 [error] [MainThread]: Encountered an error:
Compilation Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  invalid syntax for function call expression
    line 7
      {{ automate_dv.link(
[0m19:03:28.589208 [debug] [MainThread]: Command `dbt run` failed at 19:03:28.588680 after 2.76 seconds
[0m19:03:28.589738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCAF8C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCC5B1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CCB0CE930>]}
[0m19:03:28.589738 [debug] [MainThread]: Flushing usage events
[0m19:05:34.415791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A575D4F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A56BA95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5A2720F0>]}


============================== 19:05:34.420692 | cd7b9db9-9420-4ea8-8c4f-e49cc5c4ad29 ==============================
[0m19:05:34.420692 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:05:34.421819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:hub', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:05:34.674997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd7b9db9-9420-4ea8-8c4f-e49cc5c4ad29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5AC14440>]}
[0m19:05:34.743026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd7b9db9-9420-4ea8-8c4f-e49cc5c4ad29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A59D49130>]}
[0m19:05:34.744635 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:05:34.940056 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:05:34.942318 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:05:34.942879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd7b9db9-9420-4ea8-8c4f-e49cc5c4ad29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5AAA4170>]}
[0m19:05:36.925080 [error] [MainThread]: Encountered an error:
Compilation Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  invalid syntax for function call expression
    line 7
      {{ automate_dv.link(
[0m19:05:36.926087 [debug] [MainThread]: Command `dbt run` failed at 19:05:36.926087 after 2.69 seconds
[0m19:05:36.927076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5A663980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5ABBFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A5C185850>]}
[0m19:05:36.927076 [debug] [MainThread]: Flushing usage events
[0m19:05:56.548389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260152BED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026015743830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260152E52E0>]}


============================== 19:05:56.553987 | 66acc2f7-0f77-4590-967a-4a4567892600 ==============================
[0m19:05:56.553987 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:05:56.555098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m19:05:56.812372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66acc2f7-0f77-4590-967a-4a4567892600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026014B9C5C0>]}
[0m19:05:56.883294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66acc2f7-0f77-4590-967a-4a4567892600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601582A4B0>]}
[0m19:05:56.885448 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:05:57.087759 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:05:57.090212 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:05:57.091253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '66acc2f7-0f77-4590-967a-4a4567892600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026015D6BD10>]}
[0m19:05:59.094264 [error] [MainThread]: Encountered an error:
Compilation Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  invalid syntax for function call expression
    line 7
      {{ automate_dv.link(
[0m19:05:59.095870 [debug] [MainThread]: Command `dbt run` failed at 19:05:59.095870 after 2.71 seconds
[0m19:05:59.096399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260158DFE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260170C1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026015B92D50>]}
[0m19:05:59.096928 [debug] [MainThread]: Flushing usage events
[0m19:06:46.291299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFD63CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFDBB58E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFDDED2E0>]}


============================== 19:06:46.297260 | 8c25ef47-33df-4597-acd2-cb8584f8a9b1 ==============================
[0m19:06:46.297260 [info ] [MainThread]: Running with dbt=1.8.9
[0m19:06:46.298491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:06:46.550893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c25ef47-33df-4597-acd2-cb8584f8a9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFE04E570>]}
[0m19:06:46.613383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c25ef47-33df-4597-acd2-cb8584f8a9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFDDEF8F0>]}
[0m19:06:46.615014 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:06:46.826904 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m19:06:46.828910 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:06:46.828910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8c25ef47-33df-4597-acd2-cb8584f8a9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFDF103B0>]}
[0m19:06:48.781596 [error] [MainThread]: Encountered an error:
Compilation Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  invalid syntax for function call expression
    line 7
      {{ automate_dv.link(
[0m19:06:48.783221 [debug] [MainThread]: Command `dbt run` failed at 19:06:48.783221 after 2.68 seconds
[0m19:06:48.783779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFDDEFE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFF455910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACFF438A70>]}
[0m19:06:48.784378 [debug] [MainThread]: Flushing usage events
[0m11:20:47.981384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10900fd90>]}


============================== 11:20:47.984235 | 05cf398a-a369-49f7-b0f3-ae0c123198ed ==============================
[0m11:20:47.984235 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:20:47.984537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:20:48.236699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05cf398a-a369-49f7-b0f3-ae0c123198ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b25e00>]}
[0m11:20:48.255108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05cf398a-a369-49f7-b0f3-ae0c123198ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a5f20>]}
[0m11:20:48.255696 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:20:48.295216 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_packages/automate_dv/dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_packages/automate_dv
[0m11:20:48.296593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3434229, "process_in_blocks": "0", "process_kernel_time": 0.123456, "process_mem_max_rss": "103415808", "process_out_blocks": "0", "process_user_time": 0.578096}
[0m11:20:48.296898 [debug] [MainThread]: Command `dbt run` failed at 11:20:48.296847 after 0.34 seconds
[0m11:20:48.297077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d14350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d14450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d00d70>]}
[0m11:20:48.297240 [debug] [MainThread]: Flushing usage events
[0m11:33:24.966517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0fd90>]}


============================== 11:33:24.969179 | f78e4b2d-09cc-4fd7-99c6-1db51ec19430 ==============================
[0m11:33:24.969179 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:33:24.969463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:33:25.044125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f78e4b2d-09cc-4fd7-99c6-1db51ec19430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103625e00>]}
[0m11:33:25.061568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f78e4b2d-09cc-4fd7-99c6-1db51ec19430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba5f20>]}
[0m11:33:25.062052 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:33:25.099648 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:33:25.100052 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:33:25.100204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f78e4b2d-09cc-4fd7-99c6-1db51ec19430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f8550>]}
[0m11:33:25.449607 [error] [MainThread]: Encountered an error:
Compilation Error in model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
  invalid syntax for function call expression
    line 7
      {{ automate_dv.link(
[0m11:33:25.450768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5098692, "process_in_blocks": "0", "process_kernel_time": 0.121459, "process_mem_max_rss": "111214592", "process_out_blocks": "0", "process_user_time": 0.859664}
[0m11:33:25.450998 [debug] [MainThread]: Command `dbt run` failed at 11:33:25.450957 after 0.51 seconds
[0m11:33:25.451138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105973c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105973d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a3e70>]}
[0m11:33:25.451255 [debug] [MainThread]: Flushing usage events
[0m12:05:38.645813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ed92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487fd90>]}


============================== 12:05:38.648320 | 56da4213-a07a-4b20-9df1-7b80e3bd5ce2 ==============================
[0m12:05:38.648320 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:05:38.648586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:38.725258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56da4213-a07a-4b20-9df1-7b80e3bd5ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036d5e00>]}
[0m12:05:38.743292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56da4213-a07a-4b20-9df1-7b80e3bd5ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104915f20>]}
[0m12:05:38.743842 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:05:38.781633 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:05:38.782049 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:05:38.782203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '56da4213-a07a-4b20-9df1-7b80e3bd5ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105418550>]}
[0m12:05:39.322418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56da4213-a07a-4b20-9df1-7b80e3bd5ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105492d50>]}
[0m12:05:39.363762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56da4213-a07a-4b20-9df1-7b80e3bd5ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104612f90>]}
[0m12:05:39.363973 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m12:05:39.364108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56da4213-a07a-4b20-9df1-7b80e3bd5ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105803c70>]}
[0m12:05:39.365281 [info ] [MainThread]: 
[0m12:05:39.365494 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:39.367590 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:05:39.391360 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:05:39.391544 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:05:39.391646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:39.393962 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:05:39.394212 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:05:39.394314 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:05:39.394429 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:05:39.394513 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:05:39.394603 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m12:05:39.394858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:39.394979 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:05:39.395089 [info ] [MainThread]: 
[0m12:05:39.395208 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m12:05:39.395378 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m12:05:39.396282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7766271, "process_in_blocks": "0", "process_kernel_time": 0.136946, "process_mem_max_rss": "121274368", "process_out_blocks": "0", "process_user_time": 1.110718}
[0m12:05:39.396517 [debug] [MainThread]: Command `dbt run` failed at 12:05:39.396476 after 0.78 seconds
[0m12:05:39.396653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ab1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105719910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571a150>]}
[0m12:05:39.396779 [debug] [MainThread]: Flushing usage events
[0m12:08:45.334341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10660fd90>]}


============================== 12:08:45.337052 | 229a3479-06b5-4cd7-bd36-f359f78286fb ==============================
[0m12:08:45.337052 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:08:45.337356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:08:45.416144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '229a3479-06b5-4cd7-bd36-f359f78286fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105325e00>]}
[0m12:08:45.435303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '229a3479-06b5-4cd7-bd36-f359f78286fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a1f20>]}
[0m12:08:45.435854 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:08:45.477215 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:08:45.535774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:45.535990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:45.549609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '229a3479-06b5-4cd7-bd36-f359f78286fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107613150>]}
[0m12:08:45.594230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '229a3479-06b5-4cd7-bd36-f359f78286fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10789d220>]}
[0m12:08:45.594486 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m12:08:45.594638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '229a3479-06b5-4cd7-bd36-f359f78286fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ff3f0>]}
[0m12:08:45.595890 [info ] [MainThread]: 
[0m12:08:45.596176 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:45.598545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:08:45.622627 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:08:45.622848 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:08:45.622985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:45.624745 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:08:45.625037 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:08:45.625156 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:08:45.625289 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:08:45.625391 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:08:45.625499 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m12:08:45.625791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:45.625900 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:08:45.626013 [info ] [MainThread]: 
[0m12:08:45.626139 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m12:08:45.626320 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m12:08:45.627487 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.32305205, "process_in_blocks": "0", "process_kernel_time": 0.134206, "process_mem_max_rss": "115572736", "process_out_blocks": "0", "process_user_time": 0.680518}
[0m12:08:45.627709 [debug] [MainThread]: Command `dbt run` failed at 12:08:45.627670 after 0.32 seconds
[0m12:08:45.627860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fce90>]}
[0m12:08:45.627996 [debug] [MainThread]: Flushing usage events
[0m12:09:01.110384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a0fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a0fd90>]}


============================== 12:09:01.113064 | 0d5ae8fc-3137-4fba-a2b8-d6213e236f43 ==============================
[0m12:09:01.113064 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:09:01.113355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:01.191093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d5ae8fc-3137-4fba-a2b8-d6213e236f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107525e00>]}
[0m12:09:01.209316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d5ae8fc-3137-4fba-a2b8-d6213e236f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120aa5f20>]}
[0m12:09:01.210422 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:09:01.249170 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:09:01.303006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:01.303187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:01.315553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d5ae8fc-3137-4fba-a2b8-d6213e236f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c17150>]}
[0m12:09:01.358286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d5ae8fc-3137-4fba-a2b8-d6213e236f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122e9d220>]}
[0m12:09:01.358524 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m12:09:01.358672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d5ae8fc-3137-4fba-a2b8-d6213e236f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120aff3f0>]}
[0m12:09:01.359931 [info ] [MainThread]: 
[0m12:09:01.360164 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:01.362311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:09:01.385042 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:09:01.385257 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:09:01.385375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:01.386559 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:09:01.386830 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:09:01.386948 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:09:01.387082 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:09:01.387178 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:09:01.387283 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m12:09:01.387564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:01.387694 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:09:01.387812 [info ] [MainThread]: 
[0m12:09:01.387933 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m12:09:01.388124 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m12:09:01.389271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.30605817, "process_in_blocks": "0", "process_kernel_time": 0.128747, "process_mem_max_rss": "116932608", "process_out_blocks": "0", "process_user_time": 0.651157}
[0m12:09:01.389539 [debug] [MainThread]: Command `dbt run` failed at 12:09:01.389494 after 0.31 seconds
[0m12:09:01.389684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123937110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208771d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122efce90>]}
[0m12:09:01.389813 [debug] [MainThread]: Flushing usage events
[0m12:09:17.271334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e3d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dfed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047dfd90>]}


============================== 12:09:17.273669 | 2da56ba6-8116-4a72-b353-90e1057bc0bc ==============================
[0m12:09:17.273669 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:09:17.273931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:09:17.332979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2da56ba6-8116-4a72-b353-90e1057bc0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103635e00>]}
[0m12:09:17.351743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2da56ba6-8116-4a72-b353-90e1057bc0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104871f20>]}
[0m12:09:17.352175 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:09:17.386861 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:09:17.429248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:17.429427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:17.441522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2da56ba6-8116-4a72-b353-90e1057bc0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105377150>]}
[0m12:09:17.478492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2da56ba6-8116-4a72-b353-90e1057bc0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105601220>]}
[0m12:09:17.478701 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m12:09:17.478840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2da56ba6-8116-4a72-b353-90e1057bc0bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048cf3f0>]}
[0m12:09:17.480021 [info ] [MainThread]: 
[0m12:09:17.480253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:17.482344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:09:17.501237 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:09:17.501437 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:09:17.501570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:17.502085 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:09:17.502277 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:09:17.502373 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:09:17.502482 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:09:17.502566 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:09:17.502658 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m12:09:17.502901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:17.502995 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m12:09:17.503094 [info ] [MainThread]: 
[0m12:09:17.503216 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m12:09:17.503409 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m12:09:17.504040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.2579613, "process_in_blocks": "0", "process_kernel_time": 0.095823, "process_mem_max_rss": "116604928", "process_out_blocks": "0", "process_user_time": 0.635513}
[0m12:09:17.504228 [debug] [MainThread]: Command `dbt run` failed at 12:09:17.504193 after 0.26 seconds
[0m12:09:17.504358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105660e90>]}
[0m12:09:17.504481 [debug] [MainThread]: Flushing usage events
[0m12:09:22.035455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402bd90>]}


============================== 12:09:22.037177 | 56af0a6f-3a3f-4198-aa64-d634fdac6c09 ==============================
[0m12:09:22.037177 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:09:22.037452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'version_check': 'True', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:22.043880 [info ] [MainThread]: dbt version: 1.8.9
[0m12:09:22.044070 [info ] [MainThread]: python version: 3.13.0
[0m12:09:22.044188 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:09:22.044308 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:09:22.064751 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:09:22.064971 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:09:22.065102 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:09:22.065326 [info ] [MainThread]: adapter type: postgres
[0m12:09:22.065429 [info ] [MainThread]: adapter version: 1.8.2
[0m12:09:22.096961 [info ] [MainThread]: Configuration:
[0m12:09:22.097203 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:09:22.097327 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:09:22.097429 [info ] [MainThread]: Required dependencies:
[0m12:09:22.097587 [debug] [MainThread]: Executing "git --help"
[0m12:09:22.119257 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:09:22.119719 [debug] [MainThread]: STDERR: "b''"
[0m12:09:22.119847 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:09:22.119962 [info ] [MainThread]: Connection:
[0m12:09:22.120077 [info ] [MainThread]:   host: 5432
[0m12:09:22.120169 [info ] [MainThread]:   port: 5432
[0m12:09:22.120259 [info ] [MainThread]:   user: postgres
[0m12:09:22.120343 [info ] [MainThread]:   database: postgres
[0m12:09:22.120430 [info ] [MainThread]:   schema: schema
[0m12:09:22.120514 [info ] [MainThread]:   connect_timeout: 10
[0m12:09:22.120604 [info ] [MainThread]:   role: None
[0m12:09:22.120688 [info ] [MainThread]:   search_path: None
[0m12:09:22.120771 [info ] [MainThread]:   keepalives_idle: 0
[0m12:09:22.120852 [info ] [MainThread]:   sslmode: None
[0m12:09:22.120938 [info ] [MainThread]:   sslcert: None
[0m12:09:22.121021 [info ] [MainThread]:   sslkey: None
[0m12:09:22.121104 [info ] [MainThread]:   sslrootcert: None
[0m12:09:22.121188 [info ] [MainThread]:   application_name: dbt
[0m12:09:22.121269 [info ] [MainThread]:   retries: 1
[0m12:09:22.121545 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:09:22.169656 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:09:22.185069 [debug] [MainThread]: Using postgres connection "debug"
[0m12:09:22.185551 [debug] [MainThread]: On debug: select 1 as id
[0m12:09:22.185812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:22.186758 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:09:22.187451 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:09:22.187677 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:09:22.187833 [debug] [MainThread]: On debug: No close available on handle
[0m12:09:22.187996 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:09:22.188348 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:09:22.188621 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:09:22.189891 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17900488, "process_in_blocks": "0", "process_kernel_time": 0.097681, "process_mem_max_rss": "109953024", "process_out_blocks": "0", "process_user_time": 0.550905}
[0m12:09:22.190227 [debug] [MainThread]: Command `dbt debug` failed at 12:09:22.190140 after 0.18 seconds
[0m12:09:22.190379 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:09:22.190512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045eafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104665b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bf570>]}
[0m12:09:22.190666 [debug] [MainThread]: Flushing usage events
[0m13:43:09.121564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f212b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d3d90>]}


============================== 13:43:09.124067 | 60f760d3-5437-4c4e-9167-aff64e369adc ==============================
[0m13:43:09.124067 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:43:09.124344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:09.411648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60f760d3-5437-4c4e-9167-aff64e369adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104025e00>]}
[0m13:43:09.431605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60f760d3-5437-4c4e-9167-aff64e369adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105669f20>]}
[0m13:43:09.432157 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:43:09.473818 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:43:09.534753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:09.534964 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:09.547642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60f760d3-5437-4c4e-9167-aff64e369adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122917150>]}
[0m13:43:09.590533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60f760d3-5437-4c4e-9167-aff64e369adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122b9d220>]}
[0m13:43:09.590774 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m13:43:09.590913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60f760d3-5437-4c4e-9167-aff64e369adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056c33f0>]}
[0m13:43:09.592134 [info ] [MainThread]: 
[0m13:43:09.592380 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:09.594486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:43:09.620738 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:43:09.620923 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:43:09.621032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:09.621801 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m13:43:09.622060 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:43:09.622168 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:43:09.622284 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m13:43:09.622374 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:43:09.622471 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m13:43:09.622721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:09.622834 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m13:43:09.622948 [info ] [MainThread]: 
[0m13:43:09.623069 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m13:43:09.623252 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m13:43:09.624343 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5282592, "process_in_blocks": "0", "process_kernel_time": 0.139613, "process_mem_max_rss": "117587968", "process_out_blocks": "0", "process_user_time": 0.677605}
[0m13:43:09.624566 [debug] [MainThread]: Command `dbt run` failed at 13:43:09.624522 after 0.53 seconds
[0m13:43:09.624701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122d37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052771d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122bfce90>]}
[0m13:43:09.624825 [debug] [MainThread]: Flushing usage events
[0m13:43:23.292839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f452b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00fd90>]}


============================== 13:43:23.295100 | 60e46584-59f6-4b8b-b5d0-a42fbd64427b ==============================
[0m13:43:23.295100 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:43:23.295364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:23.304573 [info ] [MainThread]: dbt version: 1.8.9
[0m13:43:23.304777 [info ] [MainThread]: python version: 3.13.0
[0m13:43:23.304902 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m13:43:23.305002 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m13:43:23.337178 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m13:43:23.337396 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m13:43:23.337519 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m13:43:23.337861 [info ] [MainThread]: adapter type: postgres
[0m13:43:23.338004 [info ] [MainThread]: adapter version: 1.8.2
[0m13:43:23.369887 [info ] [MainThread]: Configuration:
[0m13:43:23.370125 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:43:23.370244 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:43:23.370345 [info ] [MainThread]: Required dependencies:
[0m13:43:23.370526 [debug] [MainThread]: Executing "git --help"
[0m13:43:23.387569 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:43:23.388040 [debug] [MainThread]: STDERR: "b''"
[0m13:43:23.388182 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:43:23.388311 [info ] [MainThread]: Connection:
[0m13:43:23.388434 [info ] [MainThread]:   host: 5432
[0m13:43:23.388527 [info ] [MainThread]:   port: 5432
[0m13:43:23.388616 [info ] [MainThread]:   user: postgres
[0m13:43:23.388707 [info ] [MainThread]:   database: postgres
[0m13:43:23.388792 [info ] [MainThread]:   schema: schema
[0m13:43:23.388880 [info ] [MainThread]:   connect_timeout: 10
[0m13:43:23.388965 [info ] [MainThread]:   role: None
[0m13:43:23.389052 [info ] [MainThread]:   search_path: None
[0m13:43:23.389148 [info ] [MainThread]:   keepalives_idle: 0
[0m13:43:23.389232 [info ] [MainThread]:   sslmode: None
[0m13:43:23.389315 [info ] [MainThread]:   sslcert: None
[0m13:43:23.389397 [info ] [MainThread]:   sslkey: None
[0m13:43:23.389481 [info ] [MainThread]:   sslrootcert: None
[0m13:43:23.389561 [info ] [MainThread]:   application_name: dbt
[0m13:43:23.389646 [info ] [MainThread]:   retries: 1
[0m13:43:23.389930 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:43:23.420623 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:43:23.438836 [debug] [MainThread]: Using postgres connection "debug"
[0m13:43:23.439003 [debug] [MainThread]: On debug: select 1 as id
[0m13:43:23.439109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:23.440920 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m13:43:23.441177 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m13:43:23.441280 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m13:43:23.441385 [debug] [MainThread]: On debug: No close available on handle
[0m13:43:23.441498 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m13:43:23.441620 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:43:23.441732 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m13:43:23.442875 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17584, "process_in_blocks": "0", "process_kernel_time": 0.115705, "process_mem_max_rss": "110264320", "process_out_blocks": "0", "process_user_time": 0.539206}
[0m13:43:23.443095 [debug] [MainThread]: Command `dbt debug` failed at 13:43:23.443053 after 0.18 seconds
[0m13:43:23.443216 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:43:23.443335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7eafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a865b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0a3570>]}
[0m13:43:23.443474 [debug] [MainThread]: Flushing usage events
[0m14:10:09.448318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d3d90>]}


============================== 14:10:09.450847 | ad99fa6c-2490-4dac-b838-f74499449f19 ==============================
[0m14:10:09.450847 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:10:09.451122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:09.460627 [info ] [MainThread]: dbt version: 1.8.9
[0m14:10:09.460814 [info ] [MainThread]: python version: 3.13.0
[0m14:10:09.460921 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m14:10:09.461018 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m14:10:09.494900 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m14:10:09.495111 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m14:10:09.495225 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m14:10:09.495553 [info ] [MainThread]: adapter type: postgres
[0m14:10:09.495720 [info ] [MainThread]: adapter version: 1.8.2
[0m14:10:09.526100 [info ] [MainThread]: Configuration:
[0m14:10:09.526323 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:10:09.526441 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:10:09.526543 [info ] [MainThread]: Required dependencies:
[0m14:10:09.526713 [debug] [MainThread]: Executing "git --help"
[0m14:10:09.543166 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:10:09.543579 [debug] [MainThread]: STDERR: "b''"
[0m14:10:09.543700 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:10:09.543816 [info ] [MainThread]: Connection:
[0m14:10:09.543939 [info ] [MainThread]:   host: 5432
[0m14:10:09.544032 [info ] [MainThread]:   port: 5432
[0m14:10:09.544118 [info ] [MainThread]:   user: postgres
[0m14:10:09.544207 [info ] [MainThread]:   database: postgres
[0m14:10:09.544290 [info ] [MainThread]:   schema: schema
[0m14:10:09.544377 [info ] [MainThread]:   connect_timeout: 10
[0m14:10:09.544465 [info ] [MainThread]:   role: None
[0m14:10:09.544547 [info ] [MainThread]:   search_path: None
[0m14:10:09.544633 [info ] [MainThread]:   keepalives_idle: 0
[0m14:10:09.544716 [info ] [MainThread]:   sslmode: None
[0m14:10:09.544799 [info ] [MainThread]:   sslcert: None
[0m14:10:09.544882 [info ] [MainThread]:   sslkey: None
[0m14:10:09.544962 [info ] [MainThread]:   sslrootcert: None
[0m14:10:09.545046 [info ] [MainThread]:   application_name: dbt
[0m14:10:09.545127 [info ] [MainThread]:   retries: 1
[0m14:10:09.545390 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:10:09.576925 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:10:09.597445 [debug] [MainThread]: Using postgres connection "debug"
[0m14:10:09.597663 [debug] [MainThread]: On debug: select 1 as id
[0m14:10:09.597784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:09.599610 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:10:09.599929 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:10:09.600049 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:10:09.600182 [debug] [MainThread]: On debug: No close available on handle
[0m14:10:09.600312 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:10:09.600439 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:10:09.600548 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:10:09.601738 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17981, "process_in_blocks": "0", "process_kernel_time": 0.123723, "process_mem_max_rss": "111411200", "process_out_blocks": "0", "process_user_time": 0.540491}
[0m14:10:09.602013 [debug] [MainThread]: Command `dbt debug` failed at 14:10:09.601960 after 0.18 seconds
[0m14:10:09.602145 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:10:09.602275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112626fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112267570>]}
[0m14:10:09.602420 [debug] [MainThread]: Flushing usage events
[0m14:19:02.512060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a352b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690fd90>]}


============================== 14:19:02.514917 | 6b65abe4-5cf1-43c8-bf32-026570bdf6b8 ==============================
[0m14:19:02.514917 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:19:02.515214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:02.594479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b65abe4-5cf1-43c8-bf32-026570bdf6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105525e00>]}
[0m14:19:02.612610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b65abe4-5cf1-43c8-bf32-026570bdf6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a5f20>]}
[0m14:19:02.613178 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:19:02.653802 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:19:02.686406 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:19:02.686667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b65abe4-5cf1-43c8-bf32-026570bdf6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107614e50>]}
[0m14:19:03.199186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b65abe4-5cf1-43c8-bf32-026570bdf6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10776c8c0>]}
[0m14:19:03.242904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b65abe4-5cf1-43c8-bf32-026570bdf6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107834ad0>]}
[0m14:19:03.243139 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m14:19:03.243278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b65abe4-5cf1-43c8-bf32-026570bdf6b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1bc70>]}
[0m14:19:03.244464 [info ] [MainThread]: 
[0m14:19:03.244687 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:19:03.246780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:19:03.269279 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:19:03.269461 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:19:03.269566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:03.271006 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:19:03.271253 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:19:03.271362 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:19:03.271479 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:19:03.271567 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:19:03.271664 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m14:19:03.271929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:03.272044 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:19:03.272151 [info ] [MainThread]: 
[0m14:19:03.272272 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m14:19:03.272438 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m14:19:03.273368 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.79080963, "process_in_blocks": "0", "process_kernel_time": 0.141017, "process_mem_max_rss": "120291328", "process_out_blocks": "0", "process_user_time": 1.116845}
[0m14:19:03.273556 [debug] [MainThread]: Command `dbt run` failed at 14:19:03.273521 after 0.79 seconds
[0m14:19:03.273683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067771d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce4100>]}
[0m14:19:03.273804 [debug] [MainThread]: Flushing usage events
[0m14:20:26.557189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10650fd90>]}


============================== 14:20:26.559568 | fea76266-a5b0-4ec1-b01f-96bf7f581c84 ==============================
[0m14:20:26.559568 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:20:26.559838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:26.638625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fea76266-a5b0-4ec1-b01f-96bf7f581c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105125e00>]}
[0m14:20:26.667667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fea76266-a5b0-4ec1-b01f-96bf7f581c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106769f20>]}
[0m14:20:26.668335 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:20:26.707962 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:20:26.765319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:26.765516 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:26.777782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fea76266-a5b0-4ec1-b01f-96bf7f581c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121813150>]}
[0m14:20:26.823319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fea76266-a5b0-4ec1-b01f-96bf7f581c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a9d220>]}
[0m14:20:26.823548 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m14:20:26.823682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fea76266-a5b0-4ec1-b01f-96bf7f581c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c33f0>]}
[0m14:20:26.824914 [info ] [MainThread]: 
[0m14:20:26.825156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:26.827209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m14:20:26.850620 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m14:20:26.850811 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:20:26.850918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:26.852471 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:20:26.852696 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m14:20:26.852802 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:20:26.852919 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:20:26.853015 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:20:26.853114 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m14:20:26.853392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:26.853539 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m14:20:26.853653 [info ] [MainThread]: 
[0m14:20:26.853778 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m14:20:26.853957 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m14:20:26.855043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3240042, "process_in_blocks": "0", "process_kernel_time": 0.132772, "process_mem_max_rss": "113131520", "process_out_blocks": "0", "process_user_time": 0.655487}
[0m14:20:26.855261 [debug] [MainThread]: Command `dbt run` failed at 14:20:26.855227 after 0.32 seconds
[0m14:20:26.855396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121afce90>]}
[0m14:20:26.855518 [debug] [MainThread]: Flushing usage events
[0m14:24:34.767712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11900fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11900fd90>]}


============================== 14:24:34.770528 | 28dfee8d-3124-4708-8b10-32e9d88e5d27 ==============================
[0m14:24:34.770528 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:24:34.770792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:24:34.780467 [info ] [MainThread]: dbt version: 1.8.9
[0m14:24:34.780689 [info ] [MainThread]: python version: 3.13.0
[0m14:24:34.780802 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m14:24:34.780906 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m14:24:34.813686 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m14:24:34.813906 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m14:24:34.814021 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m14:24:34.814361 [info ] [MainThread]: adapter type: postgres
[0m14:24:34.814530 [info ] [MainThread]: adapter version: 1.8.2
[0m14:24:34.845745 [info ] [MainThread]: Configuration:
[0m14:24:34.845970 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:24:34.846096 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:24:34.846211 [info ] [MainThread]: Required dependencies:
[0m14:24:34.846383 [debug] [MainThread]: Executing "git --help"
[0m14:24:34.859109 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:24:34.859610 [debug] [MainThread]: STDERR: "b''"
[0m14:24:34.859766 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:24:34.859889 [info ] [MainThread]: Connection:
[0m14:24:34.860011 [info ] [MainThread]:   host: 5432
[0m14:24:34.860109 [info ] [MainThread]:   port: 5432
[0m14:24:34.860202 [info ] [MainThread]:   user: postgres
[0m14:24:34.860290 [info ] [MainThread]:   database: postgres
[0m14:24:34.860378 [info ] [MainThread]:   schema: schema
[0m14:24:34.860474 [info ] [MainThread]:   connect_timeout: 10
[0m14:24:34.860564 [info ] [MainThread]:   role: None
[0m14:24:34.860651 [info ] [MainThread]:   search_path: None
[0m14:24:34.860738 [info ] [MainThread]:   keepalives_idle: 0
[0m14:24:34.860825 [info ] [MainThread]:   sslmode: None
[0m14:24:34.860913 [info ] [MainThread]:   sslcert: None
[0m14:24:34.861000 [info ] [MainThread]:   sslkey: None
[0m14:24:34.861086 [info ] [MainThread]:   sslrootcert: None
[0m14:24:34.861170 [info ] [MainThread]:   application_name: dbt
[0m14:24:34.861254 [info ] [MainThread]:   retries: 1
[0m14:24:34.861522 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:24:34.893324 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:24:34.912275 [debug] [MainThread]: Using postgres connection "debug"
[0m14:24:34.912420 [debug] [MainThread]: On debug: select 1 as id
[0m14:24:34.912522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:34.914095 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:24:34.914378 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:24:34.914484 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:24:34.914591 [debug] [MainThread]: On debug: No close available on handle
[0m14:24:34.914704 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:24:34.914825 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:24:34.914929 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:24:34.916084 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17401004, "process_in_blocks": "0", "process_kernel_time": 0.11321, "process_mem_max_rss": "111362048", "process_out_blocks": "0", "process_user_time": 0.534441}
[0m14:24:34.916329 [debug] [MainThread]: Command `dbt debug` failed at 14:24:34.916270 after 0.17 seconds
[0m14:24:34.916454 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:24:34.916594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195cefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119649b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190a3570>]}
[0m14:24:34.916755 [debug] [MainThread]: Flushing usage events
[0m14:37:25.373571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0fd90>]}


============================== 14:37:25.376462 | fb2ff160-52f8-48f2-a945-a4dadcc59738 ==============================
[0m14:37:25.376462 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:37:25.376773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:37:25.386503 [info ] [MainThread]: dbt version: 1.8.9
[0m14:37:25.386729 [info ] [MainThread]: python version: 3.13.0
[0m14:37:25.386849 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m14:37:25.386953 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m14:37:25.419752 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m14:37:25.419949 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m14:37:25.420062 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m14:37:25.420399 [info ] [MainThread]: adapter type: postgres
[0m14:37:25.420508 [info ] [MainThread]: adapter version: 1.8.2
[0m14:37:25.450439 [info ] [MainThread]: Configuration:
[0m14:37:25.450649 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:37:25.450773 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:37:25.450884 [info ] [MainThread]: Required dependencies:
[0m14:37:25.451060 [debug] [MainThread]: Executing "git --help"
[0m14:37:25.464023 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:37:25.464524 [debug] [MainThread]: STDERR: "b''"
[0m14:37:25.464673 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:37:25.464802 [info ] [MainThread]: Connection:
[0m14:37:25.464945 [info ] [MainThread]:   host: 5432
[0m14:37:25.465058 [info ] [MainThread]:   port: 5432
[0m14:37:25.465148 [info ] [MainThread]:   user: postgres
[0m14:37:25.465237 [info ] [MainThread]:   database: postgres
[0m14:37:25.465325 [info ] [MainThread]:   schema: schema
[0m14:37:25.465412 [info ] [MainThread]:   connect_timeout: 10
[0m14:37:25.465504 [info ] [MainThread]:   role: None
[0m14:37:25.465586 [info ] [MainThread]:   search_path: None
[0m14:37:25.465672 [info ] [MainThread]:   keepalives_idle: 0
[0m14:37:25.465754 [info ] [MainThread]:   sslmode: None
[0m14:37:25.465836 [info ] [MainThread]:   sslcert: None
[0m14:37:25.465921 [info ] [MainThread]:   sslkey: None
[0m14:37:25.466002 [info ] [MainThread]:   sslrootcert: None
[0m14:37:25.466085 [info ] [MainThread]:   application_name: dbt
[0m14:37:25.466169 [info ] [MainThread]:   retries: 1
[0m14:37:25.466462 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:37:25.497389 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:37:25.516628 [debug] [MainThread]: Using postgres connection "debug"
[0m14:37:25.516790 [debug] [MainThread]: On debug: select 1 as id
[0m14:37:25.516895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:25.517910 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:37:25.518208 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:37:25.518312 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:37:25.518414 [debug] [MainThread]: On debug: No close available on handle
[0m14:37:25.518536 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:37:25.518662 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:37:25.518769 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:37:25.519693 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17445004, "process_in_blocks": "0", "process_kernel_time": 0.127552, "process_mem_max_rss": "110215168", "process_out_blocks": "0", "process_user_time": 0.515775}
[0m14:37:25.519919 [debug] [MainThread]: Command `dbt debug` failed at 14:37:25.519875 after 0.17 seconds
[0m14:37:25.520042 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:37:25.520164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106549b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa3570>]}
[0m14:37:25.520306 [debug] [MainThread]: Flushing usage events
[0m14:42:13.225016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d3d90>]}


============================== 14:42:13.227534 | 5f592510-be81-413c-82ff-50622fddbfbe ==============================
[0m14:42:13.227534 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:42:13.227804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:13.237422 [info ] [MainThread]: dbt version: 1.8.9
[0m14:42:13.237630 [info ] [MainThread]: python version: 3.13.0
[0m14:42:13.237741 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m14:42:13.237840 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m14:42:13.271470 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m14:42:13.271677 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m14:42:13.271796 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m14:42:13.272108 [info ] [MainThread]: adapter type: postgres
[0m14:42:13.272214 [info ] [MainThread]: adapter version: 1.8.2
[0m14:42:13.302613 [info ] [MainThread]: Configuration:
[0m14:42:13.302828 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:42:13.302956 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:42:13.303062 [info ] [MainThread]: Required dependencies:
[0m14:42:13.303219 [debug] [MainThread]: Executing "git --help"
[0m14:42:13.320226 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:42:13.320673 [debug] [MainThread]: STDERR: "b''"
[0m14:42:13.320808 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:42:13.320935 [info ] [MainThread]: Connection:
[0m14:42:13.321058 [info ] [MainThread]:   host: 5432
[0m14:42:13.321152 [info ] [MainThread]:   port: 5432
[0m14:42:13.321244 [info ] [MainThread]:   user: postgres
[0m14:42:13.321336 [info ] [MainThread]:   database: postgres
[0m14:42:13.321425 [info ] [MainThread]:   schema: schema
[0m14:42:13.321516 [info ] [MainThread]:   connect_timeout: 10
[0m14:42:13.321602 [info ] [MainThread]:   role: None
[0m14:42:13.321690 [info ] [MainThread]:   search_path: None
[0m14:42:13.321777 [info ] [MainThread]:   keepalives_idle: 0
[0m14:42:13.321861 [info ] [MainThread]:   sslmode: None
[0m14:42:13.321950 [info ] [MainThread]:   sslcert: None
[0m14:42:13.322039 [info ] [MainThread]:   sslkey: None
[0m14:42:13.322124 [info ] [MainThread]:   sslrootcert: None
[0m14:42:13.322209 [info ] [MainThread]:   application_name: dbt
[0m14:42:13.322295 [info ] [MainThread]:   retries: 1
[0m14:42:13.322541 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:42:13.353600 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:42:13.372349 [debug] [MainThread]: Using postgres connection "debug"
[0m14:42:13.372502 [debug] [MainThread]: On debug: select 1 as id
[0m14:42:13.372602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:13.374166 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:42:13.374545 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:42:13.374646 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:42:13.374755 [debug] [MainThread]: On debug: No close available on handle
[0m14:42:13.374865 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:42:13.374977 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:42:13.375090 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:42:13.376269 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17736621, "process_in_blocks": "0", "process_kernel_time": 0.120259, "process_mem_max_rss": "109625344", "process_out_blocks": "0", "process_user_time": 0.526149}
[0m14:42:13.376499 [debug] [MainThread]: Command `dbt debug` failed at 14:42:13.376459 after 0.18 seconds
[0m14:42:13.376616 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:42:13.376742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107965b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107467570>]}
[0m14:42:13.376899 [debug] [MainThread]: Flushing usage events
[0m14:45:17.451907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd3d90>]}


============================== 14:45:17.454487 | 7685d7de-8d84-4a93-aead-1838f78826d0 ==============================
[0m14:45:17.454487 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:45:17.454774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:45:17.464216 [info ] [MainThread]: dbt version: 1.8.9
[0m14:45:17.464394 [info ] [MainThread]: python version: 3.13.0
[0m14:45:17.464504 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m14:45:17.464602 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m14:45:17.496750 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m14:45:17.496954 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m14:45:17.497072 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m14:45:17.497397 [info ] [MainThread]: adapter type: postgres
[0m14:45:17.497562 [info ] [MainThread]: adapter version: 1.8.2
[0m14:45:17.528379 [info ] [MainThread]: Configuration:
[0m14:45:17.528613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:45:17.528728 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:45:17.528834 [info ] [MainThread]: Required dependencies:
[0m14:45:17.529004 [debug] [MainThread]: Executing "git --help"
[0m14:45:17.546419 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:45:17.546866 [debug] [MainThread]: STDERR: "b''"
[0m14:45:17.547008 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:45:17.547132 [info ] [MainThread]: Connection:
[0m14:45:17.547254 [info ] [MainThread]:   host: 5432
[0m14:45:17.547348 [info ] [MainThread]:   port: 5432
[0m14:45:17.547440 [info ] [MainThread]:   user: postgres
[0m14:45:17.547526 [info ] [MainThread]:   database: postgres
[0m14:45:17.547613 [info ] [MainThread]:   schema: schema
[0m14:45:17.547699 [info ] [MainThread]:   connect_timeout: 10
[0m14:45:17.547787 [info ] [MainThread]:   role: None
[0m14:45:17.547875 [info ] [MainThread]:   search_path: None
[0m14:45:17.547960 [info ] [MainThread]:   keepalives_idle: 0
[0m14:45:17.548047 [info ] [MainThread]:   sslmode: None
[0m14:45:17.548128 [info ] [MainThread]:   sslcert: None
[0m14:45:17.548214 [info ] [MainThread]:   sslkey: None
[0m14:45:17.548296 [info ] [MainThread]:   sslrootcert: None
[0m14:45:17.548380 [info ] [MainThread]:   application_name: dbt
[0m14:45:17.548462 [info ] [MainThread]:   retries: 1
[0m14:45:17.548737 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:45:17.580544 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:45:17.599838 [debug] [MainThread]: Using postgres connection "debug"
[0m14:45:17.600019 [debug] [MainThread]: On debug: select 1 as id
[0m14:45:17.600122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:17.601300 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:45:17.601539 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:45:17.601631 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:45:17.601732 [debug] [MainThread]: On debug: No close available on handle
[0m14:45:17.601840 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:45:17.601960 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:45:17.602064 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:45:17.603277 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1768077, "process_in_blocks": "0", "process_kernel_time": 0.118529, "process_mem_max_rss": "109740032", "process_out_blocks": "0", "process_user_time": 0.530208}
[0m14:45:17.603553 [debug] [MainThread]: Command `dbt debug` failed at 14:45:17.603506 after 0.18 seconds
[0m14:45:17.603680 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:45:17.603803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107067570>]}
[0m14:45:17.603946 [debug] [MainThread]: Flushing usage events
[0m14:50:56.798571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b492b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084efd90>]}


============================== 14:50:56.801846 | 5303a7e3-c6bd-4b6a-9f89-469f6a427772 ==============================
[0m14:50:56.801846 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:50:56.802138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:56.812891 [info ] [MainThread]: dbt version: 1.8.9
[0m14:50:56.813099 [info ] [MainThread]: python version: 3.13.0
[0m14:50:56.813215 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m14:50:56.813319 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m14:50:56.848372 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m14:50:56.848598 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m14:50:56.848719 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m14:50:56.849057 [info ] [MainThread]: adapter type: postgres
[0m14:50:56.849163 [info ] [MainThread]: adapter version: 1.8.2
[0m14:50:56.880984 [info ] [MainThread]: Configuration:
[0m14:50:56.881220 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:50:56.881336 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:50:56.881441 [info ] [MainThread]: Required dependencies:
[0m14:50:56.881611 [debug] [MainThread]: Executing "git --help"
[0m14:50:56.897373 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:50:56.897854 [debug] [MainThread]: STDERR: "b''"
[0m14:50:56.897998 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:50:56.898125 [info ] [MainThread]: Connection:
[0m14:50:56.898247 [info ] [MainThread]:   host: 5432
[0m14:50:56.898346 [info ] [MainThread]:   port: 5432
[0m14:50:56.898437 [info ] [MainThread]:   user: postgres
[0m14:50:56.898527 [info ] [MainThread]:   database: postgres
[0m14:50:56.898615 [info ] [MainThread]:   schema: schema
[0m14:50:56.898705 [info ] [MainThread]:   connect_timeout: 10
[0m14:50:56.898793 [info ] [MainThread]:   role: None
[0m14:50:56.898880 [info ] [MainThread]:   search_path: None
[0m14:50:56.898965 [info ] [MainThread]:   keepalives_idle: 0
[0m14:50:56.899050 [info ] [MainThread]:   sslmode: None
[0m14:50:56.899136 [info ] [MainThread]:   sslcert: None
[0m14:50:56.899220 [info ] [MainThread]:   sslkey: None
[0m14:50:56.899305 [info ] [MainThread]:   sslrootcert: None
[0m14:50:56.899387 [info ] [MainThread]:   application_name: dbt
[0m14:50:56.899473 [info ] [MainThread]:   retries: 1
[0m14:50:56.899750 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:50:56.931458 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:50:56.950871 [debug] [MainThread]: Using postgres connection "debug"
[0m14:50:56.951034 [debug] [MainThread]: On debug: select 1 as id
[0m14:50:56.951133 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:56.952836 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m14:50:56.953061 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:50:56.953155 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:50:56.953257 [debug] [MainThread]: On debug: No close available on handle
[0m14:50:56.953372 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:50:56.953495 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:50:56.953599 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:50:56.954949 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.18998271, "process_in_blocks": "0", "process_kernel_time": 0.116495, "process_mem_max_rss": "107249664", "process_out_blocks": "0", "process_user_time": 0.521457}
[0m14:50:56.955189 [debug] [MainThread]: Command `dbt debug` failed at 14:50:56.955140 after 0.19 seconds
[0m14:50:56.955326 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:50:56.955456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aaefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b29b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108583570>]}
[0m14:50:56.955595 [debug] [MainThread]: Flushing usage events
[0m15:51:45.089187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b812b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0fd90>]}


============================== 15:51:45.091691 | aa08a7bc-efd8-4ad2-a00c-d2c227be3363 ==============================
[0m15:51:45.091691 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:51:45.091963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:45.101606 [info ] [MainThread]: dbt version: 1.8.9
[0m15:51:45.101802 [info ] [MainThread]: python version: 3.13.0
[0m15:51:45.101918 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m15:51:45.102018 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m15:51:45.136659 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m15:51:45.136884 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m15:51:45.137004 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m15:51:45.137376 [info ] [MainThread]: adapter type: postgres
[0m15:51:45.137488 [info ] [MainThread]: adapter version: 1.8.2
[0m15:51:45.169875 [info ] [MainThread]: Configuration:
[0m15:51:45.170120 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:51:45.170237 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:51:45.170338 [info ] [MainThread]: Required dependencies:
[0m15:51:45.170500 [debug] [MainThread]: Executing "git --help"
[0m15:51:45.186620 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:51:45.187062 [debug] [MainThread]: STDERR: "b''"
[0m15:51:45.187195 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:51:45.187324 [info ] [MainThread]: Connection:
[0m15:51:45.187450 [info ] [MainThread]:   host: 5432
[0m15:51:45.187545 [info ] [MainThread]:   port: 5432
[0m15:51:45.187634 [info ] [MainThread]:   user: postgres
[0m15:51:45.187723 [info ] [MainThread]:   database: postgres
[0m15:51:45.187811 [info ] [MainThread]:   schema: schema
[0m15:51:45.187900 [info ] [MainThread]:   connect_timeout: 10
[0m15:51:45.187990 [info ] [MainThread]:   role: None
[0m15:51:45.188075 [info ] [MainThread]:   search_path: None
[0m15:51:45.188163 [info ] [MainThread]:   keepalives_idle: 0
[0m15:51:45.188247 [info ] [MainThread]:   sslmode: None
[0m15:51:45.188331 [info ] [MainThread]:   sslcert: None
[0m15:51:45.188418 [info ] [MainThread]:   sslkey: None
[0m15:51:45.188504 [info ] [MainThread]:   sslrootcert: None
[0m15:51:45.188588 [info ] [MainThread]:   application_name: dbt
[0m15:51:45.188674 [info ] [MainThread]:   retries: 1
[0m15:51:45.188964 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:51:45.221704 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:51:45.240508 [debug] [MainThread]: Using postgres connection "debug"
[0m15:51:45.240670 [debug] [MainThread]: On debug: select 1 as id
[0m15:51:45.240771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:45.242460 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m15:51:45.242728 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:51:45.242836 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:51:45.242938 [debug] [MainThread]: On debug: No close available on handle
[0m15:51:45.243054 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:51:45.243175 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:51:45.243280 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:51:45.244328 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.18180154, "process_in_blocks": "0", "process_kernel_time": 0.115358, "process_mem_max_rss": "107675648", "process_out_blocks": "0", "process_user_time": 0.522975}
[0m15:51:45.244542 [debug] [MainThread]: Command `dbt debug` failed at 15:51:45.244502 after 0.18 seconds
[0m15:51:45.244661 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:51:45.244797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105249b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca3570>]}
[0m15:51:45.244947 [debug] [MainThread]: Flushing usage events
[0m16:08:00.304091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817fd90>]}


============================== 16:08:00.306631 | c139c95c-2eba-405d-83b3-a8c2f6ded12b ==============================
[0m16:08:00.306631 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:08:00.306903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:00.314748 [info ] [MainThread]: dbt version: 1.8.9
[0m16:08:00.314930 [info ] [MainThread]: python version: 3.13.0
[0m16:08:00.315047 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m16:08:00.315155 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m16:08:00.542501 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m16:08:00.542788 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m16:08:00.542949 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m16:08:00.543344 [info ] [MainThread]: adapter type: postgres
[0m16:08:00.543462 [info ] [MainThread]: adapter version: 1.8.2
[0m16:08:00.581278 [info ] [MainThread]: Configuration:
[0m16:08:00.581493 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:08:00.581605 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:08:00.581699 [info ] [MainThread]: Required dependencies:
[0m16:08:00.581854 [debug] [MainThread]: Executing "git --help"
[0m16:08:00.598708 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:08:00.599187 [debug] [MainThread]: STDERR: "b''"
[0m16:08:00.599322 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:08:00.599445 [info ] [MainThread]: Connection:
[0m16:08:00.599561 [info ] [MainThread]:   host: 5432
[0m16:08:00.599655 [info ] [MainThread]:   port: 5432
[0m16:08:00.599744 [info ] [MainThread]:   user: postgres
[0m16:08:00.599829 [info ] [MainThread]:   database: postgres
[0m16:08:00.599911 [info ] [MainThread]:   schema: schema
[0m16:08:00.599999 [info ] [MainThread]:   connect_timeout: 10
[0m16:08:00.600082 [info ] [MainThread]:   role: None
[0m16:08:00.600165 [info ] [MainThread]:   search_path: None
[0m16:08:00.600245 [info ] [MainThread]:   keepalives_idle: 0
[0m16:08:00.600327 [info ] [MainThread]:   sslmode: None
[0m16:08:00.600407 [info ] [MainThread]:   sslcert: None
[0m16:08:00.600487 [info ] [MainThread]:   sslkey: None
[0m16:08:00.600569 [info ] [MainThread]:   sslrootcert: None
[0m16:08:00.600649 [info ] [MainThread]:   application_name: dbt
[0m16:08:00.600728 [info ] [MainThread]:   retries: 1
[0m16:08:00.600995 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:08:00.641938 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:08:00.670113 [debug] [MainThread]: Using postgres connection "debug"
[0m16:08:00.670291 [debug] [MainThread]: On debug: select 1 as id
[0m16:08:00.670393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:00.671039 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m16:08:00.671310 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m16:08:00.671408 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m16:08:00.671509 [debug] [MainThread]: On debug: No close available on handle
[0m16:08:00.671622 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:08:00.671746 [info ] [MainThread]: [31m1 check failed:[0m
[0m16:08:00.671850 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:08:00.673093 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.39958903, "process_in_blocks": "0", "process_kernel_time": 0.13812, "process_mem_max_rss": "110116864", "process_out_blocks": "0", "process_user_time": 0.562536}
[0m16:08:00.673332 [debug] [MainThread]: Command `dbt debug` failed at 16:08:00.673289 after 0.40 seconds
[0m16:08:00.673457 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:08:00.673587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087be0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108213570>]}
[0m16:08:00.673733 [debug] [MainThread]: Flushing usage events
[0m10:57:28.804056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896bd90>]}


============================== 10:57:28.806618 | e4ca5394-62f1-4443-b1f3-df6473c16db3 ==============================
[0m10:57:28.806618 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:57:28.806887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:28.814563 [info ] [MainThread]: dbt version: 1.8.9
[0m10:57:28.814734 [info ] [MainThread]: python version: 3.13.0
[0m10:57:28.814845 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m10:57:28.814944 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m10:57:28.847615 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m10:57:28.847819 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m10:57:28.847935 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m10:57:28.848257 [info ] [MainThread]: adapter type: postgres
[0m10:57:28.848412 [info ] [MainThread]: adapter version: 1.8.2
[0m10:57:28.879098 [info ] [MainThread]: Configuration:
[0m10:57:28.879323 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:57:28.879437 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:57:28.879539 [info ] [MainThread]: Required dependencies:
[0m10:57:28.879708 [debug] [MainThread]: Executing "git --help"
[0m10:57:28.893563 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:57:28.893967 [debug] [MainThread]: STDERR: "b''"
[0m10:57:28.894085 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:57:28.894199 [info ] [MainThread]: Connection:
[0m10:57:28.894315 [info ] [MainThread]:   host: 5432
[0m10:57:28.894412 [info ] [MainThread]:   port: 5432
[0m10:57:28.894505 [info ] [MainThread]:   user: postgres
[0m10:57:28.894590 [info ] [MainThread]:   database: postgres
[0m10:57:28.894680 [info ] [MainThread]:   schema: schema
[0m10:57:28.894766 [info ] [MainThread]:   connect_timeout: 10
[0m10:57:28.894852 [info ] [MainThread]:   role: None
[0m10:57:28.894938 [info ] [MainThread]:   search_path: None
[0m10:57:28.895021 [info ] [MainThread]:   keepalives_idle: 0
[0m10:57:28.895106 [info ] [MainThread]:   sslmode: None
[0m10:57:28.895194 [info ] [MainThread]:   sslcert: None
[0m10:57:28.895277 [info ] [MainThread]:   sslkey: None
[0m10:57:28.895361 [info ] [MainThread]:   sslrootcert: None
[0m10:57:28.895444 [info ] [MainThread]:   application_name: dbt
[0m10:57:28.895528 [info ] [MainThread]:   retries: 1
[0m10:57:28.895791 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:28.926423 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:57:28.945298 [debug] [MainThread]: Using postgres connection "debug"
[0m10:57:28.945457 [debug] [MainThread]: On debug: select 1 as id
[0m10:57:28.945561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:28.947358 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m10:57:28.947617 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m10:57:28.947726 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m10:57:28.947825 [debug] [MainThread]: On debug: No close available on handle
[0m10:57:28.947937 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m10:57:28.948056 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:57:28.948163 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m10:57:28.949357 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17510895, "process_in_blocks": "0", "process_kernel_time": 0.115422, "process_mem_max_rss": "107511808", "process_out_blocks": "0", "process_user_time": 0.520212}
[0m10:57:28.949566 [debug] [MainThread]: Command `dbt debug` failed at 10:57:28.949528 after 0.18 seconds
[0m10:57:28.949683 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:57:28.949800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f36fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089ff570>]}
[0m10:57:28.949938 [debug] [MainThread]: Flushing usage events
[0m11:10:11.937725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031b52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5fd90>]}


============================== 11:10:11.940476 | 0c59ec47-2812-45a5-928f-bca19532c988 ==============================
[0m11:10:11.940476 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:10:11.940753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:11.948324 [info ] [MainThread]: dbt version: 1.8.9
[0m11:10:11.948505 [info ] [MainThread]: python version: 3.13.0
[0m11:10:11.948619 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m11:10:11.948720 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m11:10:11.982547 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m11:10:11.982748 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m11:10:11.982862 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m11:10:11.983190 [info ] [MainThread]: adapter type: postgres
[0m11:10:11.983359 [info ] [MainThread]: adapter version: 1.8.2
[0m11:10:12.014612 [info ] [MainThread]: Configuration:
[0m11:10:12.014830 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:10:12.014944 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:10:12.015049 [info ] [MainThread]: Required dependencies:
[0m11:10:12.015202 [debug] [MainThread]: Executing "git --help"
[0m11:10:12.027210 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:10:12.027695 [debug] [MainThread]: STDERR: "b''"
[0m11:10:12.027817 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:10:12.027936 [info ] [MainThread]: Connection:
[0m11:10:12.028062 [info ] [MainThread]:   host: 5432
[0m11:10:12.028157 [info ] [MainThread]:   port: 5432
[0m11:10:12.028248 [info ] [MainThread]:   user: postgres
[0m11:10:12.028336 [info ] [MainThread]:   database: postgres
[0m11:10:12.028421 [info ] [MainThread]:   schema: schema
[0m11:10:12.028506 [info ] [MainThread]:   connect_timeout: 10
[0m11:10:12.028594 [info ] [MainThread]:   role: None
[0m11:10:12.028675 [info ] [MainThread]:   search_path: None
[0m11:10:12.028760 [info ] [MainThread]:   keepalives_idle: 0
[0m11:10:12.028842 [info ] [MainThread]:   sslmode: None
[0m11:10:12.028923 [info ] [MainThread]:   sslcert: None
[0m11:10:12.029009 [info ] [MainThread]:   sslkey: None
[0m11:10:12.029088 [info ] [MainThread]:   sslrootcert: None
[0m11:10:12.029171 [info ] [MainThread]:   application_name: dbt
[0m11:10:12.029254 [info ] [MainThread]:   retries: 1
[0m11:10:12.029527 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:10:12.060621 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:10:12.080203 [debug] [MainThread]: Using postgres connection "debug"
[0m11:10:12.080358 [debug] [MainThread]: On debug: select 1 as id
[0m11:10:12.080460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:12.081996 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m11:10:12.082237 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:10:12.082338 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:10:12.082440 [debug] [MainThread]: On debug: No close available on handle
[0m11:10:12.082553 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:10:12.082675 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:10:12.082781 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:10:12.083684 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1732185, "process_in_blocks": "0", "process_kernel_time": 0.117149, "process_mem_max_rss": "109264896", "process_out_blocks": "0", "process_user_time": 0.516745}
[0m11:10:12.083903 [debug] [MainThread]: Command `dbt debug` failed at 11:10:12.083859 after 0.17 seconds
[0m11:10:12.084023 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:10:12.084147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10519e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf3570>]}
[0m11:10:12.084288 [debug] [MainThread]: Flushing usage events
[0m11:18:33.678083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028312b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dbd90>]}


============================== 11:18:33.680241 | e4426711-9264-4a8b-9e3f-7bd332ed02fb ==============================
[0m11:18:33.680241 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:18:33.680510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:18:33.687758 [info ] [MainThread]: dbt version: 1.8.9
[0m11:18:33.687955 [info ] [MainThread]: python version: 3.13.0
[0m11:18:33.688067 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m11:18:33.688167 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m11:18:33.720811 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m11:18:33.721006 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m11:18:33.721117 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m11:18:33.721465 [info ] [MainThread]: adapter type: postgres
[0m11:18:33.721642 [info ] [MainThread]: adapter version: 1.8.2
[0m11:18:33.752643 [info ] [MainThread]: Configuration:
[0m11:18:33.752865 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:18:33.752991 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:18:33.753093 [info ] [MainThread]: Required dependencies:
[0m11:18:33.753261 [debug] [MainThread]: Executing "git --help"
[0m11:18:33.762910 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:18:33.763313 [debug] [MainThread]: STDERR: "b''"
[0m11:18:33.763442 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:18:33.763558 [info ] [MainThread]: Connection:
[0m11:18:33.763675 [info ] [MainThread]:   host: 5432
[0m11:18:33.763770 [info ] [MainThread]:   port: 5432
[0m11:18:33.763855 [info ] [MainThread]:   user: postgres
[0m11:18:33.763941 [info ] [MainThread]:   database: postgres
[0m11:18:33.764022 [info ] [MainThread]:   schema: schema
[0m11:18:33.764107 [info ] [MainThread]:   connect_timeout: 10
[0m11:18:33.764192 [info ] [MainThread]:   role: None
[0m11:18:33.764273 [info ] [MainThread]:   search_path: None
[0m11:18:33.764360 [info ] [MainThread]:   keepalives_idle: 0
[0m11:18:33.764445 [info ] [MainThread]:   sslmode: None
[0m11:18:33.764529 [info ] [MainThread]:   sslcert: None
[0m11:18:33.764613 [info ] [MainThread]:   sslkey: None
[0m11:18:33.764695 [info ] [MainThread]:   sslrootcert: None
[0m11:18:33.764779 [info ] [MainThread]:   application_name: dbt
[0m11:18:33.764860 [info ] [MainThread]:   retries: 1
[0m11:18:33.765130 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:18:33.795741 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:18:33.814206 [debug] [MainThread]: Using postgres connection "debug"
[0m11:18:33.814362 [debug] [MainThread]: On debug: select 1 as id
[0m11:18:33.814465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:33.815415 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m11:18:33.815629 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:18:33.815720 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:18:33.815816 [debug] [MainThread]: On debug: No close available on handle
[0m11:18:33.815926 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:18:33.816049 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:18:33.816152 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:18:33.817088 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16566528, "process_in_blocks": "0", "process_kernel_time": 0.109353, "process_mem_max_rss": "107708416", "process_out_blocks": "0", "process_user_time": 0.520313}
[0m11:18:33.817320 [debug] [MainThread]: Command `dbt debug` failed at 11:18:33.817275 after 0.17 seconds
[0m11:18:33.817453 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:18:33.817585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048360f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426f570>]}
[0m11:18:33.817731 [debug] [MainThread]: Flushing usage events
[0m11:21:03.264461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10479bd90>]}


============================== 11:21:03.266848 | e0e51dd2-8b2f-448c-b39d-f77b5f92b0cd ==============================
[0m11:21:03.266848 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:21:03.267119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:03.274676 [info ] [MainThread]: dbt version: 1.8.9
[0m11:21:03.274852 [info ] [MainThread]: python version: 3.13.0
[0m11:21:03.274973 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m11:21:03.275075 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m11:21:03.308336 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m11:21:03.308537 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m11:21:03.308649 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m11:21:03.308978 [info ] [MainThread]: adapter type: postgres
[0m11:21:03.309150 [info ] [MainThread]: adapter version: 1.8.2
[0m11:21:03.339573 [info ] [MainThread]: Configuration:
[0m11:21:03.339797 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:21:03.339911 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:21:03.340014 [info ] [MainThread]: Required dependencies:
[0m11:21:03.340176 [debug] [MainThread]: Executing "git --help"
[0m11:21:03.352289 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:21:03.352707 [debug] [MainThread]: STDERR: "b''"
[0m11:21:03.352838 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:21:03.352960 [info ] [MainThread]: Connection:
[0m11:21:03.353082 [info ] [MainThread]:   host: 5432
[0m11:21:03.353172 [info ] [MainThread]:   port: 5432
[0m11:21:03.353261 [info ] [MainThread]:   user: postgres
[0m11:21:03.353346 [info ] [MainThread]:   database: postgres
[0m11:21:03.353432 [info ] [MainThread]:   schema: schema
[0m11:21:03.353519 [info ] [MainThread]:   connect_timeout: 10
[0m11:21:03.353605 [info ] [MainThread]:   role: None
[0m11:21:03.353691 [info ] [MainThread]:   search_path: None
[0m11:21:03.353774 [info ] [MainThread]:   keepalives_idle: 0
[0m11:21:03.353860 [info ] [MainThread]:   sslmode: None
[0m11:21:03.353943 [info ] [MainThread]:   sslcert: None
[0m11:21:03.354026 [info ] [MainThread]:   sslkey: None
[0m11:21:03.354108 [info ] [MainThread]:   sslrootcert: None
[0m11:21:03.354190 [info ] [MainThread]:   application_name: dbt
[0m11:21:03.354274 [info ] [MainThread]:   retries: 1
[0m11:21:03.354543 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:21:03.385895 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:21:03.404681 [debug] [MainThread]: Using postgres connection "debug"
[0m11:21:03.404829 [debug] [MainThread]: On debug: select 1 as id
[0m11:21:03.404927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:21:03.406766 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m11:21:03.407061 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:21:03.407173 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:21:03.407274 [debug] [MainThread]: On debug: No close available on handle
[0m11:21:03.407385 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:21:03.407507 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:21:03.407609 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:21:03.408759 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17325597, "process_in_blocks": "0", "process_kernel_time": 0.117119, "process_mem_max_rss": "110985216", "process_out_blocks": "0", "process_user_time": 0.541566}
[0m11:21:03.408989 [debug] [MainThread]: Command `dbt debug` failed at 11:21:03.408946 after 0.17 seconds
[0m11:21:03.409105 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:21:03.409227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d66fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482f570>]}
[0m11:21:03.409368 [debug] [MainThread]: Flushing usage events
[0m11:23:54.521338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c17ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c17d90>]}


============================== 11:23:54.523726 | 5eccc72f-7eee-4c5d-9e3d-05f0e0117f58 ==============================
[0m11:23:54.523726 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:23:54.524009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:54.530983 [info ] [MainThread]: dbt version: 1.8.9
[0m11:23:54.531138 [info ] [MainThread]: python version: 3.13.0
[0m11:23:54.531245 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m11:23:54.531342 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m11:23:54.565922 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m11:23:54.566137 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m11:23:54.566248 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m11:23:54.566580 [info ] [MainThread]: adapter type: postgres
[0m11:23:54.566684 [info ] [MainThread]: adapter version: 1.8.2
[0m11:23:54.602678 [info ] [MainThread]: Configuration:
[0m11:23:54.602940 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:23:54.603055 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:23:54.603154 [info ] [MainThread]: Required dependencies:
[0m11:23:54.603336 [debug] [MainThread]: Executing "git --help"
[0m11:23:54.614116 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:23:54.614681 [debug] [MainThread]: STDERR: "b''"
[0m11:23:54.614845 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:23:54.614979 [info ] [MainThread]: Connection:
[0m11:23:54.615114 [info ] [MainThread]:   host: 5432
[0m11:23:54.615222 [info ] [MainThread]:   port: 5432
[0m11:23:54.615315 [info ] [MainThread]:   user: postgres
[0m11:23:54.615475 [info ] [MainThread]:   database: postgres
[0m11:23:54.615645 [info ] [MainThread]:   schema: schema
[0m11:23:54.615759 [info ] [MainThread]:   connect_timeout: 10
[0m11:23:54.615862 [info ] [MainThread]:   role: None
[0m11:23:54.615959 [info ] [MainThread]:   search_path: None
[0m11:23:54.616048 [info ] [MainThread]:   keepalives_idle: 0
[0m11:23:54.616142 [info ] [MainThread]:   sslmode: None
[0m11:23:54.616230 [info ] [MainThread]:   sslcert: None
[0m11:23:54.616321 [info ] [MainThread]:   sslkey: None
[0m11:23:54.616407 [info ] [MainThread]:   sslrootcert: None
[0m11:23:54.616501 [info ] [MainThread]:   application_name: dbt
[0m11:23:54.616587 [info ] [MainThread]:   retries: 1
[0m11:23:54.616907 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:23:54.652101 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:23:54.672224 [debug] [MainThread]: Using postgres connection "debug"
[0m11:23:54.672460 [debug] [MainThread]: On debug: select 1 as id
[0m11:23:54.672578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:54.674550 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m11:23:54.674887 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:23:54.675015 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:23:54.675143 [debug] [MainThread]: On debug: No close available on handle
[0m11:23:54.675274 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:23:54.675418 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:23:54.675525 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:23:54.676870 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.18356554, "process_in_blocks": "0", "process_kernel_time": 0.124251, "process_mem_max_rss": "112246784", "process_out_blocks": "0", "process_user_time": 0.609361}
[0m11:23:54.677181 [debug] [MainThread]: Command `dbt debug` failed at 11:23:54.677130 after 0.18 seconds
[0m11:23:54.677337 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:23:54.677482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12632efd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12639e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123cab570>]}
[0m11:23:54.677647 [debug] [MainThread]: Flushing usage events
[0m11:24:58.592054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027e52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10418fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10418fd90>]}


============================== 11:24:58.593711 | 2759cbda-d20c-4d25-97e4-eeb937849f7b ==============================
[0m11:24:58.593711 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:24:58.593989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:58.597471 [info ] [MainThread]: dbt version: 1.8.9
[0m11:24:58.597628 [info ] [MainThread]: python version: 3.13.0
[0m11:24:58.597739 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m11:24:58.597844 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m11:24:58.618365 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m11:24:58.618568 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m11:24:58.618692 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m11:24:58.618907 [info ] [MainThread]: adapter type: postgres
[0m11:24:58.619011 [info ] [MainThread]: adapter version: 1.8.2
[0m11:24:58.649061 [info ] [MainThread]: Configuration:
[0m11:24:58.649275 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:24:58.649392 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:24:58.649494 [info ] [MainThread]: Required dependencies:
[0m11:24:58.649662 [debug] [MainThread]: Executing "git --help"
[0m11:24:58.657929 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:24:58.658336 [debug] [MainThread]: STDERR: "b''"
[0m11:24:58.658450 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:24:58.658566 [info ] [MainThread]: Connection:
[0m11:24:58.658701 [info ] [MainThread]:   host: 5432
[0m11:24:58.658794 [info ] [MainThread]:   port: 5432
[0m11:24:58.658887 [info ] [MainThread]:   user: postgres
[0m11:24:58.658992 [info ] [MainThread]:   database: postgres
[0m11:24:58.659092 [info ] [MainThread]:   schema: schema
[0m11:24:58.659187 [info ] [MainThread]:   connect_timeout: 10
[0m11:24:58.659280 [info ] [MainThread]:   role: None
[0m11:24:58.659367 [info ] [MainThread]:   search_path: None
[0m11:24:58.659459 [info ] [MainThread]:   keepalives_idle: 0
[0m11:24:58.659553 [info ] [MainThread]:   sslmode: None
[0m11:24:58.659653 [info ] [MainThread]:   sslcert: None
[0m11:24:58.659747 [info ] [MainThread]:   sslkey: None
[0m11:24:58.659834 [info ] [MainThread]:   sslrootcert: None
[0m11:24:58.659925 [info ] [MainThread]:   application_name: dbt
[0m11:24:58.660015 [info ] [MainThread]:   retries: 1
[0m11:24:58.660260 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:24:58.687570 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:24:58.702202 [debug] [MainThread]: Using postgres connection "debug"
[0m11:24:58.702356 [debug] [MainThread]: On debug: select 1 as id
[0m11:24:58.702460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:58.703010 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m11:24:58.703309 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m11:24:58.703420 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m11:24:58.703523 [debug] [MainThread]: On debug: No close available on handle
[0m11:24:58.703632 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:24:58.703758 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:24:58.703880 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:24:58.704521 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13610709, "process_in_blocks": "0", "process_kernel_time": 0.087298, "process_mem_max_rss": "107888640", "process_out_blocks": "0", "process_user_time": 0.528462}
[0m11:24:58.704739 [debug] [MainThread]: Command `dbt debug` failed at 11:24:58.704696 after 0.14 seconds
[0m11:24:58.704860 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:24:58.704981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10475afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ea0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104223570>]}
[0m11:24:58.705119 [debug] [MainThread]: Flushing usage events
[0m11:59:40.788985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074892b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e33ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e33d90>]}


============================== 11:59:40.790832 | 55bae897-dcea-483b-99b0-8771be1e1c7e ==============================
[0m11:59:40.790832 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:59:40.791110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:hub', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:59:40.858749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55bae897-dcea-483b-99b0-8771be1e1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c89e00>]}
[0m11:59:40.876430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55bae897-dcea-483b-99b0-8771be1e1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ecdf20>]}
[0m11:59:40.876781 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:59:40.912115 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:59:40.944074 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:59:40.944305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55bae897-dcea-483b-99b0-8771be1e1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099d8e50>]}
[0m11:59:41.427294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55bae897-dcea-483b-99b0-8771be1e1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a908c0>]}
[0m11:59:41.462920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55bae897-dcea-483b-99b0-8771be1e1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109448750>]}
[0m11:59:41.463122 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m11:59:41.463259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55bae897-dcea-483b-99b0-8771be1e1c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f2b930>]}
[0m11:59:41.464042 [info ] [MainThread]: 
[0m11:59:41.464259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:59:41.465686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m11:59:41.483824 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m11:59:41.484004 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:59:41.484111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:41.484564 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m11:59:41.484753 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m11:59:41.484848 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:59:41.484960 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m11:59:41.485045 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m11:59:41.485140 [debug] [ThreadPool]: On list_postgres: No close available on handle
[0m11:59:41.485388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:41.485482 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m11:59:41.485599 [info ] [MainThread]: 
[0m11:59:41.485720 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m11:59:41.485902 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m11:59:41.486515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.72120845, "process_in_blocks": "0", "process_kernel_time": 0.10132, "process_mem_max_rss": "120307712", "process_out_blocks": "0", "process_user_time": 1.07831}
[0m11:59:41.486700 [debug] [MainThread]: Command `dbt run` failed at 11:59:41.486665 after 0.72 seconds
[0m11:59:41.486823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d17330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e41b0>]}
[0m11:59:41.486944 [debug] [MainThread]: Flushing usage events
[0m12:01:24.338613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693fd90>]}


============================== 12:01:24.340696 | 7beb94a3-9f32-4a52-95f8-c40de5010cf1 ==============================
[0m12:01:24.340696 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:01:24.340961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:01:24.347745 [info ] [MainThread]: dbt version: 1.8.9
[0m12:01:24.347916 [info ] [MainThread]: python version: 3.13.0
[0m12:01:24.348034 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:01:24.348135 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:01:24.380379 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:01:24.380602 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:01:24.380727 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:01:24.381078 [info ] [MainThread]: adapter type: postgres
[0m12:01:24.381251 [info ] [MainThread]: adapter version: 1.8.2
[0m12:01:24.412690 [info ] [MainThread]: Configuration:
[0m12:01:24.412933 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:01:24.413080 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:01:24.413180 [info ] [MainThread]: Required dependencies:
[0m12:01:24.413351 [debug] [MainThread]: Executing "git --help"
[0m12:01:24.422289 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:01:24.422688 [debug] [MainThread]: STDERR: "b''"
[0m12:01:24.422812 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:01:24.422931 [info ] [MainThread]: Connection:
[0m12:01:24.423051 [info ] [MainThread]:   host: 5432
[0m12:01:24.423143 [info ] [MainThread]:   port: 5432
[0m12:01:24.423232 [info ] [MainThread]:   user: postgres
[0m12:01:24.423323 [info ] [MainThread]:   database: postgres
[0m12:01:24.423407 [info ] [MainThread]:   schema: schema
[0m12:01:24.423494 [info ] [MainThread]:   connect_timeout: 10
[0m12:01:24.423579 [info ] [MainThread]:   role: None
[0m12:01:24.423663 [info ] [MainThread]:   search_path: None
[0m12:01:24.423747 [info ] [MainThread]:   keepalives_idle: 0
[0m12:01:24.423829 [info ] [MainThread]:   sslmode: None
[0m12:01:24.423912 [info ] [MainThread]:   sslcert: None
[0m12:01:24.423995 [info ] [MainThread]:   sslkey: None
[0m12:01:24.424075 [info ] [MainThread]:   sslrootcert: None
[0m12:01:24.424158 [info ] [MainThread]:   application_name: dbt
[0m12:01:24.424237 [info ] [MainThread]:   retries: 1
[0m12:01:24.424506 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:01:24.455739 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:01:24.474117 [debug] [MainThread]: Using postgres connection "debug"
[0m12:01:24.474286 [debug] [MainThread]: On debug: select 1 as id
[0m12:01:24.474390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:24.475888 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:01:24.476177 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:01:24.476294 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:01:24.476408 [debug] [MainThread]: On debug: No close available on handle
[0m12:01:24.476534 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:01:24.476655 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:01:24.476758 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:01:24.477692 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16493271, "process_in_blocks": "0", "process_kernel_time": 0.106746, "process_mem_max_rss": "110788608", "process_out_blocks": "0", "process_user_time": 0.519243}
[0m12:01:24.477909 [debug] [MainThread]: Command `dbt debug` failed at 12:01:24.477870 after 0.17 seconds
[0m12:01:24.478030 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:01:24.478152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d3570>]}
[0m12:01:24.478299 [debug] [MainThread]: Flushing usage events
[0m12:33:31.991619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9dbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9dbd90>]}


============================== 12:33:31.993888 | 2f8e2594-a6f8-44ce-a98d-1eb3747b1626 ==============================
[0m12:33:31.993888 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:33:31.994152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:33:32.000937 [info ] [MainThread]: dbt version: 1.8.9
[0m12:33:32.001107 [info ] [MainThread]: python version: 3.13.0
[0m12:33:32.001222 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:33:32.001325 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:33:32.033929 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:33:32.034137 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:33:32.034253 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:33:32.034558 [info ] [MainThread]: adapter type: postgres
[0m12:33:32.034665 [info ] [MainThread]: adapter version: 1.8.2
[0m12:33:32.065140 [info ] [MainThread]: Configuration:
[0m12:33:32.065356 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:33:32.065472 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:33:32.065571 [info ] [MainThread]: Required dependencies:
[0m12:33:32.065724 [debug] [MainThread]: Executing "git --help"
[0m12:33:32.073025 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:33:32.073554 [debug] [MainThread]: STDERR: "b''"
[0m12:33:32.073715 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:33:32.073844 [info ] [MainThread]: Connection:
[0m12:33:32.073979 [info ] [MainThread]:   host: 5432
[0m12:33:32.074087 [info ] [MainThread]:   port: 5432
[0m12:33:32.074192 [info ] [MainThread]:   user: postgres
[0m12:33:32.074291 [info ] [MainThread]:   database: postgres
[0m12:33:32.074382 [info ] [MainThread]:   schema: schema
[0m12:33:32.074477 [info ] [MainThread]:   connect_timeout: 10
[0m12:33:32.074582 [info ] [MainThread]:   role: None
[0m12:33:32.074682 [info ] [MainThread]:   search_path: None
[0m12:33:32.074794 [info ] [MainThread]:   keepalives_idle: 0
[0m12:33:32.074893 [info ] [MainThread]:   sslmode: None
[0m12:33:32.074983 [info ] [MainThread]:   sslcert: None
[0m12:33:32.075083 [info ] [MainThread]:   sslkey: None
[0m12:33:32.075174 [info ] [MainThread]:   sslrootcert: None
[0m12:33:32.075271 [info ] [MainThread]:   application_name: dbt
[0m12:33:32.075363 [info ] [MainThread]:   retries: 1
[0m12:33:32.075647 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:33:32.106524 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:33:32.125473 [debug] [MainThread]: Using postgres connection "debug"
[0m12:33:32.125667 [debug] [MainThread]: On debug: select 1 as id
[0m12:33:32.125771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:33:32.126998 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:33:32.127240 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:33:32.127333 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:33:32.127430 [debug] [MainThread]: On debug: No close available on handle
[0m12:33:32.127541 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:33:32.127661 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:33:32.127764 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:33:32.128832 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16250663, "process_in_blocks": "0", "process_kernel_time": 0.105215, "process_mem_max_rss": "110198784", "process_out_blocks": "0", "process_user_time": 0.507746}
[0m12:33:32.129092 [debug] [MainThread]: Command `dbt debug` failed at 12:33:32.129046 after 0.16 seconds
[0m12:33:32.129233 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:33:32.129363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aefefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6f570>]}
[0m12:33:32.129504 [debug] [MainThread]: Flushing usage events
[0m12:34:06.856961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118dbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118dbd90>]}


============================== 12:34:06.859966 | 771b77d7-9211-46d7-985f-33ab4b64f8b4 ==============================
[0m12:34:06.859966 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:34:06.860279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:34:06.869621 [info ] [MainThread]: dbt version: 1.8.9
[0m12:34:06.869858 [info ] [MainThread]: python version: 3.13.0
[0m12:34:06.869974 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:34:06.870077 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:34:06.924181 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:34:06.924569 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:34:06.924785 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:34:06.925442 [info ] [MainThread]: adapter type: postgres
[0m12:34:06.925700 [info ] [MainThread]: adapter version: 1.8.2
[0m12:34:06.969790 [info ] [MainThread]: Configuration:
[0m12:34:06.970085 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:34:06.970239 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:34:06.970345 [info ] [MainThread]: Required dependencies:
[0m12:34:06.970524 [debug] [MainThread]: Executing "git --help"
[0m12:34:06.987462 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:34:06.988422 [debug] [MainThread]: STDERR: "b''"
[0m12:34:06.988643 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:34:06.988793 [info ] [MainThread]: Connection:
[0m12:34:06.988933 [info ] [MainThread]:   host: 5432
[0m12:34:06.989036 [info ] [MainThread]:   port: 5432
[0m12:34:06.989134 [info ] [MainThread]:   user: postgres
[0m12:34:06.989223 [info ] [MainThread]:   database: postgres
[0m12:34:06.989313 [info ] [MainThread]:   schema: schema
[0m12:34:06.989514 [info ] [MainThread]:   connect_timeout: 10
[0m12:34:06.989662 [info ] [MainThread]:   role: None
[0m12:34:06.989765 [info ] [MainThread]:   search_path: None
[0m12:34:06.989861 [info ] [MainThread]:   keepalives_idle: 0
[0m12:34:06.989954 [info ] [MainThread]:   sslmode: None
[0m12:34:06.990045 [info ] [MainThread]:   sslcert: None
[0m12:34:06.990134 [info ] [MainThread]:   sslkey: None
[0m12:34:06.990222 [info ] [MainThread]:   sslrootcert: None
[0m12:34:06.990309 [info ] [MainThread]:   application_name: dbt
[0m12:34:06.990500 [info ] [MainThread]:   retries: 1
[0m12:34:06.990929 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:34:07.028717 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:34:07.048531 [debug] [MainThread]: Using postgres connection "debug"
[0m12:34:07.048753 [debug] [MainThread]: On debug: select 1 as id
[0m12:34:07.048874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:34:07.050505 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:34:07.050824 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:34:07.050945 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:34:07.051077 [debug] [MainThread]: On debug: No close available on handle
[0m12:34:07.051212 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:34:07.051342 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:34:07.051452 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:34:07.052818 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.23271479, "process_in_blocks": "0", "process_kernel_time": 0.157968, "process_mem_max_rss": "112295936", "process_out_blocks": "0", "process_user_time": 0.694863}
[0m12:34:07.053159 [debug] [MainThread]: Command `dbt debug` failed at 12:34:07.053104 after 0.23 seconds
[0m12:34:07.053320 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:34:07.053466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e52fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ede0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11196f570>]}
[0m12:34:07.053638 [debug] [MainThread]: Flushing usage events
[0m12:36:32.325802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048752b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621fd90>]}


============================== 12:36:32.328181 | 12001912-bd52-4eab-bb40-f20f3953f703 ==============================
[0m12:36:32.328181 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:36:32.328468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:36:32.335875 [info ] [MainThread]: dbt version: 1.8.9
[0m12:36:32.336030 [info ] [MainThread]: python version: 3.13.0
[0m12:36:32.336138 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:36:32.336242 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:36:32.370576 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:36:32.370812 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:36:32.370930 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:36:32.371265 [info ] [MainThread]: adapter type: postgres
[0m12:36:32.371430 [info ] [MainThread]: adapter version: 1.8.2
[0m12:36:32.404052 [info ] [MainThread]: Configuration:
[0m12:36:32.404282 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:36:32.404404 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:36:32.404516 [info ] [MainThread]: Required dependencies:
[0m12:36:32.404685 [debug] [MainThread]: Executing "git --help"
[0m12:36:32.413748 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:36:32.414219 [debug] [MainThread]: STDERR: "b''"
[0m12:36:32.414347 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:36:32.414465 [info ] [MainThread]: Connection:
[0m12:36:32.414582 [info ] [MainThread]:   host: 5432
[0m12:36:32.414678 [info ] [MainThread]:   port: 5432
[0m12:36:32.414770 [info ] [MainThread]:   user: postgres
[0m12:36:32.414857 [info ] [MainThread]:   database: postgres
[0m12:36:32.414941 [info ] [MainThread]:   schema: schema
[0m12:36:32.415029 [info ] [MainThread]:   connect_timeout: 10
[0m12:36:32.415117 [info ] [MainThread]:   role: None
[0m12:36:32.415207 [info ] [MainThread]:   search_path: None
[0m12:36:32.415288 [info ] [MainThread]:   keepalives_idle: 0
[0m12:36:32.415372 [info ] [MainThread]:   sslmode: None
[0m12:36:32.415451 [info ] [MainThread]:   sslcert: None
[0m12:36:32.415540 [info ] [MainThread]:   sslkey: None
[0m12:36:32.415626 [info ] [MainThread]:   sslrootcert: None
[0m12:36:32.415710 [info ] [MainThread]:   application_name: dbt
[0m12:36:32.415791 [info ] [MainThread]:   retries: 1
[0m12:36:32.416053 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:36:32.449203 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:36:32.468093 [debug] [MainThread]: Using postgres connection "debug"
[0m12:36:32.468263 [debug] [MainThread]: On debug: select 1 as id
[0m12:36:32.468365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:32.469923 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:36:32.470231 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:36:32.470334 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:36:32.470435 [debug] [MainThread]: On debug: No close available on handle
[0m12:36:32.470543 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:36:32.470668 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:36:32.470770 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:36:32.471704 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.17378305, "process_in_blocks": "0", "process_kernel_time": 0.123916, "process_mem_max_rss": "108707840", "process_out_blocks": "0", "process_user_time": 0.526516}
[0m12:36:32.471924 [debug] [MainThread]: Command `dbt debug` failed at 12:36:32.471877 after 0.17 seconds
[0m12:36:32.472041 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:36:32.472164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067eafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b3570>]}
[0m12:36:32.472303 [debug] [MainThread]: Flushing usage events
[0m12:38:48.880725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdbd90>]}


============================== 12:38:48.882891 | fbd8d76a-59a1-4fa4-87e5-764991325eaf ==============================
[0m12:38:48.882891 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:38:48.883153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:48.889560 [info ] [MainThread]: dbt version: 1.8.9
[0m12:38:48.889728 [info ] [MainThread]: python version: 3.13.0
[0m12:38:48.889843 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:38:48.889943 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:38:48.921334 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:38:48.921536 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:38:48.921650 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:38:48.921949 [info ] [MainThread]: adapter type: postgres
[0m12:38:48.922054 [info ] [MainThread]: adapter version: 1.8.2
[0m12:38:48.952752 [info ] [MainThread]: Configuration:
[0m12:38:48.952993 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:38:48.953110 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:38:48.953209 [info ] [MainThread]: Required dependencies:
[0m12:38:48.953386 [debug] [MainThread]: Executing "git --help"
[0m12:38:48.961489 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:38:48.962037 [debug] [MainThread]: STDERR: "b''"
[0m12:38:48.962239 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:38:48.962390 [info ] [MainThread]: Connection:
[0m12:38:48.962532 [info ] [MainThread]:   host: 5432
[0m12:38:48.962635 [info ] [MainThread]:   port: 5432
[0m12:38:48.962735 [info ] [MainThread]:   user: postgres
[0m12:38:48.962833 [info ] [MainThread]:   database: postgres
[0m12:38:48.962928 [info ] [MainThread]:   schema: schema
[0m12:38:48.963021 [info ] [MainThread]:   connect_timeout: 10
[0m12:38:48.963122 [info ] [MainThread]:   role: None
[0m12:38:48.963211 [info ] [MainThread]:   search_path: None
[0m12:38:48.963304 [info ] [MainThread]:   keepalives_idle: 0
[0m12:38:48.963393 [info ] [MainThread]:   sslmode: None
[0m12:38:48.963484 [info ] [MainThread]:   sslcert: None
[0m12:38:48.963578 [info ] [MainThread]:   sslkey: None
[0m12:38:48.963668 [info ] [MainThread]:   sslrootcert: None
[0m12:38:48.963762 [info ] [MainThread]:   application_name: dbt
[0m12:38:48.963856 [info ] [MainThread]:   retries: 1
[0m12:38:48.964171 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:38:48.994467 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:38:49.012325 [debug] [MainThread]: Using postgres connection "debug"
[0m12:38:49.012495 [debug] [MainThread]: On debug: select 1 as id
[0m12:38:49.012599 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:49.013600 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:38:49.013842 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:38:49.013939 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:38:49.014038 [debug] [MainThread]: On debug: No close available on handle
[0m12:38:49.014147 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:38:49.014264 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:38:49.014366 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:38:49.015398 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.15946746, "process_in_blocks": "0", "process_kernel_time": 0.11183, "process_mem_max_rss": "109019136", "process_out_blocks": "0", "process_user_time": 0.519819}
[0m12:38:49.015636 [debug] [MainThread]: Command `dbt debug` failed at 12:38:49.015596 after 0.16 seconds
[0m12:38:49.015754 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:38:49.015871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107352fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6f570>]}
[0m12:38:49.016009 [debug] [MainThread]: Flushing usage events
[0m12:39:00.328524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108437ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108437d90>]}


============================== 12:39:00.330253 | 289c87cc-9bc5-48c6-9fad-9276dbabd8bd ==============================
[0m12:39:00.330253 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:39:00.330522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:00.333914 [info ] [MainThread]: dbt version: 1.8.9
[0m12:39:00.334061 [info ] [MainThread]: python version: 3.13.0
[0m12:39:00.334168 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:39:00.334270 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:39:00.354453 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:39:00.354669 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:39:00.354788 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:39:00.354973 [info ] [MainThread]: adapter type: postgres
[0m12:39:00.355075 [info ] [MainThread]: adapter version: 1.8.2
[0m12:39:00.385738 [info ] [MainThread]: Configuration:
[0m12:39:00.385973 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:39:00.386089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:39:00.386190 [info ] [MainThread]: Required dependencies:
[0m12:39:00.386363 [debug] [MainThread]: Executing "git --help"
[0m12:39:00.394378 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:39:00.394820 [debug] [MainThread]: STDERR: "b''"
[0m12:39:00.394940 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:39:00.395064 [info ] [MainThread]: Connection:
[0m12:39:00.395207 [info ] [MainThread]:   host: 5432
[0m12:39:00.395329 [info ] [MainThread]:   port: 5432
[0m12:39:00.395435 [info ] [MainThread]:   user: postgres
[0m12:39:00.395540 [info ] [MainThread]:   database: postgres
[0m12:39:00.395642 [info ] [MainThread]:   schema: schema
[0m12:39:00.395736 [info ] [MainThread]:   connect_timeout: 10
[0m12:39:00.395835 [info ] [MainThread]:   role: None
[0m12:39:00.395960 [info ] [MainThread]:   search_path: None
[0m12:39:00.396144 [info ] [MainThread]:   keepalives_idle: 0
[0m12:39:00.396252 [info ] [MainThread]:   sslmode: None
[0m12:39:00.396352 [info ] [MainThread]:   sslcert: None
[0m12:39:00.396447 [info ] [MainThread]:   sslkey: None
[0m12:39:00.396543 [info ] [MainThread]:   sslrootcert: None
[0m12:39:00.396632 [info ] [MainThread]:   application_name: dbt
[0m12:39:00.396726 [info ] [MainThread]:   retries: 1
[0m12:39:00.397049 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:39:00.424691 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:39:00.437743 [debug] [MainThread]: Using postgres connection "debug"
[0m12:39:00.437891 [debug] [MainThread]: On debug: select 1 as id
[0m12:39:00.437999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:00.438500 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:39:00.438697 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:39:00.438801 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:39:00.438924 [debug] [MainThread]: On debug: No close available on handle
[0m12:39:00.439044 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:39:00.439161 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:39:00.439281 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:39:00.439971 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.13434088, "process_in_blocks": "0", "process_kernel_time": 0.080485, "process_mem_max_rss": "108216320", "process_out_blocks": "0", "process_user_time": 0.516081}
[0m12:39:00.440180 [debug] [MainThread]: Command `dbt debug` failed at 12:39:00.440141 after 0.13 seconds
[0m12:39:00.440299 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:39:00.440417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a02fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a8e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084cb570>]}
[0m12:39:00.440556 [debug] [MainThread]: Flushing usage events
[0m12:45:13.121883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d1bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d1bed0>]}


============================== 12:45:13.125093 | 110ddc51-588f-4925-89ea-2b917bed9095 ==============================
[0m12:45:13.125093 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:45:13.125413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:13.134533 [info ] [MainThread]: dbt version: 1.8.9
[0m12:45:13.134924 [info ] [MainThread]: python version: 3.13.0
[0m12:45:13.135076 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:45:13.135193 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:45:13.171819 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:45:13.172050 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:45:13.172172 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:45:13.172526 [info ] [MainThread]: adapter type: postgres
[0m12:45:13.172634 [info ] [MainThread]: adapter version: 1.8.2
[0m12:45:13.205310 [info ] [MainThread]: Configuration:
[0m12:45:13.205557 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:45:13.205695 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:45:13.205801 [info ] [MainThread]: Required dependencies:
[0m12:45:13.205976 [debug] [MainThread]: Executing "git --help"
[0m12:45:13.216539 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:45:13.217150 [debug] [MainThread]: STDERR: "b''"
[0m12:45:13.217324 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:45:13.217451 [info ] [MainThread]: Connection:
[0m12:45:13.217580 [info ] [MainThread]:   host: 5432
[0m12:45:13.217677 [info ] [MainThread]:   port: 5432
[0m12:45:13.217769 [info ] [MainThread]:   user: postgres
[0m12:45:13.217856 [info ] [MainThread]:   database: postgres
[0m12:45:13.217947 [info ] [MainThread]:   schema: schema
[0m12:45:13.218039 [info ] [MainThread]:   connect_timeout: 10
[0m12:45:13.218131 [info ] [MainThread]:   role: None
[0m12:45:13.218221 [info ] [MainThread]:   search_path: None
[0m12:45:13.218307 [info ] [MainThread]:   keepalives_idle: 0
[0m12:45:13.218396 [info ] [MainThread]:   sslmode: None
[0m12:45:13.218482 [info ] [MainThread]:   sslcert: None
[0m12:45:13.218569 [info ] [MainThread]:   sslkey: None
[0m12:45:13.218655 [info ] [MainThread]:   sslrootcert: None
[0m12:45:13.218799 [info ] [MainThread]:   application_name: dbt
[0m12:45:13.218983 [info ] [MainThread]:   retries: 1
[0m12:45:13.219340 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:45:13.253145 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:45:13.275149 [debug] [MainThread]: Using postgres connection "debug"
[0m12:45:13.275383 [debug] [MainThread]: On debug: select 1 as id
[0m12:45:13.275510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:13.277649 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:45:13.277956 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:45:13.278083 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:45:13.278212 [debug] [MainThread]: On debug: No close available on handle
[0m12:45:13.278354 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:45:13.278488 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:45:13.278599 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:45:13.280210 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.19747558, "process_in_blocks": "0", "process_kernel_time": 0.139743, "process_mem_max_rss": "112738304", "process_out_blocks": "0", "process_user_time": 0.618153}
[0m12:45:13.280549 [debug] [MainThread]: Command `dbt debug` failed at 12:45:13.280492 after 0.20 seconds
[0m12:45:13.280707 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:45:13.280863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137452fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1374de0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13446f570>]}
[0m12:45:13.281042 [debug] [MainThread]: Flushing usage events
[0m12:49:41.796759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106defd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106defed0>]}


============================== 12:49:41.798861 | 09f83c2a-8caf-4dd0-aaca-e3f5ae049df6 ==============================
[0m12:49:41.798861 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:49:41.799117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:41.805632 [info ] [MainThread]: dbt version: 1.8.9
[0m12:49:41.805772 [info ] [MainThread]: python version: 3.13.0
[0m12:49:41.805880 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:49:41.805982 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:49:41.837921 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:49:41.838139 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:49:41.838254 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:49:41.838608 [info ] [MainThread]: adapter type: postgres
[0m12:49:41.838787 [info ] [MainThread]: adapter version: 1.8.2
[0m12:49:41.870008 [info ] [MainThread]: Configuration:
[0m12:49:41.870254 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:49:41.870369 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:49:41.870481 [info ] [MainThread]: Required dependencies:
[0m12:49:41.870637 [debug] [MainThread]: Executing "git --help"
[0m12:49:41.878572 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:49:41.879081 [debug] [MainThread]: STDERR: "b''"
[0m12:49:41.879202 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:49:41.879316 [info ] [MainThread]: Connection:
[0m12:49:41.879460 [info ] [MainThread]:   host: 5432
[0m12:49:41.879559 [info ] [MainThread]:   port: 5432
[0m12:49:41.879665 [info ] [MainThread]:   user: postgres
[0m12:49:41.879767 [info ] [MainThread]:   database: postgres
[0m12:49:41.879870 [info ] [MainThread]:   schema: schema
[0m12:49:41.879962 [info ] [MainThread]:   connect_timeout: 10
[0m12:49:41.880056 [info ] [MainThread]:   role: None
[0m12:49:41.880152 [info ] [MainThread]:   search_path: None
[0m12:49:41.880243 [info ] [MainThread]:   keepalives_idle: 0
[0m12:49:41.880334 [info ] [MainThread]:   sslmode: None
[0m12:49:41.880425 [info ] [MainThread]:   sslcert: None
[0m12:49:41.880518 [info ] [MainThread]:   sslkey: None
[0m12:49:41.880607 [info ] [MainThread]:   sslrootcert: None
[0m12:49:41.880698 [info ] [MainThread]:   application_name: dbt
[0m12:49:41.880786 [info ] [MainThread]:   retries: 1
[0m12:49:41.881146 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:49:41.911495 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:49:41.928747 [debug] [MainThread]: Using postgres connection "debug"
[0m12:49:41.928912 [debug] [MainThread]: On debug: select 1 as id
[0m12:49:41.929019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:41.930017 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m12:49:41.930235 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m12:49:41.930326 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m12:49:41.930425 [debug] [MainThread]: On debug: No close available on handle
[0m12:49:41.930538 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:49:41.930654 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:49:41.930762 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "5432" (0.0.21.56), port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:49:41.931823 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.16069387, "process_in_blocks": "0", "process_kernel_time": 0.101926, "process_mem_max_rss": "110264320", "process_out_blocks": "0", "process_user_time": 0.513703}
[0m12:49:41.932103 [debug] [MainThread]: Command `dbt debug` failed at 12:49:41.932052 after 0.16 seconds
[0m12:49:41.932238 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:49:41.932370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b6fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074420f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7f570>]}
[0m12:49:41.932521 [debug] [MainThread]: Flushing usage events
[0m12:55:35.950465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c1bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c1bed0>]}


============================== 12:55:35.952829 | 7658c84b-9540-4824-a985-ac5c3ad8619e ==============================
[0m12:55:35.952829 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:55:35.953110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:55:35.960564 [info ] [MainThread]: dbt version: 1.8.9
[0m12:55:35.960849 [info ] [MainThread]: python version: 3.13.0
[0m12:55:35.960990 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.13/bin/python3.13
[0m12:55:35.961102 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit-Mach-O
[0m12:55:35.993452 [info ] [MainThread]: Using profiles dir at /Users/imaikin-egor/.dbt
[0m12:55:35.993659 [info ] [MainThread]: Using profiles.yml file at /Users/imaikin-egor/.dbt/profiles.yml
[0m12:55:35.993776 [info ] [MainThread]: Using dbt_project.yml file at /Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/dbt_project.yml
[0m12:55:35.994102 [info ] [MainThread]: adapter type: postgres
[0m12:55:35.994254 [info ] [MainThread]: adapter version: 1.8.2
[0m12:55:36.024952 [info ] [MainThread]: Configuration:
[0m12:55:36.025164 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:55:36.025268 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:55:36.025380 [info ] [MainThread]: Required dependencies:
[0m12:55:36.025530 [debug] [MainThread]: Executing "git --help"
[0m12:55:36.033799 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:55:36.034211 [debug] [MainThread]: STDERR: "b''"
[0m12:55:36.034334 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:55:36.034455 [info ] [MainThread]: Connection:
[0m12:55:36.034575 [info ] [MainThread]:   host: localhost
[0m12:55:36.034671 [info ] [MainThread]:   port: 5434
[0m12:55:36.034762 [info ] [MainThread]:   user: postgres
[0m12:55:36.034852 [info ] [MainThread]:   database: postgres
[0m12:55:36.034939 [info ] [MainThread]:   schema: dwh_detailed
[0m12:55:36.035028 [info ] [MainThread]:   connect_timeout: 10
[0m12:55:36.035115 [info ] [MainThread]:   role: None
[0m12:55:36.035200 [info ] [MainThread]:   search_path: None
[0m12:55:36.035290 [info ] [MainThread]:   keepalives_idle: 0
[0m12:55:36.035374 [info ] [MainThread]:   sslmode: None
[0m12:55:36.035463 [info ] [MainThread]:   sslcert: None
[0m12:55:36.035549 [info ] [MainThread]:   sslkey: None
[0m12:55:36.035634 [info ] [MainThread]:   sslrootcert: None
[0m12:55:36.035721 [info ] [MainThread]:   application_name: dbt
[0m12:55:36.035804 [info ] [MainThread]:   retries: 1
[0m12:55:36.036083 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:55:36.066172 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:55:36.084402 [debug] [MainThread]: Using postgres connection "debug"
[0m12:55:36.084563 [debug] [MainThread]: On debug: select 1 as id
[0m12:55:36.084667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:36.168765 [debug] [MainThread]: SQL status: SELECT 1 in 0.084 seconds
[0m12:55:36.169340 [debug] [MainThread]: On debug: Close
[0m12:55:36.169506 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:55:36.169654 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:55:36.170791 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.24572153, "process_in_blocks": "0", "process_kernel_time": 0.121248, "process_mem_max_rss": "118226944", "process_out_blocks": "0", "process_user_time": 0.524753}
[0m12:55:36.171070 [debug] [MainThread]: Command `dbt debug` succeeded at 12:55:36.171018 after 0.25 seconds
[0m12:55:36.171214 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:55:36.171375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111237100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110caaad0>]}
[0m12:55:36.171555 [debug] [MainThread]: Flushing usage events
[0m12:56:08.829150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027112b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bfed0>]}


============================== 12:56:08.831327 | fd6516de-2234-4f7b-9825-169730da9434 ==============================
[0m12:56:08.831327 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:56:08.831598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'version_check': 'True', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:08.914844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f11e00>]}
[0m12:56:08.932403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104159d00>]}
[0m12:56:08.932910 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:56:08.970723 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:56:09.003006 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:56:09.003205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c60e50>]}
[0m12:56:09.504714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce08c0>]}
[0m12:56:09.544799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d0750>]}
[0m12:56:09.545010 [info ] [MainThread]: Found 35 models, 8 sources, 544 macros
[0m12:56:09.545154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505b930>]}
[0m12:56:09.545968 [info ] [MainThread]: 
[0m12:56:09.546207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:09.547677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:56:09.569359 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:56:09.569539 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:56:09.569646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:09.673270 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.104 seconds
[0m12:56:09.674045 [debug] [ThreadPool]: On list_postgres: Close
[0m12:56:09.674443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_dwh_detailed_dwh_detailed)
[0m12:56:09.674924 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "dwh_detailed_dwh_detailed"
"
[0m12:56:09.677455 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m12:56:09.677606 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m12:56:09.677725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:09.685320 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:56:09.685539 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m12:56:09.685678 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "create_postgres_dwh_detailed_dwh_detailed"} */
create schema if not exists "dwh_detailed_dwh_detailed"
[0m12:56:09.686285 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m12:56:09.686798 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m12:56:09.686950 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m12:56:09.687078 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m12:56:09.687829 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m12:56:09.687956 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: Close
[0m12:56:09.689398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_postgres_dwh_detailed_dwh_detailed, now list_postgres_dwh_detailed_dwh_detailed)
[0m12:56:09.692400 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m12:56:09.692542 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m12:56:09.692650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:09.701439 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:56:09.701609 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m12:56:09.701743 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m12:56:09.703785 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m12:56:09.704336 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m12:56:09.704764 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m12:56:09.707503 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:09.707654 [debug] [MainThread]: On master: BEGIN
[0m12:56:09.707765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:09.715780 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:56:09.715984 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:09.716190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:09.718171 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m12:56:09.718727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3fc50>]}
[0m12:56:09.718942 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:09.719385 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:09.719504 [debug] [MainThread]: On master: BEGIN
[0m12:56:09.720211 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:56:09.720352 [debug] [MainThread]: On master: COMMIT
[0m12:56:09.720471 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:09.720577 [debug] [MainThread]: On master: COMMIT
[0m12:56:09.721042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:09.721199 [debug] [MainThread]: On master: Close
[0m12:56:09.721409 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:56:09.721548 [info ] [MainThread]: 
[0m12:56:09.723648 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m12:56:09.723842 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m12:56:09.724002 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_bookings
[0m12:56:09.724137 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_airports
[0m12:56:09.724342 [info ] [Thread-4 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m12:56:09.724583 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m12:56:09.724789 [info ] [Thread-3 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m12:56:09.724983 [info ] [Thread-2 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m12:56:09.725248 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_flights'
[0m12:56:09.725462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.hub_aircrafts)
[0m12:56:09.725657 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_bookings'
[0m12:56:09.725854 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_airports'
[0m12:56:09.726018 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.hub_flights
[0m12:56:09.726168 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m12:56:09.726298 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m12:56:09.726436 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_airports
[0m12:56:09.740018 [debug] [Thread-3 (]: Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.740925 [debug] [Thread-1 (]: Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.741705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105328ec0>]}
[0m12:56:09.741977 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103694730>]}
[0m12:56:09.742552 [debug] [Thread-2 (]: Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.742966 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[31mERROR[0m in 0.02s]
[0m12:56:09.743483 [error] [Thread-3 (]: 3 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_bookings  [[31mERROR[0m in 0.01s]
[0m12:56:09.743687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053174d0>]}
[0m12:56:09.743964 [debug] [Thread-4 (]: Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.744190 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m12:56:09.744375 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_bookings
[0m12:56:09.744577 [error] [Thread-2 (]: 2 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_airports  [[31mERROR[0m in 0.02s]
[0m12:56:09.744743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f00a60>]}
[0m12:56:09.744925 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m12:56:09.745358 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_tickets
[0m12:56:09.745552 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_airports
[0m12:56:09.745784 [error] [Thread-4 (]: 4 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_flights  [[31mERROR[0m in 0.02s]
[0m12:56:09.745942 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m12:56:09.746147 [info ] [Thread-3 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m12:56:09.746413 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m12:56:09.746571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_seats)
[0m12:56:09.746725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_tickets)
[0m12:56:09.746887 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m12:56:09.747023 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m12:56:09.752758 [debug] [Thread-1 (]: Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.753502 [debug] [Thread-3 (]: Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.753676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052efb90>]}
[0m12:56:09.753809 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd6516de-2234-4f7b-9825-169730da9434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052edd30>]}
[0m12:56:09.754045 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.01s]
[0m12:56:09.754474 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m12:56:09.754264 [error] [Thread-3 (]: 6 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_tickets  [[31mERROR[0m in 0.01s]
[0m12:56:09.754726 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_tickets
[0m12:56:09.755228 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:09.755343 [debug] [MainThread]: On master: BEGIN
[0m12:56:09.755431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:09.764465 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:56:09.764679 [debug] [MainThread]: On master: COMMIT
[0m12:56:09.764790 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:09.764904 [debug] [MainThread]: On master: COMMIT
[0m12:56:09.765352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:56:09.765521 [debug] [MainThread]: On master: Close
[0m12:56:09.765733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:09.765884 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_seats' was properly closed.
[0m12:56:09.765984 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_flights' was properly closed.
[0m12:56:09.766078 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m12:56:09.766163 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_airports' was properly closed.
[0m12:56:09.766317 [info ] [MainThread]: 
[0m12:56:09.766457 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:56:09.766903 [debug] [MainThread]: Command end result
[0m12:56:09.782095 [info ] [MainThread]: 
[0m12:56:09.782319 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:56:09.782433 [info ] [MainThread]: 
[0m12:56:09.782587 [error] [MainThread]:   Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.782694 [info ] [MainThread]: 
[0m12:56:09.782825 [error] [MainThread]:   Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.782924 [info ] [MainThread]: 
[0m12:56:09.783052 [error] [MainThread]:   Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.783148 [info ] [MainThread]: 
[0m12:56:09.783272 [error] [MainThread]:   Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.783372 [info ] [MainThread]: 
[0m12:56:09.783490 [error] [MainThread]:   Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.783589 [info ] [MainThread]: 
[0m12:56:09.783706 [error] [MainThread]:   Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:56:09.783807 [info ] [MainThread]: 
[0m12:56:09.783924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:56:09.785233 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9822313, "process_in_blocks": "0", "process_kernel_time": 0.134929, "process_mem_max_rss": "129368064", "process_out_blocks": "0", "process_user_time": 1.160323}
[0m12:56:09.785489 [debug] [MainThread]: Command `dbt run` failed at 12:56:09.785447 after 0.98 seconds
[0m12:56:09.785650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e0fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041af890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548bef0>]}
[0m12:56:09.785780 [debug] [MainThread]: Flushing usage events
[0m12:58:18.200665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ed2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661bed0>]}


============================== 12:58:18.202757 | bacd9125-1720-4664-90a2-2662c1c77ae5 ==============================
[0m12:58:18.202757 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:58:18.203019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:58:18.241094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bacd9125-1720-4664-90a2-2662c1c77ae5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105133a80>]}
[0m12:58:18.271698 [debug] [MainThread]: Set downloads directory='/var/folders/jc/7p1wm2qs3lx5blkvy2tsr9l80000gn/T/dbt-downloads-n_x0g9sh'
[0m12:58:18.271952 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:58:18.509973 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:58:18.511448 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:58:18.601833 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:58:18.607017 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m12:58:18.607842 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m12:58:19.380817 [debug] [MainThread]: STDOUT: "b''"
[0m12:58:19.381305 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m12:58:19.381596 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m12:58:19.381764 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:58:19.390431 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:58:19.390835 [debug] [MainThread]: STDERR: "b''"
[0m12:58:19.390989 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m12:58:19.391128 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:58:20.051816 [debug] [MainThread]: STDOUT: "b''"
[0m12:58:20.052505 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m12:58:20.052745 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:58:20.070481 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m12:58:20.070958 [debug] [MainThread]: STDERR: "b''"
[0m12:58:20.071144 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:58:20.079741 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:58:20.080149 [debug] [MainThread]: STDERR: "b''"
[0m12:58:20.080311 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m12:58:20.080461 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:58:20.088212 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:58:20.088615 [debug] [MainThread]: STDERR: "b''"
[0m12:58:20.090291 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m12:58:20.098051 [debug] [MainThread]: STDOUT: "b''"
[0m12:58:20.098437 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m12:58:20.098554 [debug] [MainThread]: command return code=128
[0m12:58:20.098929 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m12:58:20.099061 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:58:20.106209 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:58:20.106555 [debug] [MainThread]: STDERR: "b''"
[0m12:58:20.106688 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m12:58:20.106814 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:58:20.698189 [debug] [MainThread]: STDOUT: "b''"
[0m12:58:20.699148 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m12:58:20.699434 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m12:58:20.716283 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m12:58:20.716765 [debug] [MainThread]: STDERR: "b''"
[0m12:58:20.716956 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m12:58:20.725248 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m12:58:20.725624 [debug] [MainThread]: STDERR: "b''"
[0m12:58:20.725808 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m12:58:20.726109 [info ] [MainThread]: Installed from revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06
[0m12:58:20.726394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bacd9125-1720-4664-90a2-2662c1c77ae5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676f790>]}
[0m12:58:20.726649 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:58:21.171206 [info ] [MainThread]: Installed from version 1.3.0
[0m12:58:21.171607 [info ] [MainThread]: Up to date!
[0m12:58:21.171825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bacd9125-1720-4664-90a2-2662c1c77ae5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067908c0>]}
[0m12:58:21.174143 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.9982011, "process_in_blocks": "0", "process_kernel_time": 0.174543, "process_mem_max_rss": "106135552", "process_out_blocks": "0", "process_user_time": 0.556353}
[0m12:58:21.174644 [debug] [MainThread]: Command `dbt deps` succeeded at 12:58:21.174565 after 3.00 seconds
[0m12:58:21.174934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e3e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106757a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a7450>]}
[0m12:58:21.175105 [debug] [MainThread]: Flushing usage events
[0m12:58:33.862901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074852b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d1bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d1bed0>]}


============================== 12:58:33.864605 | 7cb95b85-e87f-4cd3-bf1e-0f0b268681f6 ==============================
[0m12:58:33.864605 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:58:33.864874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:33.932314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2de00>]}
[0m12:58:33.949489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db5d00>]}
[0m12:58:33.950588 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:58:33.989265 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:58:34.043246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 109 files added, 1 files changed.
[0m12:58:34.043500 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/ma_sat.sql
[0m12:58:34.043629 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/data_types/type_binary.sql
[0m12:58:34.043747 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/xts.sql
[0m12:58:34.043848 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/pit.sql
[0m12:58:34.043945 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/hub.sql
[0m12:58:34.044037 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/hub.sql
[0m12:58:34.044131 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/dateadd.sql
[0m12:58:34.044221 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/alias.sql
[0m12:58:34.044315 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/link.sql
[0m12:58:34.044404 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/concat_ws.sql
[0m12:58:34.044498 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/ghost_records/null_ghost.sql
[0m12:58:34.044590 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/pit.sql
[0m12:58:34.044681 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/data_types/type_timestamp.sql
[0m12:58:34.044772 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/eff_sat.sql
[0m12:58:34.044859 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/xts.sql
[0m12:58:34.044951 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/incremental_bridge_materialization.sql
[0m12:58:34.045040 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/eff_sat.sql
[0m12:58:34.045133 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/bridge.sql
[0m12:58:34.045221 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/hash.sql
[0m12:58:34.045311 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/xts.sql
[0m12:58:34.045399 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/link.sql
[0m12:58:34.045490 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/data_types/type_string.sql
[0m12:58:34.045581 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/period_mat_helpers/get_period_of_load.sql
[0m12:58:34.045671 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/sat.sql
[0m12:58:34.045762 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/bridge.sql
[0m12:58:34.045851 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/ma_sat.sql
[0m12:58:34.045941 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/hash_components/standard_column_wrapper.sql
[0m12:58:34.046035 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/staging/hash_columns.sql
[0m12:58:34.046124 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/rank_mat_helpers/get_min_max_ranks.sql
[0m12:58:34.046216 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/logging/log_relation_sources.sql
[0m12:58:34.046308 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/period_mat_helpers/get_start_stop_dates.sql
[0m12:58:34.046397 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/rank_mat_helpers/replace_placeholder_with_rank_filter.sql
[0m12:58:34.046487 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/xts.sql
[0m12:58:34.046577 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/t_link.sql
[0m12:58:34.046668 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/sat.sql
[0m12:58:34.046759 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/eff_sat.sql
[0m12:58:34.046849 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/stage_processing_macros/process_columns_to_escape.sql
[0m12:58:34.046942 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/stage_processing_macros/process_hash_column_excludes.sql
[0m12:58:34.047032 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/staging/source_columns.sql
[0m12:58:34.047119 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/sat.sql
[0m12:58:34.047205 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/mat_is_checks.sql
[0m12:58:34.047293 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/period_mat_helpers/replace_placeholder_with_period_filter.sql
[0m12:58:34.047384 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/incremental_pit_materialization.sql
[0m12:58:34.047473 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/prefix.sql
[0m12:58:34.047563 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/eff_sat.sql
[0m12:58:34.047653 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/is_checks.sql
[0m12:58:34.047744 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/get_escape_characters.sql
[0m12:58:34.047832 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/escape_column_names.sql
[0m12:58:34.047922 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/hub.sql
[0m12:58:34.048010 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/ghost_records/binary_ghost.sql
[0m12:58:34.048103 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/as_of_date_window.sql
[0m12:58:34.048194 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/ma_sat.sql
[0m12:58:34.048283 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/link.sql
[0m12:58:34.048373 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/t_link.sql
[0m12:58:34.048464 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/casting/cast_binary.sql
[0m12:58:34.048552 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/drop_temporary.sql
[0m12:58:34.048642 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/pit.sql
[0m12:58:34.048730 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/staging/rank_columns.sql
[0m12:58:34.048819 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/bridge.sql
[0m12:58:34.048910 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/vault_insert_by_rank_materialization.sql
[0m12:58:34.049000 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/t_link.sql
[0m12:58:34.049090 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/sat.sql
[0m12:58:34.049177 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/max_datetime.sql
[0m12:58:34.049265 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/period_mat_helpers/error_messages.sql
[0m12:58:34.049354 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/staging/derive_columns.sql
[0m12:58:34.050839 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/pit.sql
[0m12:58:34.050936 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/ghost_records/date_ghost.sql
[0m12:58:34.051028 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/databricks/bridge.sql
[0m12:58:34.051121 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/t_link.sql
[0m12:58:34.051213 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/escape_column_name.sql
[0m12:58:34.051306 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/ma_sat.sql
[0m12:58:34.051400 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/pit.sql
[0m12:58:34.051491 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/as_constant.sql
[0m12:58:34.051586 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/stage_processing_macros/process_columns_to_select.sql
[0m12:58:34.051677 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/prepend_generated_by.sql
[0m12:58:34.051767 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/bigquery/hub.sql
[0m12:58:34.051855 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/timestamp_add.sql
[0m12:58:34.051945 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/casting/cast_datetime.sql
[0m12:58:34.052031 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/sat.sql
[0m12:58:34.052120 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/link.sql
[0m12:58:34.052212 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/stage_processing_macros/print_list.sql
[0m12:58:34.052304 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/vault_insert_by_period_materialization.sql
[0m12:58:34.052403 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/bridge.sql
[0m12:58:34.052491 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/multikey.sql
[0m12:58:34.052581 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/shared_helpers.sql
[0m12:58:34.052668 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/sqlserver/hub.sql
[0m12:58:34.052756 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/casting/cast_date.sql
[0m12:58:34.052842 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/hash_components/null_expression.sql
[0m12:58:34.052932 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/process_payload_column_excludes.sql
[0m12:58:34.053020 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/get_query_results_as_dict.sql
[0m12:58:34.053110 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/period_mat_helpers/check_datediff.sql
[0m12:58:34.053202 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/stage_processing_macros/extract_column_names.sql
[0m12:58:34.053293 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/bridge_shared.sql
[0m12:58:34.053380 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/xts.sql
[0m12:58:34.053467 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/staging/stage.sql
[0m12:58:34.053553 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/t_link.sql
[0m12:58:34.053641 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/ghost_records/create_ghost_record.sql
[0m12:58:34.053728 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/period_mat_helpers/get_period_filter_sql.sql
[0m12:58:34.053815 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/snowflake/ma_sat.sql
[0m12:58:34.053902 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/check_required_parameters.sql
[0m12:58:34.053991 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/incremental_pit_bridge_replace.sql
[0m12:58:34.054079 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/link.sql
[0m12:58:34.054168 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/helpers/stage_processing_macros/extract_null_column_names.sql
[0m12:58:34.054258 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/supporting/hash_components/select_hash_alg.sql
[0m12:58:34.054347 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/expand_column_list.sql
[0m12:58:34.054437 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/materialisations/period_mat_helpers/get_period_boundaries.sql
[0m12:58:34.054529 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/internal/metadata_processing/alias_all.sql
[0m12:58:34.054622 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/staging/null_columns.sql
[0m12:58:34.054710 [debug] [MainThread]: Partial parsing: added file: automate_dv://macros/tables/postgres/eff_sat.sql
[0m12:58:34.054826 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/sql/star.sql
[0m12:58:34.332322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a29450>]}
[0m12:58:34.374286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca8c80>]}
[0m12:58:34.374536 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m12:58:34.374690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bff310>]}
[0m12:58:34.375516 [info ] [MainThread]: 
[0m12:58:34.375750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:58:34.377262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m12:58:34.442540 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m12:58:34.442730 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m12:58:34.442834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:34.521427 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.079 seconds
[0m12:58:34.522198 [debug] [ThreadPool]: On list_postgres: Close
[0m12:58:34.523673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m12:58:34.526522 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m12:58:34.526669 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m12:58:34.526782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:34.540434 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:58:34.540597 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m12:58:34.540749 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m12:58:34.545132 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:58:34.545716 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m12:58:34.546485 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m12:58:34.549624 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:34.549779 [debug] [MainThread]: On master: BEGIN
[0m12:58:34.549888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:34.561679 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:58:34.561828 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:34.562023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:58:34.565249 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:58:34.565817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112caf2b0>]}
[0m12:58:34.566024 [debug] [MainThread]: On master: ROLLBACK
[0m12:58:34.566657 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:34.566789 [debug] [MainThread]: On master: BEGIN
[0m12:58:34.567644 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:58:34.567847 [debug] [MainThread]: On master: COMMIT
[0m12:58:34.567985 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:34.568109 [debug] [MainThread]: On master: COMMIT
[0m12:58:34.568631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:34.568835 [debug] [MainThread]: On master: Close
[0m12:58:34.569076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:58:34.569257 [info ] [MainThread]: 
[0m12:58:34.573720 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m12:58:34.573929 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_bookings
[0m12:58:34.574104 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m12:58:34.574254 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_airports
[0m12:58:34.574481 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m12:58:34.574715 [info ] [Thread-3 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m12:58:34.574996 [info ] [Thread-4 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m12:58:34.575277 [info ] [Thread-2 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m12:58:34.575486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.hub_aircrafts)
[0m12:58:34.575689 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_bookings'
[0m12:58:34.575875 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_flights'
[0m12:58:34.576060 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_airports'
[0m12:58:34.576210 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m12:58:34.576349 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m12:58:34.576479 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.hub_flights
[0m12:58:34.576614 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_airports
[0m12:58:34.590597 [info ] [Thread-1 (]: 12:58:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m12:58:34.592699 [info ] [Thread-3 (]: 12:58:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m12:58:34.594583 [info ] [Thread-4 (]: 12:58:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m12:58:34.596563 [info ] [Thread-2 (]: 12:58:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m12:58:34.622624 [debug] [Thread-2 (]: Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  dbt was unable to infer all dependencies for the model "hub_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_airports":
  
  -- depends_on: {{ ref('stg_airports') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_airports (models/raw_vault/hubs/hub_airports.sql)
[0m12:58:34.623373 [debug] [Thread-4 (]: Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  dbt was unable to infer all dependencies for the model "hub_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_flights":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_flights (models/raw_vault/hubs/hub_flights.sql)
[0m12:58:34.624685 [debug] [Thread-3 (]: Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  dbt was unable to infer all dependencies for the model "hub_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_bookings":
  
  -- depends_on: {{ ref('stg_bookings') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
[0m12:58:34.625020 [debug] [Thread-1 (]: Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "hub_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_aircrafts":
  
  -- depends_on: {{ ref('stg_aircrafts') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
[0m12:58:34.625664 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a87050>]}
[0m12:58:34.625839 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11308dbd0>]}
[0m12:58:34.626024 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11308dd30>]}
[0m12:58:34.626197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f0730>]}
[0m12:58:34.626478 [error] [Thread-2 (]: 2 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_airports  [[31mERROR[0m in 0.05s]
[0m12:58:34.626738 [error] [Thread-4 (]: 4 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_flights  [[31mERROR[0m in 0.05s]
[0m12:58:34.626956 [error] [Thread-3 (]: 3 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_bookings  [[31mERROR[0m in 0.05s]
[0m12:58:34.627182 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[31mERROR[0m in 0.05s]
[0m12:58:34.627407 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_airports
[0m12:58:34.627595 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m12:58:34.627791 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_bookings
[0m12:58:34.627969 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m12:58:34.628129 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_seats
[0m12:58:34.628558 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_tickets
[0m12:58:34.628829 [info ] [Thread-2 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m12:58:34.629006 [info ] [Thread-4 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m12:58:34.629182 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_seats)
[0m12:58:34.629333 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_tickets)
[0m12:58:34.629469 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_seats
[0m12:58:34.629593 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m12:58:34.631555 [info ] [Thread-2 (]: 12:58:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m12:58:34.633280 [info ] [Thread-4 (]: 12:58:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m12:58:34.636153 [debug] [Thread-2 (]: Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  dbt was unable to infer all dependencies for the model "hub_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_seats (models/raw_vault/hubs/hub_seats.sql)
[0m12:58:34.637054 [debug] [Thread-4 (]: Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  dbt was unable to infer all dependencies for the model "hub_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_tickets":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
[0m12:58:34.637225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a65ef0>]}
[0m12:58:34.637352 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cb95b85-e87f-4cd3-bf1e-0f0b268681f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113614130>]}
[0m12:58:34.637588 [error] [Thread-2 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.01s]
[0m12:58:34.637849 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_seats
[0m12:58:34.638044 [error] [Thread-4 (]: 6 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_tickets  [[31mERROR[0m in 0.01s]
[0m12:58:34.638331 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_tickets
[0m12:58:34.638914 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:34.639047 [debug] [MainThread]: On master: BEGIN
[0m12:58:34.639150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:34.654658 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:58:34.654853 [debug] [MainThread]: On master: COMMIT
[0m12:58:34.654968 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:34.655059 [debug] [MainThread]: On master: COMMIT
[0m12:58:34.655765 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:58:34.655864 [debug] [MainThread]: On master: Close
[0m12:58:34.656004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:34.656093 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_aircrafts' was properly closed.
[0m12:58:34.656172 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_bookings' was properly closed.
[0m12:58:34.656251 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m12:58:34.656325 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_seats' was properly closed.
[0m12:58:34.656451 [info ] [MainThread]: 
[0m12:58:34.656568 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:58:34.656997 [debug] [MainThread]: Command end result
[0m12:58:34.677209 [info ] [MainThread]: 
[0m12:58:34.677419 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m12:58:34.677531 [info ] [MainThread]: 
[0m12:58:34.677696 [error] [MainThread]:   Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  dbt was unable to infer all dependencies for the model "hub_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_airports":
  
  -- depends_on: {{ ref('stg_airports') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_airports (models/raw_vault/hubs/hub_airports.sql)
[0m12:58:34.677810 [info ] [MainThread]: 
[0m12:58:34.677964 [error] [MainThread]:   Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  dbt was unable to infer all dependencies for the model "hub_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_flights":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_flights (models/raw_vault/hubs/hub_flights.sql)
[0m12:58:34.678075 [info ] [MainThread]: 
[0m12:58:34.678218 [error] [MainThread]:   Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  dbt was unable to infer all dependencies for the model "hub_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_bookings":
  
  -- depends_on: {{ ref('stg_bookings') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
[0m12:58:34.678324 [info ] [MainThread]: 
[0m12:58:34.678458 [error] [MainThread]:   Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "hub_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_aircrafts":
  
  -- depends_on: {{ ref('stg_aircrafts') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
[0m12:58:34.678562 [info ] [MainThread]: 
[0m12:58:34.678694 [error] [MainThread]:   Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  dbt was unable to infer all dependencies for the model "hub_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_seats (models/raw_vault/hubs/hub_seats.sql)
[0m12:58:34.678797 [info ] [MainThread]: 
[0m12:58:34.678937 [error] [MainThread]:   Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  dbt was unable to infer all dependencies for the model "hub_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_tickets":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
[0m12:58:34.679044 [info ] [MainThread]: 
[0m12:58:34.679173 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m12:58:34.679864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8401624, "process_in_blocks": "0", "process_kernel_time": 0.119569, "process_mem_max_rss": "126730240", "process_out_blocks": "0", "process_user_time": 1.031187}
[0m12:58:34.680060 [debug] [MainThread]: Command `dbt run` failed at 12:58:34.680027 after 0.84 seconds
[0m12:58:34.680197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113729d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113729d30>]}
[0m12:58:34.680319 [debug] [MainThread]: Flushing usage events
[0m13:01:00.637683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7ed0>]}


============================== 13:01:00.639370 | d11d8716-89ac-47ee-9930-db6d97ac79cf ==============================
[0m13:01:00.639370 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:01:00.639630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:00.694492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105239e00>]}
[0m13:01:00.711643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106481d00>]}
[0m13:01:00.711966 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:00.747359 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:01:00.795058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:00.795239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:00.806919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8b750>]}
[0m13:01:00.844940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dc050>]}
[0m13:01:00.845141 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m13:01:00.845281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d7070>]}
[0m13:01:00.846076 [info ] [MainThread]: 
[0m13:01:00.846305 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:00.847785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:01:00.866484 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:01:00.866695 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:01:00.866814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:00.924417 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.058 seconds
[0m13:01:00.925154 [debug] [ThreadPool]: On list_postgres: Close
[0m13:01:00.926601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m13:01:00.929329 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:01:00.929499 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m13:01:00.929617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:00.937888 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:01:00.938099 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:01:00.938241 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m13:01:00.940207 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:01:00.940835 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m13:01:00.941249 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m13:01:00.945462 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:00.945635 [debug] [MainThread]: On master: BEGIN
[0m13:01:00.945742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:00.954786 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:01:00.954982 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:00.955158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:00.956760 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m13:01:00.957287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d0a10>]}
[0m13:01:00.957492 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:00.957917 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:00.958033 [debug] [MainThread]: On master: BEGIN
[0m13:01:00.958761 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:01:00.958928 [debug] [MainThread]: On master: COMMIT
[0m13:01:00.959054 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:00.959166 [debug] [MainThread]: On master: COMMIT
[0m13:01:00.959545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:00.959662 [debug] [MainThread]: On master: Close
[0m13:01:00.959851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:00.959998 [info ] [MainThread]: 
[0m13:01:00.961198 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_airports
[0m13:01:00.961428 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_bookings
[0m13:01:00.961612 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m13:01:00.961757 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m13:01:00.961975 [info ] [Thread-2 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m13:01:00.962184 [info ] [Thread-3 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m13:01:00.962394 [info ] [Thread-4 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m13:01:00.962601 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m13:01:00.962838 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_airports'
[0m13:01:00.963041 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_bookings'
[0m13:01:00.963210 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_flights'
[0m13:01:00.963360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.hub_aircrafts)
[0m13:01:00.963501 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_airports
[0m13:01:00.963630 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m13:01:00.963750 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.hub_flights
[0m13:01:00.963908 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m13:01:00.978566 [info ] [Thread-3 (]: 13:01:00 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m13:01:00.978881 [info ] [Thread-2 (]: 13:01:00 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m13:01:00.980778 [info ] [Thread-4 (]: 13:01:00 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m13:01:00.982460 [info ] [Thread-1 (]: 13:01:00 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m13:01:01.001602 [debug] [Thread-3 (]: Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  dbt was unable to infer all dependencies for the model "hub_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_bookings":
  
  -- depends_on: {{ ref('stg_bookings') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
[0m13:01:01.002755 [debug] [Thread-2 (]: Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  dbt was unable to infer all dependencies for the model "hub_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_airports":
  
  -- depends_on: {{ ref('stg_airports') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_airports (models/raw_vault/hubs/hub_airports.sql)
[0m13:01:01.003360 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f6b10>]}
[0m13:01:01.003532 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076010d0>]}
[0m13:01:01.004532 [debug] [Thread-1 (]: Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "hub_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_aircrafts":
  
  -- depends_on: {{ ref('stg_aircrafts') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
[0m13:01:01.005590 [debug] [Thread-4 (]: Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  dbt was unable to infer all dependencies for the model "hub_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_flights":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_flights (models/raw_vault/hubs/hub_flights.sql)
[0m13:01:01.005877 [error] [Thread-3 (]: 3 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_bookings  [[31mERROR[0m in 0.04s]
[0m13:01:01.006095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f5a90>]}
[0m13:01:01.006302 [error] [Thread-2 (]: 2 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_airports  [[31mERROR[0m in 0.04s]
[0m13:01:01.006467 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735b380>]}
[0m13:01:01.006658 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_bookings
[0m13:01:01.006858 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[31mERROR[0m in 0.04s]
[0m13:01:01.007060 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_airports
[0m13:01:01.007231 [error] [Thread-4 (]: 4 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_flights  [[31mERROR[0m in 0.04s]
[0m13:01:01.007412 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_seats
[0m13:01:01.007852 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m13:01:01.008005 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_tickets
[0m13:01:01.008214 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m13:01:01.008369 [info ] [Thread-3 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m13:01:01.008655 [info ] [Thread-2 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m13:01:01.008898 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_seats)
[0m13:01:01.009043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_tickets)
[0m13:01:01.009172 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_seats
[0m13:01:01.009301 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m13:01:01.011225 [info ] [Thread-3 (]: 13:01:01 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m13:01:01.012958 [info ] [Thread-2 (]: 13:01:01 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m13:01:01.016221 [debug] [Thread-3 (]: Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  dbt was unable to infer all dependencies for the model "hub_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_seats (models/raw_vault/hubs/hub_seats.sql)
[0m13:01:01.016889 [debug] [Thread-2 (]: Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  dbt was unable to infer all dependencies for the model "hub_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_tickets":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
[0m13:01:01.017092 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074dda90>]}
[0m13:01:01.017243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd11d8716-89ac-47ee-9930-db6d97ac79cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074def20>]}
[0m13:01:01.017483 [error] [Thread-3 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.01s]
[0m13:01:01.017702 [error] [Thread-2 (]: 6 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_tickets  [[31mERROR[0m in 0.01s]
[0m13:01:01.017910 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_seats
[0m13:01:01.018071 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_tickets
[0m13:01:01.018670 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:01.018775 [debug] [MainThread]: On master: BEGIN
[0m13:01:01.018865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:01.029130 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:01:01.029344 [debug] [MainThread]: On master: COMMIT
[0m13:01:01.029445 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:01.029539 [debug] [MainThread]: On master: COMMIT
[0m13:01:01.029909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:01.030009 [debug] [MainThread]: On master: Close
[0m13:01:01.030167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:01.030279 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_aircrafts' was properly closed.
[0m13:01:01.030363 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m13:01:01.030441 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_seats' was properly closed.
[0m13:01:01.030525 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_flights' was properly closed.
[0m13:01:01.030693 [info ] [MainThread]: 
[0m13:01:01.030838 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m13:01:01.031349 [debug] [MainThread]: Command end result
[0m13:01:01.049659 [info ] [MainThread]: 
[0m13:01:01.049862 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m13:01:01.049981 [info ] [MainThread]: 
[0m13:01:01.050141 [error] [MainThread]:   Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  dbt was unable to infer all dependencies for the model "hub_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_bookings":
  
  -- depends_on: {{ ref('stg_bookings') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
[0m13:01:01.050264 [info ] [MainThread]: 
[0m13:01:01.050404 [error] [MainThread]:   Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  dbt was unable to infer all dependencies for the model "hub_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_airports":
  
  -- depends_on: {{ ref('stg_airports') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_airports (models/raw_vault/hubs/hub_airports.sql)
[0m13:01:01.050515 [info ] [MainThread]: 
[0m13:01:01.050655 [error] [MainThread]:   Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "hub_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_aircrafts":
  
  -- depends_on: {{ ref('stg_aircrafts') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
[0m13:01:01.050764 [info ] [MainThread]: 
[0m13:01:01.050901 [error] [MainThread]:   Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  dbt was unable to infer all dependencies for the model "hub_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_flights":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_flights (models/raw_vault/hubs/hub_flights.sql)
[0m13:01:01.051015 [info ] [MainThread]: 
[0m13:01:01.051144 [error] [MainThread]:   Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  dbt was unable to infer all dependencies for the model "hub_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_seats (models/raw_vault/hubs/hub_seats.sql)
[0m13:01:01.051256 [info ] [MainThread]: 
[0m13:01:01.051384 [error] [MainThread]:   Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  dbt was unable to infer all dependencies for the model "hub_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_tickets":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
[0m13:01:01.051500 [info ] [MainThread]: 
[0m13:01:01.051621 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m13:01:01.052670 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4390605, "process_in_blocks": "0", "process_kernel_time": 0.104796, "process_mem_max_rss": "126943232", "process_out_blocks": "0", "process_user_time": 0.718598}
[0m13:01:01.052923 [debug] [MainThread]: Command `dbt run` failed at 13:01:01.052882 after 0.44 seconds
[0m13:01:01.053091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c57950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c578f0>]}
[0m13:01:01.053214 [debug] [MainThread]: Flushing usage events
[0m13:01:33.966848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c212b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085cbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085cbed0>]}


============================== 13:01:33.968558 | e865ffd3-0424-436b-b88d-a74e3ad5ed61 ==============================
[0m13:01:33.968558 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:01:33.968826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'debug': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m13:01:34.023664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107421e00>]}
[0m13:01:34.040653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108669d00>]}
[0m13:01:34.040963 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:01:34.075787 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:01:34.124174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:34.124360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:34.135949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109273750>]}
[0m13:01:34.173932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c4050>]}
[0m13:01:34.174128 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m13:01:34.174265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c7070>]}
[0m13:01:34.175067 [info ] [MainThread]: 
[0m13:01:34.175291 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:01:34.176776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:01:34.196003 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:01:34.196219 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:01:34.196344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:34.224971 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.029 seconds
[0m13:01:34.225636 [debug] [ThreadPool]: On list_postgres: Close
[0m13:01:34.227030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m13:01:34.229662 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:01:34.229842 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m13:01:34.229960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:34.237448 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:01:34.237677 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:01:34.237822 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m13:01:34.239285 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m13:01:34.239805 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m13:01:34.240224 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m13:01:34.244112 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.244302 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.244412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:34.252807 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:01:34.252999 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.253169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:01:34.254672 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m13:01:34.255176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098bca10>]}
[0m13:01:34.255359 [debug] [MainThread]: On master: ROLLBACK
[0m13:01:34.255779 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.255931 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.256648 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:01:34.256769 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.256873 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.256964 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.257319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:34.257435 [debug] [MainThread]: On master: Close
[0m13:01:34.257625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:34.257757 [info ] [MainThread]: 
[0m13:01:34.259093 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_bookings
[0m13:01:34.259279 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m13:01:34.259408 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m13:01:34.259527 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_airports
[0m13:01:34.259742 [info ] [Thread-3 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m13:01:34.260033 [info ] [Thread-4 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m13:01:34.260269 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m13:01:34.260486 [info ] [Thread-2 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m13:01:34.260722 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_bookings'
[0m13:01:34.260898 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_flights'
[0m13:01:34.261044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.hub_aircrafts)
[0m13:01:34.261202 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_airports'
[0m13:01:34.261342 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m13:01:34.261464 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.hub_flights
[0m13:01:34.261581 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m13:01:34.261698 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_airports
[0m13:01:34.276071 [info ] [Thread-4 (]: 13:01:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m13:01:34.276867 [info ] [Thread-3 (]: 13:01:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m13:01:34.278848 [info ] [Thread-1 (]: 13:01:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m13:01:34.280552 [info ] [Thread-2 (]: 13:01:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m13:01:34.303017 [debug] [Thread-1 (]: Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "hub_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_aircrafts":
  
  -- depends_on: {{ ref('stg_aircrafts') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
[0m13:01:34.304436 [debug] [Thread-3 (]: Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  dbt was unable to infer all dependencies for the model "hub_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_bookings":
  
  -- depends_on: {{ ref('stg_bookings') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
[0m13:01:34.304813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095da990>]}
[0m13:01:34.304985 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f5230>]}
[0m13:01:34.306021 [debug] [Thread-2 (]: Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  dbt was unable to infer all dependencies for the model "hub_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_airports":
  
  -- depends_on: {{ ref('stg_airports') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_airports (models/raw_vault/hubs/hub_airports.sql)
[0m13:01:34.307021 [debug] [Thread-4 (]: Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  dbt was unable to infer all dependencies for the model "hub_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_flights":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_flights (models/raw_vault/hubs/hub_flights.sql)
[0m13:01:34.307285 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[31mERROR[0m in 0.04s]
[0m13:01:34.307531 [error] [Thread-3 (]: 3 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_bookings  [[31mERROR[0m in 0.04s]
[0m13:01:34.307710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba4730>]}
[0m13:01:34.307851 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10963fbf0>]}
[0m13:01:34.308051 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m13:01:34.308233 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_bookings
[0m13:01:34.308445 [error] [Thread-2 (]: 2 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_airports  [[31mERROR[0m in 0.05s]
[0m13:01:34.308649 [error] [Thread-4 (]: 4 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_flights  [[31mERROR[0m in 0.05s]
[0m13:01:34.308857 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m13:01:34.309318 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_tickets
[0m13:01:34.309544 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_airports
[0m13:01:34.309719 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m13:01:34.309886 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m13:01:34.310065 [info ] [Thread-3 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m13:01:34.310324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_seats)
[0m13:01:34.310477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_tickets)
[0m13:01:34.310615 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m13:01:34.310738 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m13:01:34.312620 [info ] [Thread-1 (]: 13:01:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m13:01:34.314107 [info ] [Thread-3 (]: 13:01:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m13:01:34.316889 [debug] [Thread-1 (]: Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  dbt was unable to infer all dependencies for the model "hub_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_seats (models/raw_vault/hubs/hub_seats.sql)
[0m13:01:34.317058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099744b0>]}
[0m13:01:34.318145 [debug] [Thread-3 (]: Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  dbt was unable to infer all dependencies for the model "hub_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_tickets":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
[0m13:01:34.318585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e865ffd3-0424-436b-b88d-a74e3ad5ed61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806c590>]}
[0m13:01:34.318431 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.01s]
[0m13:01:34.318859 [error] [Thread-3 (]: 6 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_tickets  [[31mERROR[0m in 0.01s]
[0m13:01:34.319108 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m13:01:34.319297 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_tickets
[0m13:01:34.319899 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.320015 [debug] [MainThread]: On master: BEGIN
[0m13:01:34.320103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:34.329340 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:01:34.329556 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.329672 [debug] [MainThread]: Using postgres connection "master"
[0m13:01:34.329795 [debug] [MainThread]: On master: COMMIT
[0m13:01:34.330230 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:01:34.330356 [debug] [MainThread]: On master: Close
[0m13:01:34.330524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:34.330635 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_seats' was properly closed.
[0m13:01:34.330730 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m13:01:34.330817 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_flights' was properly closed.
[0m13:01:34.330899 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_airports' was properly closed.
[0m13:01:34.331060 [info ] [MainThread]: 
[0m13:01:34.331200 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:01:34.331741 [debug] [MainThread]: Command end result
[0m13:01:34.350345 [info ] [MainThread]: 
[0m13:01:34.350550 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m13:01:34.350667 [info ] [MainThread]: 
[0m13:01:34.350838 [error] [MainThread]:   Compilation Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "hub_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_aircrafts":
  
  -- depends_on: {{ ref('stg_aircrafts') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
[0m13:01:34.350958 [info ] [MainThread]: 
[0m13:01:34.351119 [error] [MainThread]:   Compilation Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  dbt was unable to infer all dependencies for the model "hub_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_bookings":
  
  -- depends_on: {{ ref('stg_bookings') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
[0m13:01:34.351227 [info ] [MainThread]: 
[0m13:01:34.351374 [error] [MainThread]:   Compilation Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  dbt was unable to infer all dependencies for the model "hub_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_airports":
  
  -- depends_on: {{ ref('stg_airports') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_airports (models/raw_vault/hubs/hub_airports.sql)
[0m13:01:34.351478 [info ] [MainThread]: 
[0m13:01:34.351621 [error] [MainThread]:   Compilation Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  dbt was unable to infer all dependencies for the model "hub_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_flights":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_flights (models/raw_vault/hubs/hub_flights.sql)
[0m13:01:34.351749 [info ] [MainThread]: 
[0m13:01:34.351891 [error] [MainThread]:   Compilation Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  dbt was unable to infer all dependencies for the model "hub_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_seats (models/raw_vault/hubs/hub_seats.sql)
[0m13:01:34.351997 [info ] [MainThread]: 
[0m13:01:34.352125 [error] [MainThread]:   Compilation Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  dbt was unable to infer all dependencies for the model "hub_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "hub_tickets":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__hub (macros/tables/postgres/hub.sql)
  > called by macro hub (macros/tables/snowflake/hub.sql)
  > called by model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
[0m13:01:34.352232 [info ] [MainThread]: 
[0m13:01:34.352346 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m13:01:34.353075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.40967786, "process_in_blocks": "0", "process_kernel_time": 0.110911, "process_mem_max_rss": "125992960", "process_out_blocks": "0", "process_user_time": 0.729872}
[0m13:01:34.353304 [debug] [MainThread]: Command `dbt run` failed at 13:01:34.353265 after 0.41 seconds
[0m13:01:34.353451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085eec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5f9b0>]}
[0m13:01:34.353575 [debug] [MainThread]: Flushing usage events
[0m13:03:36.271754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3fed0>]}


============================== 13:03:36.273510 | a2e373d1-b141-4c77-8417-10eb1b4ccf5c ==============================
[0m13:03:36.273510 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:03:36.273777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:03:36.328503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95e00>]}
[0m13:03:36.345610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dddd00>]}
[0m13:03:36.345934 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:03:36.380798 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:03:36.428895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m13:03:36.429186 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/hubs/hub_flights.sql
[0m13:03:36.429330 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/hubs/hub_bookings.sql
[0m13:03:36.429457 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/hubs/hub_tickets.sql
[0m13:03:36.429593 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/hubs/hub_aircrafts.sql
[0m13:03:36.429711 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/hubs/hub_airports.sql
[0m13:03:36.429830 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/hubs/hub_seats.sql
[0m13:03:36.550708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a2b550>]}
[0m13:03:36.588838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e4f6b0>]}
[0m13:03:36.589050 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m13:03:36.589183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ed03d0>]}
[0m13:03:36.589973 [info ] [MainThread]: 
[0m13:03:36.590188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:03:36.591641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:03:36.631133 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:03:36.631312 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:03:36.631418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:36.674353 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.043 seconds
[0m13:03:36.674997 [debug] [ThreadPool]: On list_postgres: Close
[0m13:03:36.676229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m13:03:36.678750 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:03:36.678974 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m13:03:36.679135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:36.688685 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:03:36.688871 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:03:36.689009 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m13:03:36.691824 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:03:36.692428 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m13:03:36.692922 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m13:03:36.696275 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:36.696520 [debug] [MainThread]: On master: BEGIN
[0m13:03:36.696636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:36.705818 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:03:36.706037 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:36.706213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:03:36.707883 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m13:03:36.708385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e668f0>]}
[0m13:03:36.708569 [debug] [MainThread]: On master: ROLLBACK
[0m13:03:36.708962 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:36.709060 [debug] [MainThread]: On master: BEGIN
[0m13:03:36.709753 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:03:36.709858 [debug] [MainThread]: On master: COMMIT
[0m13:03:36.709953 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:36.710044 [debug] [MainThread]: On master: COMMIT
[0m13:03:36.710386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:03:36.710548 [debug] [MainThread]: On master: Close
[0m13:03:36.710754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:36.710906 [info ] [MainThread]: 
[0m13:03:36.712119 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_airports
[0m13:03:36.712315 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m13:03:36.712491 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m13:03:36.712633 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_bookings
[0m13:03:36.712845 [info ] [Thread-2 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m13:03:36.713089 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m13:03:36.713324 [info ] [Thread-4 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m13:03:36.713525 [info ] [Thread-3 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m13:03:36.713738 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_airports'
[0m13:03:36.713893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.hub_aircrafts)
[0m13:03:36.714058 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_flights'
[0m13:03:36.714201 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_bookings'
[0m13:03:36.714324 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_airports
[0m13:03:36.714444 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m13:03:36.714557 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.hub_flights
[0m13:03:36.714672 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m13:03:36.722041 [info ] [Thread-2 (]: 13:03:36 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m13:03:36.724131 [info ] [Thread-1 (]: 13:03:36 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m13:03:36.725842 [info ] [Thread-4 (]: 13:03:36 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m13:03:36.728680 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m13:03:36.727762 [info ] [Thread-3 (]: 13:03:36 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m13:03:36.729578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m13:03:36.730613 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m13:03:36.731448 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m13:03:36.732095 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.hub_airports
[0m13:03:36.732256 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.hub_flights
[0m13:03:36.732407 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.hub_bookings
[0m13:03:36.738841 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m13:03:36.757249 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m13:03:36.757643 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m13:03:36.759075 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m13:03:36.760320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m13:03:36.760958 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m13:03:36.761111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m13:03:36.761252 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m13:03:36.761386 [debug] [Thread-2 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m13:03:36.761508 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m13:03:36.761628 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m13:03:36.761739 [debug] [Thread-3 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m13:03:36.761861 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:03:36.761989 [debug] [Thread-4 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m13:03:36.762103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:36.762232 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:03:36.762395 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:03:36.776834 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m13:03:36.777073 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m13:03:36.777232 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m13:03:36.777388 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m13:03:36.777521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:03:36.777653 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m13:03:36.777784 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m13:03:36.777924 [debug] [Thread-4 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:03:36.778059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m13:03:36.778190 [debug] [Thread-3 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:03:36.778338 [debug] [Thread-2 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:03:36.778551 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:03:36.778985 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "dwh_detailed_dwh_detailed.stg_flights" does not exist
LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights...
                  ^

[0m13:03:36.779168 [debug] [Thread-4 (]: On model.dbt_dwh.hub_flights: ROLLBACK
[0m13:03:36.779340 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "dwh_detailed_dwh_detailed.stg_bookings" does not exist
LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_booking...
                  ^

[0m13:03:36.779501 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "dwh_detailed_dwh_detailed.stg_airports" does not exist
LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airport...
                  ^

[0m13:03:36.779651 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dwh_detailed_dwh_detailed.stg_aircrafts" does not exist
LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircraf...
                  ^

[0m13:03:36.779804 [debug] [Thread-3 (]: On model.dbt_dwh.hub_bookings: ROLLBACK
[0m13:03:36.779950 [debug] [Thread-2 (]: On model.dbt_dwh.hub_airports: ROLLBACK
[0m13:03:36.780136 [debug] [Thread-4 (]: On model.dbt_dwh.hub_flights: Close
[0m13:03:36.780267 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: ROLLBACK
[0m13:03:36.781052 [debug] [Thread-2 (]: On model.dbt_dwh.hub_airports: Close
[0m13:03:36.781275 [debug] [Thread-3 (]: On model.dbt_dwh.hub_bookings: Close
[0m13:03:36.781699 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m13:03:36.789296 [debug] [Thread-1 (]: Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  relation "dwh_detailed_dwh_detailed.stg_aircrafts" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircraf...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_aircrafts.sql
[0m13:03:36.789680 [debug] [Thread-2 (]: Database Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  relation "dwh_detailed_dwh_detailed.stg_airports" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airport...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_airports.sql
[0m13:03:36.790104 [debug] [Thread-4 (]: Database Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  relation "dwh_detailed_dwh_detailed.stg_flights" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_flights.sql
[0m13:03:36.790736 [debug] [Thread-3 (]: Database Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  relation "dwh_detailed_dwh_detailed.stg_bookings" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_booking...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_bookings.sql
[0m13:03:36.791366 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebb890>]}
[0m13:03:36.791646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d6e60>]}
[0m13:03:36.791810 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8d6db0>]}
[0m13:03:36.791966 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d89a90>]}
[0m13:03:36.792253 [error] [Thread-2 (]: 2 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_airports  [[31mERROR[0m in 0.08s]
[0m13:03:36.792529 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[31mERROR[0m in 0.08s]
[0m13:03:36.793219 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_airports
[0m13:03:36.792747 [error] [Thread-4 (]: 4 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_flights  [[31mERROR[0m in 0.08s]
[0m13:03:36.792981 [error] [Thread-3 (]: 3 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_bookings  [[31mERROR[0m in 0.08s]
[0m13:03:36.793527 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m13:03:36.793702 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_seats
[0m13:03:36.794199 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m13:03:36.794400 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_bookings
[0m13:03:36.794568 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m13:03:36.794788 [info ] [Thread-2 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m13:03:36.795075 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m13:03:36.795274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_seats)
[0m13:03:36.795435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_tickets)
[0m13:03:36.795576 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.hub_seats
[0m13:03:36.795705 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m13:03:36.797567 [info ] [Thread-2 (]: 13:03:36 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m13:03:36.799521 [info ] [Thread-1 (]: 13:03:36 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m13:03:36.800334 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m13:03:36.801068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m13:03:36.801420 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m13:03:36.801558 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.hub_seats
[0m13:03:36.803119 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m13:03:36.806586 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m13:03:36.807011 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m13:03:36.807167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m13:03:36.807294 [debug] [Thread-2 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m13:03:36.807439 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m13:03:36.807575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:03:36.807693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:03:36.819785 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:03:36.820023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m13:03:36.820190 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_tickets"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:03:36.820359 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m13:03:36.820523 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m13:03:36.820693 [debug] [Thread-2 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, seat_no) rr.aircraft_code, seat_no, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code, seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, seat_no, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m13:03:36.820946 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "dwh_detailed_dwh_detailed.stg_tickets" does not exist
LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets...
                  ^

[0m13:03:36.821137 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: ROLLBACK
[0m13:03:36.821292 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                   ^

[0m13:03:36.821445 [debug] [Thread-2 (]: On model.dbt_dwh.hub_seats: ROLLBACK
[0m13:03:36.821632 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m13:03:36.822390 [debug] [Thread-2 (]: On model.dbt_dwh.hub_seats: Close
[0m13:03:36.824149 [debug] [Thread-1 (]: Database Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  relation "dwh_detailed_dwh_detailed.stg_tickets" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_tickets.sql
[0m13:03:36.824371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b7d90>]}
[0m13:03:36.825407 [debug] [Thread-2 (]: Database Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_seats.sql
[0m13:03:36.825807 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e373d1-b141-4c77-8417-10eb1b4ccf5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afaf90>]}
[0m13:03:36.825665 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_tickets  [[31mERROR[0m in 0.03s]
[0m13:03:36.826103 [error] [Thread-2 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.03s]
[0m13:03:36.826357 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m13:03:36.826541 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_seats
[0m13:03:36.827170 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:36.827279 [debug] [MainThread]: On master: BEGIN
[0m13:03:36.827367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:36.835126 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:03:36.835341 [debug] [MainThread]: On master: COMMIT
[0m13:03:36.835439 [debug] [MainThread]: Using postgres connection "master"
[0m13:03:36.835529 [debug] [MainThread]: On master: COMMIT
[0m13:03:36.835922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:03:36.836020 [debug] [MainThread]: On master: Close
[0m13:03:36.836205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:36.836315 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m13:03:36.836405 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_seats' was properly closed.
[0m13:03:36.836489 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_flights' was properly closed.
[0m13:03:36.836569 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_bookings' was properly closed.
[0m13:03:36.836722 [info ] [MainThread]: 
[0m13:03:36.836861 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:03:36.837429 [debug] [MainThread]: Command end result
[0m13:03:36.856367 [info ] [MainThread]: 
[0m13:03:36.856596 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m13:03:36.856714 [info ] [MainThread]: 
[0m13:03:36.856867 [error] [MainThread]:   Database Error in model hub_airports (models/raw_vault/hubs/hub_airports.sql)
  relation "dwh_detailed_dwh_detailed.stg_airports" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airport...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_airports.sql
[0m13:03:36.856977 [info ] [MainThread]: 
[0m13:03:36.857110 [error] [MainThread]:   Database Error in model hub_aircrafts (models/raw_vault/hubs/hub_aircrafts.sql)
  relation "dwh_detailed_dwh_detailed.stg_aircrafts" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircraf...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_aircrafts.sql
[0m13:03:36.857213 [info ] [MainThread]: 
[0m13:03:36.857338 [error] [MainThread]:   Database Error in model hub_flights (models/raw_vault/hubs/hub_flights.sql)
  relation "dwh_detailed_dwh_detailed.stg_flights" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_flights.sql
[0m13:03:36.857435 [info ] [MainThread]: 
[0m13:03:36.857560 [error] [MainThread]:   Database Error in model hub_bookings (models/raw_vault/hubs/hub_bookings.sql)
  relation "dwh_detailed_dwh_detailed.stg_bookings" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_booking...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_bookings.sql
[0m13:03:36.857659 [info ] [MainThread]: 
[0m13:03:36.857780 [error] [MainThread]:   Database Error in model hub_tickets (models/raw_vault/hubs/hub_tickets.sql)
  relation "dwh_detailed_dwh_detailed.stg_tickets" does not exist
  LINE 19:     FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets...
                    ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_tickets.sql
[0m13:03:36.857882 [info ] [MainThread]: 
[0m13:03:36.858001 [error] [MainThread]:   Database Error in model hub_seats (models/raw_vault/hubs/hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target/run/dbt_dwh/models/raw_vault/hubs/hub_seats.sql
[0m13:03:36.858104 [info ] [MainThread]: 
[0m13:03:36.858216 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m13:03:36.858924 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6100143, "process_in_blocks": "0", "process_kernel_time": 0.116267, "process_mem_max_rss": "133103616", "process_out_blocks": "0", "process_user_time": 0.865316}
[0m13:03:36.859109 [debug] [MainThread]: Command `dbt run` failed at 13:03:36.859075 after 0.61 seconds
[0m13:03:36.859243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b167f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1659d0>]}
[0m13:03:36.859361 [debug] [MainThread]: Flushing usage events
[0m13:07:44.971668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a492b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f7ed0>]}


============================== 13:07:44.973955 | 81e0692f-5af1-49bd-a784-e7aa24c9f2fc ==============================
[0m13:07:44.973955 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:07:44.974220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:07:45.058603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107249e00>]}
[0m13:07:45.076895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108491d00>]}
[0m13:07:45.077445 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:07:45.116326 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:07:45.180079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:45.180275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:45.192480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f99250>]}
[0m13:07:45.237719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ec230>]}
[0m13:07:45.237964 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m13:07:45.238108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109203230>]}
[0m13:07:45.239343 [info ] [MainThread]: 
[0m13:07:45.239600 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:07:45.241754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:07:45.265438 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:07:45.265624 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:07:45.265732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:07:45.346038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.080 seconds
[0m13:07:45.346818 [debug] [ThreadPool]: On list_postgres: Close
[0m13:07:45.348285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m13:07:45.351094 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:07:45.351251 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m13:07:45.351366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:07:45.364193 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:07:45.364356 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:07:45.364511 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m13:07:45.368444 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:07:45.368968 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m13:07:45.369697 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m13:07:45.373868 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:45.374018 [debug] [MainThread]: On master: BEGIN
[0m13:07:45.374129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:07:45.386421 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:07:45.386589 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:45.386783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:07:45.390284 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:07:45.390841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e4940>]}
[0m13:07:45.391041 [debug] [MainThread]: On master: ROLLBACK
[0m13:07:45.391694 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:45.391820 [debug] [MainThread]: On master: BEGIN
[0m13:07:45.392903 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:07:45.393033 [debug] [MainThread]: On master: COMMIT
[0m13:07:45.393153 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:45.393269 [debug] [MainThread]: On master: COMMIT
[0m13:07:45.394022 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:07:45.394152 [debug] [MainThread]: On master: Close
[0m13:07:45.394336 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:07:45.394480 [info ] [MainThread]: 
[0m13:07:45.396817 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m13:07:45.397030 [debug] [Thread-3 (]: Began running node model.dbt_dwh.link_flights_airports
[0m13:07:45.397191 [debug] [Thread-4 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m13:07:45.397346 [debug] [Thread-2 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m13:07:45.397574 [info ] [Thread-1 (]: 1 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m13:07:45.397852 [info ] [Thread-3 (]: 3 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m13:07:45.398148 [info ] [Thread-4 (]: 4 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m13:07:45.398431 [info ] [Thread-2 (]: 2 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m13:07:45.398689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.link_aircrafts_seats)
[0m13:07:45.398922 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.link_flights_airports'
[0m13:07:45.399118 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.link_ticket_flights'
[0m13:07:45.399302 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.link_boarding_passes'
[0m13:07:45.399457 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m13:07:45.399605 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m13:07:45.399740 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m13:07:45.399871 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m13:07:45.415599 [info ] [Thread-3 (]: 13:07:45 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m13:07:45.416337 [info ] [Thread-1 (]: 13:07:45 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m13:07:45.418189 [info ] [Thread-4 (]: 13:07:45 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m13:07:45.419962 [info ] [Thread-2 (]: 13:07:45 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m13:07:45.443246 [debug] [Thread-2 (]: Compilation Error in model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "link_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_boarding_passes":
  
  -- depends_on: {{ ref('stg_boarding_passes') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
[0m13:07:45.444365 [debug] [Thread-3 (]: Compilation Error in model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
  dbt was unable to infer all dependencies for the model "link_flights_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_flights_airports":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
[0m13:07:45.444722 [debug] [Thread-4 (]: Compilation Error in model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "link_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_ticket_flights":
  
  -- depends_on: {{ ref('stg_ticket_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
[0m13:07:45.445717 [debug] [Thread-1 (]: Compilation Error in model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
  dbt was unable to infer all dependencies for the model "link_aircrafts_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_aircrafts_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
[0m13:07:45.446109 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915f1d0>]}
[0m13:07:45.446298 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109605860>]}
[0m13:07:45.446457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109605bd0>]}
[0m13:07:45.446606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cc730>]}
[0m13:07:45.446885 [error] [Thread-2 (]: 2 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[31mERROR[0m in 0.05s]
[0m13:07:45.447143 [error] [Thread-3 (]: 3 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[31mERROR[0m in 0.05s]
[0m13:07:45.447359 [error] [Thread-4 (]: 4 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[31mERROR[0m in 0.05s]
[0m13:07:45.447890 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m13:07:45.447596 [error] [Thread-1 (]: 1 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.05s]
[0m13:07:45.448178 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m13:07:45.448380 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m13:07:45.448555 [debug] [Thread-2 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m13:07:45.449044 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m13:07:45.449205 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m13:07:45.449395 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_airports
[0m13:07:45.449638 [info ] [Thread-2 (]: 5 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m13:07:45.449866 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m13:07:45.450069 [info ] [Thread-3 (]: 6 of 35 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ........... [RUN]
[0m13:07:45.450345 [info ] [Thread-4 (]: 7 of 35 START sql view model dwh_detailed_dwh_detailed.raw_airports ............ [RUN]
[0m13:07:45.450551 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_tickets_bookings)
[0m13:07:45.450775 [info ] [Thread-1 (]: 8 of 35 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ..... [RUN]
[0m13:07:45.450996 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.raw_aircrafts)
[0m13:07:45.451313 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.raw_airports)
[0m13:07:45.451725 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m13:07:45.451941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.raw_boarding_passes)
[0m13:07:45.452206 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m13:07:45.452376 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_airports
[0m13:07:45.455092 [info ] [Thread-2 (]: 13:07:45 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m13:07:45.455357 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m13:07:45.456669 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m13:07:45.458009 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m13:07:45.460462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m13:07:45.461733 [debug] [Thread-2 (]: Compilation Error in model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
  dbt was unable to infer all dependencies for the model "link_tickets_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_tickets_bookings":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
[0m13:07:45.462128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8971c0>]}
[0m13:07:45.462469 [error] [Thread-2 (]: 5 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[31mERROR[0m in 0.01s]
[0m13:07:45.462889 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m13:07:45.463104 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_bookings
[0m13:07:45.463354 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m13:07:45.463503 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m13:07:45.463737 [info ] [Thread-2 (]: 9 of 35 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............ [RUN]
[0m13:07:45.475710 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_airports
[0m13:07:45.483165 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m13:07:45.484265 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m13:07:45.484511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_tickets_bookings, now model.dbt_dwh.raw_bookings)
[0m13:07:45.485985 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m13:07:45.486315 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m13:07:45.487700 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m13:07:45.488193 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_bookings
[0m13:07:45.488382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:07:45.488547 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:07:45.490065 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m13:07:45.490249 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m13:07:45.490431 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:07:45.490583 [debug] [Thread-4 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m13:07:45.490768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:45.490934 [debug] [Thread-3 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m13:07:45.491075 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:07:45.491233 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:07:45.491429 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:07:45.491611 [debug] [Thread-2 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m13:07:45.491782 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:07:45.505095 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m13:07:45.505433 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:07:45.505615 [debug] [Thread-2 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m13:07:45.506966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:07:45.507169 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m13:07:45.507357 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.bookings" does not exist
LINE 11:         FROM "postgres"."system"."bookings"
                      ^

[0m13:07:45.507504 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m13:07:45.507662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:07:45.507809 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:07:45.507961 [debug] [Thread-2 (]: On model.dbt_dwh.raw_bookings: ROLLBACK
[0m13:07:45.508092 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:07:45.508244 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m13:07:45.508390 [debug] [Thread-3 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m13:07:45.508583 [debug] [Thread-4 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m13:07:45.508951 [debug] [Thread-2 (]: On model.dbt_dwh.raw_bookings: Close
[0m13:07:45.509613 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.boarding_passes" does not exist
LINE 12:         FROM "postgres"."system"."boarding_passes"
                      ^

[0m13:07:45.509799 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.airports" does not exist
LINE 14:         FROM "postgres"."system"."airports"
                      ^

[0m13:07:45.509948 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: ROLLBACK
[0m13:07:45.510078 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.aircrafts" does not exist
LINE 11:         FROM "postgres"."system"."aircrafts"
                      ^

[0m13:07:45.510217 [debug] [Thread-4 (]: On model.dbt_dwh.raw_airports: ROLLBACK
[0m13:07:45.510428 [debug] [Thread-3 (]: On model.dbt_dwh.raw_aircrafts: ROLLBACK
[0m13:07:45.510929 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m13:07:45.511177 [debug] [Thread-3 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m13:07:45.511950 [debug] [Thread-4 (]: On model.dbt_dwh.raw_airports: Close
[0m13:07:45.515296 [debug] [Thread-4 (]: Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:07:45.515592 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f849af0>]}
[0m13:07:45.516628 [debug] [Thread-2 (]: Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:07:45.517710 [debug] [Thread-3 (]: Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:07:45.517912 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f86fb90>]}
[0m13:07:45.518183 [error] [Thread-4 (]: 7 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_airports ... [[31mERROR[0m in 0.06s]
[0m13:07:45.519058 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f848650>]}
[0m13:07:45.519587 [debug] [Thread-1 (]: Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:07:45.519932 [error] [Thread-2 (]: 9 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_bookings ... [[31mERROR[0m in 0.03s]
[0m13:07:45.520248 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_airports
[0m13:07:45.520495 [error] [Thread-3 (]: 6 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_aircrafts .. [[31mERROR[0m in 0.07s]
[0m13:07:45.520719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f86fb90>]}
[0m13:07:45.520972 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_bookings
[0m13:07:45.521167 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_flights
[0m13:07:45.521442 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m13:07:45.521753 [error] [Thread-1 (]: 8 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_boarding_passes  [[31mERROR[0m in 0.07s]
[0m13:07:45.521961 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_seats
[0m13:07:45.522173 [info ] [Thread-4 (]: 10 of 35 START sql view model dwh_detailed_dwh_detailed.raw_flights ............ [RUN]
[0m13:07:45.522444 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m13:07:45.522998 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m13:07:45.523222 [info ] [Thread-2 (]: 11 of 35 START sql view model dwh_detailed_dwh_detailed.raw_seats .............. [RUN]
[0m13:07:45.523554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_flights)
[0m13:07:45.523777 [info ] [Thread-3 (]: 12 of 35 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ..... [RUN]
[0m13:07:45.523968 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m13:07:45.524154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_seats)
[0m13:07:45.524302 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_flights
[0m13:07:45.524471 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_ticket_flights)
[0m13:07:45.524665 [info ] [Thread-1 (]: 13 of 35 START sql view model dwh_detailed_dwh_detailed.raw_tickets ............ [RUN]
[0m13:07:45.524834 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_seats
[0m13:07:45.526024 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m13:07:45.526165 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m13:07:45.526313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_tickets)
[0m13:07:45.529577 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m13:07:45.530848 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m13:07:45.531012 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m13:07:45.532095 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m13:07:45.532326 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_flights
[0m13:07:45.532485 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_seats
[0m13:07:45.557512 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m13:07:45.558868 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m13:07:45.560092 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m13:07:45.561289 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m13:07:45.561443 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m13:07:45.562740 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m13:07:45.563040 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:07:45.563193 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:07:45.563342 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m13:07:45.563515 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:07:45.563653 [debug] [Thread-3 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m13:07:45.563798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:07:45.563926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:07:45.564054 [debug] [Thread-4 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m13:07:45.564182 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:07:45.564300 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m13:07:45.564462 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:07:45.564625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:07:45.578152 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m13:07:45.578381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:07:45.578571 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m13:07:45.578726 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:07:45.578853 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m13:07:45.578979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:07:45.579097 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:07:45.579225 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m13:07:45.579351 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:07:45.579471 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m13:07:45.579617 [debug] [Thread-4 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m13:07:45.579812 [debug] [Thread-3 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m13:07:45.580358 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.seats" does not exist
LINE 11:         FROM "postgres"."system"."seats"
                      ^

[0m13:07:45.580568 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.tickets" does not exist
LINE 13:         FROM "postgres"."system"."tickets"
                      ^

[0m13:07:45.580746 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.flights" does not exist
LINE 18:         FROM "postgres"."system"."flights"
                      ^

[0m13:07:45.580877 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.ticket_flights" does not exist
LINE 12:         FROM "postgres"."system"."ticket_flights"
                      ^

[0m13:07:45.581007 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: ROLLBACK
[0m13:07:45.581126 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: ROLLBACK
[0m13:07:45.581238 [debug] [Thread-4 (]: On model.dbt_dwh.raw_flights: ROLLBACK
[0m13:07:45.581350 [debug] [Thread-3 (]: On model.dbt_dwh.raw_ticket_flights: ROLLBACK
[0m13:07:45.581873 [debug] [Thread-3 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m13:07:45.582031 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: Close
[0m13:07:45.582217 [debug] [Thread-4 (]: On model.dbt_dwh.raw_flights: Close
[0m13:07:45.582407 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m13:07:45.585335 [debug] [Thread-2 (]: Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:07:45.586338 [debug] [Thread-1 (]: Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:07:45.586524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107989130>]}
[0m13:07:45.587569 [debug] [Thread-3 (]: Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:07:45.587744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c079b0>]}
[0m13:07:45.588002 [error] [Thread-2 (]: 11 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_seats ..... [[31mERROR[0m in 0.06s]
[0m13:07:45.588229 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890b890>]}
[0m13:07:45.589114 [debug] [Thread-4 (]: Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:07:45.589542 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_seats
[0m13:07:45.589321 [error] [Thread-1 (]: 13 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_tickets ... [[31mERROR[0m in 0.06s]
[0m13:07:45.589779 [error] [Thread-3 (]: 12 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_ticket_flights  [[31mERROR[0m in 0.06s]
[0m13:07:45.589931 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107989130>]}
[0m13:07:45.590079 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m13:07:45.590311 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m13:07:45.590488 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m13:07:45.590671 [info ] [Thread-2 (]: 14 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ... [RUN]
[0m13:07:45.590889 [error] [Thread-4 (]: 10 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_flights ... [[31mERROR[0m in 0.07s]
[0m13:07:45.591061 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m13:07:45.591234 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m13:07:45.591405 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.sat_aircrafts)
[0m13:07:45.591603 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_flights
[0m13:07:45.591781 [info ] [Thread-1 (]: 15 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_airports .... [RUN]
[0m13:07:45.591950 [info ] [Thread-3 (]: 16 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m13:07:45.592094 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m13:07:45.592225 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_bookings
[0m13:07:45.592376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_tickets, now model.dbt_dwh.sat_airports)
[0m13:07:45.592501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.sat_boarding_passes)
[0m13:07:45.594726 [info ] [Thread-4 (]: 17 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings .... [RUN]
[0m13:07:45.594960 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m13:07:45.595116 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m13:07:45.595279 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.sat_bookings)
[0m13:07:45.597899 [debug] [Thread-2 (]: Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.599914 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m13:07:45.600674 [debug] [Thread-3 (]: Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.600828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f827ad0>]}
[0m13:07:45.601552 [debug] [Thread-1 (]: Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.603294 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8597f0>]}
[0m13:07:45.604307 [debug] [Thread-4 (]: Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.604549 [error] [Thread-2 (]: 14 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.01s]
[0m13:07:45.604754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f827ad0>]}
[0m13:07:45.604982 [error] [Thread-3 (]: 16 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.01s]
[0m13:07:45.605135 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108954ad0>]}
[0m13:07:45.605321 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m13:07:45.605512 [error] [Thread-1 (]: 15 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.01s]
[0m13:07:45.605709 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m13:07:45.605882 [error] [Thread-4 (]: 17 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.01s]
[0m13:07:45.606062 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_flights
[0m13:07:45.606271 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m13:07:45.606412 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_seats
[0m13:07:45.606599 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_bookings
[0m13:07:45.606755 [info ] [Thread-2 (]: 18 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ..... [RUN]
[0m13:07:45.606967 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m13:07:45.607149 [info ] [Thread-3 (]: 19 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ....... [RUN]
[0m13:07:45.607314 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_tickets
[0m13:07:45.607488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_flights)
[0m13:07:45.607663 [info ] [Thread-1 (]: 20 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m13:07:45.607817 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_seats)
[0m13:07:45.607966 [info ] [Thread-4 (]: 21 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ..... [RUN]
[0m13:07:45.608116 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_flights
[0m13:07:45.608249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_ticket_flights)
[0m13:07:45.608364 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_seats
[0m13:07:45.608481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_tickets)
[0m13:07:45.610393 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m13:07:45.612478 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m13:07:45.613427 [debug] [Thread-3 (]: Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.615984 [debug] [Thread-2 (]: Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.617779 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971cb90>]}
[0m13:07:45.617938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971c0b0>]}
[0m13:07:45.618216 [error] [Thread-3 (]: 19 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.01s]
[0m13:07:45.619203 [debug] [Thread-4 (]: Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.618439 [error] [Thread-2 (]: 18 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.01s]
[0m13:07:45.619508 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_seats
[0m13:07:45.620290 [debug] [Thread-1 (]: Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:45.620449 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971d670>]}
[0m13:07:45.620618 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_flights
[0m13:07:45.620757 [debug] [Thread-3 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m13:07:45.620925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109563ef0>]}
[0m13:07:45.621140 [error] [Thread-4 (]: 21 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.01s]
[0m13:07:45.621310 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_airports
[0m13:07:45.621491 [info ] [Thread-3 (]: 22 of 35 START sql view model dwh_detailed_dwh_detailed.stg_aircrafts .......... [RUN]
[0m13:07:45.621727 [error] [Thread-1 (]: 20 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.01s]
[0m13:07:45.621918 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_tickets
[0m13:07:45.622075 [info ] [Thread-2 (]: 23 of 35 START sql view model dwh_detailed_dwh_detailed.stg_airports ........... [RUN]
[0m13:07:45.622232 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.stg_aircrafts)
[0m13:07:45.622399 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m13:07:45.622554 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m13:07:45.622726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.stg_airports)
[0m13:07:45.622869 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.stg_aircrafts
[0m13:07:45.623020 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m13:07:45.623216 [info ] [Thread-4 (]: 24 of 35 START sql view model dwh_detailed_dwh_detailed.stg_boarding_passes .... [RUN]
[0m13:07:45.623362 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.stg_airports
[0m13:07:45.634160 [info ] [Thread-1 (]: 25 of 35 START sql view model dwh_detailed_dwh_detailed.stg_bookings ........... [RUN]
[0m13:07:45.634401 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_tickets, now model.dbt_dwh.stg_boarding_passes)
[0m13:07:45.637243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.stg_bookings)
[0m13:07:45.637889 [debug] [Thread-3 (]: Compilation Error in model stg_aircrafts (models/stage/stg_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "stg_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_aircrafts":
  
  -- depends_on: {{ ref('raw_aircrafts') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_aircrafts (models/stage/stg_aircrafts.sql)
[0m13:07:45.638050 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.stg_boarding_passes
[0m13:07:45.638935 [debug] [Thread-2 (]: Compilation Error in model stg_airports (models/stage/stg_airports.sql)
  dbt was unable to infer all dependencies for the model "stg_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_airports":
  
  -- depends_on: {{ ref('raw_airports') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_airports (models/stage/stg_airports.sql)
[0m13:07:45.639072 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_bookings
[0m13:07:45.639211 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935e930>]}
[0m13:07:45.641802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935fcb0>]}
[0m13:07:45.644065 [error] [Thread-3 (]: 22 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_aircrafts . [[31mERROR[0m in 0.02s]
[0m13:07:45.644626 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m13:07:45.645722 [debug] [Thread-1 (]: Compilation Error in model stg_bookings (models/stage/stg_bookings.sql)
  dbt was unable to infer all dependencies for the model "stg_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_bookings":
  
  -- depends_on: {{ ref('raw_bookings') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_bookings (models/stage/stg_bookings.sql)
[0m13:07:45.646754 [debug] [Thread-4 (]: Compilation Error in model stg_boarding_passes (models/stage/stg_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "stg_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_boarding_passes":
  
  -- depends_on: {{ ref('raw_boarding_passes') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_boarding_passes (models/stage/stg_boarding_passes.sql)
[0m13:07:45.646960 [debug] [Thread-3 (]: Began running node model.dbt_dwh.stg_flights
[0m13:07:45.647175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935c170>]}
[0m13:07:45.647436 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935c3b0>]}
[0m13:07:45.647627 [info ] [Thread-3 (]: 26 of 35 START sql view model dwh_detailed_dwh_detailed.stg_flights ............ [RUN]
[0m13:07:45.648082 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_aircrafts, now model.dbt_dwh.stg_flights)
[0m13:07:45.648229 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.stg_flights
[0m13:07:45.652005 [debug] [Thread-3 (]: Compilation Error in model stg_flights (models/stage/stg_flights.sql)
  dbt was unable to infer all dependencies for the model "stg_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_flights":
  
  -- depends_on: {{ ref('raw_flights') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_flights (models/stage/stg_flights.sql)
[0m13:07:45.652189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935e090>]}
[0m13:07:46.431826 [error] [Thread-2 (]: 23 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_airports .. [[31mERROR[0m in 0.02s]
[0m13:07:46.432116 [error] [Thread-1 (]: 25 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_bookings .. [[31mERROR[0m in 0.01s]
[0m13:07:46.432464 [error] [Thread-4 (]: 24 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_boarding_passes  [[31mERROR[0m in 0.01s]
[0m13:07:46.432726 [error] [Thread-3 (]: 26 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_flights ... [[31mERROR[0m in 0.00s]
[0m13:07:46.433001 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_airports
[0m13:07:46.433229 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m13:07:46.433446 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m13:07:46.433654 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.stg_flights
[0m13:07:46.433843 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_seats
[0m13:07:46.434089 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m13:07:46.434374 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_tickets
[0m13:07:46.434576 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m13:07:46.434848 [info ] [Thread-2 (]: 27 of 35 START sql view model dwh_detailed_dwh_detailed.stg_seats .............. [RUN]
[0m13:07:46.435063 [info ] [Thread-1 (]: 28 of 35 START sql view model dwh_detailed_dwh_detailed.stg_ticket_flights ..... [RUN]
[0m13:07:46.435269 [info ] [Thread-4 (]: 29 of 35 START sql view model dwh_detailed_dwh_detailed.stg_tickets ............ [RUN]
[0m13:07:46.435454 [info ] [Thread-3 (]: 30 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_aircrafts ................. [[33mSKIP[0m]
[0m13:07:46.435681 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_airports, now model.dbt_dwh.stg_seats)
[0m13:07:46.435862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_bookings, now model.dbt_dwh.stg_ticket_flights)
[0m13:07:46.436020 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_boarding_passes, now model.dbt_dwh.stg_tickets)
[0m13:07:46.436195 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m13:07:46.436344 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.stg_seats
[0m13:07:46.436484 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_ticket_flights
[0m13:07:46.436616 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.stg_tickets
[0m13:07:46.436780 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_airports
[0m13:07:46.448175 [info ] [Thread-3 (]: 31 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_airports .................. [[33mSKIP[0m]
[0m13:07:46.449820 [debug] [Thread-4 (]: Compilation Error in model stg_tickets (models/stage/stg_tickets.sql)
  dbt was unable to infer all dependencies for the model "stg_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_tickets":
  
  -- depends_on: {{ ref('raw_tickets') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_tickets (models/stage/stg_tickets.sql)
[0m13:07:46.450025 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_airports
[0m13:07:46.450751 [debug] [Thread-2 (]: Compilation Error in model stg_seats (models/stage/stg_seats.sql)
  dbt was unable to infer all dependencies for the model "stg_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_seats":
  
  -- depends_on: {{ ref('raw_seats') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_seats (models/stage/stg_seats.sql)
[0m13:07:46.450962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e7590>]}
[0m13:07:46.451961 [debug] [Thread-1 (]: Compilation Error in model stg_ticket_flights (models/stage/stg_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "stg_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_ticket_flights":
  
  -- depends_on: {{ ref('raw_ticket_flights') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_ticket_flights (models/stage/stg_ticket_flights.sql)
[0m13:07:46.452131 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_bookings
[0m13:07:46.452271 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079369f0>]}
[0m13:07:46.452528 [error] [Thread-4 (]: 29 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_tickets ... [[31mERROR[0m in 0.01s]
[0m13:07:46.452675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81e0692f-5af1-49bd-a784-e7aa24c9f2fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109764bf0>]}
[0m13:07:46.452813 [info ] [Thread-3 (]: 32 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_bookings .................. [[33mSKIP[0m]
[0m13:07:46.453016 [error] [Thread-2 (]: 27 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_seats ..... [[31mERROR[0m in 0.02s]
[0m13:07:46.453244 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_tickets
[0m13:07:46.453422 [error] [Thread-1 (]: 28 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.stg_ticket_flights  [[31mERROR[0m in 0.02s]
[0m13:07:46.453611 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_bookings
[0m13:07:46.453812 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_seats
[0m13:07:46.453971 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m13:07:46.454190 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m13:07:46.454439 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_tickets
[0m13:07:46.454569 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_seats
[0m13:07:46.454697 [info ] [Thread-4 (]: 33 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_flights ................... [[33mSKIP[0m]
[0m13:07:46.454898 [info ] [Thread-2 (]: 35 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_tickets ................... [[33mSKIP[0m]
[0m13:07:46.455066 [info ] [Thread-3 (]: 34 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_seats ..................... [[33mSKIP[0m]
[0m13:07:46.455218 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m13:07:46.455352 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_tickets
[0m13:07:46.455481 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_seats
[0m13:07:46.456083 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:46.456206 [debug] [MainThread]: On master: BEGIN
[0m13:07:46.456309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:07:46.473154 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:07:46.473332 [debug] [MainThread]: On master: COMMIT
[0m13:07:46.473451 [debug] [MainThread]: Using postgres connection "master"
[0m13:07:46.473552 [debug] [MainThread]: On master: COMMIT
[0m13:07:46.474130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:07:46.474244 [debug] [MainThread]: On master: Close
[0m13:07:46.474405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:07:46.474502 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_ticket_flights' was properly closed.
[0m13:07:46.474592 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_flights' was properly closed.
[0m13:07:46.474677 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_tickets' was properly closed.
[0m13:07:46.474762 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_seats' was properly closed.
[0m13:07:46.474930 [info ] [MainThread]: 
[0m13:07:46.475052 [info ] [MainThread]: Finished running 19 incremental models, 16 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m13:07:46.476521 [debug] [MainThread]: Command end result
[0m13:07:46.496576 [info ] [MainThread]: 
[0m13:07:46.496775 [info ] [MainThread]: [31mCompleted with 29 errors and 0 warnings:[0m
[0m13:07:46.496884 [info ] [MainThread]: 
[0m13:07:46.497044 [error] [MainThread]:   Compilation Error in model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "link_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_boarding_passes":
  
  -- depends_on: {{ ref('stg_boarding_passes') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
[0m13:07:46.497164 [info ] [MainThread]: 
[0m13:07:46.497305 [error] [MainThread]:   Compilation Error in model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
  dbt was unable to infer all dependencies for the model "link_flights_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_flights_airports":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
[0m13:07:46.497418 [info ] [MainThread]: 
[0m13:07:46.497551 [error] [MainThread]:   Compilation Error in model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "link_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_ticket_flights":
  
  -- depends_on: {{ ref('stg_ticket_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
[0m13:07:46.497658 [info ] [MainThread]: 
[0m13:07:46.497790 [error] [MainThread]:   Compilation Error in model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
  dbt was unable to infer all dependencies for the model "link_aircrafts_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_aircrafts_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
[0m13:07:46.497896 [info ] [MainThread]: 
[0m13:07:46.498028 [error] [MainThread]:   Compilation Error in model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
  dbt was unable to infer all dependencies for the model "link_tickets_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_tickets_bookings":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
[0m13:07:46.498133 [info ] [MainThread]: 
[0m13:07:46.498250 [error] [MainThread]:   Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:07:46.498349 [info ] [MainThread]: 
[0m13:07:46.498465 [error] [MainThread]:   Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:07:46.498564 [info ] [MainThread]: 
[0m13:07:46.498679 [error] [MainThread]:   Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:07:46.498776 [info ] [MainThread]: 
[0m13:07:46.498894 [error] [MainThread]:   Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:07:46.498993 [info ] [MainThread]: 
[0m13:07:46.499115 [error] [MainThread]:   Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:07:46.499212 [info ] [MainThread]: 
[0m13:07:46.499333 [error] [MainThread]:   Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:07:46.499430 [info ] [MainThread]: 
[0m13:07:46.499554 [error] [MainThread]:   Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:07:46.499654 [info ] [MainThread]: 
[0m13:07:46.499770 [error] [MainThread]:   Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:07:46.499870 [info ] [MainThread]: 
[0m13:07:46.499988 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.500084 [info ] [MainThread]: 
[0m13:07:46.500205 [error] [MainThread]:   Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.500299 [info ] [MainThread]: 
[0m13:07:46.500420 [error] [MainThread]:   Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.500516 [info ] [MainThread]: 
[0m13:07:46.500635 [error] [MainThread]:   Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.500732 [info ] [MainThread]: 
[0m13:07:46.500847 [error] [MainThread]:   Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.500946 [info ] [MainThread]: 
[0m13:07:46.501064 [error] [MainThread]:   Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.501160 [info ] [MainThread]: 
[0m13:07:46.501281 [error] [MainThread]:   Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.501379 [info ] [MainThread]: 
[0m13:07:46.501504 [error] [MainThread]:   Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:07:46.501597 [info ] [MainThread]: 
[0m13:07:46.501728 [error] [MainThread]:   Compilation Error in model stg_aircrafts (models/stage/stg_aircrafts.sql)
  dbt was unable to infer all dependencies for the model "stg_aircrafts".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_aircrafts":
  
  -- depends_on: {{ ref('raw_aircrafts') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_aircrafts (models/stage/stg_aircrafts.sql)
[0m13:07:46.501836 [info ] [MainThread]: 
[0m13:07:46.501960 [error] [MainThread]:   Compilation Error in model stg_airports (models/stage/stg_airports.sql)
  dbt was unable to infer all dependencies for the model "stg_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_airports":
  
  -- depends_on: {{ ref('raw_airports') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_airports (models/stage/stg_airports.sql)
[0m13:07:46.502069 [info ] [MainThread]: 
[0m13:07:46.502200 [error] [MainThread]:   Compilation Error in model stg_bookings (models/stage/stg_bookings.sql)
  dbt was unable to infer all dependencies for the model "stg_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_bookings":
  
  -- depends_on: {{ ref('raw_bookings') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_bookings (models/stage/stg_bookings.sql)
[0m13:07:46.502305 [info ] [MainThread]: 
[0m13:07:46.502438 [error] [MainThread]:   Compilation Error in model stg_boarding_passes (models/stage/stg_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "stg_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_boarding_passes":
  
  -- depends_on: {{ ref('raw_boarding_passes') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_boarding_passes (models/stage/stg_boarding_passes.sql)
[0m13:07:46.502548 [info ] [MainThread]: 
[0m13:07:46.502676 [error] [MainThread]:   Compilation Error in model stg_flights (models/stage/stg_flights.sql)
  dbt was unable to infer all dependencies for the model "stg_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_flights":
  
  -- depends_on: {{ ref('raw_flights') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_flights (models/stage/stg_flights.sql)
[0m13:07:46.502780 [info ] [MainThread]: 
[0m13:07:46.502907 [error] [MainThread]:   Compilation Error in model stg_tickets (models/stage/stg_tickets.sql)
  dbt was unable to infer all dependencies for the model "stg_tickets".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_tickets":
  
  -- depends_on: {{ ref('raw_tickets') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_tickets (models/stage/stg_tickets.sql)
[0m13:07:46.503015 [info ] [MainThread]: 
[0m13:07:46.503141 [error] [MainThread]:   Compilation Error in model stg_seats (models/stage/stg_seats.sql)
  dbt was unable to infer all dependencies for the model "stg_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_seats":
  
  -- depends_on: {{ ref('raw_seats') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_seats (models/stage/stg_seats.sql)
[0m13:07:46.503249 [info ] [MainThread]: 
[0m13:07:46.503380 [error] [MainThread]:   Compilation Error in model stg_ticket_flights (models/stage/stg_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "stg_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "stg_ticket_flights":
  
  -- depends_on: {{ ref('raw_ticket_flights') }}
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model stg_ticket_flights (models/stage/stg_ticket_flights.sql)
[0m13:07:46.503493 [info ] [MainThread]: 
[0m13:07:46.503609 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=29 SKIP=6 TOTAL=35
[0m13:07:46.504838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5589675, "process_in_blocks": "0", "process_kernel_time": 0.169424, "process_mem_max_rss": "132988928", "process_out_blocks": "0", "process_user_time": 0.940703}
[0m13:07:46.505108 [debug] [MainThread]: Command `dbt run` failed at 13:07:46.505065 after 1.56 seconds
[0m13:07:46.505263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f986d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f986f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f986a50>]}
[0m13:07:46.505397 [debug] [MainThread]: Flushing usage events
[0m13:09:37.698819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033092b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb7ed0>]}


============================== 13:09:37.700554 | 4f23e354-9988-4734-86f5-b316665a6dd2 ==============================
[0m13:09:37.700554 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:09:37.700821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:09:37.755546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b09e00>]}
[0m13:09:37.772679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f51d00>]}
[0m13:09:37.773008 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:09:37.808275 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:09:37.859565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m13:09:37.859842 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_aircrafts.sql
[0m13:09:37.859985 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_boarding_passes.sql
[0m13:09:37.860114 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_airports.sql
[0m13:09:37.860232 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_flights.sql
[0m13:09:37.860349 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_seats.sql
[0m13:09:37.860463 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_ticket_flights.sql
[0m13:09:37.860578 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_bookings.sql
[0m13:09:37.860696 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/stage/stg_tickets.sql
[0m13:09:38.030580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105653b50>]}
[0m13:09:38.091592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f5130>]}
[0m13:09:38.091812 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m13:09:38.091947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551dfd0>]}
[0m13:09:38.093110 [info ] [MainThread]: 
[0m13:09:38.093332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:09:38.095416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:09:38.113850 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:09:38.114034 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:09:38.114154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:09:38.130337 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m13:09:38.131005 [debug] [ThreadPool]: On list_postgres: Close
[0m13:09:38.132416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m13:09:38.134790 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:09:38.134930 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m13:09:38.135025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:09:38.143661 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:09:38.143894 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:09:38.144018 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m13:09:38.145398 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m13:09:38.145897 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m13:09:38.146316 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m13:09:38.149127 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:38.149252 [debug] [MainThread]: On master: BEGIN
[0m13:09:38.149339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:09:38.157299 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:09:38.157519 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:38.157680 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:09:38.159196 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m13:09:38.159681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd8e20>]}
[0m13:09:38.159868 [debug] [MainThread]: On master: ROLLBACK
[0m13:09:38.160264 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:38.160356 [debug] [MainThread]: On master: BEGIN
[0m13:09:38.161042 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:09:38.161191 [debug] [MainThread]: On master: COMMIT
[0m13:09:38.161287 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:38.161380 [debug] [MainThread]: On master: COMMIT
[0m13:09:38.161737 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:09:38.161857 [debug] [MainThread]: On master: Close
[0m13:09:38.162025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:09:38.162178 [info ] [MainThread]: 
[0m13:09:38.163373 [debug] [Thread-4 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m13:09:38.163585 [debug] [Thread-3 (]: Began running node model.dbt_dwh.link_flights_airports
[0m13:09:38.163738 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m13:09:38.163856 [debug] [Thread-2 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m13:09:38.164041 [info ] [Thread-4 (]: 4 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m13:09:38.164237 [info ] [Thread-3 (]: 3 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m13:09:38.164414 [info ] [Thread-1 (]: 1 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m13:09:38.164579 [info ] [Thread-2 (]: 2 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m13:09:38.164784 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.link_ticket_flights'
[0m13:09:38.164958 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.link_flights_airports'
[0m13:09:38.165102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.link_aircrafts_seats)
[0m13:09:38.165257 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.link_boarding_passes'
[0m13:09:38.165384 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m13:09:38.165516 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m13:09:38.165647 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m13:09:38.165767 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m13:09:38.177559 [info ] [Thread-4 (]: 13:09:38 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m13:09:38.179362 [info ] [Thread-3 (]: 13:09:38 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m13:09:38.180966 [info ] [Thread-1 (]: 13:09:38 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m13:09:38.182546 [info ] [Thread-2 (]: 13:09:38 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m13:09:38.202605 [debug] [Thread-1 (]: Compilation Error in model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
  dbt was unable to infer all dependencies for the model "link_aircrafts_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_aircrafts_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
[0m13:09:38.203290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106703b90>]}
[0m13:09:38.204410 [debug] [Thread-4 (]: Compilation Error in model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "link_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_ticket_flights":
  
  -- depends_on: {{ ref('stg_ticket_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
[0m13:09:38.205696 [debug] [Thread-3 (]: Compilation Error in model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
  dbt was unable to infer all dependencies for the model "link_flights_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_flights_airports":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
[0m13:09:38.206738 [debug] [Thread-2 (]: Compilation Error in model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "link_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_boarding_passes":
  
  -- depends_on: {{ ref('stg_boarding_passes') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
[0m13:09:38.204712 [error] [Thread-1 (]: 1 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.04s]
[0m13:09:38.206995 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069da6d0>]}
[0m13:09:38.207164 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d9f610>]}
[0m13:09:38.207306 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428c730>]}
[0m13:09:38.207524 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m13:09:38.207767 [error] [Thread-4 (]: 4 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[31mERROR[0m in 0.04s]
[0m13:09:38.207982 [error] [Thread-3 (]: 3 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[31mERROR[0m in 0.04s]
[0m13:09:38.208184 [error] [Thread-2 (]: 2 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[31mERROR[0m in 0.04s]
[0m13:09:38.208398 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m13:09:38.208862 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m13:09:38.209039 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m13:09:38.209209 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m13:09:38.209369 [info ] [Thread-1 (]: 5 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m13:09:38.209553 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m13:09:38.209737 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_airports
[0m13:09:38.209918 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m13:09:38.210093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_tickets_bookings)
[0m13:09:38.210256 [info ] [Thread-4 (]: 6 of 35 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ........... [RUN]
[0m13:09:38.210423 [info ] [Thread-3 (]: 7 of 35 START sql view model dwh_detailed_dwh_detailed.raw_airports ............ [RUN]
[0m13:09:38.210608 [info ] [Thread-2 (]: 8 of 35 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ..... [RUN]
[0m13:09:38.210758 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m13:09:38.210900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.raw_aircrafts)
[0m13:09:38.211033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.raw_airports)
[0m13:09:38.211160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.raw_boarding_passes)
[0m13:09:38.213394 [info ] [Thread-1 (]: 13:09:38 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m13:09:38.213586 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m13:09:38.213720 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_airports
[0m13:09:38.213840 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m13:09:38.216363 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m13:09:38.217620 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m13:09:38.218875 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m13:09:38.219963 [debug] [Thread-1 (]: Compilation Error in model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
  dbt was unable to infer all dependencies for the model "link_tickets_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_tickets_bookings":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
[0m13:09:38.220237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f189f0>]}
[0m13:09:38.220553 [error] [Thread-1 (]: 5 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[31mERROR[0m in 0.01s]
[0m13:09:38.220742 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m13:09:38.220973 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m13:09:38.233443 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_airports
[0m13:09:38.233619 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m13:09:38.234744 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m13:09:38.234919 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m13:09:38.236130 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m13:09:38.237249 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m13:09:38.237484 [info ] [Thread-1 (]: 9 of 35 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............ [RUN]
[0m13:09:38.237832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_tickets_bookings, now model.dbt_dwh.raw_bookings)
[0m13:09:38.238044 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m13:09:38.238983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m13:09:38.239133 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:09:38.239319 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m13:09:38.239450 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:09:38.239602 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:09:38.239830 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m13:09:38.239971 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:09:38.240093 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:09:38.240219 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m13:09:38.240348 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m13:09:38.241838 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m13:09:38.241993 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:09:38.242277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:09:38.242398 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m13:09:38.242516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:38.250937 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m13:09:38.251195 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m13:09:38.251358 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:09:38.251520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:09:38.251654 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:09:38.251788 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m13:09:38.251961 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m13:09:38.252122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:09:38.252269 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m13:09:38.252440 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:09:38.252634 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m13:09:38.252825 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m13:09:38.253026 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.aircrafts" does not exist
LINE 11:         FROM "postgres"."system"."aircrafts"
                      ^

[0m13:09:38.253183 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.boarding_passes" does not exist
LINE 12:         FROM "postgres"."system"."boarding_passes"
                      ^

[0m13:09:38.253330 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.bookings" does not exist
LINE 11:         FROM "postgres"."system"."bookings"
                      ^

[0m13:09:38.253491 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: ROLLBACK
[0m13:09:38.253627 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: ROLLBACK
[0m13:09:38.253768 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: ROLLBACK
[0m13:09:38.253910 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.airports" does not exist
LINE 14:         FROM "postgres"."system"."airports"
                      ^

[0m13:09:38.254103 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: ROLLBACK
[0m13:09:38.254343 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m13:09:38.254511 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m13:09:38.254669 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m13:09:38.255225 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: Close
[0m13:09:38.259480 [debug] [Thread-2 (]: Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:09:38.259963 [debug] [Thread-3 (]: Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:09:38.260994 [debug] [Thread-1 (]: Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:09:38.261875 [debug] [Thread-4 (]: Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:09:38.262057 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7a510>]}
[0m13:09:38.262197 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7a090>]}
[0m13:09:38.262318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7ae70>]}
[0m13:09:38.262438 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7aed0>]}
[0m13:09:38.262715 [error] [Thread-3 (]: 7 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_airports ... [[31mERROR[0m in 0.05s]
[0m13:09:38.262959 [error] [Thread-2 (]: 8 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_boarding_passes  [[31mERROR[0m in 0.05s]
[0m13:09:38.263173 [error] [Thread-1 (]: 9 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_bookings ... [[31mERROR[0m in 0.02s]
[0m13:09:38.263398 [error] [Thread-4 (]: 6 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_aircrafts .. [[31mERROR[0m in 0.05s]
[0m13:09:38.263639 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_airports
[0m13:09:38.263811 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m13:09:38.263978 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m13:09:38.264144 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m13:09:38.264281 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_flights
[0m13:09:38.264468 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_seats
[0m13:09:38.264703 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m13:09:38.264876 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_tickets
[0m13:09:38.265095 [info ] [Thread-3 (]: 10 of 35 START sql view model dwh_detailed_dwh_detailed.raw_flights ............ [RUN]
[0m13:09:38.265305 [info ] [Thread-2 (]: 11 of 35 START sql view model dwh_detailed_dwh_detailed.raw_seats .............. [RUN]
[0m13:09:38.265493 [info ] [Thread-1 (]: 12 of 35 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ..... [RUN]
[0m13:09:38.265668 [info ] [Thread-4 (]: 13 of 35 START sql view model dwh_detailed_dwh_detailed.raw_tickets ............ [RUN]
[0m13:09:38.265845 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_flights)
[0m13:09:38.265972 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_seats)
[0m13:09:38.266098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_ticket_flights)
[0m13:09:38.266227 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_tickets)
[0m13:09:38.266342 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_flights
[0m13:09:38.266452 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_seats
[0m13:09:38.266567 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m13:09:38.266682 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m13:09:38.267917 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m13:09:38.268854 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m13:09:38.270008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m13:09:38.270893 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m13:09:38.271301 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_flights
[0m13:09:38.271439 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_seats
[0m13:09:38.271557 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_tickets
[0m13:09:38.271670 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m13:09:38.274970 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m13:09:38.276179 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m13:09:38.277294 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m13:09:38.278430 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m13:09:38.278802 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:09:38.278958 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:09:38.279106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:09:38.279235 [debug] [Thread-4 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m13:09:38.279363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:09:38.279488 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m13:09:38.279615 [debug] [Thread-3 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m13:09:38.279754 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:09:38.279899 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m13:09:38.280018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:09:38.280135 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:09:38.280298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:09:38.296413 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m13:09:38.296632 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m13:09:38.296769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m13:09:38.296882 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m13:09:38.296999 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:09:38.297120 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:09:38.297230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:09:38.297338 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:09:38.297463 [debug] [Thread-3 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m13:09:38.297610 [debug] [Thread-4 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m13:09:38.297741 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m13:09:38.297866 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m13:09:38.298383 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.tickets" does not exist
LINE 13:         FROM "postgres"."system"."tickets"
                      ^

[0m13:09:38.298541 [debug] [Thread-4 (]: On model.dbt_dwh.raw_tickets: ROLLBACK
[0m13:09:38.298704 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.ticket_flights" does not exist
LINE 12:         FROM "postgres"."system"."ticket_flights"
                      ^

[0m13:09:38.298834 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.flights" does not exist
LINE 18:         FROM "postgres"."system"."flights"
                      ^

[0m13:09:38.298962 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.seats" does not exist
LINE 11:         FROM "postgres"."system"."seats"
                      ^

[0m13:09:38.299122 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: ROLLBACK
[0m13:09:38.299286 [debug] [Thread-3 (]: On model.dbt_dwh.raw_flights: ROLLBACK
[0m13:09:38.299430 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: ROLLBACK
[0m13:09:38.299584 [debug] [Thread-4 (]: On model.dbt_dwh.raw_tickets: Close
[0m13:09:38.300216 [debug] [Thread-3 (]: On model.dbt_dwh.raw_flights: Close
[0m13:09:38.300377 [debug] [Thread-2 (]: On model.dbt_dwh.raw_seats: Close
[0m13:09:38.301433 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m13:09:38.303111 [debug] [Thread-4 (]: Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:09:38.303306 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df0d70>]}
[0m13:09:38.303582 [error] [Thread-4 (]: 13 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_tickets ... [[31mERROR[0m in 0.04s]
[0m13:09:38.304574 [debug] [Thread-3 (]: Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:09:38.305469 [debug] [Thread-1 (]: Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:09:38.306350 [debug] [Thread-2 (]: Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:09:38.306546 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_tickets
[0m13:09:38.306672 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df0d70>]}
[0m13:09:38.306793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549b710>]}
[0m13:09:38.306909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054992b0>]}
[0m13:09:38.307054 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m13:09:38.307299 [error] [Thread-3 (]: 10 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_flights ... [[31mERROR[0m in 0.04s]
[0m13:09:38.307585 [error] [Thread-2 (]: 11 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_seats ..... [[31mERROR[0m in 0.04s]
[0m13:09:38.307775 [error] [Thread-1 (]: 12 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_ticket_flights  [[31mERROR[0m in 0.04s]
[0m13:09:38.307961 [info ] [Thread-4 (]: 14 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ... [RUN]
[0m13:09:38.308170 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_flights
[0m13:09:38.308345 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_seats
[0m13:09:38.308519 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m13:09:38.308680 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_tickets, now model.dbt_dwh.sat_aircrafts)
[0m13:09:38.308836 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_airports
[0m13:09:38.309036 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m13:09:38.309286 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m13:09:38.309488 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m13:09:38.309674 [info ] [Thread-3 (]: 15 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_airports .... [RUN]
[0m13:09:38.309876 [info ] [Thread-2 (]: 16 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m13:09:38.310064 [info ] [Thread-1 (]: 17 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings .... [RUN]
[0m13:09:38.311955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.sat_airports)
[0m13:09:38.312116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.sat_boarding_passes)
[0m13:09:38.312259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.sat_bookings)
[0m13:09:38.312451 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_airports
[0m13:09:38.313201 [debug] [Thread-4 (]: Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.313339 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m13:09:38.313462 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m13:09:38.315586 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549b710>]}
[0m13:09:38.318065 [debug] [Thread-3 (]: Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.320564 [debug] [Thread-2 (]: Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.320739 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105448e90>]}
[0m13:09:38.321515 [debug] [Thread-1 (]: Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.321676 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449250>]}
[0m13:09:38.321881 [error] [Thread-4 (]: 14 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.01s]
[0m13:09:38.322128 [error] [Thread-3 (]: 15 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.01s]
[0m13:09:38.322286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10549b710>]}
[0m13:09:38.322506 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m13:09:38.322670 [error] [Thread-2 (]: 16 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.01s]
[0m13:09:38.322858 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_airports
[0m13:09:38.323022 [error] [Thread-1 (]: 17 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.01s]
[0m13:09:38.323183 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_flights
[0m13:09:38.323372 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m13:09:38.323501 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_seats
[0m13:09:38.323681 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m13:09:38.323829 [info ] [Thread-4 (]: 18 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ..... [RUN]
[0m13:09:38.323980 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m13:09:38.324148 [info ] [Thread-3 (]: 19 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ....... [RUN]
[0m13:09:38.324298 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m13:09:38.324474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_flights)
[0m13:09:38.324665 [info ] [Thread-2 (]: 20 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m13:09:38.324833 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_seats)
[0m13:09:38.325002 [info ] [Thread-1 (]: 21 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ..... [RUN]
[0m13:09:38.325144 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_flights
[0m13:09:38.325290 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_ticket_flights)
[0m13:09:38.325420 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_seats
[0m13:09:38.325544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_tickets)
[0m13:09:38.327495 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m13:09:38.328254 [debug] [Thread-4 (]: Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.330039 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m13:09:38.331597 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f99d0>]}
[0m13:09:38.333481 [error] [Thread-4 (]: 18 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.01s]
[0m13:09:38.334409 [debug] [Thread-1 (]: Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.334977 [debug] [Thread-2 (]: Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.335179 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_flights
[0m13:09:38.335986 [debug] [Thread-3 (]: Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.336173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f79d30>]}
[0m13:09:38.336311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f79850>]}
[0m13:09:38.336463 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_airports
[0m13:09:38.336634 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f23e354-9988-4734-86f5-b316665a6dd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105498a70>]}
[0m13:09:38.336858 [error] [Thread-1 (]: 21 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.01s]
[0m13:09:38.337071 [error] [Thread-2 (]: 20 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.01s]
[0m13:09:38.337241 [info ] [Thread-4 (]: 22 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_airports .................. [[33mSKIP[0m]
[0m13:09:38.337437 [error] [Thread-3 (]: 19 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.01s]
[0m13:09:38.337633 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m13:09:38.337799 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m13:09:38.337927 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_airports
[0m13:09:38.338076 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_seats
[0m13:09:38.338212 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m13:09:38.338371 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_bookings
[0m13:09:38.338523 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m13:09:38.338729 [debug] [Thread-3 (]: Began running node model.dbt_dwh.stg_tickets
[0m13:09:38.338906 [info ] [Thread-1 (]: 23 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_boarding_passes ........... [[33mSKIP[0m]
[0m13:09:38.339087 [info ] [Thread-2 (]: 24 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_bookings .................. [[33mSKIP[0m]
[0m13:09:38.339246 [info ] [Thread-4 (]: 25 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_aircrafts ................. [[33mSKIP[0m]
[0m13:09:38.339407 [info ] [Thread-3 (]: 26 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_tickets ................... [[33mSKIP[0m]
[0m13:09:38.339583 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m13:09:38.339723 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_bookings
[0m13:09:38.339856 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m13:09:38.339984 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.stg_tickets
[0m13:09:38.340122 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_flights
[0m13:09:38.340289 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_seats
[0m13:09:38.340463 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m13:09:38.340649 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_airports
[0m13:09:38.340799 [info ] [Thread-1 (]: 27 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_flights ................... [[33mSKIP[0m]
[0m13:09:38.340963 [info ] [Thread-2 (]: 28 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_seats ..................... [[33mSKIP[0m]
[0m13:09:38.341114 [info ] [Thread-4 (]: 29 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_ticket_flights ............ [[33mSKIP[0m]
[0m13:09:38.341263 [info ] [Thread-3 (]: 30 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_airports .................. [[33mSKIP[0m]
[0m13:09:38.341418 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_flights
[0m13:09:38.341544 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_seats
[0m13:09:38.341667 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m13:09:38.341795 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_airports
[0m13:09:38.341919 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m13:09:38.342095 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m13:09:38.342250 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m13:09:38.342424 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_seats
[0m13:09:38.342573 [info ] [Thread-1 (]: 31 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_bookings .................. [[33mSKIP[0m]
[0m13:09:38.342753 [info ] [Thread-2 (]: 32 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_aircrafts ................. [[33mSKIP[0m]
[0m13:09:38.342934 [info ] [Thread-4 (]: 33 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_flights ................... [[33mSKIP[0m]
[0m13:09:38.343083 [info ] [Thread-3 (]: 34 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_seats ..................... [[33mSKIP[0m]
[0m13:09:38.343237 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m13:09:38.343360 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m13:09:38.343474 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m13:09:38.343593 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_seats
[0m13:09:38.343713 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m13:09:38.343937 [info ] [Thread-1 (]: 35 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_tickets ................... [[33mSKIP[0m]
[0m13:09:38.344087 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m13:09:38.344673 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:38.344787 [debug] [MainThread]: On master: BEGIN
[0m13:09:38.344964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:09:38.357784 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:09:38.357924 [debug] [MainThread]: On master: COMMIT
[0m13:09:38.358037 [debug] [MainThread]: Using postgres connection "master"
[0m13:09:38.358125 [debug] [MainThread]: On master: COMMIT
[0m13:09:38.358711 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:09:38.358813 [debug] [MainThread]: On master: Close
[0m13:09:38.359006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:09:38.359096 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m13:09:38.359174 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_flights' was properly closed.
[0m13:09:38.359250 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_seats' was properly closed.
[0m13:09:38.359327 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_ticket_flights' was properly closed.
[0m13:09:38.359479 [info ] [MainThread]: 
[0m13:09:38.359599 [info ] [MainThread]: Finished running 19 incremental models, 16 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:09:38.360703 [debug] [MainThread]: Command end result
[0m13:09:38.381195 [info ] [MainThread]: 
[0m13:09:38.381407 [info ] [MainThread]: [31mCompleted with 21 errors and 0 warnings:[0m
[0m13:09:38.381519 [info ] [MainThread]: 
[0m13:09:38.381681 [error] [MainThread]:   Compilation Error in model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
  dbt was unable to infer all dependencies for the model "link_aircrafts_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_aircrafts_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
[0m13:09:38.381801 [info ] [MainThread]: 
[0m13:09:38.381940 [error] [MainThread]:   Compilation Error in model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "link_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_ticket_flights":
  
  -- depends_on: {{ ref('stg_ticket_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
[0m13:09:38.382050 [info ] [MainThread]: 
[0m13:09:38.382186 [error] [MainThread]:   Compilation Error in model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
  dbt was unable to infer all dependencies for the model "link_flights_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_flights_airports":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
[0m13:09:38.382293 [info ] [MainThread]: 
[0m13:09:38.382423 [error] [MainThread]:   Compilation Error in model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "link_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_boarding_passes":
  
  -- depends_on: {{ ref('stg_boarding_passes') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
[0m13:09:38.382532 [info ] [MainThread]: 
[0m13:09:38.382659 [error] [MainThread]:   Compilation Error in model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
  dbt was unable to infer all dependencies for the model "link_tickets_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_tickets_bookings":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
[0m13:09:38.382767 [info ] [MainThread]: 
[0m13:09:38.382882 [error] [MainThread]:   Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:09:38.382975 [info ] [MainThread]: 
[0m13:09:38.383093 [error] [MainThread]:   Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:09:38.383187 [info ] [MainThread]: 
[0m13:09:38.383304 [error] [MainThread]:   Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:09:38.383396 [info ] [MainThread]: 
[0m13:09:38.383512 [error] [MainThread]:   Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:09:38.383606 [info ] [MainThread]: 
[0m13:09:38.383719 [error] [MainThread]:   Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:09:38.383815 [info ] [MainThread]: 
[0m13:09:38.383929 [error] [MainThread]:   Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:09:38.384024 [info ] [MainThread]: 
[0m13:09:38.384140 [error] [MainThread]:   Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:09:38.384231 [info ] [MainThread]: 
[0m13:09:38.384347 [error] [MainThread]:   Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:09:38.384439 [info ] [MainThread]: 
[0m13:09:38.384553 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.384647 [info ] [MainThread]: 
[0m13:09:38.384759 [error] [MainThread]:   Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.384852 [info ] [MainThread]: 
[0m13:09:38.384967 [error] [MainThread]:   Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.385060 [info ] [MainThread]: 
[0m13:09:38.385175 [error] [MainThread]:   Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.385273 [info ] [MainThread]: 
[0m13:09:38.385396 [error] [MainThread]:   Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.385489 [info ] [MainThread]: 
[0m13:09:38.385612 [error] [MainThread]:   Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.385705 [info ] [MainThread]: 
[0m13:09:38.385829 [error] [MainThread]:   Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.385931 [info ] [MainThread]: 
[0m13:09:38.386069 [error] [MainThread]:   Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:09:38.386179 [info ] [MainThread]: 
[0m13:09:38.386314 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=21 SKIP=14 TOTAL=35
[0m13:09:38.387066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7122759, "process_in_blocks": "0", "process_kernel_time": 0.132043, "process_mem_max_rss": "136511488", "process_out_blocks": "0", "process_user_time": 1.026189}
[0m13:09:38.387284 [debug] [MainThread]: Command `dbt run` failed at 13:09:38.387243 after 0.71 seconds
[0m13:09:38.387492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103af78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730f890>]}
[0m13:09:38.387653 [debug] [MainThread]: Flushing usage events
[0m13:09:53.426756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b112b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bfd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bfed0>]}


============================== 13:09:53.428472 | ee50e9fd-fc87-4cd7-99c8-c68448d61d3c ==============================
[0m13:09:53.428472 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:09:53.428763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:09:53.465489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee50e9fd-fc87-4cd7-99c8-c68448d61d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105253a80>]}
[0m13:09:53.493811 [debug] [MainThread]: Set downloads directory='/var/folders/jc/7p1wm2qs3lx5blkvy2tsr9l80000gn/T/dbt-downloads-zy0cw_i6'
[0m13:09:53.494024 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:09:53.690806 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:09:53.692050 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:09:53.817993 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:09:53.824990 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m13:09:53.825933 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m13:09:54.569225 [debug] [MainThread]: STDOUT: "b''"
[0m13:09:54.569924 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m13:09:54.570305 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m13:09:54.570524 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:09:54.582015 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:09:54.582500 [debug] [MainThread]: STDERR: "b''"
[0m13:09:54.582687 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m13:09:54.582854 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:09:55.217169 [debug] [MainThread]: STDOUT: "b''"
[0m13:09:55.217992 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m13:09:55.218315 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:09:55.238330 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m13:09:55.238764 [debug] [MainThread]: STDERR: "b''"
[0m13:09:55.238950 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:09:55.247087 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:09:55.247478 [debug] [MainThread]: STDERR: "b''"
[0m13:09:55.247645 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m13:09:55.247796 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:09:55.255287 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:09:55.255652 [debug] [MainThread]: STDERR: "b''"
[0m13:09:55.257280 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m13:09:55.264976 [debug] [MainThread]: STDOUT: "b''"
[0m13:09:55.265304 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m13:09:55.265417 [debug] [MainThread]: command return code=128
[0m13:09:55.265800 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m13:09:55.265933 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:09:55.272954 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:09:55.273266 [debug] [MainThread]: STDERR: "b''"
[0m13:09:55.273398 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m13:09:55.273527 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:09:55.911640 [debug] [MainThread]: STDOUT: "b''"
[0m13:09:55.912768 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m13:09:55.913087 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:09:55.929209 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m13:09:55.929659 [debug] [MainThread]: STDERR: "b''"
[0m13:09:55.929843 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:09:55.937779 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:09:55.938149 [debug] [MainThread]: STDERR: "b''"
[0m13:09:55.938329 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m13:09:55.938630 [info ] [MainThread]: Installed from revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06
[0m13:09:55.938980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee50e9fd-fc87-4cd7-99c8-c68448d61d3c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106613790>]}
[0m13:09:55.939242 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:09:56.390342 [info ] [MainThread]: Installed from version 1.3.0
[0m13:09:56.390638 [info ] [MainThread]: Up to date!
[0m13:09:56.390841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ee50e9fd-fc87-4cd7-99c8-c68448d61d3c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e1f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066348c0>]}
[0m13:09:56.392213 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.9885063, "process_in_blocks": "0", "process_kernel_time": 0.156974, "process_mem_max_rss": "104251392", "process_out_blocks": "0", "process_user_time": 0.544645}
[0m13:09:56.392590 [debug] [MainThread]: Command `dbt deps` succeeded at 13:09:56.392523 after 2.99 seconds
[0m13:09:56.392833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624be70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065fba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652f450>]}
[0m13:09:56.392991 [debug] [MainThread]: Flushing usage events
[0m13:09:59.419151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10288d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423bed0>]}


============================== 13:09:59.420943 | 9bd9d5cf-24b7-4199-aa23-bf524fb29c9d ==============================
[0m13:09:59.420943 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:09:59.421215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:09:59.459247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd9d5cf-24b7-4199-aa23-bf524fb29c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fcfa80>]}
[0m13:09:59.484307 [debug] [MainThread]: Set downloads directory='/var/folders/jc/7p1wm2qs3lx5blkvy2tsr9l80000gn/T/dbt-downloads-oshczun9'
[0m13:09:59.484528 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:09:59.568814 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:09:59.569259 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:09:59.753976 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:09:59.759830 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m13:09:59.760760 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m13:10:00.590497 [debug] [MainThread]: STDOUT: "b''"
[0m13:10:00.591071 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m13:10:00.591441 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m13:10:00.591632 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:10:00.601893 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:10:00.602316 [debug] [MainThread]: STDERR: "b''"
[0m13:10:00.602480 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m13:10:00.602633 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:10:01.227943 [debug] [MainThread]: STDOUT: "b''"
[0m13:10:01.228813 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m13:10:01.229114 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:10:01.250403 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m13:10:01.250913 [debug] [MainThread]: STDERR: "b''"
[0m13:10:01.251104 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:10:01.259470 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:10:01.259911 [debug] [MainThread]: STDERR: "b''"
[0m13:10:01.260077 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m13:10:01.260228 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:10:01.267755 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:10:01.268158 [debug] [MainThread]: STDERR: "b''"
[0m13:10:01.269686 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m13:10:01.277323 [debug] [MainThread]: STDOUT: "b''"
[0m13:10:01.277688 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m13:10:01.277802 [debug] [MainThread]: command return code=128
[0m13:10:01.278184 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m13:10:01.278320 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:10:01.285421 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:10:01.285812 [debug] [MainThread]: STDERR: "b''"
[0m13:10:01.285955 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m13:10:01.286116 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:10:01.905172 [debug] [MainThread]: STDOUT: "b''"
[0m13:10:01.906204 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m13:10:01.906491 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m13:10:01.922739 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m13:10:01.923178 [debug] [MainThread]: STDERR: "b''"
[0m13:10:01.923341 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m13:10:01.931762 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m13:10:01.932115 [debug] [MainThread]: STDERR: "b''"
[0m13:10:01.932267 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m13:10:01.932570 [info ] [MainThread]: Installed from revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06
[0m13:10:01.932825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bd9d5cf-24b7-4199-aa23-bf524fb29c9d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10438f790>]}
[0m13:10:01.933059 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:10:02.323283 [info ] [MainThread]: Installed from version 1.3.0
[0m13:10:02.323538 [info ] [MainThread]: Up to date!
[0m13:10:02.323725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9bd9d5cf-24b7-4199-aa23-bf524fb29c9d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b08c0>]}
[0m13:10:02.324890 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.929091, "process_in_blocks": "0", "process_kernel_time": 0.149151, "process_mem_max_rss": "103202816", "process_out_blocks": "0", "process_user_time": 0.534341}
[0m13:10:02.325205 [debug] [MainThread]: Command `dbt deps` succeeded at 13:10:02.325150 after 2.93 seconds
[0m13:10:02.325415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc3e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104377a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ab450>]}
[0m13:10:02.325612 [debug] [MainThread]: Flushing usage events
[0m13:10:05.340953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcbed0>]}


============================== 13:10:05.342649 | 89b6008c-85d3-46e2-aed9-26e94410e95a ==============================
[0m13:10:05.342649 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:10:05.342915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:10:05.400190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1de00>]}
[0m13:10:05.418342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e65d00>]}
[0m13:10:05.418689 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:10:05.453712 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:10:05.502913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:05.503097 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:05.516210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a71250>]}
[0m13:10:05.563254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc4230>]}
[0m13:10:05.563488 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m13:10:05.563636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd73f0>]}
[0m13:10:05.564900 [info ] [MainThread]: 
[0m13:10:05.565154 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:05.567449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:10:05.588359 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:10:05.588555 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:10:05.588663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:05.604972 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.016 seconds
[0m13:10:05.605509 [debug] [ThreadPool]: On list_postgres: Close
[0m13:10:05.606785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m13:10:05.609096 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:10:05.609207 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m13:10:05.609296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:05.621701 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:10:05.621887 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:10:05.622011 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m13:10:05.623436 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m13:10:05.623915 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m13:10:05.624379 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m13:10:05.628266 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:05.628427 [debug] [MainThread]: On master: BEGIN
[0m13:10:05.628528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:05.638161 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:10:05.638381 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:05.638549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:05.640199 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m13:10:05.640672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a70a10>]}
[0m13:10:05.640841 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:05.641235 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:05.641330 [debug] [MainThread]: On master: BEGIN
[0m13:10:05.642015 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:10:05.642129 [debug] [MainThread]: On master: COMMIT
[0m13:10:05.642215 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:05.642299 [debug] [MainThread]: On master: COMMIT
[0m13:10:05.642639 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:10:05.642752 [debug] [MainThread]: On master: Close
[0m13:10:05.642928 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:05.643073 [info ] [MainThread]: 
[0m13:10:05.644317 [debug] [Thread-4 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m13:10:05.644503 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m13:10:05.644646 [debug] [Thread-2 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m13:10:05.644758 [debug] [Thread-3 (]: Began running node model.dbt_dwh.link_flights_airports
[0m13:10:05.644950 [info ] [Thread-4 (]: 4 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m13:10:05.645202 [info ] [Thread-1 (]: 1 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m13:10:05.645427 [info ] [Thread-2 (]: 2 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m13:10:05.645657 [info ] [Thread-3 (]: 3 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m13:10:05.645926 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.link_ticket_flights'
[0m13:10:05.646074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.link_aircrafts_seats)
[0m13:10:05.646238 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.link_boarding_passes'
[0m13:10:05.646392 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.link_flights_airports'
[0m13:10:05.646533 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m13:10:05.646664 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m13:10:05.646783 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m13:10:05.646903 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m13:10:05.658859 [info ] [Thread-4 (]: 13:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m13:10:05.660851 [info ] [Thread-1 (]: 13:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m13:10:05.662463 [info ] [Thread-2 (]: 13:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m13:10:05.664038 [info ] [Thread-3 (]: 13:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m13:10:05.683453 [debug] [Thread-1 (]: Compilation Error in model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
  dbt was unable to infer all dependencies for the model "link_aircrafts_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_aircrafts_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
[0m13:10:05.684175 [debug] [Thread-4 (]: Compilation Error in model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "link_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_ticket_flights":
  
  -- depends_on: {{ ref('stg_ticket_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
[0m13:10:05.685478 [debug] [Thread-3 (]: Compilation Error in model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
  dbt was unable to infer all dependencies for the model "link_flights_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_flights_airports":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
[0m13:10:05.685822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de31d0>]}
[0m13:10:05.685974 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa15a0>]}
[0m13:10:05.686942 [debug] [Thread-2 (]: Compilation Error in model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "link_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_boarding_passes":
  
  -- depends_on: {{ ref('stg_boarding_passes') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
[0m13:10:05.687089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa1650>]}
[0m13:10:05.687336 [error] [Thread-1 (]: 1 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.04s]
[0m13:10:05.687779 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3bec0>]}
[0m13:10:05.687571 [error] [Thread-4 (]: 4 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[31mERROR[0m in 0.04s]
[0m13:10:05.688067 [error] [Thread-3 (]: 3 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[31mERROR[0m in 0.04s]
[0m13:10:05.688335 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m13:10:05.688541 [error] [Thread-2 (]: 2 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[31mERROR[0m in 0.04s]
[0m13:10:05.688742 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m13:10:05.688908 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m13:10:05.689056 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m13:10:05.689491 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m13:10:05.689640 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m13:10:05.689811 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_airports
[0m13:10:05.689995 [info ] [Thread-1 (]: 5 of 35 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m13:10:05.690174 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m13:10:05.690337 [info ] [Thread-4 (]: 6 of 35 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ........... [RUN]
[0m13:10:05.690534 [info ] [Thread-3 (]: 7 of 35 START sql view model dwh_detailed_dwh_detailed.raw_airports ............ [RUN]
[0m13:10:05.690698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_tickets_bookings)
[0m13:10:05.690848 [info ] [Thread-2 (]: 8 of 35 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ..... [RUN]
[0m13:10:05.690990 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.raw_aircrafts)
[0m13:10:05.691109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.raw_airports)
[0m13:10:05.691250 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m13:10:05.691392 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.raw_boarding_passes)
[0m13:10:05.691519 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m13:10:05.691634 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_airports
[0m13:10:05.693558 [info ] [Thread-1 (]: 13:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m13:10:05.693744 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m13:10:05.694656 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m13:10:05.695635 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m13:10:05.697526 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m13:10:05.698629 [debug] [Thread-1 (]: Compilation Error in model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
  dbt was unable to infer all dependencies for the model "link_tickets_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_tickets_bookings":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
[0m13:10:05.698792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b38de0>]}
[0m13:10:05.699031 [error] [Thread-1 (]: 5 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[31mERROR[0m in 0.01s]
[0m13:10:05.699258 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m13:10:05.699403 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_airports
[0m13:10:05.699569 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m13:10:05.705854 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m13:10:05.706004 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m13:10:05.713780 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m13:10:05.712509 [info ] [Thread-1 (]: 9 of 35 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............ [RUN]
[0m13:10:05.715180 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m13:10:05.716332 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m13:10:05.716538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_tickets_bookings, now model.dbt_dwh.raw_bookings)
[0m13:10:05.716788 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m13:10:05.717923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m13:10:05.718186 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:10:05.718329 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:10:05.718465 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m13:10:05.718618 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:10:05.718748 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m13:10:05.718879 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m13:10:05.719006 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:10:05.719128 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m13:10:05.719242 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:10:05.720447 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m13:10:05.720677 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:10:05.721058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:10:05.721195 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m13:10:05.721320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:05.732644 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m13:10:05.732881 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m13:10:05.733017 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m13:10:05.733141 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:10:05.733259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:10:05.733377 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:10:05.733497 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:10:05.733647 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m13:10:05.733775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:10:05.733898 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m13:10:05.734029 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m13:10:05.734194 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m13:10:05.734622 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.boarding_passes" does not exist
LINE 12:         FROM "postgres"."system"."boarding_passes"
                      ^

[0m13:10:05.734787 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: ROLLBACK
[0m13:10:05.736055 [debug] [Thread-2 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m13:10:05.736234 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.aircrafts" does not exist
LINE 11:         FROM "postgres"."system"."aircrafts"
                      ^

[0m13:10:05.736558 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.airports" does not exist
LINE 14:         FROM "postgres"."system"."airports"
                      ^

[0m13:10:05.736702 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.bookings" does not exist
LINE 11:         FROM "postgres"."system"."bookings"
                      ^

[0m13:10:05.737243 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: ROLLBACK
[0m13:10:05.737377 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: ROLLBACK
[0m13:10:05.737618 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: ROLLBACK
[0m13:10:05.738173 [debug] [Thread-4 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m13:10:05.738354 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m13:10:05.738509 [debug] [Thread-3 (]: On model.dbt_dwh.raw_airports: Close
[0m13:10:05.739758 [debug] [Thread-2 (]: Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:10:05.741614 [debug] [Thread-4 (]: Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:10:05.742524 [debug] [Thread-1 (]: Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:10:05.742727 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4e8d0>]}
[0m13:10:05.743251 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4e7b0>]}
[0m13:10:05.743427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4e990>]}
[0m13:10:05.744511 [debug] [Thread-3 (]: Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:10:05.744761 [error] [Thread-2 (]: 8 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_boarding_passes  [[31mERROR[0m in 0.05s]
[0m13:10:05.745021 [error] [Thread-4 (]: 6 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_aircrafts .. [[31mERROR[0m in 0.05s]
[0m13:10:05.745247 [error] [Thread-1 (]: 9 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_bookings ... [[31mERROR[0m in 0.03s]
[0m13:10:05.745423 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d4fc50>]}
[0m13:10:05.745640 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m13:10:05.745814 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m13:10:05.745989 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m13:10:05.746159 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_flights
[0m13:10:05.746345 [error] [Thread-3 (]: 7 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_airports ... [[31mERROR[0m in 0.05s]
[0m13:10:05.746605 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_seats
[0m13:10:05.746794 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m13:10:05.746978 [info ] [Thread-2 (]: 10 of 35 START sql view model dwh_detailed_dwh_detailed.raw_flights ............ [RUN]
[0m13:10:05.747243 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_airports
[0m13:10:05.747395 [info ] [Thread-4 (]: 11 of 35 START sql view model dwh_detailed_dwh_detailed.raw_seats .............. [RUN]
[0m13:10:05.747568 [info ] [Thread-1 (]: 12 of 35 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ..... [RUN]
[0m13:10:05.747725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_flights)
[0m13:10:05.747866 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_tickets
[0m13:10:05.748032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_seats)
[0m13:10:05.748155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_ticket_flights)
[0m13:10:05.748269 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_flights
[0m13:10:05.748412 [info ] [Thread-3 (]: 13 of 35 START sql view model dwh_detailed_dwh_detailed.raw_tickets ............ [RUN]
[0m13:10:05.748556 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_seats
[0m13:10:05.748670 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m13:10:05.749750 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m13:10:05.749889 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_tickets)
[0m13:10:05.752805 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m13:10:05.753675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m13:10:05.753858 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m13:10:05.755012 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m13:10:05.755310 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_seats
[0m13:10:05.755442 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m13:10:05.755571 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_tickets
[0m13:10:05.778902 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_flights
[0m13:10:05.780137 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m13:10:05.781288 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m13:10:05.782410 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m13:10:05.783400 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m13:10:05.783844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:10:05.784000 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:10:05.784130 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:10:05.784250 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m13:10:05.784367 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:10:05.784495 [debug] [Thread-4 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m13:10:05.784607 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m13:10:05.784719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:05.784836 [debug] [Thread-3 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m13:10:05.784959 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:10:05.785086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:10:05.785257 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:10:05.801288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m13:10:05.801524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:10:05.801650 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m13:10:05.801770 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:10:05.801887 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m13:10:05.802011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:10:05.802131 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:10:05.802263 [debug] [Thread-4 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m13:10:05.802393 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:10:05.802534 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m13:10:05.802685 [debug] [Thread-3 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m13:10:05.802888 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m13:10:05.803447 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.seats" does not exist
LINE 11:         FROM "postgres"."system"."seats"
                      ^

[0m13:10:05.803629 [debug] [Thread-4 (]: On model.dbt_dwh.raw_seats: ROLLBACK
[0m13:10:05.803782 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.ticket_flights" does not exist
LINE 12:         FROM "postgres"."system"."ticket_flights"
                      ^

[0m13:10:05.803958 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.tickets" does not exist
LINE 13:         FROM "postgres"."system"."tickets"
                      ^

[0m13:10:05.804108 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.flights" does not exist
LINE 18:         FROM "postgres"."system"."flights"
                      ^

[0m13:10:05.804256 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: ROLLBACK
[0m13:10:05.804397 [debug] [Thread-3 (]: On model.dbt_dwh.raw_tickets: ROLLBACK
[0m13:10:05.804535 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: ROLLBACK
[0m13:10:05.804713 [debug] [Thread-4 (]: On model.dbt_dwh.raw_seats: Close
[0m13:10:05.805386 [debug] [Thread-3 (]: On model.dbt_dwh.raw_tickets: Close
[0m13:10:05.805617 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m13:10:05.806648 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: Close
[0m13:10:05.808576 [debug] [Thread-3 (]: Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:10:05.809594 [debug] [Thread-4 (]: Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:10:05.809793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a9970>]}
[0m13:10:05.810797 [debug] [Thread-1 (]: Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:10:05.811725 [debug] [Thread-2 (]: Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:10:05.811886 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac4e30>]}
[0m13:10:05.812319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac6b10>]}
[0m13:10:05.812172 [error] [Thread-3 (]: 13 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_tickets ... [[31mERROR[0m in 0.06s]
[0m13:10:05.812547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac7a70>]}
[0m13:10:05.812784 [error] [Thread-4 (]: 11 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_seats ..... [[31mERROR[0m in 0.06s]
[0m13:10:05.813004 [error] [Thread-1 (]: 12 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_ticket_flights  [[31mERROR[0m in 0.06s]
[0m13:10:05.813243 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_tickets
[0m13:10:05.813441 [error] [Thread-2 (]: 10 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_flights ... [[31mERROR[0m in 0.06s]
[0m13:10:05.813688 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_seats
[0m13:10:05.813883 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m13:10:05.814048 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m13:10:05.814287 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_flights
[0m13:10:05.814481 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_airports
[0m13:10:05.814674 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m13:10:05.814925 [info ] [Thread-3 (]: 14 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ... [RUN]
[0m13:10:05.815100 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_bookings
[0m13:10:05.815314 [info ] [Thread-4 (]: 15 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_airports .... [RUN]
[0m13:10:05.815535 [info ] [Thread-1 (]: 16 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m13:10:05.815728 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_tickets, now model.dbt_dwh.sat_aircrafts)
[0m13:10:05.815891 [info ] [Thread-2 (]: 17 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings .... [RUN]
[0m13:10:05.816066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.sat_airports)
[0m13:10:05.816202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.sat_boarding_passes)
[0m13:10:05.816334 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m13:10:05.816506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.sat_bookings)
[0m13:10:05.816646 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_airports
[0m13:10:05.816769 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m13:10:05.819034 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m13:10:05.823350 [debug] [Thread-3 (]: Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.823950 [debug] [Thread-4 (]: Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.824717 [debug] [Thread-1 (]: Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.826818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba70b0>]}
[0m13:10:05.827042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d19d30>]}
[0m13:10:05.827849 [debug] [Thread-2 (]: Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.827998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba7050>]}
[0m13:10:05.828244 [error] [Thread-3 (]: 14 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.01s]
[0m13:10:05.828453 [error] [Thread-4 (]: 15 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.01s]
[0m13:10:05.828596 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba70b0>]}
[0m13:10:05.828775 [error] [Thread-1 (]: 16 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.01s]
[0m13:10:05.828973 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m13:10:05.829126 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_airports
[0m13:10:05.829295 [error] [Thread-2 (]: 17 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.01s]
[0m13:10:05.829492 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m13:10:05.829647 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_flights
[0m13:10:05.829838 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_seats
[0m13:10:05.830036 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_bookings
[0m13:10:05.830178 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m13:10:05.830358 [info ] [Thread-3 (]: 18 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ..... [RUN]
[0m13:10:05.830552 [info ] [Thread-4 (]: 19 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ....... [RUN]
[0m13:10:05.830727 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_tickets
[0m13:10:05.830896 [info ] [Thread-1 (]: 20 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m13:10:05.831073 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_flights)
[0m13:10:05.831206 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_seats)
[0m13:10:05.831365 [info ] [Thread-2 (]: 21 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ..... [RUN]
[0m13:10:05.831539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_ticket_flights)
[0m13:10:05.831671 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_flights
[0m13:10:05.831810 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_seats
[0m13:10:05.831938 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_tickets)
[0m13:10:05.832071 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m13:10:05.835960 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m13:10:05.838640 [debug] [Thread-3 (]: Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.841307 [debug] [Thread-4 (]: Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.842218 [debug] [Thread-1 (]: Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.842932 [debug] [Thread-2 (]: Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.843112 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074707d0>]}
[0m13:10:05.843265 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d1a030>]}
[0m13:10:05.843391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d1bcb0>]}
[0m13:10:05.843514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89b6008c-85d3-46e2-aed9-26e94410e95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d02210>]}
[0m13:10:05.843791 [error] [Thread-4 (]: 19 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.01s]
[0m13:10:05.844049 [error] [Thread-3 (]: 18 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.01s]
[0m13:10:05.844262 [error] [Thread-1 (]: 20 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.01s]
[0m13:10:05.844483 [error] [Thread-2 (]: 21 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.01s]
[0m13:10:05.844692 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_seats
[0m13:10:05.844873 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_flights
[0m13:10:05.845046 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m13:10:05.845211 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_tickets
[0m13:10:05.845356 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m13:10:05.845549 [debug] [Thread-3 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m13:10:05.845714 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m13:10:05.845888 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_airports
[0m13:10:05.846040 [info ] [Thread-4 (]: 22 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_boarding_passes ........... [[33mSKIP[0m]
[0m13:10:05.846227 [info ] [Thread-3 (]: 23 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_aircrafts ................. [[33mSKIP[0m]
[0m13:10:05.846379 [info ] [Thread-1 (]: 24 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_bookings .................. [[33mSKIP[0m]
[0m13:10:05.846529 [info ] [Thread-2 (]: 25 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_airports .................. [[33mSKIP[0m]
[0m13:10:05.846716 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m13:10:05.846884 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m13:10:05.847045 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m13:10:05.847183 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_airports
[0m13:10:05.847342 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_tickets
[0m13:10:05.847516 [debug] [Thread-3 (]: Began running node model.dbt_dwh.stg_seats
[0m13:10:05.847691 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m13:10:05.847904 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_flights
[0m13:10:05.848079 [info ] [Thread-4 (]: 26 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_tickets ................... [[33mSKIP[0m]
[0m13:10:05.848239 [info ] [Thread-3 (]: 27 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_seats ..................... [[33mSKIP[0m]
[0m13:10:05.848406 [info ] [Thread-1 (]: 28 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_ticket_flights ............ [[33mSKIP[0m]
[0m13:10:05.848576 [info ] [Thread-2 (]: 29 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_flights ................... [[33mSKIP[0m]
[0m13:10:05.848743 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_tickets
[0m13:10:05.848883 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.stg_seats
[0m13:10:05.849012 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m13:10:05.849133 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_flights
[0m13:10:05.849268 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_bookings
[0m13:10:05.849422 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m13:10:05.849589 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m13:10:05.849757 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_seats
[0m13:10:05.849956 [info ] [Thread-4 (]: 30 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_bookings .................. [[33mSKIP[0m]
[0m13:10:05.850132 [info ] [Thread-3 (]: 31 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_aircrafts ................. [[33mSKIP[0m]
[0m13:10:05.850314 [info ] [Thread-1 (]: 32 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_airports .................. [[33mSKIP[0m]
[0m13:10:05.850481 [info ] [Thread-2 (]: 33 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_seats ..................... [[33mSKIP[0m]
[0m13:10:05.850630 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_bookings
[0m13:10:05.850752 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m13:10:05.850871 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m13:10:05.850991 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_seats
[0m13:10:05.851130 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_tickets
[0m13:10:05.851272 [debug] [Thread-3 (]: Began running node model.dbt_dwh.hub_flights
[0m13:10:05.851482 [info ] [Thread-4 (]: 34 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_tickets ................... [[33mSKIP[0m]
[0m13:10:05.851645 [info ] [Thread-3 (]: 35 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_flights ................... [[33mSKIP[0m]
[0m13:10:05.851788 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_tickets
[0m13:10:05.851908 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.hub_flights
[0m13:10:05.852485 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:05.852595 [debug] [MainThread]: On master: BEGIN
[0m13:10:05.852685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:05.865165 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:10:05.865336 [debug] [MainThread]: On master: COMMIT
[0m13:10:05.865441 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:05.865540 [debug] [MainThread]: On master: COMMIT
[0m13:10:05.866380 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:10:05.866494 [debug] [MainThread]: On master: Close
[0m13:10:05.866647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:05.866742 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_ticket_flights' was properly closed.
[0m13:10:05.866821 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_seats' was properly closed.
[0m13:10:05.866899 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m13:10:05.866976 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_flights' was properly closed.
[0m13:10:05.867129 [info ] [MainThread]: 
[0m13:10:05.867255 [info ] [MainThread]: Finished running 19 incremental models, 16 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m13:10:05.868349 [debug] [MainThread]: Command end result
[0m13:10:05.895358 [info ] [MainThread]: 
[0m13:10:05.895560 [info ] [MainThread]: [31mCompleted with 21 errors and 0 warnings:[0m
[0m13:10:05.895669 [info ] [MainThread]: 
[0m13:10:05.895823 [error] [MainThread]:   Compilation Error in model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
  dbt was unable to infer all dependencies for the model "link_aircrafts_seats".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_aircrafts_seats":
  
  -- depends_on: {{ ref('stg_seats') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_aircrafts_seats (models/raw_vault/links/link_aircrafts_seats.sql)
[0m13:10:05.895943 [info ] [MainThread]: 
[0m13:10:05.896085 [error] [MainThread]:   Compilation Error in model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
  dbt was unable to infer all dependencies for the model "link_ticket_flights".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_ticket_flights":
  
  -- depends_on: {{ ref('stg_ticket_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_ticket_flights (models/raw_vault/links/link_ticket_flights.sql)
[0m13:10:05.896200 [info ] [MainThread]: 
[0m13:10:05.896330 [error] [MainThread]:   Compilation Error in model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
  dbt was unable to infer all dependencies for the model "link_flights_airports".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_flights_airports":
  
  -- depends_on: {{ ref('stg_flights') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_flights_airports (models/raw_vault/links/link_flights_airports.sql)
[0m13:10:05.896442 [info ] [MainThread]: 
[0m13:10:05.896574 [error] [MainThread]:   Compilation Error in model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
  dbt was unable to infer all dependencies for the model "link_boarding_passes".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_boarding_passes":
  
  -- depends_on: {{ ref('stg_boarding_passes') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_boarding_passes (models/raw_vault/links/link_boarding_passes.sql)
[0m13:10:05.896685 [info ] [MainThread]: 
[0m13:10:05.896814 [error] [MainThread]:   Compilation Error in model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
  dbt was unable to infer all dependencies for the model "link_tickets_bookings".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "link_tickets_bookings":
  
  -- depends_on: {{ ref('stg_tickets') }}
  
  > in macro postgres__link (macros/tables/postgres/link.sql)
  > called by macro link (macros/tables/snowflake/link.sql)
  > called by model link_tickets_bookings (models/raw_vault/links/link_tickets_bookings.sql)
[0m13:10:05.896920 [info ] [MainThread]: 
[0m13:10:05.897039 [error] [MainThread]:   Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:10:05.897135 [info ] [MainThread]: 
[0m13:10:05.897257 [error] [MainThread]:   Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:10:05.897352 [info ] [MainThread]: 
[0m13:10:05.897470 [error] [MainThread]:   Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:10:05.897564 [info ] [MainThread]: 
[0m13:10:05.897683 [error] [MainThread]:   Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:10:05.897776 [info ] [MainThread]: 
[0m13:10:05.897892 [error] [MainThread]:   Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:10:05.897987 [info ] [MainThread]: 
[0m13:10:05.898101 [error] [MainThread]:   Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:10:05.898197 [info ] [MainThread]: 
[0m13:10:05.898314 [error] [MainThread]:   Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:10:05.898411 [info ] [MainThread]: 
[0m13:10:05.898528 [error] [MainThread]:   Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:10:05.898621 [info ] [MainThread]: 
[0m13:10:05.898738 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.898831 [info ] [MainThread]: 
[0m13:10:05.898956 [error] [MainThread]:   Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.899050 [info ] [MainThread]: 
[0m13:10:05.899166 [error] [MainThread]:   Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.899261 [info ] [MainThread]: 
[0m13:10:05.899375 [error] [MainThread]:   Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.899467 [info ] [MainThread]: 
[0m13:10:05.899584 [error] [MainThread]:   Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.899674 [info ] [MainThread]: 
[0m13:10:05.899790 [error] [MainThread]:   Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.899886 [info ] [MainThread]: 
[0m13:10:05.900003 [error] [MainThread]:   Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.900099 [info ] [MainThread]: 
[0m13:10:05.900215 [error] [MainThread]:   Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:10:05.900313 [info ] [MainThread]: 
[0m13:10:05.900428 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=21 SKIP=14 TOTAL=35
[0m13:10:05.901215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.58491665, "process_in_blocks": "0", "process_kernel_time": 0.131924, "process_mem_max_rss": "129728512", "process_out_blocks": "0", "process_user_time": 0.907323}
[0m13:10:05.901435 [debug] [MainThread]: Command `dbt run` failed at 13:10:05.901397 after 0.59 seconds
[0m13:10:05.901598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068662d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e6fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e6f830>]}
[0m13:10:05.901719 [debug] [MainThread]: Flushing usage events
[0m13:11:44.549449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccbed0>]}


============================== 13:11:44.551577 | e4f5b3e4-e0df-4780-a688-81d626e637f0 ==============================
[0m13:11:44.551577 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:11:44.551840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/imaikin-egor/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/imaikin-egor/Desktop/учеба/dwh/DWH_hw02-main 2/dbt_dwh/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:44.617575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b21e00>]}
[0m13:11:44.634744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d65d00>]}
[0m13:11:44.635754 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:11:44.675349 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:11:44.736115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:11:44.736398 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/links/link_flights_airports.sql
[0m13:11:44.736543 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/links/link_aircrafts_seats.sql
[0m13:11:44.736676 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/links/link_tickets_bookings.sql
[0m13:11:44.736797 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/links/link_boarding_passes.sql
[0m13:11:44.736921 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models/raw_vault/links/link_ticket_flights.sql
[0m13:11:44.852520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986eb50>]}
[0m13:11:44.898493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4fd40>]}
[0m13:11:44.898722 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m13:11:44.898867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfacf0>]}
[0m13:11:44.900039 [info ] [MainThread]: 
[0m13:11:44.900279 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:44.902368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m13:11:44.945688 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m13:11:44.945920 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m13:11:44.946050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:45.051482 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.105 seconds
[0m13:11:45.052326 [debug] [ThreadPool]: On list_postgres: Close
[0m13:11:45.053978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now list_postgres_dwh_detailed_dwh_detailed)
[0m13:11:45.057141 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:11:45.057326 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m13:11:45.057464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:45.069715 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:11:45.069988 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m13:11:45.070175 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m13:11:45.072305 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:11:45.073044 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m13:11:45.073730 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m13:11:45.077619 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:45.077819 [debug] [MainThread]: On master: BEGIN
[0m13:11:45.077945 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:45.087655 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:11:45.087881 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:45.088103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:45.089974 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:11:45.090581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bbe820>]}
[0m13:11:45.090817 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:45.091327 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:45.091496 [debug] [MainThread]: On master: BEGIN
[0m13:11:45.092414 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:11:45.092568 [debug] [MainThread]: On master: COMMIT
[0m13:11:45.092701 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:45.092829 [debug] [MainThread]: On master: COMMIT
[0m13:11:45.093287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:45.093479 [debug] [MainThread]: On master: Close
[0m13:11:45.093748 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:45.094063 [info ] [MainThread]: 
[0m13:11:45.095880 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m13:11:45.096113 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_bookings
[0m13:11:45.096302 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m13:11:45.096472 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_airports
[0m13:11:45.096743 [info ] [Thread-3 (]: 3 of 35 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ..... [RUN]
[0m13:11:45.097014 [info ] [Thread-4 (]: 4 of 35 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............ [RUN]
[0m13:11:45.097280 [info ] [Thread-1 (]: 1 of 35 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ........... [RUN]
[0m13:11:45.097536 [info ] [Thread-2 (]: 2 of 35 START sql view model dwh_detailed_dwh_detailed.raw_airports ............ [RUN]
[0m13:11:45.097823 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_boarding_passes'
[0m13:11:45.098068 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_bookings'
[0m13:11:45.098288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_postgres_dwh_detailed_dwh_detailed, now model.dbt_dwh.raw_aircrafts)
[0m13:11:45.098523 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_airports'
[0m13:11:45.098695 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m13:11:45.098857 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m13:11:45.099025 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m13:11:45.099183 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_airports
[0m13:11:45.103238 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m13:11:45.104514 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m13:11:45.105884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m13:11:45.107239 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m13:11:45.107788 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m13:11:45.107956 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_bookings
[0m13:11:45.108095 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_airports
[0m13:11:45.108220 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m13:11:45.124053 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m13:11:45.125753 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m13:11:45.127111 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m13:11:45.128256 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m13:11:45.128738 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:11:45.128942 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:11:45.129097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:11:45.129225 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:11:45.129348 [debug] [Thread-2 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m13:11:45.129489 [debug] [Thread-3 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m13:11:45.129617 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m13:11:45.129739 [debug] [Thread-4 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m13:11:45.129859 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:11:45.129979 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:11:45.130097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:45.130209 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:11:45.142749 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m13:11:45.142982 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m13:11:45.143153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m13:11:45.143365 [debug] [Thread-4 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m13:11:45.143587 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m13:11:45.143780 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m13:11:45.143911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m13:11:45.144075 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m13:11:45.144221 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m13:11:45.144462 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.bookings" does not exist
LINE 11:         FROM "postgres"."system"."bookings"
                      ^

[0m13:11:45.144660 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m13:11:45.144845 [debug] [Thread-2 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m13:11:45.145012 [debug] [Thread-3 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m13:11:45.145162 [debug] [Thread-4 (]: On model.dbt_dwh.raw_bookings: ROLLBACK
[0m13:11:45.145726 [debug] [Thread-4 (]: On model.dbt_dwh.raw_bookings: Close
[0m13:11:45.145908 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.aircrafts" does not exist
LINE 11:         FROM "postgres"."system"."aircrafts"
                      ^

[0m13:11:45.146054 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.airports" does not exist
LINE 14:         FROM "postgres"."system"."airports"
                      ^

[0m13:11:45.146218 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.boarding_passes" does not exist
LINE 12:         FROM "postgres"."system"."boarding_passes"
                      ^

[0m13:11:45.146837 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: ROLLBACK
[0m13:11:45.146985 [debug] [Thread-2 (]: On model.dbt_dwh.raw_airports: ROLLBACK
[0m13:11:45.147147 [debug] [Thread-3 (]: On model.dbt_dwh.raw_boarding_passes: ROLLBACK
[0m13:11:45.147605 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m13:11:45.147817 [debug] [Thread-3 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m13:11:45.147994 [debug] [Thread-2 (]: On model.dbt_dwh.raw_airports: Close
[0m13:11:45.154074 [debug] [Thread-3 (]: Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:11:45.155180 [debug] [Thread-2 (]: Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:11:45.157489 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdf950>]}
[0m13:11:45.157848 [debug] [Thread-4 (]: Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:11:45.158156 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d16f10>]}
[0m13:11:45.158843 [debug] [Thread-1 (]: Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:11:45.158504 [error] [Thread-2 (]: 2 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_airports ... [[31mERROR[0m in 0.06s]
[0m13:11:45.159042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a0730>]}
[0m13:11:45.159256 [error] [Thread-3 (]: 3 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_boarding_passes  [[31mERROR[0m in 0.06s]
[0m13:11:45.159429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f23d10>]}
[0m13:11:45.159670 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_airports
[0m13:11:45.159864 [error] [Thread-4 (]: 4 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_bookings ... [[31mERROR[0m in 0.06s]
[0m13:11:45.160097 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m13:11:45.160480 [debug] [Thread-2 (]: Began running node model.dbt_dwh.raw_flights
[0m13:11:45.160325 [error] [Thread-1 (]: 1 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_aircrafts .. [[31mERROR[0m in 0.06s]
[0m13:11:45.160992 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_bookings
[0m13:11:45.161164 [debug] [Thread-3 (]: Began running node model.dbt_dwh.raw_seats
[0m13:11:45.161362 [info ] [Thread-2 (]: 5 of 35 START sql view model dwh_detailed_dwh_detailed.raw_flights ............. [RUN]
[0m13:11:45.161603 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m13:11:45.161757 [debug] [Thread-4 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m13:11:45.162126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_flights)
[0m13:11:45.161953 [info ] [Thread-3 (]: 6 of 35 START sql view model dwh_detailed_dwh_detailed.raw_seats ............... [RUN]
[0m13:11:45.162323 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m13:11:45.162524 [info ] [Thread-4 (]: 7 of 35 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ...... [RUN]
[0m13:11:45.162710 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.raw_flights
[0m13:11:45.162872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_seats)
[0m13:11:45.163046 [info ] [Thread-1 (]: 8 of 35 START sql view model dwh_detailed_dwh_detailed.raw_tickets ............. [RUN]
[0m13:11:45.163203 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_ticket_flights)
[0m13:11:45.164341 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m13:11:45.164478 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.raw_seats
[0m13:11:45.164614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_tickets)
[0m13:11:45.164755 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m13:11:45.165994 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m13:11:45.166137 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m13:11:45.167082 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m13:11:45.168240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m13:11:45.168399 [debug] [Thread-2 (]: Began executing node model.dbt_dwh.raw_flights
[0m13:11:45.168717 [debug] [Thread-3 (]: Began executing node model.dbt_dwh.raw_seats
[0m13:11:45.170321 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m13:11:45.171645 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m13:11:45.171804 [debug] [Thread-4 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m13:11:45.171940 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m13:11:45.173186 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m13:11:45.174525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m13:11:45.174765 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:11:45.174929 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m13:11:45.175062 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:45.175207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:11:45.175446 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:11:45.175580 [debug] [Thread-3 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m13:11:45.175725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:11:45.175872 [debug] [Thread-4 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m13:11:45.176003 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:45.176145 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m13:11:45.176282 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:45.176466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:45.186132 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m13:11:45.186381 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m13:11:45.186539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m13:11:45.186688 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m13:11:45.186821 [debug] [Thread-3 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m13:11:45.186960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:11:45.187141 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m13:11:45.187307 [debug] [Thread-4 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m13:11:45.187454 [debug] [Thread-3 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m13:11:45.187600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m13:11:45.187757 [debug] [Thread-4 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m13:11:45.187954 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m13:11:45.188180 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "system.flights" does not exist
LINE 18:         FROM "postgres"."system"."flights"
                      ^

[0m13:11:45.188337 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: ROLLBACK
[0m13:11:45.188542 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "system.seats" does not exist
LINE 11:         FROM "postgres"."system"."seats"
                      ^

[0m13:11:45.188704 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "system.ticket_flights" does not exist
LINE 12:         FROM "postgres"."system"."ticket_flights"
                      ^

[0m13:11:45.188847 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "system.tickets" does not exist
LINE 13:         FROM "postgres"."system"."tickets"
                      ^

[0m13:11:45.188999 [debug] [Thread-2 (]: On model.dbt_dwh.raw_flights: Close
[0m13:11:45.189117 [debug] [Thread-3 (]: On model.dbt_dwh.raw_seats: ROLLBACK
[0m13:11:45.189232 [debug] [Thread-4 (]: On model.dbt_dwh.raw_ticket_flights: ROLLBACK
[0m13:11:45.189342 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: ROLLBACK
[0m13:11:45.190965 [debug] [Thread-2 (]: Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:11:45.191143 [debug] [Thread-3 (]: On model.dbt_dwh.raw_seats: Close
[0m13:11:45.191280 [debug] [Thread-4 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m13:11:45.191423 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1be6d0>]}
[0m13:11:45.191571 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m13:11:45.193633 [debug] [Thread-3 (]: Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:11:45.193925 [error] [Thread-2 (]: 5 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_flights .... [[31mERROR[0m in 0.03s]
[0m13:11:45.194948 [debug] [Thread-4 (]: Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:11:45.195537 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc1910>]}
[0m13:11:45.195777 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.raw_flights
[0m13:11:45.195958 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc1490>]}
[0m13:11:45.196918 [debug] [Thread-1 (]: Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:11:45.197140 [error] [Thread-3 (]: 6 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_seats ...... [[31mERROR[0m in 0.03s]
[0m13:11:45.197333 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m13:11:45.197604 [error] [Thread-4 (]: 7 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_ticket_flights  [[31mERROR[0m in 0.03s]
[0m13:11:45.197802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fc1490>]}
[0m13:11:45.197996 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.raw_seats
[0m13:11:45.198156 [info ] [Thread-2 (]: 9 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts .... [RUN]
[0m13:11:45.198363 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m13:11:45.198546 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_airports
[0m13:11:45.198775 [error] [Thread-1 (]: 8 of 35 ERROR creating sql view model dwh_detailed_dwh_detailed.raw_tickets .... [[31mERROR[0m in 0.03s]
[0m13:11:45.199033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.sat_aircrafts)
[0m13:11:45.199198 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m13:11:45.199423 [info ] [Thread-3 (]: 10 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_airports .... [RUN]
[0m13:11:45.199653 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m13:11:45.199781 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m13:11:45.199959 [info ] [Thread-4 (]: 11 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m13:11:45.200136 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.sat_airports)
[0m13:11:45.200309 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m13:11:45.203976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.sat_boarding_passes)
[0m13:11:45.204139 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_airports
[0m13:11:45.204483 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m13:11:45.204327 [info ] [Thread-1 (]: 12 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings .... [RUN]
[0m13:11:45.208582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_tickets, now model.dbt_dwh.sat_bookings)
[0m13:11:45.208750 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m13:11:45.213616 [debug] [Thread-2 (]: Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.214236 [debug] [Thread-3 (]: Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.214406 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0deb0>]}
[0m13:11:45.215222 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a16b5f0>]}
[0m13:11:45.215510 [debug] [Thread-1 (]: Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.215785 [debug] [Thread-4 (]: Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.216032 [error] [Thread-2 (]: 9 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.02s]
[0m13:11:45.216415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0deb0>]}
[0m13:11:45.216282 [error] [Thread-3 (]: 10 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.02s]
[0m13:11:45.216602 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a14ed50>]}
[0m13:11:45.216812 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m13:11:45.217037 [error] [Thread-1 (]: 12 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.01s]
[0m13:11:45.217267 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_airports
[0m13:11:45.217470 [error] [Thread-4 (]: 11 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.01s]
[0m13:11:45.217659 [debug] [Thread-2 (]: Began running node model.dbt_dwh.sat_flights
[0m13:11:45.217883 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m13:11:45.218043 [debug] [Thread-3 (]: Began running node model.dbt_dwh.sat_seats
[0m13:11:45.218235 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m13:11:45.218413 [info ] [Thread-2 (]: 13 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ..... [RUN]
[0m13:11:45.218607 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m13:11:45.218812 [info ] [Thread-3 (]: 14 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ....... [RUN]
[0m13:11:45.218984 [debug] [Thread-4 (]: Began running node model.dbt_dwh.sat_tickets
[0m13:11:45.219163 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_flights)
[0m13:11:45.219342 [info ] [Thread-1 (]: 15 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m13:11:45.219510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_seats)
[0m13:11:45.219677 [info ] [Thread-4 (]: 16 of 35 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ..... [RUN]
[0m13:11:45.219831 [debug] [Thread-2 (]: Began compiling node model.dbt_dwh.sat_flights
[0m13:11:45.219979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_ticket_flights)
[0m13:11:45.220111 [debug] [Thread-3 (]: Began compiling node model.dbt_dwh.sat_seats
[0m13:11:45.220255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_tickets)
[0m13:11:45.222640 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m13:11:45.224410 [debug] [Thread-4 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m13:11:45.228616 [debug] [Thread-2 (]: Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.228902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1325d0>]}
[0m13:11:45.229212 [error] [Thread-2 (]: 13 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.01s]
[0m13:11:45.229928 [debug] [Thread-3 (]: Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.230108 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.sat_flights
[0m13:11:45.230870 [debug] [Thread-1 (]: Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.231490 [debug] [Thread-4 (]: Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.231628 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a133bf0>]}
[0m13:11:45.231779 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_airports
[0m13:11:45.231945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a132810>]}
[0m13:11:45.232070 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4f5b3e4-e0df-4780-a688-81d626e637f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a131310>]}
[0m13:11:45.232269 [error] [Thread-3 (]: 14 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.01s]
[0m13:11:45.232443 [info ] [Thread-2 (]: 17 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_airports .................. [[33mSKIP[0m]
[0m13:11:45.232668 [error] [Thread-1 (]: 15 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.01s]
[0m13:11:45.232880 [error] [Thread-4 (]: 16 of 35 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.01s]
[0m13:11:45.233050 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.sat_seats
[0m13:11:45.233178 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_airports
[0m13:11:45.233331 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m13:11:45.233478 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.sat_tickets
[0m13:11:45.233613 [debug] [Thread-3 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m13:11:45.233765 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_bookings
[0m13:11:45.233983 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m13:11:45.234145 [debug] [Thread-4 (]: Began running node model.dbt_dwh.stg_flights
[0m13:11:45.234303 [info ] [Thread-3 (]: 18 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_boarding_passes ........... [[33mSKIP[0m]
[0m13:11:45.234461 [info ] [Thread-2 (]: 19 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_bookings .................. [[33mSKIP[0m]
[0m13:11:45.234686 [info ] [Thread-1 (]: 20 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_aircrafts ................. [[33mSKIP[0m]
[0m13:11:45.234854 [info ] [Thread-4 (]: 21 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_flights ................... [[33mSKIP[0m]
[0m13:11:45.235026 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m13:11:45.235201 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_bookings
[0m13:11:45.235381 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m13:11:45.235529 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.stg_flights
[0m13:11:45.235702 [debug] [Thread-3 (]: Began running node model.dbt_dwh.stg_seats
[0m13:11:45.235895 [debug] [Thread-2 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m13:11:45.236144 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_tickets
[0m13:11:45.236312 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_airports
[0m13:11:45.236520 [info ] [Thread-3 (]: 22 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_seats ..................... [[33mSKIP[0m]
[0m13:11:45.236700 [info ] [Thread-2 (]: 23 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_ticket_flights ............ [[33mSKIP[0m]
[0m13:11:45.236865 [info ] [Thread-1 (]: 24 of 35 SKIP relation dwh_detailed_dwh_detailed.stg_tickets ................... [[33mSKIP[0m]
[0m13:11:45.237018 [info ] [Thread-4 (]: 25 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_airports .................. [[33mSKIP[0m]
[0m13:11:45.237185 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.stg_seats
[0m13:11:45.237315 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m13:11:45.237442 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_tickets
[0m13:11:45.237568 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_airports
[0m13:11:45.237701 [debug] [Thread-3 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m13:11:45.237868 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_bookings
[0m13:11:45.238037 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m13:11:45.238227 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_flights
[0m13:11:45.238390 [info ] [Thread-3 (]: 26 of 35 SKIP relation dwh_detailed_dwh_detailed.link_boarding_passes .......... [[33mSKIP[0m]
[0m13:11:45.238548 [info ] [Thread-2 (]: 27 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_bookings .................. [[33mSKIP[0m]
[0m13:11:45.238711 [info ] [Thread-1 (]: 28 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_aircrafts ................. [[33mSKIP[0m]
[0m13:11:45.238871 [info ] [Thread-4 (]: 29 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_flights ................... [[33mSKIP[0m]
[0m13:11:45.239037 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m13:11:45.239184 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_bookings
[0m13:11:45.239318 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m13:11:45.239438 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_flights
[0m13:11:45.239562 [debug] [Thread-3 (]: Began running node model.dbt_dwh.link_flights_airports
[0m13:11:45.239709 [debug] [Thread-2 (]: Began running node model.dbt_dwh.hub_seats
[0m13:11:45.239866 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m13:11:45.240010 [debug] [Thread-4 (]: Began running node model.dbt_dwh.hub_tickets
[0m13:11:45.240157 [info ] [Thread-3 (]: 30 of 35 SKIP relation dwh_detailed_dwh_detailed.link_flights_airports ......... [[33mSKIP[0m]
[0m13:11:45.240312 [info ] [Thread-2 (]: 31 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_seats ..................... [[33mSKIP[0m]
[0m13:11:45.240474 [info ] [Thread-1 (]: 32 of 35 SKIP relation dwh_detailed_dwh_detailed.link_aircrafts_seats .......... [[33mSKIP[0m]
[0m13:11:45.240630 [info ] [Thread-4 (]: 33 of 35 SKIP relation dwh_detailed_dwh_detailed.hub_tickets ................... [[33mSKIP[0m]
[0m13:11:45.240810 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m13:11:45.240938 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.hub_seats
[0m13:11:45.241065 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m13:11:45.241189 [debug] [Thread-4 (]: Finished running node model.dbt_dwh.hub_tickets
[0m13:11:45.241315 [debug] [Thread-3 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m13:11:45.241473 [debug] [Thread-2 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m13:11:45.241712 [info ] [Thread-3 (]: 34 of 35 SKIP relation dwh_detailed_dwh_detailed.link_ticket_flights ........... [[33mSKIP[0m]
[0m13:11:45.241883 [info ] [Thread-2 (]: 35 of 35 SKIP relation dwh_detailed_dwh_detailed.link_tickets_bookings ......... [[33mSKIP[0m]
[0m13:11:45.242038 [debug] [Thread-3 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m13:11:45.242169 [debug] [Thread-2 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m13:11:45.242780 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:45.242892 [debug] [MainThread]: On master: BEGIN
[0m13:11:45.242993 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:45.251385 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:11:45.251582 [debug] [MainThread]: On master: COMMIT
[0m13:11:45.251680 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:45.251769 [debug] [MainThread]: On master: COMMIT
[0m13:11:45.252110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:45.252230 [debug] [MainThread]: On master: Close
[0m13:11:45.252411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:45.252533 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_ticket_flights' was properly closed.
[0m13:11:45.252621 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_seats' was properly closed.
[0m13:11:45.252702 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m13:11:45.252779 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_flights' was properly closed.
[0m13:11:45.252939 [info ] [MainThread]: 
[0m13:11:45.253064 [info ] [MainThread]: Finished running 16 view models, 19 incremental models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:11:45.254155 [debug] [MainThread]: Command end result
[0m13:11:45.273501 [info ] [MainThread]: 
[0m13:11:45.273711 [info ] [MainThread]: [31mCompleted with 16 errors and 0 warnings:[0m
[0m13:11:45.273825 [info ] [MainThread]: 
[0m13:11:45.273969 [error] [MainThread]:   Database Error in model raw_airports (models/raw/raw_airports.sql)
  relation "system.airports" does not exist
  LINE 14:         FROM "postgres"."system"."airports"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_airports.sql
[0m13:11:45.274079 [info ] [MainThread]: 
[0m13:11:45.274207 [error] [MainThread]:   Database Error in model raw_boarding_passes (models/raw/raw_boarding_passes.sql)
  relation "system.boarding_passes" does not exist
  LINE 12:         FROM "postgres"."system"."boarding_passes"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_boarding_passes.sql
[0m13:11:45.274311 [info ] [MainThread]: 
[0m13:11:45.274435 [error] [MainThread]:   Database Error in model raw_bookings (models/raw/raw_bookings.sql)
  relation "system.bookings" does not exist
  LINE 11:         FROM "postgres"."system"."bookings"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_bookings.sql
[0m13:11:45.274535 [info ] [MainThread]: 
[0m13:11:45.274653 [error] [MainThread]:   Database Error in model raw_aircrafts (models/raw/raw_aircrafts.sql)
  relation "system.aircrafts" does not exist
  LINE 11:         FROM "postgres"."system"."aircrafts"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_aircrafts.sql
[0m13:11:45.274752 [info ] [MainThread]: 
[0m13:11:45.274871 [error] [MainThread]:   Database Error in model raw_flights (models/raw/raw_flights.sql)
  relation "system.flights" does not exist
  LINE 18:         FROM "postgres"."system"."flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_flights.sql
[0m13:11:45.274969 [info ] [MainThread]: 
[0m13:11:45.275085 [error] [MainThread]:   Database Error in model raw_seats (models/raw/raw_seats.sql)
  relation "system.seats" does not exist
  LINE 11:         FROM "postgres"."system"."seats"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_seats.sql
[0m13:11:45.275182 [info ] [MainThread]: 
[0m13:11:45.275303 [error] [MainThread]:   Database Error in model raw_ticket_flights (models/raw/raw_ticket_flights.sql)
  relation "system.ticket_flights" does not exist
  LINE 12:         FROM "postgres"."system"."ticket_flights"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_ticket_flights.sql
[0m13:11:45.275401 [info ] [MainThread]: 
[0m13:11:45.275524 [error] [MainThread]:   Database Error in model raw_tickets (models/raw/raw_tickets.sql)
  relation "system.tickets" does not exist
  LINE 13:         FROM "postgres"."system"."tickets"
                        ^
  compiled code at target/run/dbt_dwh/models/raw/raw_tickets.sql
[0m13:11:45.275619 [info ] [MainThread]: 
[0m13:11:45.275739 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models/raw_vault/sats/sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.275836 [info ] [MainThread]: 
[0m13:11:45.275953 [error] [MainThread]:   Compilation Error in model sat_airports (models/raw_vault/sats/sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.276048 [info ] [MainThread]: 
[0m13:11:45.276163 [error] [MainThread]:   Compilation Error in model sat_bookings (models/raw_vault/sats/sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.276258 [info ] [MainThread]: 
[0m13:11:45.276378 [error] [MainThread]:   Compilation Error in model sat_boarding_passes (models/raw_vault/sats/sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.276476 [info ] [MainThread]: 
[0m13:11:45.276595 [error] [MainThread]:   Compilation Error in model sat_flights (models/raw_vault/sats/sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.276694 [info ] [MainThread]: 
[0m13:11:45.276812 [error] [MainThread]:   Compilation Error in model sat_seats (models/raw_vault/sats/sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.276908 [info ] [MainThread]: 
[0m13:11:45.277025 [error] [MainThread]:   Compilation Error in model sat_ticket_flights (models/raw_vault/sats/sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.277120 [info ] [MainThread]: 
[0m13:11:45.277233 [error] [MainThread]:   Compilation Error in model sat_tickets (models/raw_vault/sats/sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:11:45.277336 [info ] [MainThread]: 
[0m13:11:45.277451 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=16 SKIP=19 TOTAL=35
[0m13:11:45.278484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7541699, "process_in_blocks": "0", "process_kernel_time": 0.158322, "process_mem_max_rss": "131219456", "process_out_blocks": "0", "process_user_time": 0.932399}
[0m13:11:45.278697 [debug] [MainThread]: Command `dbt run` failed at 13:11:45.278660 after 0.75 seconds
[0m13:11:45.278850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0efcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ef830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ef7d0>]}
[0m13:11:45.278984 [debug] [MainThread]: Flushing usage events
[0m23:38:22.997302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C17A109B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C17A13140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C17A139E0>]}


============================== 23:38:23.017733 | 3b4b0f4b-510b-40fa-91ae-53910c0887cf ==============================
[0m23:38:23.017733 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:38:23.019372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:38:23.095329 [info ] [MainThread]: dbt version: 1.8.9
[0m23:38:23.097834 [info ] [MainThread]: python version: 3.12.3
[0m23:38:23.098837 [info ] [MainThread]: python path: C:\ProgramData\anaconda3\python.exe
[0m23:38:23.099840 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m23:38:23.247020 [info ] [MainThread]: Using profiles dir at C:\Users\d_tru\.dbt
[0m23:38:23.248166 [info ] [MainThread]: Using profiles.yml file at C:\Users\d_tru\.dbt\profiles.yml
[0m23:38:23.249242 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\d_tru\Downloads\D\gruzi_suda_uchebu\FTIAD_true\DWH\DWH_hw02-main\dbt_dwh\dbt_project.yml
[0m23:38:23.252031 [info ] [MainThread]: adapter type: postgres
[0m23:38:23.253356 [info ] [MainThread]: adapter version: 1.8.2
[0m23:38:23.429254 [info ] [MainThread]: Configuration:
[0m23:38:23.431107 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:38:23.432755 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:38:23.434415 [info ] [MainThread]: Required dependencies:
[0m23:38:23.435429 [debug] [MainThread]: Executing "git --help"
[0m23:38:23.495802 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:38:23.496809 [debug] [MainThread]: STDERR: "b''"
[0m23:38:23.497819 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:38:23.500032 [info ] [MainThread]: Connection:
[0m23:38:23.501161 [info ] [MainThread]:   host: localhost
[0m23:38:23.502819 [info ] [MainThread]:   port: 5432
[0m23:38:23.504456 [info ] [MainThread]:   user: postgres
[0m23:38:23.505534 [info ] [MainThread]:   database: postgres
[0m23:38:23.507279 [info ] [MainThread]:   schema: dwh_detailed
[0m23:38:23.509114 [info ] [MainThread]:   connect_timeout: 10
[0m23:38:23.510211 [info ] [MainThread]:   role: None
[0m23:38:23.511316 [info ] [MainThread]:   search_path: None
[0m23:38:23.513556 [info ] [MainThread]:   keepalives_idle: 0
[0m23:38:23.515129 [info ] [MainThread]:   sslmode: None
[0m23:38:23.517738 [info ] [MainThread]:   sslcert: None
[0m23:38:23.519364 [info ] [MainThread]:   sslkey: None
[0m23:38:23.520998 [info ] [MainThread]:   sslrootcert: None
[0m23:38:23.522696 [info ] [MainThread]:   application_name: dbt
[0m23:38:23.525190 [info ] [MainThread]:   retries: 1
[0m23:38:23.527982 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:38:23.830339 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:38:24.737688 [debug] [MainThread]: Using postgres connection "debug"
[0m23:38:24.738682 [debug] [MainThread]: On debug: select 1 as id
[0m23:38:24.739696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:24.813179 [debug] [MainThread]: SQL status: SELECT 1 in 0.073 seconds
[0m23:38:24.815717 [debug] [MainThread]: On debug: Close
[0m23:38:24.816731 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:38:24.818747 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:38:24.822269 [debug] [MainThread]: Command `dbt debug` succeeded at 23:38:24.820749 after 2.25 seconds
[0m23:38:24.822269 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:38:24.823366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C177798B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C114D8C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C177BD3D0>]}
[0m23:38:24.824391 [debug] [MainThread]: Flushing usage events
[0m23:39:44.296776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6AF7DA0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6AD55F500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6AFC422A0>]}


============================== 23:39:44.305034 | 8e1f9659-55d0-4004-b98d-72d978884c96 ==============================
[0m23:39:44.305034 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:39:44.307375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:raw', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:39:44.804528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e1f9659-55d0-4004-b98d-72d978884c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B00E47A0>]}
[0m23:39:44.908270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e1f9659-55d0-4004-b98d-72d978884c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6AFF1EBD0>]}
[0m23:39:44.911066 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:39:45.200656 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path C:\Users\d_tru\Downloads\D\gruzi_suda_uchebu\FTIAD_true\DWH\DWH_hw02-main\dbt_dwh\dbt_packages\automate_dv\dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in C:\Users\d_tru\Downloads\D\gruzi_suda_uchebu\FTIAD_true\DWH\DWH_hw02-main\dbt_dwh\dbt_packages\automate_dv
[0m23:39:45.202672 [debug] [MainThread]: Command `dbt run` failed at 23:39:45.202672 after 1.18 seconds
[0m23:39:45.204332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B0090C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B02734D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6B025C0B0>]}
[0m23:39:45.205680 [debug] [MainThread]: Flushing usage events
[0m23:40:14.960995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023959FEE840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CA37020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CA37E60>]}


============================== 23:40:14.967566 | 3d15564f-8338-4458-a3d9-778b88dfac54 ==============================
[0m23:40:14.967566 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:40:14.969607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:40:15.244731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d15564f-8338-4458-a3d9-778b88dfac54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395BF19F40>]}
[0m23:40:15.429252 [debug] [MainThread]: Set downloads directory='C:\Users\d_tru\AppData\Local\Temp\dbt-downloads-zt5t_fzi'
[0m23:40:15.430318 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:40:16.049508 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:40:16.051221 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:40:16.536635 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:40:16.541592 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m23:40:16.543817 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m23:40:18.172950 [debug] [MainThread]: STDOUT: "b''"
[0m23:40:18.174087 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m23:40:18.175149 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m23:40:18.175712 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:40:18.221853 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m23:40:18.223441 [debug] [MainThread]: STDERR: "b''"
[0m23:40:18.225083 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m23:40:18.226240 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m23:40:19.557939 [debug] [MainThread]: STDOUT: "b''"
[0m23:40:19.558584 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m23:40:19.559674 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m23:40:19.655138 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m23:40:19.656276 [debug] [MainThread]: STDERR: "b''"
[0m23:40:19.656276 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:40:19.703083 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m23:40:19.704992 [debug] [MainThread]: STDERR: "b''"
[0m23:40:19.706029 [debug] [MainThread]: Checked out at 8ee9ee8.
[0m23:40:19.707067 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:40:19.753270 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m23:40:19.754527 [debug] [MainThread]: STDERR: "b''"
[0m23:40:19.789156 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m23:40:19.835068 [debug] [MainThread]: STDOUT: "b''"
[0m23:40:19.836215 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m23:40:19.836784 [debug] [MainThread]: command return code=128
[0m23:40:19.838322 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m23:40:19.839340 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:40:19.886543 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m23:40:19.887754 [debug] [MainThread]: STDERR: "b''"
[0m23:40:19.888890 [debug] [MainThread]: Checking out revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06.
[0m23:40:19.889424 [debug] [MainThread]: Executing "git fetch origin --depth 1 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m23:40:21.184512 [debug] [MainThread]: STDOUT: "b''"
[0m23:40:21.185617 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            8ee9ee882a9b3f3e4c334b38ef6460eafc12af06 -> FETCH_HEAD\n'"
[0m23:40:21.186696 [debug] [MainThread]: Executing "git reset --hard 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06"
[0m23:40:21.250835 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m23:40:21.251371 [debug] [MainThread]: STDERR: "b''"
[0m23:40:21.253268 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m23:40:21.300461 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m23:40:21.300461 [debug] [MainThread]: STDERR: "b''"
[0m23:40:21.302465 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m23:40:21.306413 [info ] [MainThread]: Installed from revision 8ee9ee882a9b3f3e4c334b38ef6460eafc12af06
[0m23:40:21.308024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3d15564f-8338-4458-a3d9-778b88dfac54', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CEC0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CC50D10>]}
[0m23:40:21.309124 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:40:22.540255 [info ] [MainThread]: Installed from version 1.3.0
[0m23:40:22.541266 [info ] [MainThread]: Up to date!
[0m23:40:22.542267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3d15564f-8338-4458-a3d9-778b88dfac54', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CCA2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CEBB440>]}
[0m23:40:22.546317 [debug] [MainThread]: Command `dbt deps` succeeded at 23:40:22.546317 after 7.85 seconds
[0m23:40:22.546882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395BF19F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CADE9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002395CADC200>]}
[0m23:40:22.548352 [debug] [MainThread]: Flushing usage events
[0m23:40:45.388798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021232CE3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212329F20F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212322FF1A0>]}


============================== 23:40:45.396801 | c6328cf3-4cf2-4e3e-81e2-79956d1315ce ==============================
[0m23:40:45.396801 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:40:45.399017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:raw', 'send_anonymous_usage_stats': 'True'}
[0m23:40:45.775510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021233096930>]}
[0m23:40:45.888836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002123232E0F0>]}
[0m23:40:45.891840 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:40:46.193945 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:40:46.329269 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:40:46.330356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002123460B350>]}
[0m23:40:52.213193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002123496A0C0>]}
[0m23:40:52.506782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234A23B00>]}
[0m23:40:52.508294 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:40:52.510310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002123438CAA0>]}
[0m23:40:52.514824 [info ] [MainThread]: 
[0m23:40:52.516310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:40:52.524628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:40:53.048393 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:40:53.049593 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:40:53.050148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:53.121162 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.071 seconds
[0m23:40:53.123511 [debug] [ThreadPool]: On list_postgres: Close
[0m23:40:53.126453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_dwh_detailed_dwh_detailed)
[0m23:40:53.138256 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "dwh_detailed_dwh_detailed"
"
[0m23:40:53.145874 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m23:40:53.146974 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:40:53.147539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:40:53.191265 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m23:40:53.193609 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m23:40:53.195129 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "create_postgres_dwh_detailed_dwh_detailed"} */
create schema if not exists "dwh_detailed_dwh_detailed"
[0m23:40:53.202022 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.007 seconds
[0m23:40:53.205199 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m23:40:53.206225 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m23:40:53.207241 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m23:40:53.226656 [debug] [ThreadPool]: SQL status: COMMIT in 0.020 seconds
[0m23:40:53.228181 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: Close
[0m23:40:53.235762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m23:40:53.243358 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:40:53.244876 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:40:53.245899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:40:53.288846 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m23:40:53.289948 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:40:53.290945 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m23:40:53.311580 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.020 seconds
[0m23:40:53.314009 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m23:40:53.316733 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m23:40:53.331796 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:53.331796 [debug] [MainThread]: On master: BEGIN
[0m23:40:53.333794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:40:53.373777 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m23:40:53.376672 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:53.376672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:40:53.411230 [debug] [MainThread]: SQL status: SELECT 0 in 0.033 seconds
[0m23:40:53.413228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234C3F860>]}
[0m23:40:53.415752 [debug] [MainThread]: On master: ROLLBACK
[0m23:40:53.418431 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:53.419785 [debug] [MainThread]: On master: BEGIN
[0m23:40:53.425288 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:40:53.426391 [debug] [MainThread]: On master: COMMIT
[0m23:40:53.428102 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:53.429123 [debug] [MainThread]: On master: COMMIT
[0m23:40:53.431199 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:40:53.432219 [debug] [MainThread]: On master: Close
[0m23:40:53.434214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:40:53.436167 [info ] [MainThread]: 
[0m23:40:53.444451 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m23:40:53.446059 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ............ [RUN]
[0m23:40:53.447768 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_aircrafts'
[0m23:40:53.448873 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m23:40:53.460365 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m23:40:53.462843 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m23:40:53.512439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m23:40:53.516487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m23:40:53.518994 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m23:40:53.520006 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:40:53.591083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m23:40:53.592340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m23:40:53.593455 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m23:40:53.623563 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.030 seconds
[0m23:40:53.632618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m23:40:53.633625 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp" rename to "raw_aircrafts"
[0m23:40:53.636583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:40:53.655265 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m23:40:53.656556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m23:40:53.657112 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m23:40:53.678247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m23:40:53.689572 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup"
[0m23:40:53.697032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m23:40:53.698552 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup" cascade
[0m23:40:53.702643 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:53.706201 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m23:40:53.709754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212308709B0>]}
[0m23:40:53.710757 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_aircrafts ....... [[32mCREATE VIEW[0m in 0.26s]
[0m23:40:53.713882 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m23:40:53.715397 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_airports
[0m23:40:53.717465 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.raw_airports ............. [RUN]
[0m23:40:53.718986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_airports)
[0m23:40:53.721297 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_airports
[0m23:40:53.726952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m23:40:53.729488 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_airports
[0m23:40:53.738474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m23:40:53.741848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m23:40:53.743479 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m23:40:53.744024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:53.792802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m23:40:53.793882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m23:40:53.794890 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m23:40:53.813580 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m23:40:53.819184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m23:40:53.820193 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m23:40:53.826508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m23:40:53.830952 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m23:40:53.832069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m23:40:53.833871 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m23:40:53.842023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:40:53.845963 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup"
[0m23:40:53.847084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m23:40:53.847633 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup" cascade
[0m23:40:53.851346 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:53.854138 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: Close
[0m23:40:53.856612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002123030AF90>]}
[0m23:40:53.858433 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_airports ........ [[32mCREATE VIEW[0m in 0.14s]
[0m23:40:53.861277 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_airports
[0m23:40:53.862397 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m23:40:53.864090 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ...... [RUN]
[0m23:40:53.867019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_boarding_passes)
[0m23:40:53.869261 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m23:40:53.877277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m23:40:53.879784 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m23:40:53.885346 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m23:40:53.888203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m23:40:53.889328 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m23:40:53.889328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:53.944283 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m23:40:53.945396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m23:40:53.946277 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m23:40:53.960614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m23:40:53.965763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m23:40:53.966776 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp" rename to "raw_boarding_passes"
[0m23:40:53.969748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:40:53.972011 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m23:40:53.973017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m23:40:53.974011 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m23:40:53.982835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:40:53.986901 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup"
[0m23:40:53.989443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m23:40:53.989443 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup" cascade
[0m23:40:53.992552 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:53.994908 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m23:40:53.996934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234CB7920>]}
[0m23:40:53.998448 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_boarding_passes . [[32mCREATE VIEW[0m in 0.13s]
[0m23:40:54.000801 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m23:40:54.000801 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m23:40:54.002804 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............. [RUN]
[0m23:40:54.005643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_bookings)
[0m23:40:54.006742 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m23:40:54.011139 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m23:40:54.014067 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m23:40:54.021132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m23:40:54.023157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m23:40:54.024149 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m23:40:54.025540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:54.072356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m23:40:54.074824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m23:40:54.075876 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m23:40:54.092927 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m23:40:54.098380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m23:40:54.099502 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp" rename to "raw_bookings"
[0m23:40:54.102342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:40:54.105861 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m23:40:54.107017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m23:40:54.108673 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m23:40:54.115716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:40:54.120317 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup"
[0m23:40:54.121929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m23:40:54.123045 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup" cascade
[0m23:40:54.125802 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:54.128081 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m23:40:54.129153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234C8B2F0>]}
[0m23:40:54.131189 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_bookings ........ [[32mCREATE VIEW[0m in 0.12s]
[0m23:40:54.133581 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m23:40:54.136116 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_flights
[0m23:40:54.140159 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.raw_flights .............. [RUN]
[0m23:40:54.143337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_flights)
[0m23:40:54.145584 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_flights
[0m23:40:54.150579 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m23:40:54.153490 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_flights
[0m23:40:54.159592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m23:40:54.161955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m23:40:54.163061 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m23:40:54.163616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:54.212381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m23:40:54.213593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m23:40:54.214771 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m23:40:54.231132 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m23:40:54.236175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m23:40:54.237173 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp" rename to "raw_flights"
[0m23:40:54.241690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m23:40:54.243558 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m23:40:54.245091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m23:40:54.246316 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m23:40:54.252881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:40:54.256898 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup"
[0m23:40:54.259425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m23:40:54.260422 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup" cascade
[0m23:40:54.264080 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:54.268617 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: Close
[0m23:40:54.269630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212343F9B50>]}
[0m23:40:54.271644 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_flights ......... [[32mCREATE VIEW[0m in 0.13s]
[0m23:40:54.273639 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_flights
[0m23:40:54.275149 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_seats
[0m23:40:54.277272 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.raw_seats ................ [RUN]
[0m23:40:54.278798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.raw_seats)
[0m23:40:54.279806 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_seats
[0m23:40:54.287787 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m23:40:54.290022 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_seats
[0m23:40:54.295070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m23:40:54.296278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m23:40:54.297274 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m23:40:54.299781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:54.346477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:40:54.347037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m23:40:54.348410 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m23:40:54.364818 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m23:40:54.370685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m23:40:54.372078 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp" rename to "raw_seats"
[0m23:40:54.375226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:40:54.377227 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m23:40:54.378488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m23:40:54.378488 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m23:40:54.386691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:40:54.393135 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup"
[0m23:40:54.394682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m23:40:54.395732 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup" cascade
[0m23:40:54.398557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:54.400838 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: Close
[0m23:40:54.402661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234C70740>]}
[0m23:40:54.403801 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_seats ........... [[32mCREATE VIEW[0m in 0.12s]
[0m23:40:54.406009 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_seats
[0m23:40:54.407021 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m23:40:54.408533 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ....... [RUN]
[0m23:40:54.409548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.raw_ticket_flights)
[0m23:40:54.410642 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m23:40:54.415646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m23:40:54.418608 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m23:40:54.426428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m23:40:54.428457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m23:40:54.428974 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m23:40:54.430271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:54.477347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:40:54.478458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m23:40:54.478458 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m23:40:54.496104 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m23:40:54.502144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m23:40:54.503143 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp" rename to "raw_ticket_flights"
[0m23:40:54.505892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:40:54.508415 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m23:40:54.509900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m23:40:54.509900 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m23:40:54.517183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:40:54.521501 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup"
[0m23:40:54.522649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m23:40:54.523645 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup" cascade
[0m23:40:54.526345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:54.529532 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m23:40:54.530631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234CC0A10>]}
[0m23:40:54.532932 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_ticket_flights .. [[32mCREATE VIEW[0m in 0.12s]
[0m23:40:54.533936 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m23:40:54.536688 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m23:40:54.536688 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.raw_tickets .............. [RUN]
[0m23:40:54.539917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.raw_tickets)
[0m23:40:54.541034 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m23:40:54.552430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m23:40:54.554095 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m23:40:54.559889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m23:40:54.561738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m23:40:54.562740 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m23:40:54.564135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:40:54.613319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m23:40:54.614836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m23:40:54.615854 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m23:40:54.631525 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m23:40:54.636051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m23:40:54.637050 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp" rename to "raw_tickets"
[0m23:40:54.639588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:40:54.641766 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m23:40:54.643975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m23:40:54.645149 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m23:40:54.651908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:40:54.656276 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup"
[0m23:40:54.656809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m23:40:54.658333 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup" cascade
[0m23:40:54.660356 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:40:54.663360 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m23:40:54.664898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6328cf3-4cf2-4e3e-81e2-79956d1315ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234C64890>]}
[0m23:40:54.666576 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_tickets ......... [[32mCREATE VIEW[0m in 0.12s]
[0m23:40:54.671237 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m23:40:54.673465 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:54.674982 [debug] [MainThread]: On master: BEGIN
[0m23:40:54.676083 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:40:54.723022 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m23:40:54.724023 [debug] [MainThread]: On master: COMMIT
[0m23:40:54.725025 [debug] [MainThread]: Using postgres connection "master"
[0m23:40:54.726181 [debug] [MainThread]: On master: COMMIT
[0m23:40:54.729505 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:40:54.730508 [debug] [MainThread]: On master: Close
[0m23:40:54.731523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:40:54.733524 [debug] [MainThread]: Connection 'create_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:40:54.733524 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:40:54.735042 [debug] [MainThread]: Connection 'model.dbt_dwh.raw_tickets' was properly closed.
[0m23:40:54.736125 [info ] [MainThread]: 
[0m23:40:54.737544 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m23:40:54.741140 [debug] [MainThread]: Command end result
[0m23:40:54.816401 [info ] [MainThread]: 
[0m23:40:54.818219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:40:54.819484 [info ] [MainThread]: 
[0m23:40:54.821584 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:40:54.825716 [debug] [MainThread]: Command `dbt run` succeeded at 23:40:54.825716 after 9.69 seconds
[0m23:40:54.826804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021232109790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002123491A8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021234CA0DA0>]}
[0m23:40:54.828496 [debug] [MainThread]: Flushing usage events
[0m23:41:30.653154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0199871A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01C092AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01B0A0800>]}


============================== 23:41:30.661657 | d2f2d6b1-b89f-4464-86d9-349335333cd0 ==============================
[0m23:41:30.661657 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:41:30.664656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:stage', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:41:31.097395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01B4E6DE0>]}
[0m23:41:31.212169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01C1FEBD0>]}
[0m23:41:31.214317 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:41:31.570401 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:41:32.112222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:32.113222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:32.164479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01D70AFF0>]}
[0m23:41:32.359281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01DEF3DD0>]}
[0m23:41:32.361469 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:41:32.363389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01DA56FF0>]}
[0m23:41:32.367187 [info ] [MainThread]: 
[0m23:41:32.369373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:41:32.377547 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:41:32.980056 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:41:32.981061 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:41:32.983331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:33.044080 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.061 seconds
[0m23:41:33.045627 [debug] [ThreadPool]: On list_postgres: Close
[0m23:41:33.051799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m23:41:33.062731 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:41:33.063837 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:41:33.064943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:33.121871 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m23:41:33.122992 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:41:33.123548 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m23:41:33.144119 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.019 seconds
[0m23:41:33.146889 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m23:41:33.150189 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m23:41:33.163702 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:33.164882 [debug] [MainThread]: On master: BEGIN
[0m23:41:33.165439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:41:33.211025 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m23:41:33.212145 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:33.213200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:41:33.260152 [debug] [MainThread]: SQL status: SELECT 8 in 0.046 seconds
[0m23:41:33.264495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01C63E870>]}
[0m23:41:33.264495 [debug] [MainThread]: On master: ROLLBACK
[0m23:41:33.268474 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:33.269482 [debug] [MainThread]: On master: BEGIN
[0m23:41:33.273853 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:41:33.274846 [debug] [MainThread]: On master: COMMIT
[0m23:41:33.276480 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:33.276990 [debug] [MainThread]: On master: COMMIT
[0m23:41:33.280288 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:41:33.281409 [debug] [MainThread]: On master: Close
[0m23:41:33.282441 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:33.283904 [info ] [MainThread]: 
[0m23:41:33.291301 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m23:41:33.293136 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.stg_aircrafts ............ [RUN]
[0m23:41:33.294810 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.stg_aircrafts'
[0m23:41:33.295372 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_aircrafts
[0m23:41:33.363244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.364350 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: BEGIN
[0m23:41:33.364350 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:41:33.410574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m23:41:33.410574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.411766 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:33.454108 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.041 seconds
[0m23:41:33.527227 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.528291 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:33.534191 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m23:41:33.613959 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.616627 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_aircrafts
[0m23:41:33.662805 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.676409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.677550 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'AIRCRAFTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS aircraft_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS aircraft_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    aircraft_pk,
    aircraft_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:33.706533 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m23:41:33.716995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.718663 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m23:41:33.722190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:41:33.742142 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m23:41:33.744362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.747639 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m23:41:33.768210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m23:41:33.779751 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup"
[0m23:41:33.786718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m23:41:33.788696 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m23:41:33.792816 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:41:33.796832 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: Close
[0m23:41:33.801891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A019EE07A0>]}
[0m23:41:33.802957 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_aircrafts ....... [[32mCREATE VIEW[0m in 0.50s]
[0m23:41:33.805958 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m23:41:33.807488 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_airports
[0m23:41:33.808999 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.stg_airports ............. [RUN]
[0m23:41:33.810012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_aircrafts, now model.dbt_dwh.stg_airports)
[0m23:41:33.811008 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_airports
[0m23:41:33.825316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m23:41:33.827275 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: BEGIN
[0m23:41:33.828941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:33.892878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m23:41:33.894062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m23:41:33.894062 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:33.933908 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.038 seconds
[0m23:41:33.940869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m23:41:33.941865 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:33.949430 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m23:41:33.961735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_airports"
[0m23:41:33.963739 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_airports
[0m23:41:33.969668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_airports"
[0m23:41:33.971913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m23:41:33.972908 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_airports"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'AIRPORTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS airport_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS airport_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    airport_pk,
    airport_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:33.992612 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m23:41:33.997453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m23:41:33.998969 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m23:41:34.001994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:41:34.004003 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m23:41:34.005521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m23:41:34.006972 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m23:41:34.025623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m23:41:34.029539 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup"
[0m23:41:34.031163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m23:41:34.031721 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup" cascade
[0m23:41:34.035115 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:41:34.037581 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: Close
[0m23:41:34.040373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E1BF380>]}
[0m23:41:34.041766 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_airports ........ [[32mCREATE VIEW[0m in 0.23s]
[0m23:41:34.044772 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_airports
[0m23:41:34.045772 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m23:41:34.046783 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.stg_boarding_passes ...... [RUN]
[0m23:41:34.049301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_airports, now model.dbt_dwh.stg_boarding_passes)
[0m23:41:34.050254 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_boarding_passes
[0m23:41:34.061237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.062683 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: BEGIN
[0m23:41:34.064047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:34.124750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m23:41:34.126589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.127956 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.163026 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.033 seconds
[0m23:41:34.169256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.170343 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.175854 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:41:34.275878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.279019 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_boarding_passes
[0m23:41:34.286812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.290060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.291160 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'BOARDING_PASSES'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS boarding_pass_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    boarding_pass_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:34.314460 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m23:41:34.320967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.322044 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m23:41:34.325429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:41:34.327933 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m23:41:34.328959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.329484 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m23:41:34.337554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:41:34.342730 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m23:41:34.345530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m23:41:34.346733 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m23:41:34.350915 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:41:34.353092 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: Close
[0m23:41:34.354225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E1795E0>]}
[0m23:41:34.356913 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_boarding_passes . [[32mCREATE VIEW[0m in 0.31s]
[0m23:41:34.358911 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m23:41:34.360357 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m23:41:34.361666 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.stg_bookings ............. [RUN]
[0m23:41:34.365761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_boarding_passes, now model.dbt_dwh.stg_bookings)
[0m23:41:34.367282 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_bookings
[0m23:41:34.384338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m23:41:34.384338 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: BEGIN
[0m23:41:34.384338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:34.440471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m23:41:34.441614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m23:41:34.442632 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.483065 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.039 seconds
[0m23:41:34.492734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m23:41:34.493880 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.500197 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:41:34.515810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_bookings"
[0m23:41:34.518153 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_bookings
[0m23:41:34.523583 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_bookings"
[0m23:41:34.525844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m23:41:34.527397 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'BOOKINGS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS booking_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    booking_pk,
    booking_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:34.549785 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m23:41:34.554731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m23:41:34.554731 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m23:41:34.558878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:41:34.561304 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m23:41:34.562314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m23:41:34.563317 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m23:41:34.579887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m23:41:34.584301 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup"
[0m23:41:34.586837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m23:41:34.587957 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m23:41:34.592206 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:41:34.594894 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: Close
[0m23:41:34.596619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E0753D0>]}
[0m23:41:34.597769 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_bookings ........ [[32mCREATE VIEW[0m in 0.23s]
[0m23:41:34.599872 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m23:41:34.600961 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_flights
[0m23:41:34.601504 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.stg_flights .............. [RUN]
[0m23:41:34.603141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_bookings, now model.dbt_dwh.stg_flights)
[0m23:41:34.604238 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_flights
[0m23:41:34.613562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m23:41:34.614888 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: BEGIN
[0m23:41:34.616934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:34.672954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m23:41:34.674327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m23:41:34.674327 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.715642 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.039 seconds
[0m23:41:34.725822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m23:41:34.727172 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.733729 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m23:41:34.757330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_flights"
[0m23:41:34.760607 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_flights
[0m23:41:34.767283 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_flights"
[0m23:41:34.770446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m23:41:34.770446 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    flight_pk,
    flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:34.794675 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m23:41:34.799937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m23:41:34.800989 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m23:41:34.804453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:41:34.806984 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m23:41:34.808059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m23:41:34.809577 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m23:41:34.815741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:41:34.820325 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup"
[0m23:41:34.822324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m23:41:34.823323 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup" cascade
[0m23:41:34.827333 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m23:41:34.832967 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: Close
[0m23:41:34.835485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E1B8620>]}
[0m23:41:34.837926 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_flights ......... [[32mCREATE VIEW[0m in 0.23s]
[0m23:41:34.840615 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_flights
[0m23:41:34.841702 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_seats
[0m23:41:34.842878 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.stg_seats ................ [RUN]
[0m23:41:34.844557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_flights, now model.dbt_dwh.stg_seats)
[0m23:41:34.846226 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_seats
[0m23:41:34.857255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m23:41:34.859276 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: BEGIN
[0m23:41:34.860972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:34.910701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m23:41:34.912375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m23:41:34.914090 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.950220 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.035 seconds
[0m23:41:34.961644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m23:41:34.963839 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:34.970639 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:41:34.978961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_seats"
[0m23:41:34.982709 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_seats
[0m23:41:34.990307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_seats"
[0m23:41:34.992904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m23:41:34.993916 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_seats"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'SEATS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS seat_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS seat_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    seat_pk,
    seat_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:35.015780 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m23:41:35.021730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m23:41:35.023743 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m23:41:35.027588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:41:35.030991 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m23:41:35.032005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m23:41:35.033022 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m23:41:35.053931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m23:41:35.057370 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup"
[0m23:41:35.060034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m23:41:35.060034 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup" cascade
[0m23:41:35.063204 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:41:35.067070 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: Close
[0m23:41:35.069072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E24C170>]}
[0m23:41:35.070200 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_seats ........... [[32mCREATE VIEW[0m in 0.22s]
[0m23:41:35.071431 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_seats
[0m23:41:35.072733 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m23:41:35.074193 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.stg_ticket_flights ....... [RUN]
[0m23:41:35.076239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_seats, now model.dbt_dwh.stg_ticket_flights)
[0m23:41:35.078243 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_ticket_flights
[0m23:41:35.090791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.091887 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: BEGIN
[0m23:41:35.093105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:35.145752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m23:41:35.146802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.147335 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:35.185625 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.038 seconds
[0m23:41:35.199116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.201157 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:35.208568 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m23:41:35.224100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.228251 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_ticket_flights
[0m23:41:35.233920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.237115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.238217 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'TICKET_FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    ticket_flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:35.257654 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m23:41:35.264887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.266725 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m23:41:35.270079 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m23:41:35.272822 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m23:41:35.273903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.275015 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m23:41:35.280840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:41:35.284128 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m23:41:35.286677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m23:41:35.287793 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m23:41:35.294117 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m23:41:35.297478 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: Close
[0m23:41:35.299160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01E195160>]}
[0m23:41:35.301411 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_ticket_flights .. [[32mCREATE VIEW[0m in 0.22s]
[0m23:41:35.304834 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m23:41:35.305960 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_tickets
[0m23:41:35.307744 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.stg_tickets .............. [RUN]
[0m23:41:35.310161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_ticket_flights, now model.dbt_dwh.stg_tickets)
[0m23:41:35.311433 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_tickets
[0m23:41:35.323583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m23:41:35.325326 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: BEGIN
[0m23:41:35.326993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:41:35.379373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m23:41:35.381008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m23:41:35.382123 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:35.417544 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.034 seconds
[0m23:41:35.427217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m23:41:35.428320 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:41:35.435128 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m23:41:35.449829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_tickets"
[0m23:41:35.452468 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_tickets
[0m23:41:35.460833 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_tickets"
[0m23:41:35.463885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m23:41:35.468547 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'TICKETS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS ticket_pk,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_fk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    ticket_pk,
    booking_fk,
    ticket_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m23:41:35.490464 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m23:41:35.497664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m23:41:35.498812 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m23:41:35.502583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m23:41:35.504659 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m23:41:35.504659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m23:41:35.506784 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m23:41:35.513080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:41:35.518124 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup"
[0m23:41:35.519649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m23:41:35.520665 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m23:41:35.524358 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m23:41:35.527365 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: Close
[0m23:41:35.528985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2f2d6b1-b89f-4464-86d9-349335333cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01C6984A0>]}
[0m23:41:35.531202 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_tickets ......... [[32mCREATE VIEW[0m in 0.22s]
[0m23:41:35.533435 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_tickets
[0m23:41:35.536219 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.536814 [debug] [MainThread]: On master: BEGIN
[0m23:41:35.538016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:41:35.591388 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m23:41:35.592485 [debug] [MainThread]: On master: COMMIT
[0m23:41:35.593588 [debug] [MainThread]: Using postgres connection "master"
[0m23:41:35.594717 [debug] [MainThread]: On master: COMMIT
[0m23:41:35.598111 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:41:35.599198 [debug] [MainThread]: On master: Close
[0m23:41:35.600290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:35.600841 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:41:35.601961 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:41:35.602603 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_tickets' was properly closed.
[0m23:41:35.603158 [info ] [MainThread]: 
[0m23:41:35.604176 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m23:41:35.607731 [debug] [MainThread]: Command end result
[0m23:41:35.670027 [info ] [MainThread]: 
[0m23:41:35.672105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:35.674106 [info ] [MainThread]: 
[0m23:41:35.675617 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m23:41:35.679594 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:35.679594 after 5.30 seconds
[0m23:41:35.680635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01C30B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01B1AD2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A01D7A7E90>]}
[0m23:41:35.682926 [debug] [MainThread]: Flushing usage events
[0m23:42:41.455802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C52D8EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C46396A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C825AF60>]}


============================== 23:42:41.465022 | 1afe170e-3c77-45b8-b390-d4034334cd02 ==============================
[0m23:42:41.465022 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:42:41.467020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:hub', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:42:41.856876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C8587590>]}
[0m23:42:41.968690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C834C6E0>]}
[0m23:42:41.971169 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:42:42.274356 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:42:42.658955 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:42:42.660472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:42:42.709141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C8739460>]}
[0m23:42:42.897362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C9A749B0>]}
[0m23:42:42.899621 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:42:42.901233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C87F7A10>]}
[0m23:42:42.904528 [info ] [MainThread]: 
[0m23:42:42.906200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:42:42.915959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:42:43.495257 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:42:43.496679 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:42:43.498472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:43.560385 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.062 seconds
[0m23:42:43.562733 [debug] [ThreadPool]: On list_postgres: Close
[0m23:42:43.568796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m23:42:43.578367 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:42:43.578367 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:42:43.579366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:43.630988 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:42:43.632093 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:42:43.633245 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m23:42:43.653102 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.018 seconds
[0m23:42:43.656024 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m23:42:43.658832 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m23:42:43.671768 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:43.672769 [debug] [MainThread]: On master: BEGIN
[0m23:42:43.672769 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:42:43.720440 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m23:42:43.720950 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:43.722106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:42:43.772903 [debug] [MainThread]: SQL status: SELECT 16 in 0.050 seconds
[0m23:42:43.778484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C9F53050>]}
[0m23:42:43.779474 [debug] [MainThread]: On master: ROLLBACK
[0m23:42:43.782353 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:43.783446 [debug] [MainThread]: On master: BEGIN
[0m23:42:43.788509 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:42:43.789760 [debug] [MainThread]: On master: COMMIT
[0m23:42:43.790876 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:43.791889 [debug] [MainThread]: On master: COMMIT
[0m23:42:43.794272 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:42:43.795306 [debug] [MainThread]: On master: Close
[0m23:42:43.796308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:43.797829 [info ] [MainThread]: 
[0m23:42:43.808317 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m23:42:43.809373 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m23:42:43.810381 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m23:42:43.811853 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m23:42:43.855339 [info ] [Thread-1 (]: 23:42:43 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m23:42:43.936017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m23:42:43.939697 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m23:42:44.011705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m23:42:44.014472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:42:44.015473 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m23:42:44.015473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:42:44.060585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m23:42:44.061766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:42:44.062760 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:42:44.108493 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.045 seconds
[0m23:42:44.130667 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m23:42:44.131682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:42:44.131682 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m23:42:44.150608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m23:42:44.153730 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m23:42:44.158041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C5F60A40>]}
[0m23:42:44.159225 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mSELECT 0[0m in 0.34s]
[0m23:42:44.161750 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m23:42:44.162746 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m23:42:44.164746 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m23:42:44.167099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m23:42:44.169345 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m23:42:44.175483 [info ] [Thread-1 (]: 23:42:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m23:42:44.181620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m23:42:44.183765 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m23:42:44.190578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m23:42:44.195298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:42:44.196313 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m23:42:44.197327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:44.246984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m23:42:44.248656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:42:44.249228 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:42:44.288775 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.039 seconds
[0m23:42:44.291424 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m23:42:44.292426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:42:44.293754 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m23:42:44.312450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m23:42:44.313694 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m23:42:44.315804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CA2079B0>]}
[0m23:42:44.317321 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mSELECT 1[0m in 0.15s]
[0m23:42:44.320274 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m23:42:44.321322 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m23:42:44.321322 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m23:42:44.323833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m23:42:44.324921 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m23:42:44.331468 [info ] [Thread-1 (]: 23:42:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m23:42:44.337389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m23:42:44.339918 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m23:42:44.345785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m23:42:44.348069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:42:44.349167 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m23:42:44.350268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:44.399059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m23:42:44.399059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:42:44.400582 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:42:44.443903 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m23:42:44.446712 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m23:42:44.448064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:42:44.448758 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m23:42:44.455800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:42:44.458580 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m23:42:44.459991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CA18BC80>]}
[0m23:42:44.462517 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mSELECT 0[0m in 0.14s]
[0m23:42:44.464719 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m23:42:44.465890 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m23:42:44.467545 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m23:42:44.469770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m23:42:44.470875 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m23:42:44.477296 [info ] [Thread-1 (]: 23:42:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m23:42:44.482048 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m23:42:44.484250 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m23:42:44.489422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m23:42:44.491945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:42:44.491945 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m23:42:44.494159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:44.540867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:42:44.541881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:42:44.543542 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:42:44.587731 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m23:42:44.590086 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m23:42:44.590615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:42:44.591738 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m23:42:44.604334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m23:42:44.605335 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m23:42:44.606860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CA263470>]}
[0m23:42:44.609225 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mSELECT 0[0m in 0.14s]
[0m23:42:44.611619 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m23:42:44.613337 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m23:42:44.615019 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m23:42:44.617635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m23:42:44.618796 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m23:42:44.625458 [info ] [Thread-1 (]: 23:42:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m23:42:44.631539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m23:42:44.634535 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m23:42:44.643390 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m23:42:44.645565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m23:42:44.646671 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m23:42:44.647226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:44.694763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m23:42:44.695864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m23:42:44.696918 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, seat_no) rr.aircraft_code, seat_no, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code, seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, seat_no, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:42:44.700465 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                   ^

[0m23:42:44.701487 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: ROLLBACK
[0m23:42:44.703889 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m23:42:44.727397 [debug] [Thread-1 (]: Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m23:42:44.729106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C9AA5340>]}
[0m23:42:44.729645 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.11s]
[0m23:42:44.732276 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m23:42:44.732833 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m23:42:44.735684 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m23:42:44.738093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m23:42:44.739199 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m23:42:44.747426 [info ] [Thread-1 (]: 23:42:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m23:42:44.751642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m23:42:44.754139 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m23:42:44.758933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m23:42:44.761463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:42:44.762466 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m23:42:44.763548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:44.810687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:42:44.811770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:42:44.812764 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_tickets"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:42:44.858976 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.045 seconds
[0m23:42:44.862581 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m23:42:44.863576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:42:44.865577 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m23:42:44.873742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:42:44.874754 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m23:42:44.875760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1afe170e-3c77-45b8-b390-d4034334cd02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201CA265D30>]}
[0m23:42:44.878293 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mSELECT 0[0m in 0.14s]
[0m23:42:44.880294 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m23:42:44.883834 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:44.884836 [debug] [MainThread]: On master: BEGIN
[0m23:42:44.885835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:42:44.931680 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m23:42:44.933672 [debug] [MainThread]: On master: COMMIT
[0m23:42:44.933672 [debug] [MainThread]: Using postgres connection "master"
[0m23:42:44.936914 [debug] [MainThread]: On master: COMMIT
[0m23:42:44.942465 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m23:42:44.943852 [debug] [MainThread]: On master: Close
[0m23:42:44.946262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:44.948408 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:42:44.949563 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:42:44.950653 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m23:42:44.952303 [info ] [MainThread]: 
[0m23:42:44.954133 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m23:42:44.957313 [debug] [MainThread]: Command end result
[0m23:42:45.117014 [info ] [MainThread]: 
[0m23:42:45.118820 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:42:45.120814 [info ] [MainThread]: 
[0m23:42:45.123034 [error] [MainThread]:   Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m23:42:45.125053 [info ] [MainThread]: 
[0m23:42:45.127052 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:42:45.129653 [debug] [MainThread]: Command `dbt run` failed at 23:42:45.129063 after 3.97 seconds
[0m23:42:45.130677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C838B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C845F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C845C590>]}
[0m23:42:45.132493 [debug] [MainThread]: Flushing usage events
[0m23:43:50.299586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A062300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A062BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A0CED80>]}


============================== 23:43:50.306854 | d4c493f9-dade-4961-8ffd-590d969d068e ==============================
[0m23:43:50.306854 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:43:50.309383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:hub', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:43:50.730860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A3AC410>]}
[0m23:43:50.843206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005966A060>]}
[0m23:43:50.846513 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:43:51.206962 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:43:51.643766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:51.644331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:51.691606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A669250>]}
[0m23:43:51.890896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005BA73B00>]}
[0m23:43:51.893079 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:43:51.894744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A5B9940>]}
[0m23:43:51.898071 [info ] [MainThread]: 
[0m23:43:51.900461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:43:51.907469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:43:52.458713 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:43:52.460084 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:43:52.461722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:52.523629 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.061 seconds
[0m23:43:52.525905 [debug] [ThreadPool]: On list_postgres: Close
[0m23:43:52.532061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m23:43:52.541499 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:43:52.543285 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:43:52.543285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:52.595043 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m23:43:52.596166 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:43:52.598008 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m23:43:52.613469 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.014 seconds
[0m23:43:52.615673 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m23:43:52.618567 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m23:43:52.632784 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:52.633918 [debug] [MainThread]: On master: BEGIN
[0m23:43:52.635057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:43:52.684757 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m23:43:52.685758 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:52.686757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:43:52.744731 [debug] [MainThread]: SQL status: SELECT 16 in 0.057 seconds
[0m23:43:52.750248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A4A0680>]}
[0m23:43:52.751640 [debug] [MainThread]: On master: ROLLBACK
[0m23:43:52.756420 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:52.757520 [debug] [MainThread]: On master: BEGIN
[0m23:43:52.762449 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:43:52.763644 [debug] [MainThread]: On master: COMMIT
[0m23:43:52.764666 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:52.765440 [debug] [MainThread]: On master: COMMIT
[0m23:43:52.768404 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:43:52.769498 [debug] [MainThread]: On master: Close
[0m23:43:52.770604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:43:52.772824 [info ] [MainThread]: 
[0m23:43:52.781638 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m23:43:52.784189 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m23:43:52.787186 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m23:43:52.788182 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m23:43:52.839045 [info ] [Thread-1 (]: 23:43:52 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m23:43:52.924576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m23:43:52.927311 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m23:43:52.998137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:43:52.999503 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp234352964314"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:43:53.000614 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:43:53.082510 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.082 seconds
[0m23:43:53.101697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:43:53.102731 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m23:43:53.105752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:43:53.106753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:43:53.108262 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp234352964314'
        
      order by ordinal_position

  
[0m23:43:53.140904 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.031 seconds
[0m23:43:53.148414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:43:53.149422 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.155653 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:43:53.166018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:43:53.167176 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.172475 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:43:53.191466 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m23:43:53.193628 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:43:53.194233 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp234352964314"
    )


  
[0m23:43:53.199211 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m23:43:53.216461 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m23:43:53.218051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:43:53.219185 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m23:43:53.241373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m23:43:53.245112 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m23:43:53.248783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020059B9ABA0>]}
[0m23:43:53.250408 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mINSERT 0 0[0m in 0.46s]
[0m23:43:53.253318 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m23:43:53.254536 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m23:43:53.256193 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m23:43:53.258499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m23:43:53.259592 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m23:43:53.268622 [info ] [Thread-1 (]: 23:43:53 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m23:43:53.278917 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m23:43:53.281605 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m23:43:53.288614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:43:53.289615 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp234353285616"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:43:53.290831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:53.372316 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.081 seconds
[0m23:43:53.378011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:43:53.379141 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m23:43:53.381794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:43:53.382300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:43:53.383313 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp234353285616'
        
      order by ordinal_position

  
[0m23:43:53.421360 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.037 seconds
[0m23:43:53.427217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:43:53.427217 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.434048 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m23:43:53.439165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:43:53.440240 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.445159 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m23:43:53.447138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m23:43:53.450171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:43:53.450737 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp234353285616"
    )


  
[0m23:43:53.456276 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m23:43:53.459283 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m23:43:53.460310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:43:53.460310 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m23:43:53.468495 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:43:53.470839 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m23:43:53.472368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005C1F09E0>]}
[0m23:43:53.473769 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mINSERT 0 0[0m in 0.21s]
[0m23:43:53.476768 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m23:43:53.476768 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m23:43:53.478630 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m23:43:53.482097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m23:43:53.484116 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m23:43:53.491362 [info ] [Thread-1 (]: 23:43:53 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m23:43:53.501203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m23:43:53.503729 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m23:43:53.512597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:43:53.514101 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp234353508242"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:43:53.514101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:53.605250 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.090 seconds
[0m23:43:53.609682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:43:53.610879 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m23:43:53.613632 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:43:53.614714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:43:53.615258 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp234353508242'
        
      order by ordinal_position

  
[0m23:43:53.650270 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.034 seconds
[0m23:43:53.654600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:43:53.656237 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.662975 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:43:53.669050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:43:53.670035 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.675734 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m23:43:53.678247 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m23:43:53.680746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:43:53.681745 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp234353508242"
    )


  
[0m23:43:53.686858 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m23:43:53.688373 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m23:43:53.690155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:43:53.690723 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m23:43:53.698961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:43:53.700740 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m23:43:53.702278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005C2087A0>]}
[0m23:43:53.703375 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mINSERT 0 0[0m in 0.22s]
[0m23:43:53.705870 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m23:43:53.706867 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m23:43:53.708382 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m23:43:53.710750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m23:43:53.711844 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m23:43:53.718004 [info ] [Thread-1 (]: 23:43:53 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m23:43:53.723127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m23:43:53.725254 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m23:43:53.740483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:43:53.742423 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp234353730790"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:43:53.743441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:53.839657 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.095 seconds
[0m23:43:53.936978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:43:53.938074 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m23:43:53.940838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:43:53.941371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:43:53.942761 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp234353730790'
        
      order by ordinal_position

  
[0m23:43:53.972964 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.028 seconds
[0m23:43:53.976966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:43:53.978475 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.984590 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:43:53.989413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:43:53.990642 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:53.997643 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:43:54.000373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m23:43:54.002493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:43:54.003607 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp234353730790"
    )


  
[0m23:43:54.007770 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m23:43:54.010926 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m23:43:54.011450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:43:54.012056 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m23:43:54.029856 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m23:43:54.031462 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m23:43:54.033187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005C2771A0>]}
[0m23:43:54.034982 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mINSERT 0 0[0m in 0.32s]
[0m23:43:54.036741 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m23:43:54.038349 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m23:43:54.039465 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m23:43:54.040523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m23:43:54.042043 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m23:43:54.049687 [info ] [Thread-1 (]: 23:43:54 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m23:43:54.055114 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m23:43:54.057932 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m23:43:54.068291 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m23:43:54.070311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m23:43:54.070866 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m23:43:54.071875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:54.119432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m23:43:54.120536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m23:43:54.121635 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, seat_no) rr.aircraft_code, seat_no, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code, seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, seat_no, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:43:54.124642 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                   ^

[0m23:43:54.125641 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: ROLLBACK
[0m23:43:54.131536 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m23:43:54.147437 [debug] [Thread-1 (]: Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m23:43:54.149795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005B8BF620>]}
[0m23:43:54.150906 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.11s]
[0m23:43:54.151917 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m23:43:54.153146 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m23:43:54.155147 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m23:43:54.157716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m23:43:54.158717 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m23:43:54.165785 [info ] [Thread-1 (]: 23:43:54 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m23:43:54.171695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m23:43:54.173903 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m23:43:54.184901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:43:54.186906 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp234354181894"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:43:54.187903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:43:54.284372 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.096 seconds
[0m23:43:54.289307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:43:54.290623 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m23:43:54.294504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m23:43:54.296198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:43:54.298495 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp234354181894'
        
      order by ordinal_position

  
[0m23:43:54.334007 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.034 seconds
[0m23:43:54.339085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:43:54.340180 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:54.346481 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:43:54.354590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:43:54.355695 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:43:54.361451 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:43:54.364302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m23:43:54.366312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:43:54.368130 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp234354181894"
    )


  
[0m23:43:54.374328 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m23:43:54.378250 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m23:43:54.379353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:43:54.380567 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m23:43:54.406420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m23:43:54.408785 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m23:43:54.410904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c493f9-dade-4961-8ffd-590d969d068e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A59B6E0>]}
[0m23:43:54.413957 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mINSERT 0 0[0m in 0.25s]
[0m23:43:54.416135 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m23:43:54.418321 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:54.420132 [debug] [MainThread]: On master: BEGIN
[0m23:43:54.421242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:43:54.472291 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m23:43:54.473492 [debug] [MainThread]: On master: COMMIT
[0m23:43:54.474095 [debug] [MainThread]: Using postgres connection "master"
[0m23:43:54.474676 [debug] [MainThread]: On master: COMMIT
[0m23:43:54.477413 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:43:54.478494 [debug] [MainThread]: On master: Close
[0m23:43:54.479596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:43:54.480687 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:43:54.481255 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:43:54.482919 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m23:43:54.484193 [info ] [MainThread]: 
[0m23:43:54.485367 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m23:43:54.487369 [debug] [MainThread]: Command end result
[0m23:43:54.569364 [info ] [MainThread]: 
[0m23:43:54.571815 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:43:54.573934 [info ] [MainThread]: 
[0m23:43:54.576404 [error] [MainThread]:   Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m23:43:54.579530 [info ] [MainThread]: 
[0m23:43:54.580547 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:43:54.583221 [debug] [MainThread]: Command `dbt run` failed at 23:43:54.582713 after 4.57 seconds
[0m23:43:54.583770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020054286B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005A30E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002005C2026F0>]}
[0m23:43:54.584329 [debug] [MainThread]: Flushing usage events
[0m23:44:18.523240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FC103320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FEBE45F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FEA0E300>]}


============================== 23:44:18.530755 | 3ea71cc9-6532-4e6e-83ab-514c143c0eb1 ==============================
[0m23:44:18.530755 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:44:18.533270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:hub', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:44:18.910804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF5A3FE0>]}
[0m23:44:19.019827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FEB1A5A0>]}
[0m23:44:19.022331 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:44:19.329032 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:44:19.767600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:19.768705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:19.813557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF9D1490>]}
[0m23:44:20.004738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FFB93DD0>]}
[0m23:44:20.005862 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:44:20.006959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FFCFB740>]}
[0m23:44:20.010192 [info ] [MainThread]: 
[0m23:44:20.012394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:44:20.018518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:44:20.595205 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:44:20.596320 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:44:20.596869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:20.687683 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.091 seconds
[0m23:44:20.690857 [debug] [ThreadPool]: On list_postgres: Close
[0m23:44:20.698031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m23:44:20.711262 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:44:20.712342 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:44:20.712910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:44:20.762124 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m23:44:20.763329 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:44:20.763866 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m23:44:20.779418 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.015 seconds
[0m23:44:20.782676 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m23:44:20.784698 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m23:44:20.801961 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:20.802531 [debug] [MainThread]: On master: BEGIN
[0m23:44:20.803589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:20.853818 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m23:44:20.854976 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:20.855530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:44:20.914382 [debug] [MainThread]: SQL status: SELECT 16 in 0.059 seconds
[0m23:44:20.918045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF8A56D0>]}
[0m23:44:20.920018 [debug] [MainThread]: On master: ROLLBACK
[0m23:44:20.922558 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:20.923562 [debug] [MainThread]: On master: BEGIN
[0m23:44:20.927556 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:44:20.928562 [debug] [MainThread]: On master: COMMIT
[0m23:44:20.929860 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:20.931114 [debug] [MainThread]: On master: COMMIT
[0m23:44:20.933535 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:44:20.934661 [debug] [MainThread]: On master: Close
[0m23:44:20.936891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:44:20.940010 [info ] [MainThread]: 
[0m23:44:20.949200 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m23:44:20.951752 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m23:44:20.954019 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m23:44:20.955097 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m23:44:20.997838 [info ] [Thread-1 (]: 23:44:20 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m23:44:21.100568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.102210 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m23:44:21.169980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.171039 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp234421137813"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:44:21.172126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:44:21.256018 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.084 seconds
[0m23:44:21.278211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.279378 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m23:44:21.283379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m23:44:21.285037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.285608 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp234421137813'
        
      order by ordinal_position

  
[0m23:44:21.318247 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.031 seconds
[0m23:44:21.325922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.326944 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:21.333388 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:44:21.345080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.346248 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:21.352529 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:44:21.382921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.385666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.387499 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp234421137813"
    )


  
[0m23:44:21.394808 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m23:44:21.420780 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m23:44:21.422352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m23:44:21.423370 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m23:44:21.430957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:44:21.436789 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m23:44:21.440170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FCF80A10>]}
[0m23:44:21.442409 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mINSERT 0 0[0m in 0.49s]
[0m23:44:21.444713 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m23:44:21.445803 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m23:44:21.447431 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m23:44:21.449670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m23:44:21.450217 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m23:44:21.458059 [info ] [Thread-1 (]: 23:44:21 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m23:44:21.463668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m23:44:21.466392 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m23:44:21.473859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:44:21.475061 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp234421471377"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:44:21.475061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:21.564944 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.090 seconds
[0m23:44:21.572109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:44:21.573553 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m23:44:21.576900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:44:21.578618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:44:21.580304 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp234421471377'
        
      order by ordinal_position

  
[0m23:44:21.612926 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.031 seconds
[0m23:44:21.619671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:44:21.620239 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:21.626286 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:44:21.631241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:44:21.632319 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:21.637918 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m23:44:21.641195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m23:44:21.643446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:44:21.644633 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp234421471377"
    )


  
[0m23:44:21.648912 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m23:44:21.651833 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m23:44:21.652910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m23:44:21.654083 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m23:44:21.661475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:44:21.664785 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m23:44:21.666286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D181513A40>]}
[0m23:44:21.669079 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mINSERT 0 0[0m in 0.22s]
[0m23:44:21.671387 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m23:44:21.672381 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m23:44:21.673471 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m23:44:21.675185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m23:44:21.676831 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m23:44:21.685502 [info ] [Thread-1 (]: 23:44:21 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m23:44:21.695816 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m23:44:21.697818 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m23:44:21.708348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:44:21.710389 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp234421704119"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:44:21.712494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:21.812978 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.100 seconds
[0m23:44:21.818610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:44:21.819772 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m23:44:21.822043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:44:21.823330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:44:21.824366 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp234421704119'
        
      order by ordinal_position

  
[0m23:44:21.852054 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.028 seconds
[0m23:44:21.857100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:44:21.858103 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:21.864384 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:44:21.869737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:44:21.870981 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:21.877104 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m23:44:21.880678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m23:44:21.883209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:44:21.884216 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp234421704119"
    )


  
[0m23:44:21.888365 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m23:44:21.891382 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m23:44:21.892408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m23:44:21.893576 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m23:44:21.900806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:44:21.902907 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m23:44:21.904608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1814595B0>]}
[0m23:44:21.907060 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mINSERT 0 0[0m in 0.23s]
[0m23:44:21.908724 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m23:44:21.909826 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m23:44:21.911769 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m23:44:21.914019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m23:44:21.914572 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m23:44:21.923086 [info ] [Thread-1 (]: 23:44:21 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m23:44:21.928482 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m23:44:21.931774 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m23:44:21.942882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:44:21.943896 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp234421935718"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:44:21.944910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:22.027709 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.083 seconds
[0m23:44:22.131071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:44:22.132144 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m23:44:22.134905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:44:22.135987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:44:22.136545 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp234421935718'
        
      order by ordinal_position

  
[0m23:44:22.177309 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.040 seconds
[0m23:44:22.182360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:44:22.183448 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:22.189789 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:44:22.196148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:44:22.198412 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:22.204587 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m23:44:22.207452 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m23:44:22.210245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:44:22.211345 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp234421935718"
    )


  
[0m23:44:22.216522 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m23:44:22.219781 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m23:44:22.220874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m23:44:22.220874 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m23:44:22.227254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m23:44:22.229350 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m23:44:22.231083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D181502360>]}
[0m23:44:22.233292 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mINSERT 0 0[0m in 0.32s]
[0m23:44:22.235556 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m23:44:22.236097 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m23:44:22.237184 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m23:44:22.242212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m23:44:22.242773 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m23:44:22.251641 [info ] [Thread-1 (]: 23:44:22 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m23:44:22.256653 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m23:44:22.259959 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m23:44:22.268303 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m23:44:22.271916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m23:44:22.273596 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m23:44:22.275283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:22.323668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m23:44:22.324260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m23:44:22.325390 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, seat_no) rr.aircraft_code, seat_no, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code, seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, seat_no, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:44:22.328894 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                   ^

[0m23:44:22.330066 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: ROLLBACK
[0m23:44:22.332154 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m23:44:22.347865 [debug] [Thread-1 (]: Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m23:44:22.348864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1814F06E0>]}
[0m23:44:22.350385 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.11s]
[0m23:44:22.352150 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m23:44:22.353165 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m23:44:22.355185 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m23:44:22.358180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m23:44:22.359690 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m23:44:22.367254 [info ] [Thread-1 (]: 23:44:22 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m23:44:22.374735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m23:44:22.376981 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m23:44:22.389188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:44:22.391295 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp234422386009"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m23:44:22.392410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:44:22.479213 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.087 seconds
[0m23:44:22.485127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:44:22.485690 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m23:44:22.488515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m23:44:22.490178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:44:22.490732 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp234422386009'
        
      order by ordinal_position

  
[0m23:44:22.526816 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.035 seconds
[0m23:44:22.530809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:44:22.532344 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:22.538189 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m23:44:22.544317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:44:22.545313 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m23:44:22.551112 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m23:44:22.554526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m23:44:22.556381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:44:22.556958 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp234422386009"
    )


  
[0m23:44:22.561381 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m23:44:22.564371 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m23:44:22.565399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m23:44:22.566393 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m23:44:22.581354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m23:44:22.584112 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m23:44:22.585923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ea71cc9-6532-4e6e-83ab-514c143c0eb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D181435190>]}
[0m23:44:22.588229 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mINSERT 0 0[0m in 0.23s]
[0m23:44:22.590985 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m23:44:22.594281 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:22.595401 [debug] [MainThread]: On master: BEGIN
[0m23:44:22.596519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:44:22.642417 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m23:44:22.643726 [debug] [MainThread]: On master: COMMIT
[0m23:44:22.644801 [debug] [MainThread]: Using postgres connection "master"
[0m23:44:22.645957 [debug] [MainThread]: On master: COMMIT
[0m23:44:22.649303 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:44:22.650310 [debug] [MainThread]: On master: Close
[0m23:44:22.651430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:22.653477 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:44:22.654582 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:44:22.656251 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m23:44:22.657351 [info ] [MainThread]: 
[0m23:44:22.659553 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m23:44:22.661811 [debug] [MainThread]: Command end result
[0m23:44:22.723360 [info ] [MainThread]: 
[0m23:44:22.725440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:44:22.726957 [info ] [MainThread]: 
[0m23:44:22.728011 [error] [MainThread]:   Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m23:44:22.730015 [info ] [MainThread]: 
[0m23:44:22.731145 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:44:22.733680 [debug] [MainThread]: Command `dbt run` failed at 23:44:22.733680 after 4.45 seconds
[0m23:44:22.734695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FF431760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FFB44A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1FC103320>]}
[0m23:44:22.735695 [debug] [MainThread]: Flushing usage events
[0m23:44:56.045924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689B03380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689B02900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689B03D10>]}


============================== 23:44:56.052691 | bd0bed69-9178-48f0-a2d5-f3a603524bfe ==============================
[0m23:44:56.052691 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:44:56.055238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:link', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:44:56.417687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd0bed69-9178-48f0-a2d5-f3a603524bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689CB7590>]}
[0m23:44:56.529469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd0bed69-9178-48f0-a2d5-f3a603524bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689E063C0>]}
[0m23:44:56.533007 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:44:56.857839 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:44:57.208815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:44:57.208815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:44:57.252919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd0bed69-9178-48f0-a2d5-f3a603524bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689F540B0>]}
[0m23:44:57.438362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd0bed69-9178-48f0-a2d5-f3a603524bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B2047D0>]}
[0m23:44:57.439809 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:44:57.441838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd0bed69-9178-48f0-a2d5-f3a603524bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689EBE900>]}
[0m23:44:57.442839 [warn ] [MainThread]: The selection criterion 'tag:link' does not match any enabled nodes
[0m23:44:57.446337 [info ] [MainThread]: 
[0m23:44:57.448758 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:44:57.452755 [debug] [MainThread]: Command end result
[0m23:44:57.512951 [debug] [MainThread]: Command `dbt run` succeeded at 23:44:57.512951 after 1.75 seconds
[0m23:44:57.515616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025689BF6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568B2BA4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002568977C200>]}
[0m23:44:57.516617 [debug] [MainThread]: Flushing usage events
[0m23:47:15.450258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F04F8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F11D3D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F11D38F0>]}


============================== 23:47:15.457957 | 7c1e74cf-931b-44bb-8a20-ff0265a23bc0 ==============================
[0m23:47:15.457957 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:47:15.458935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:satellite', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:47:15.854891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1677680>]}
[0m23:47:15.953773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F11D16A0>]}
[0m23:47:15.957074 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:47:16.246646 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:47:16.610829 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:16.610829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:16.654346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F2935CA0>]}
[0m23:47:16.826889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F2A7BB90>]}
[0m23:47:16.827883 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:47:16.829900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F28EEA50>]}
[0m23:47:16.834675 [info ] [MainThread]: 
[0m23:47:16.837014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:16.844803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:47:17.359414 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:47:17.360678 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:47:17.361220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:17.427631 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.066 seconds
[0m23:47:17.430036 [debug] [ThreadPool]: On list_postgres: Close
[0m23:47:17.438139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m23:47:17.449186 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:47:17.450646 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:47:17.450646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:17.495632 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m23:47:17.498094 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:47:17.499095 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m23:47:17.514858 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.015 seconds
[0m23:47:17.517647 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m23:47:17.520419 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m23:47:17.533743 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:17.534894 [debug] [MainThread]: On master: BEGIN
[0m23:47:17.535425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:47:17.580069 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m23:47:17.580618 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:17.581646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:47:17.637043 [debug] [MainThread]: SQL status: SELECT 16 in 0.054 seconds
[0m23:47:17.644668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EF0B5BB0>]}
[0m23:47:17.645218 [debug] [MainThread]: On master: ROLLBACK
[0m23:47:17.648807 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:17.649876 [debug] [MainThread]: On master: BEGIN
[0m23:47:17.653425 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:47:17.654692 [debug] [MainThread]: On master: COMMIT
[0m23:47:17.655705 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:17.657121 [debug] [MainThread]: On master: COMMIT
[0m23:47:17.659161 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:47:17.660157 [debug] [MainThread]: On master: Close
[0m23:47:17.662164 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:47:17.664183 [info ] [MainThread]: 
[0m23:47:17.672397 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m23:47:17.674078 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m23:47:17.675688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m23:47:17.676222 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m23:47:17.707272 [debug] [Thread-1 (]: Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.709268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F0D4AE40>]}
[0m23:47:17.710266 [error] [Thread-1 (]: 1 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.03s]
[0m23:47:17.713577 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m23:47:17.714647 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m23:47:17.716169 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m23:47:17.718485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m23:47:17.718485 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m23:47:17.729918 [debug] [Thread-1 (]: Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.731619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F3345EB0>]}
[0m23:47:17.733527 [error] [Thread-1 (]: 2 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.01s]
[0m23:47:17.735231 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m23:47:17.736985 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m23:47:17.738726 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m23:47:17.741229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m23:47:17.742346 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m23:47:17.751587 [debug] [Thread-1 (]: Compilation Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.753738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F3251C40>]}
[0m23:47:17.755385 [error] [Thread-1 (]: 3 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.01s]
[0m23:47:17.756482 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m23:47:17.758884 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m23:47:17.759880 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m23:47:17.762390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m23:47:17.762390 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m23:47:17.770939 [debug] [Thread-1 (]: Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.772453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F333C830>]}
[0m23:47:17.775037 [error] [Thread-1 (]: 4 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.01s]
[0m23:47:17.777329 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m23:47:17.779010 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m23:47:17.780090 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m23:47:17.782934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m23:47:17.785169 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m23:47:17.794531 [debug] [Thread-1 (]: Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.795546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F32D5850>]}
[0m23:47:17.796068 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.01s]
[0m23:47:17.798684 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m23:47:17.799872 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m23:47:17.803178 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m23:47:17.805704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m23:47:17.807147 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m23:47:17.815692 [debug] [Thread-1 (]: Compilation Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.816730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F32B23F0>]}
[0m23:47:17.817733 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.01s]
[0m23:47:17.819730 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m23:47:17.820728 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m23:47:17.822240 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m23:47:17.824806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m23:47:17.825803 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m23:47:17.836080 [debug] [Thread-1 (]: Compilation Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.837762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F3364AD0>]}
[0m23:47:17.838847 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.01s]
[0m23:47:17.839965 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m23:47:17.841063 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m23:47:17.842780 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m23:47:17.845113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m23:47:17.846835 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m23:47:17.855033 [debug] [Thread-1 (]: Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:17.856674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c1e74cf-931b-44bb-8a20-ff0265a23bc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F337FF80>]}
[0m23:47:17.857795 [error] [Thread-1 (]: 8 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.01s]
[0m23:47:17.860219 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m23:47:17.862952 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:17.863498 [debug] [MainThread]: On master: BEGIN
[0m23:47:17.864059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:47:17.926829 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m23:47:17.927822 [debug] [MainThread]: On master: COMMIT
[0m23:47:17.928830 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:17.929857 [debug] [MainThread]: On master: COMMIT
[0m23:47:17.932372 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:47:17.933510 [debug] [MainThread]: On master: Close
[0m23:47:17.934743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:47:17.936476 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:47:17.937543 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:47:17.938887 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m23:47:17.940073 [info ] [MainThread]: 
[0m23:47:17.941541 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m23:47:17.943651 [debug] [MainThread]: Command end result
[0m23:47:18.005807 [info ] [MainThread]: 
[0m23:47:18.007044 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m23:47:18.009170 [info ] [MainThread]: 
[0m23:47:18.010167 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.012173 [info ] [MainThread]: 
[0m23:47:18.014278 [error] [MainThread]:   Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.016777 [info ] [MainThread]: 
[0m23:47:18.019083 [error] [MainThread]:   Compilation Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.020323 [info ] [MainThread]: 
[0m23:47:18.022562 [error] [MainThread]:   Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.024225 [info ] [MainThread]: 
[0m23:47:18.025653 [error] [MainThread]:   Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.027856 [info ] [MainThread]: 
[0m23:47:18.028978 [error] [MainThread]:   Compilation Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.030219 [info ] [MainThread]: 
[0m23:47:18.031293 [error] [MainThread]:   Compilation Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.033301 [info ] [MainThread]: 
[0m23:47:18.035470 [error] [MainThread]:   Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  'dict object' has no attribute 'satellite'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m23:47:18.036583 [info ] [MainThread]: 
[0m23:47:18.038214 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=0 TOTAL=8
[0m23:47:18.040995 [debug] [MainThread]: Command `dbt run` failed at 23:47:18.040995 after 2.95 seconds
[0m23:47:18.042085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255ED739640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F04C6C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1202630>]}
[0m23:47:18.043185 [debug] [MainThread]: Flushing usage events
[0m23:48:52.651519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F17A9A630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F182622A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F17801100>]}


============================== 23:48:52.658656 | dafeff17-c6f3-48e9-b928-951675a97eff ==============================
[0m23:48:52.658656 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:48:52.660811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:satellite', 'send_anonymous_usage_stats': 'True'}
[0m23:48:53.041443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dafeff17-c6f3-48e9-b928-951675a97eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F17FFAFF0>]}
[0m23:48:53.147446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dafeff17-c6f3-48e9-b928-951675a97eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F195FBBC0>]}
[0m23:48:53.152374 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:48:53.445408 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:48:53.991312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m23:48:53.992385 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m23:48:53.994082 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m23:48:53.994641 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m23:48:53.996002 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m23:48:53.997098 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m23:48:53.997623 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m23:48:53.998773 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m23:48:53.999906 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m23:48:54.315169 [error] [MainThread]: Encountered an error:
Compilation Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  macro 'dbt_macro__sat' takes no keyword argument 'src_nk'
[0m23:48:54.318247 [debug] [MainThread]: Command `dbt run` failed at 23:48:54.318247 after 2.01 seconds
[0m23:48:54.319416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F181DB770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F18380E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F197C2F60>]}
[0m23:48:54.319986 [debug] [MainThread]: Flushing usage events
[0m23:50:57.251712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B1090A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B104AAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B0E6D970>]}


============================== 23:50:57.258514 | 000d9761-b9fc-4376-ad82-af5eb601f95a ==============================
[0m23:50:57.258514 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:50:57.261082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:satellite', 'send_anonymous_usage_stats': 'True'}
[0m23:50:57.654913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '000d9761-b9fc-4376-ad82-af5eb601f95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B04B9A60>]}
[0m23:50:57.770798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '000d9761-b9fc-4376-ad82-af5eb601f95a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B0DA3860>]}
[0m23:50:57.773323 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:50:58.090478 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:50:58.617033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m23:50:58.618037 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m23:50:58.619036 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m23:50:58.620552 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m23:50:58.621563 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m23:50:58.621563 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m23:50:58.622555 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m23:50:58.623560 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m23:50:58.624557 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m23:50:58.976971 [error] [MainThread]: Encountered an error:
Compilation Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  macro 'dbt_macro__sat' takes no keyword argument 'columns'
[0m23:50:58.980039 [debug] [MainThread]: Command `dbt run` failed at 23:50:58.980039 after 2.10 seconds
[0m23:50:58.981079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B078EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B0D0E930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7B1395C70>]}
[0m23:50:58.982103 [debug] [MainThread]: Flushing usage events
[0m23:55:53.247157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298995521B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298996E4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029899893E00>]}


============================== 23:55:53.253684 | 3e5794db-cb62-489e-a29a-33dfb257963f ==============================
[0m23:55:53.253684 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:55:53.256200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:satellite', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:55:53.623624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e5794db-cb62-489e-a29a-33dfb257963f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298999F36B0>]}
[0m23:55:53.727243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e5794db-cb62-489e-a29a-33dfb257963f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298959DA930>]}
[0m23:55:53.729944 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:55:54.039514 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:55:54.500011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m23:55:54.501013 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m23:55:54.503772 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m23:55:54.504839 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m23:55:54.505392 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m23:55:54.506494 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m23:55:54.507581 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m23:55:54.508128 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m23:55:54.509210 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m23:55:54.864333 [error] [MainThread]: Encountered an error:
Compilation Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  unexpected '}'
    line 12
      -- } -%}
[0m23:55:54.868243 [debug] [MainThread]: Command `dbt run` failed at 23:55:54.868243 after 1.99 seconds
[0m23:55:54.869355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002989987A4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002989B4CF620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029899D31490>]}
[0m23:55:54.870490 [debug] [MainThread]: Flushing usage events
[0m23:57:25.008698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262AF85E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B3CF2AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B02192B0>]}


============================== 23:57:25.016638 | 3d6480ac-8fd8-4c56-b477-f8be04f9e4dc ==============================
[0m23:57:25.016638 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:57:25.019660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:satellite', 'send_anonymous_usage_stats': 'True'}
[0m23:57:25.424197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d6480ac-8fd8-4c56-b477-f8be04f9e4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B4163800>]}
[0m23:57:25.528990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d6480ac-8fd8-4c56-b477-f8be04f9e4dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B3F9EB10>]}
[0m23:57:25.531825 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:57:25.830875 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:57:26.289893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m23:57:26.290907 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m23:57:26.292276 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m23:57:26.293278 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m23:57:26.293278 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m23:57:26.295096 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m23:57:26.296799 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m23:57:26.297860 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m23:57:26.298904 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m23:57:26.590080 [error] [MainThread]: Encountered an error:
keyword argument repeated: src_ldts (<template>, line 28)
[0m23:57:26.599927 [error] [MainThread]: Traceback (most recent call last):
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\manifest.py", line 435, in load
    self.parse_project(
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\manifest.py", line 733, in parse_project
    parser.parse_file(block)
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\base.py", line 484, in parse_file
    self.parse_node(file_block)
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\base.py", line 445, in parse_node
    self.render_update(node, config)
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\models.py", line 348, in render_update
    super().render_update(node, config)
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\base.py", line 421, in render_update
    context = self.render_with_context(node, config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\parser\base.py", line 270, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt\clients\jinja.py", line 138, in get_rendered
    template = get_template(
               ^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt_common\clients\jinja.py", line 565, in get_template
    return env.from_string(template_source, globals=ctx)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\jinja2\environment.py", line 1108, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
                               ^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\jinja2\environment.py", line 766, in compile
    return self._compile(source, filename)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\dbt_common\clients\jinja.py", line 125, in _compile
    return super()._compile(source, filename)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\anaconda3\Lib\site-packages\jinja2\environment.py", line 706, in _compile
    return compile(source, filename, "exec")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 28
SyntaxError: keyword argument repeated: src_ldts

[0m23:57:26.605477 [debug] [MainThread]: Command `dbt run` failed at 23:57:26.605477 after 1.94 seconds
[0m23:57:26.606480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262ADA42C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B5B586E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262B3FB2060>]}
[0m23:57:26.607996 [debug] [MainThread]: Flushing usage events
[0m23:58:36.898537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50AE421B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50A2C69C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50AE72300>]}


============================== 23:58:36.906975 | f4fd695c-1ff2-41cf-8d51-b1a551fdac1b ==============================
[0m23:58:36.906975 [info ] [MainThread]: Running with dbt=1.8.9
[0m23:58:36.909542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:satellite', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:58:37.306161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50B2922D0>]}
[0m23:58:37.410262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50AE73DD0>]}
[0m23:58:37.412990 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:58:37.697777 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m23:58:38.129859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m23:58:38.131509 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m23:58:38.132608 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m23:58:38.133148 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m23:58:38.134157 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m23:58:38.135664 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m23:58:38.136673 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m23:58:38.137672 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m23:58:38.137672 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m23:58:38.764091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50B4BC140>]}
[0m23:58:39.017821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50B11C0E0>]}
[0m23:58:39.019328 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m23:58:39.021336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50CD72D50>]}
[0m23:58:39.025879 [info ] [MainThread]: 
[0m23:58:39.027880 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:39.037798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m23:58:39.535929 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m23:58:39.536933 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m23:58:39.538259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:39.596850 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.059 seconds
[0m23:58:39.599388 [debug] [ThreadPool]: On list_postgres: Close
[0m23:58:39.604671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m23:58:39.613227 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:58:39.614226 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m23:58:39.615741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:39.659065 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m23:58:39.660128 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m23:58:39.661241 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m23:58:39.677113 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.015 seconds
[0m23:58:39.679349 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m23:58:39.682131 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m23:58:39.699403 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:39.699927 [debug] [MainThread]: On master: BEGIN
[0m23:58:39.700935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:39.748620 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m23:58:39.749139 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:39.749139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:39.811035 [debug] [MainThread]: SQL status: SELECT 16 in 0.060 seconds
[0m23:58:39.815487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50CF99B20>]}
[0m23:58:39.817538 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:39.820436 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:39.821543 [debug] [MainThread]: On master: BEGIN
[0m23:58:39.826693 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:58:39.827689 [debug] [MainThread]: On master: COMMIT
[0m23:58:39.827689 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:39.829202 [debug] [MainThread]: On master: COMMIT
[0m23:58:39.831352 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:58:39.832534 [debug] [MainThread]: On master: Close
[0m23:58:39.834210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:39.837046 [info ] [MainThread]: 
[0m23:58:39.844216 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m23:58:39.845962 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m23:58:39.848177 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m23:58:39.849196 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m23:58:39.867064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_aircrafts"
[0m23:58:39.870621 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_aircrafts
[0m23:58:39.942514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_aircrafts"
[0m23:58:39.948201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m23:58:39.949726 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: BEGIN
[0m23:58:39.950741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:39.993850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m23:58:39.994951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m23:58:39.994951 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_aircrafts"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS a
    WHERE a.aircraft_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.031243 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m23:58:40.054250 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m23:58:40.055651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m23:58:40.057079 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m23:58:40.074108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m23:58:40.077665 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: Close
[0m23:58:40.082217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B508CC0980>]}
[0m23:58:40.084380 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[32mSELECT 0[0m in 0.23s]
[0m23:58:40.088116 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m23:58:40.089224 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m23:58:40.091538 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m23:58:40.094398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m23:58:40.095528 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m23:58:40.111299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_airports"
[0m23:58:40.114980 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_airports
[0m23:58:40.122038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_airports"
[0m23:58:40.124560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m23:58:40.125574 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: BEGIN
[0m23:58:40.125574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:40.172820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m23:58:40.173826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m23:58:40.175225 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_airports"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.airport_code, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS a
    WHERE a.airport_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.airport_code, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.220389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.044 seconds
[0m23:58:40.222404 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m23:58:40.224408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m23:58:40.225944 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m23:58:40.235487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:58:40.235487 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: Close
[0m23:58:40.239098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50CFC18B0>]}
[0m23:58:40.241688 [info ] [Thread-1 (]: 2 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_airports . [[32mSELECT 1[0m in 0.14s]
[0m23:58:40.244494 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m23:58:40.246163 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m23:58:40.247278 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m23:58:40.249529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m23:58:40.251887 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m23:58:40.263144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m23:58:40.265711 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m23:58:40.271594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_boarding_passes"
[0m23:58:40.273592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m23:58:40.274591 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: BEGIN
[0m23:58:40.274591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:40.344726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m23:58:40.345799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m23:58:40.347104 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.349998 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m23:58:40.351122 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: ROLLBACK
[0m23:58:40.353301 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m23:58:40.367716 [debug] [Thread-1 (]: Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m23:58:40.369239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50CF98680>]}
[0m23:58:40.370259 [error] [Thread-1 (]: 3 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.12s]
[0m23:58:40.372253 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m23:58:40.373249 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m23:58:40.375766 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m23:58:40.377797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m23:58:40.378797 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m23:58:40.390241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_bookings"
[0m23:58:40.392447 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_bookings
[0m23:58:40.400147 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_bookings"
[0m23:58:40.403055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m23:58:40.404057 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: BEGIN
[0m23:58:40.404057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:40.454002 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m23:58:40.455679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m23:58:40.457517 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_bookings"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.book_ref, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS a
    WHERE a.book_ref IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.book_ref, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.498211 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m23:58:40.500914 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m23:58:40.501915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m23:58:40.502914 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m23:58:40.510554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:58:40.512558 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: Close
[0m23:58:40.513065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50D07CE90>]}
[0m23:58:40.514082 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_bookings . [[32mSELECT 0[0m in 0.14s]
[0m23:58:40.517122 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m23:58:40.518118 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m23:58:40.519127 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m23:58:40.521016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m23:58:40.523031 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m23:58:40.534037 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_flights"
[0m23:58:40.536327 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_flights
[0m23:58:40.541900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_flights"
[0m23:58:40.544357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m23:58:40.545648 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: BEGIN
[0m23:58:40.547454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:40.592056 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m23:58:40.593755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m23:58:40.594863 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.flight_id, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS a
    WHERE a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.flight_id, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.633898 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m23:58:40.636757 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m23:58:40.637844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m23:58:40.638403 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m23:58:40.644711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m23:58:40.646982 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: Close
[0m23:58:40.648117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50C7D2A50>]}
[0m23:58:40.649768 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_flights .. [[32mSELECT 0[0m in 0.13s]
[0m23:58:40.651424 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m23:58:40.653425 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m23:58:40.654425 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m23:58:40.655936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m23:58:40.656953 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m23:58:40.670572 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m23:58:40.672784 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m23:58:40.679288 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_seats"
[0m23:58:40.680970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m23:58:40.682037 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: BEGIN
[0m23:58:40.683089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:40.730508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m23:58:40.731591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m23:58:40.732593 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_seats"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code, seat_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.735415 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                  ^

[0m23:58:40.736415 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: ROLLBACK
[0m23:58:40.740387 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m23:58:40.745878 [debug] [Thread-1 (]: Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m23:58:40.746991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50D0DCF80>]}
[0m23:58:40.748702 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.09s]
[0m23:58:40.750365 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m23:58:40.750900 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m23:58:40.752701 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m23:58:40.754326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m23:58:40.754862 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m23:58:40.766008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m23:58:40.769054 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m23:58:40.774630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_ticket_flights"
[0m23:58:40.777682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m23:58:40.779195 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: BEGIN
[0m23:58:40.780449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:40.825150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m23:58:40.826855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m23:58:40.827402 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.831510 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m23:58:40.832587 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: ROLLBACK
[0m23:58:40.835374 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m23:58:40.840076 [debug] [Thread-1 (]: Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m23:58:40.841249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50C7D1A60>]}
[0m23:58:40.842995 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.09s]
[0m23:58:40.845148 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m23:58:40.846415 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m23:58:40.847515 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m23:58:40.849127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m23:58:40.849681 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m23:58:40.859023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_tickets"
[0m23:58:40.862389 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_tickets
[0m23:58:40.870316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_tickets"
[0m23:58:40.872477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m23:58:40.873029 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: BEGIN
[0m23:58:40.874791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:40.925232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m23:58:40.927039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m23:58:40.928174 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_tickets"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS a
    WHERE a.ticket_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m23:58:40.967061 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m23:58:40.970035 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m23:58:40.970035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m23:58:40.971059 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m23:58:40.978278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m23:58:40.979796 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: Close
[0m23:58:40.981823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4fd695c-1ff2-41cf-8d51-b1a551fdac1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50CF26510>]}
[0m23:58:40.983712 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_tickets .. [[32mSELECT 0[0m in 0.13s]
[0m23:58:40.986757 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m23:58:40.990797 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:40.991970 [debug] [MainThread]: On master: BEGIN
[0m23:58:40.993483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:41.057071 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m23:58:41.058085 [debug] [MainThread]: On master: COMMIT
[0m23:58:41.059080 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:41.060813 [debug] [MainThread]: On master: COMMIT
[0m23:58:41.064347 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m23:58:41.064347 [debug] [MainThread]: On master: Close
[0m23:58:41.065869 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:41.065869 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m23:58:41.067706 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m23:58:41.069219 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m23:58:41.070240 [info ] [MainThread]: 
[0m23:58:41.071228 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m23:58:41.073227 [debug] [MainThread]: Command end result
[0m23:58:41.133802 [info ] [MainThread]: 
[0m23:58:41.135348 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m23:58:41.137154 [info ] [MainThread]: 
[0m23:58:41.138370 [error] [MainThread]:   Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m23:58:41.140527 [info ] [MainThread]: 
[0m23:58:41.141796 [error] [MainThread]:   Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m23:58:41.143804 [info ] [MainThread]: 
[0m23:58:41.145913 [error] [MainThread]:   Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m23:58:41.146995 [info ] [MainThread]: 
[0m23:58:41.148000 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m23:58:41.150513 [debug] [MainThread]: Command `dbt run` failed at 23:58:41.150513 after 4.55 seconds
[0m23:58:41.151516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50A8BB0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50ADAD8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50AA60EF0>]}
[0m23:58:41.152684 [debug] [MainThread]: Flushing usage events
[0m00:00:35.690145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EAFE02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277E7EACF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EAC321B0>]}


============================== 00:00:35.696768 | dbab4c18-45aa-4c0a-a767-abe174bdf0c8 ==============================
[0m00:00:35.696768 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:00:35.699024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:00:36.105909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EAFFC830>]}
[0m00:00:36.211266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EA7B4140>]}
[0m00:00:36.214005 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:00:36.537074 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:00:36.999800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:37.000334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:37.042817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EB26EC00>]}
[0m00:00:37.235521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EC6400B0>]}
[0m00:00:37.236691 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:00:37.238357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EA106FF0>]}
[0m00:00:37.242199 [info ] [MainThread]: 
[0m00:00:37.243826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:37.251275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:00:37.764226 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:00:37.764226 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:00:37.765236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:37.821722 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.057 seconds
[0m00:00:37.824549 [debug] [ThreadPool]: On list_postgres: Close
[0m00:00:37.831643 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m00:00:37.840477 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:00:37.841985 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m00:00:37.844108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:37.890150 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m00:00:37.891692 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:00:37.892710 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m00:00:37.906013 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.013 seconds
[0m00:00:37.909008 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m00:00:37.912244 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m00:00:37.926658 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:37.926658 [debug] [MainThread]: On master: BEGIN
[0m00:00:37.928180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:37.973371 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m00:00:37.974401 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:37.974401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:38.030835 [debug] [MainThread]: SQL status: SELECT 16 in 0.055 seconds
[0m00:00:38.034736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EB33FDA0>]}
[0m00:00:38.035338 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:38.037860 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:38.039826 [debug] [MainThread]: On master: BEGIN
[0m00:00:38.043526 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:00:38.045719 [debug] [MainThread]: On master: COMMIT
[0m00:00:38.045719 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:38.046779 [debug] [MainThread]: On master: COMMIT
[0m00:00:38.049539 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:00:38.050549 [debug] [MainThread]: On master: Close
[0m00:00:38.051551 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:38.054418 [info ] [MainThread]: 
[0m00:00:38.063950 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m00:00:38.064966 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m00:00:38.066968 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m00:00:38.066968 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m00:00:38.122046 [info ] [Thread-1 (]: 00:00:38 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m00:00:38.204351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.206386 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m00:00:38.271012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.272086 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp000038238994"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:00:38.272648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:00:38.348923 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.077 seconds
[0m00:00:38.368578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.369778 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m00:00:38.373591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:00:38.374613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.375608 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp000038238994'
        
      order by ordinal_position

  
[0m00:00:38.406209 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.031 seconds
[0m00:00:38.413896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.415901 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:38.422984 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m00:00:38.432647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.433664 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:38.441510 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.007 seconds
[0m00:00:38.459842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.462411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.463650 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp000038238994"
    )


  
[0m00:00:38.468227 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:00:38.486917 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m00:00:38.487916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:00:38.488925 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m00:00:38.508778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m00:00:38.513227 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m00:00:38.518190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EA7EAC60>]}
[0m00:00:38.521338 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mINSERT 0 0[0m in 0.45s]
[0m00:00:38.523681 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m00:00:38.525800 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m00:00:38.527210 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m00:00:38.530187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m00:00:38.531999 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m00:00:38.539995 [info ] [Thread-1 (]: 00:00:38 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m00:00:38.545405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m00:00:38.549437 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m00:00:38.557400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:00:38.558927 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp000038554529"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:00:38.558927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:38.644763 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.085 seconds
[0m00:00:38.648801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:00:38.648801 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m00:00:38.652870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:00:38.654022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:00:38.655037 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp000038554529'
        
      order by ordinal_position

  
[0m00:00:38.686650 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.031 seconds
[0m00:00:38.691817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:00:38.693132 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:38.699224 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:00:38.703429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:00:38.704428 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:38.710102 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:00:38.713629 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m00:00:38.716588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:00:38.716588 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp000038554529"
    )


  
[0m00:00:38.722769 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:00:38.725779 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m00:00:38.726775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:00:38.727775 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m00:00:38.737430 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m00:00:38.739657 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m00:00:38.740737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277ECDAFEC0>]}
[0m00:00:38.742760 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mINSERT 0 0[0m in 0.21s]
[0m00:00:38.745579 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m00:00:38.746590 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m00:00:38.749102 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m00:00:38.751543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m00:00:38.751543 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m00:00:38.760398 [info ] [Thread-1 (]: 00:00:38 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m00:00:38.769566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m00:00:38.773085 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m00:00:38.780560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:00:38.781552 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp000038779032"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:00:38.782608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:38.885291 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.102 seconds
[0m00:00:38.890291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:00:38.891830 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m00:00:38.894629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:00:38.896057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:00:38.896598 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp000038779032'
        
      order by ordinal_position

  
[0m00:00:38.929411 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.032 seconds
[0m00:00:38.933686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:00:38.934685 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:38.941608 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:00:38.947424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:00:38.948269 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:38.954508 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:00:38.957289 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m00:00:38.958895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:00:38.959961 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp000038779032"
    )


  
[0m00:00:38.965006 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:00:38.966789 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m00:00:38.967797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:00:38.967797 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m00:00:38.986824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m00:00:38.988637 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m00:00:38.989830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277ECE2E900>]}
[0m00:00:38.992653 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mINSERT 0 0[0m in 0.24s]
[0m00:00:38.994889 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m00:00:38.996299 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m00:00:38.997825 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m00:00:39.000120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m00:00:39.001631 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m00:00:39.009563 [info ] [Thread-1 (]: 00:00:39 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m00:00:39.016456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m00:00:39.019620 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m00:00:39.029204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:00:39.030713 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp000039024201"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:00:39.031658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:39.125835 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.094 seconds
[0m00:00:39.222812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:00:39.224811 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m00:00:39.229962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:00:39.231462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:00:39.232470 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp000039024201'
        
      order by ordinal_position

  
[0m00:00:39.267332 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.034 seconds
[0m00:00:39.272499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:00:39.273594 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:39.279971 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m00:00:39.284645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:00:39.285642 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:39.291528 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m00:00:39.294275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m00:00:39.296543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:00:39.297106 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp000039024201"
    )


  
[0m00:00:39.303842 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m00:00:39.306014 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m00:00:39.307126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:00:39.308758 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m00:00:39.327885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m00:00:39.329626 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m00:00:39.331738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EB381070>]}
[0m00:00:39.332785 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mINSERT 0 0[0m in 0.33s]
[0m00:00:39.334889 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m00:00:39.336278 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m00:00:39.338664 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m00:00:39.340495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m00:00:39.342124 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m00:00:39.348799 [info ] [Thread-1 (]: 00:00:39 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m00:00:39.354340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m00:00:39.356691 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m00:00:39.363724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m00:00:39.366726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m00:00:39.369366 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m00:00:39.369366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:39.437985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m00:00:39.439802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m00:00:39.440966 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, seat_no) rr.aircraft_code, seat_no, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code, seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, seat_no, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:00:39.444544 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                   ^

[0m00:00:39.445082 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: ROLLBACK
[0m00:00:39.448024 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m00:00:39.464246 [debug] [Thread-1 (]: Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m00:00:39.465247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277ECCD8E30>]}
[0m00:00:39.466286 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.13s]
[0m00:00:39.468300 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m00:00:39.469299 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m00:00:39.470753 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m00:00:39.472469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m00:00:39.473060 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m00:00:39.480583 [info ] [Thread-1 (]: 00:00:39 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m00:00:39.486174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m00:00:39.487173 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m00:00:39.500579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:00:39.501658 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp000039496814"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:00:39.502176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:39.583331 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.082 seconds
[0m00:00:39.590866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:00:39.591954 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m00:00:39.595320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:00:39.596394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:00:39.597504 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp000039496814'
        
      order by ordinal_position

  
[0m00:00:39.623362 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.025 seconds
[0m00:00:39.627888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:00:39.628951 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:39.635051 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:00:39.640085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:00:39.640085 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:00:39.646371 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:00:39.649957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m00:00:39.651463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:00:39.652482 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp000039496814"
    )


  
[0m00:00:39.657998 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:00:39.660017 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m00:00:39.660017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:00:39.661524 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m00:00:39.676118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m00:00:39.678286 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m00:00:39.680857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbab4c18-45aa-4c0a-a767-abe174bdf0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277ECDDD370>]}
[0m00:00:39.682578 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mINSERT 0 0[0m in 0.21s]
[0m00:00:39.684326 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m00:00:39.686520 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:39.688296 [debug] [MainThread]: On master: BEGIN
[0m00:00:39.689462 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:39.734387 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m00:00:39.735487 [debug] [MainThread]: On master: COMMIT
[0m00:00:39.736028 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:39.737243 [debug] [MainThread]: On master: COMMIT
[0m00:00:39.740421 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:00:39.741531 [debug] [MainThread]: On master: Close
[0m00:00:39.743415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:39.744521 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:00:39.745584 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m00:00:39.746633 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m00:00:39.748171 [info ] [MainThread]: 
[0m00:00:39.749368 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m00:00:39.751787 [debug] [MainThread]: Command end result
[0m00:00:39.820524 [info ] [MainThread]: 
[0m00:00:39.822195 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:00:39.823821 [info ] [MainThread]: 
[0m00:00:39.824904 [error] [MainThread]:   Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  syntax error at or near ","
  LINE 20:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m00:00:39.826650 [info ] [MainThread]: 
[0m00:00:39.827778 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:00:39.830121 [debug] [MainThread]: Command `dbt run` failed at 00:00:39.830121 after 4.41 seconds
[0m00:00:39.830778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EAFE02F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EAE1E240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277EAE1C1A0>]}
[0m00:00:39.831299 [debug] [MainThread]: Flushing usage events
[0m00:05:23.199551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252636DA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252637B2EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252636DBAA0>]}


============================== 00:05:23.208068 | b64f02fa-9d8e-4398-b1bf-164976d059b6 ==============================
[0m00:05:23.208068 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:05:23.210076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m00:05:23.612669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025264010F80>]}
[0m00:05:23.728058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002525FFBF7D0>]}
[0m00:05:23.731457 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:05:24.068799 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:05:24.471299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:05:24.472357 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_seats.sql
[0m00:05:24.977076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252655101D0>]}
[0m00:05:25.157860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252654D9E20>]}
[0m00:05:25.158956 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:05:25.160602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252657139E0>]}
[0m00:05:25.164358 [info ] [MainThread]: 
[0m00:05:25.166095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:05:25.171728 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:05:25.716973 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:05:25.718065 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:05:25.719252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:25.773174 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.054 seconds
[0m00:05:25.775861 [debug] [ThreadPool]: On list_postgres: Close
[0m00:05:25.781557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m00:05:25.789827 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:05:25.790841 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m00:05:25.790841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:05:25.849493 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m00:05:25.850529 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:05:25.851641 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m00:05:25.865536 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.014 seconds
[0m00:05:25.869035 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m00:05:25.871753 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m00:05:25.885484 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:25.887011 [debug] [MainThread]: On master: BEGIN
[0m00:05:25.888218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:05:25.934623 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m00:05:25.935747 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:25.936312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:05:25.995627 [debug] [MainThread]: SQL status: SELECT 16 in 0.058 seconds
[0m00:05:26.001142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025261A56000>]}
[0m00:05:26.002143 [debug] [MainThread]: On master: ROLLBACK
[0m00:05:26.004158 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:26.005161 [debug] [MainThread]: On master: BEGIN
[0m00:05:26.009673 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:05:26.010674 [debug] [MainThread]: On master: COMMIT
[0m00:05:26.011674 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:26.011674 [debug] [MainThread]: On master: COMMIT
[0m00:05:26.015324 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:05:26.016408 [debug] [MainThread]: On master: Close
[0m00:05:26.018637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:05:26.020352 [info ] [MainThread]: 
[0m00:05:26.027075 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m00:05:26.028589 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m00:05:26.030165 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m00:05:26.031244 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m00:05:26.055611 [info ] [Thread-1 (]: 00:05:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m00:05:26.065741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.068276 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m00:05:26.137169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.137776 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp000526103651"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:05:26.140027 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:05:26.227600 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.087 seconds
[0m00:05:26.339391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.339391 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m00:05:26.345828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m00:05:26.346957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.349468 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp000526103651'
        
      order by ordinal_position

  
[0m00:05:26.392147 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.041 seconds
[0m00:05:26.401438 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.402551 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:26.408302 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:05:26.417177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.418265 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:26.424053 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:05:26.438970 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.440972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.441973 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp000526103651"
    )


  
[0m00:05:26.447101 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:05:26.464899 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m00:05:26.465892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:05:26.467401 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m00:05:26.486644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m00:05:26.489197 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m00:05:26.492199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252619E4F20>]}
[0m00:05:26.494221 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mINSERT 0 0[0m in 0.46s]
[0m00:05:26.496341 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m00:05:26.497858 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m00:05:26.499619 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m00:05:26.501300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m00:05:26.502414 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m00:05:26.511121 [info ] [Thread-1 (]: 00:05:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m00:05:26.518605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m00:05:26.520307 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m00:05:26.530696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:05:26.531693 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp000526526123"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:05:26.532695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:26.619873 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.087 seconds
[0m00:05:26.626475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:05:26.628023 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m00:05:26.631318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:05:26.632316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:05:26.632316 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp000526526123'
        
      order by ordinal_position

  
[0m00:05:26.661968 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.028 seconds
[0m00:05:26.670702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:05:26.671241 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:26.677933 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:05:26.682055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:05:26.682055 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:26.688271 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:05:26.691860 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m00:05:26.695190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:05:26.696200 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp000526526123"
    )


  
[0m00:05:26.700245 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m00:05:26.702251 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m00:05:26.703772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:05:26.705799 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m00:05:26.713633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m00:05:26.715298 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m00:05:26.716981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025265BD0DA0>]}
[0m00:05:26.719227 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mINSERT 0 0[0m in 0.22s]
[0m00:05:26.721639 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m00:05:26.723384 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m00:05:26.724473 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m00:05:26.726802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m00:05:26.727910 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m00:05:26.736190 [info ] [Thread-1 (]: 00:05:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m00:05:26.743971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m00:05:26.745994 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m00:05:26.754790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:05:26.755781 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp000526751769"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:05:26.755781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:26.844615 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.087 seconds
[0m00:05:26.848685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:05:26.849702 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m00:05:26.853608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m00:05:26.854622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:05:26.855640 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp000526751769'
        
      order by ordinal_position

  
[0m00:05:26.891001 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.034 seconds
[0m00:05:26.897889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:05:26.899016 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:26.905113 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:05:26.910850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:05:26.911853 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:26.917684 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:05:26.921039 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m00:05:26.923275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:05:26.923819 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp000526751769"
    )


  
[0m00:05:26.928464 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:05:26.933562 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m00:05:26.934576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:05:26.935577 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m00:05:26.942084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:05:26.944612 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m00:05:26.945624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025265E76F60>]}
[0m00:05:26.948428 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mINSERT 0 0[0m in 0.22s]
[0m00:05:26.950865 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m00:05:26.952547 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m00:05:26.953547 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m00:05:26.955752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m00:05:26.957275 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m00:05:26.965334 [info ] [Thread-1 (]: 00:05:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m00:05:26.972873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m00:05:26.975821 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m00:05:26.982381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:05:26.984407 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp000526979370"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:05:26.985514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:27.079596 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.094 seconds
[0m00:05:27.084384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:05:27.085397 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m00:05:27.088064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:05:27.089065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:05:27.090064 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp000526979370'
        
      order by ordinal_position

  
[0m00:05:27.126994 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.035 seconds
[0m00:05:27.132562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:05:27.134180 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:27.141528 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m00:05:27.146979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:05:27.148096 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:27.153960 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m00:05:27.156720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m00:05:27.158932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:05:27.159465 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp000526979370"
    )


  
[0m00:05:27.165742 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m00:05:27.167985 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m00:05:27.169190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:05:27.170284 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m00:05:27.185478 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m00:05:27.188473 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m00:05:27.190156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025265A286E0>]}
[0m00:05:27.191295 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mINSERT 0 0[0m in 0.23s]
[0m00:05:27.194027 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m00:05:27.194582 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m00:05:27.196253 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m00:05:27.197861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m00:05:27.198987 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m00:05:27.206453 [info ] [Thread-1 (]: 00:05:27 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m00:05:27.211404 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m00:05:27.213625 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m00:05:27.225271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m00:05:27.227294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m00:05:27.228306 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m00:05:27.229303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:27.287075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m00:05:27.287075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m00:05:27.288356 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.delivery_pk, rr.product_pk) rr.delivery_pk, rr.product_pk, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.delivery_pk IS NOT NULL
    AND rr.product_pk IS NOT NULL
    ORDER BY rr.delivery_pk, rr.product_pk, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.delivery_pk, a.product_pk, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:05:27.292372 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.delivery_pk does not exist
LINE 18: ...ELECT DISTINCT ON (rr.delivery_pk, rr.product_pk) rr.deliver...
                                                              ^

[0m00:05:27.293378 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: ROLLBACK
[0m00:05:27.298027 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m00:05:27.314624 [debug] [Thread-1 (]: Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  column rr.delivery_pk does not exist
  LINE 18: ...ELECT DISTINCT ON (rr.delivery_pk, rr.product_pk) rr.deliver...
                                                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m00:05:27.315779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025265438560>]}
[0m00:05:27.316841 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.12s]
[0m00:05:27.318458 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m00:05:27.319574 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m00:05:27.321809 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m00:05:27.323474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m00:05:27.324780 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m00:05:27.331149 [info ] [Thread-1 (]: 00:05:27 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m00:05:27.336995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m00:05:27.339327 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m00:05:27.346818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:05:27.349805 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp000527344825"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:05:27.350799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:05:27.433003 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.082 seconds
[0m00:05:27.437151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:05:27.439165 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m00:05:27.442252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:05:27.443897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:05:27.444905 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp000527344825'
        
      order by ordinal_position

  
[0m00:05:27.472746 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.027 seconds
[0m00:05:27.477171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:05:27.477728 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:27.482288 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:05:27.487414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:05:27.488419 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:05:27.493432 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:05:27.496930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m00:05:27.498377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:05:27.500397 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp000527344825"
    )


  
[0m00:05:27.504397 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:05:27.506908 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m00:05:27.507922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:05:27.507922 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m00:05:27.527549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m00:05:27.528552 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m00:05:27.529913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b64f02fa-9d8e-4398-b1bf-164976d059b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025265A31430>]}
[0m00:05:27.532849 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mINSERT 0 0[0m in 0.21s]
[0m00:05:27.535513 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m00:05:27.537029 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:27.538484 [debug] [MainThread]: On master: BEGIN
[0m00:05:27.539601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:05:27.585390 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m00:05:27.586914 [debug] [MainThread]: On master: COMMIT
[0m00:05:27.586914 [debug] [MainThread]: Using postgres connection "master"
[0m00:05:27.587923 [debug] [MainThread]: On master: COMMIT
[0m00:05:27.589922 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:05:27.591706 [debug] [MainThread]: On master: Close
[0m00:05:27.594994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:05:27.596684 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:05:27.597786 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m00:05:27.598914 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m00:05:27.600041 [info ] [MainThread]: 
[0m00:05:27.601832 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m00:05:27.604500 [debug] [MainThread]: Command end result
[0m00:05:27.671416 [info ] [MainThread]: 
[0m00:05:27.673454 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:05:27.674524 [info ] [MainThread]: 
[0m00:05:27.675684 [error] [MainThread]:   Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  column rr.delivery_pk does not exist
  LINE 18: ...ELECT DISTINCT ON (rr.delivery_pk, rr.product_pk) rr.deliver...
                                                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m00:05:27.677196 [info ] [MainThread]: 
[0m00:05:27.678237 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m00:05:27.681734 [debug] [MainThread]: Command `dbt run` failed at 00:05:27.680734 after 4.84 seconds
[0m00:05:27.681734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025263BA2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025265EAA6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025265A90470>]}
[0m00:05:27.683736 [debug] [MainThread]: Flushing usage events
[0m00:05:58.872691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC036334A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC036BC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC03630A70>]}


============================== 00:05:58.879778 | 55d1f0ef-6246-4ebd-b4d5-08a286394bd2 ==============================
[0m00:05:58.879778 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:05:58.882011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:05:59.260030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC03814410>]}
[0m00:05:59.361891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC02CF1F70>]}
[0m00:05:59.365736 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:05:59.698721 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:06:00.195108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:06:00.196816 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_seats.sql
[0m00:06:00.692325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC04C608F0>]}
[0m00:06:00.851860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC04DB60F0>]}
[0m00:06:00.852861 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:06:00.854376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC04D42750>]}
[0m00:06:00.857729 [info ] [MainThread]: 
[0m00:06:00.860512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:06:00.867639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:06:01.401822 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:06:01.402897 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:06:01.404030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:01.464913 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.061 seconds
[0m00:06:01.467595 [debug] [ThreadPool]: On list_postgres: Close
[0m00:06:01.474760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m00:06:01.483733 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:06:01.484826 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m00:06:01.486036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:01.527744 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m00:06:01.530106 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:06:01.531105 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m00:06:01.544976 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.013 seconds
[0m00:06:01.548491 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m00:06:01.550960 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m00:06:01.566167 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:01.567674 [debug] [MainThread]: On master: BEGIN
[0m00:06:01.568699 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:01.613055 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m00:06:01.614136 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:01.615289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:06:01.675576 [debug] [MainThread]: SQL status: SELECT 16 in 0.060 seconds
[0m00:06:01.679428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC0519FDA0>]}
[0m00:06:01.680506 [debug] [MainThread]: On master: ROLLBACK
[0m00:06:01.683329 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:01.683885 [debug] [MainThread]: On master: BEGIN
[0m00:06:01.688975 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:06:01.690093 [debug] [MainThread]: On master: COMMIT
[0m00:06:01.691096 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:01.691096 [debug] [MainThread]: On master: COMMIT
[0m00:06:01.694291 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:06:01.696307 [debug] [MainThread]: On master: Close
[0m00:06:01.697376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:01.699584 [info ] [MainThread]: 
[0m00:06:01.708027 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m00:06:01.709076 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m00:06:01.711259 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m00:06:01.713257 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m00:06:01.750782 [info ] [Thread-1 (]: 00:06:01 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m00:06:01.761408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m00:06:01.764295 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m00:06:01.846125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:06:01.846125 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp000601809752"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:06:01.847634 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:06:01.923565 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.077 seconds
[0m00:06:02.037784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:06:02.038817 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m00:06:02.040819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:06:02.042204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:06:02.043207 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp000601809752'
        
      order by ordinal_position

  
[0m00:06:02.075178 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.030 seconds
[0m00:06:02.083477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:06:02.085540 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.091941 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m00:06:02.101820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:06:02.102819 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.108039 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:06:02.124528 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m00:06:02.126527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:06:02.128043 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp000601809752"
    )


  
[0m00:06:02.133260 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:06:02.152385 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m00:06:02.153385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m00:06:02.154389 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m00:06:02.172757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m00:06:02.177332 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m00:06:02.181770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC055B8260>]}
[0m00:06:02.183548 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mINSERT 0 0[0m in 0.47s]
[0m00:06:02.185936 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m00:06:02.187079 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m00:06:02.188663 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m00:06:02.191817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m00:06:02.192669 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m00:06:02.204702 [info ] [Thread-1 (]: 00:06:02 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m00:06:02.212937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m00:06:02.216480 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m00:06:02.224162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:06:02.225156 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp000602221154"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:06:02.226163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:02.309953 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.083 seconds
[0m00:06:02.317885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:06:02.319665 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m00:06:02.322478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:06:02.323718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:06:02.324269 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp000602221154'
        
      order by ordinal_position

  
[0m00:06:02.356372 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.031 seconds
[0m00:06:02.365104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:06:02.366095 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.370825 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:06:02.376241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:06:02.377312 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.382981 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:06:02.386430 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m00:06:02.390032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:06:02.391270 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp000602221154"
    )


  
[0m00:06:02.396552 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:06:02.399729 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m00:06:02.402055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m00:06:02.402055 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m00:06:02.409537 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:06:02.411535 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m00:06:02.413540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC04C80050>]}
[0m00:06:02.415584 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mINSERT 0 0[0m in 0.22s]
[0m00:06:02.417765 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m00:06:02.420349 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m00:06:02.421870 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m00:06:02.423539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m00:06:02.425365 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m00:06:02.433385 [info ] [Thread-1 (]: 00:06:02 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m00:06:02.438938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m00:06:02.440999 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m00:06:02.449690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:06:02.450197 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp000602446535"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:06:02.451225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:02.536070 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.085 seconds
[0m00:06:02.540504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:06:02.541043 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m00:06:02.544586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:06:02.546062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:06:02.546062 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp000602446535'
        
      order by ordinal_position

  
[0m00:06:02.576345 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.029 seconds
[0m00:06:02.580965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:06:02.581959 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.590033 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m00:06:02.595838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:06:02.596941 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.601634 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m00:06:02.604660 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m00:06:02.606678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:06:02.607674 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp000602446535"
    )


  
[0m00:06:02.612192 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:06:02.618216 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m00:06:02.618802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m00:06:02.619871 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m00:06:02.626345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:06:02.628024 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m00:06:02.629039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC055C2300>]}
[0m00:06:02.631426 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mINSERT 0 0[0m in 0.21s]
[0m00:06:02.633429 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m00:06:02.635058 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m00:06:02.636069 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m00:06:02.638656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m00:06:02.639654 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m00:06:02.648635 [info ] [Thread-1 (]: 00:06:02 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m00:06:02.653342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m00:06:02.657734 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m00:06:02.665630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:06:02.666728 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp000602661855"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:06:02.667712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:02.748177 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.081 seconds
[0m00:06:02.753403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:06:02.753983 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m00:06:02.757319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:06:02.758717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:06:02.759376 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp000602661855'
        
      order by ordinal_position

  
[0m00:06:02.795540 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.035 seconds
[0m00:06:02.800649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:06:02.801192 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.806897 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m00:06:02.812238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:06:02.813248 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:02.817769 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m00:06:02.823431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m00:06:02.825044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:06:02.826186 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp000602661855"
    )


  
[0m00:06:02.830643 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m00:06:02.832848 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m00:06:02.833939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m00:06:02.835311 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m00:06:02.841960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:06:02.843589 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m00:06:02.845230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC039F0650>]}
[0m00:06:02.846758 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mINSERT 0 0[0m in 0.21s]
[0m00:06:02.849794 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m00:06:02.850426 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m00:06:02.851873 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m00:06:02.854394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m00:06:02.855505 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m00:06:02.862322 [info ] [Thread-1 (]: 00:06:02 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m00:06:02.868034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m00:06:02.870542 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m00:06:02.881382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m00:06:02.884107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m00:06:02.884660 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m00:06:02.885741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:02.931099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m00:06:02.932099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m00:06:02.933097 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, rr.seat_no) rr.aircraft_code, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, rr.seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:06:02.973411 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.040 seconds
[0m00:06:02.984451 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m00:06:02.985616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m00:06:02.986172 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m00:06:02.992623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:06:02.994348 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m00:06:02.995834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC051775F0>]}
[0m00:06:02.997802 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_seats .... [[32mSELECT 0[0m in 0.14s]
[0m00:06:02.999844 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m00:06:02.999844 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m00:06:03.002008 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m00:06:03.004282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m00:06:03.004282 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m00:06:03.015310 [info ] [Thread-1 (]: 00:06:03 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m00:06:03.020270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m00:06:03.023279 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m00:06:03.030159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:06:03.031542 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp000603027645"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m00:06:03.032550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:03.114653 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.082 seconds
[0m00:06:03.119193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:06:03.120301 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m00:06:03.123011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m00:06:03.124533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:06:03.125653 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp000603027645'
        
      order by ordinal_position

  
[0m00:06:03.162604 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.036 seconds
[0m00:06:03.167778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:06:03.168795 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:03.175237 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:06:03.182120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:06:03.182665 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m00:06:03.188540 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m00:06:03.191339 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m00:06:03.193872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:06:03.194986 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp000603027645"
    )


  
[0m00:06:03.198806 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m00:06:03.201162 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m00:06:03.201162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m00:06:03.202439 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m00:06:03.210658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m00:06:03.211672 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m00:06:03.212659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d1f0ef-6246-4ebd-b4d5-08a286394bd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC05254D70>]}
[0m00:06:03.215188 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mINSERT 0 0[0m in 0.21s]
[0m00:06:03.217710 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m00:06:03.219988 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:03.221057 [debug] [MainThread]: On master: BEGIN
[0m00:06:03.221057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:06:03.271754 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m00:06:03.272307 [debug] [MainThread]: On master: COMMIT
[0m00:06:03.273397 [debug] [MainThread]: Using postgres connection "master"
[0m00:06:03.273957 [debug] [MainThread]: On master: COMMIT
[0m00:06:03.276165 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:06:03.277545 [debug] [MainThread]: On master: Close
[0m00:06:03.278078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:03.280554 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:06:03.281552 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m00:06:03.282554 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m00:06:03.283995 [info ] [MainThread]: 
[0m00:06:03.286011 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m00:06:03.288359 [debug] [MainThread]: Command end result
[0m00:06:03.352649 [info ] [MainThread]: 
[0m00:06:03.354312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:03.355985 [info ] [MainThread]: 
[0m00:06:03.357623 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:06:03.359839 [debug] [MainThread]: Command `dbt run` succeeded at 00:06:03.359285 after 4.76 seconds
[0m00:06:03.360392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC036BC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC036BCE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC033982F0>]}
[0m00:06:03.361493 [debug] [MainThread]: Flushing usage events
[0m00:08:01.440365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3B61CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3E3F2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3E3F3AD0>]}


============================== 00:08:01.447928 | c36dd6ff-82a6-4be8-bda3-e98ed6acd76c ==============================
[0m00:08:01.447928 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:08:01.450737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:link', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:08:01.829256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c36dd6ff-82a6-4be8-bda3-e98ed6acd76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3DF6BAD0>]}
[0m00:08:01.941105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c36dd6ff-82a6-4be8-bda3-e98ed6acd76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3E013260>]}
[0m00:08:01.943119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:08:02.251174 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:08:02.709362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:02.709878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:02.750913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c36dd6ff-82a6-4be8-bda3-e98ed6acd76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3EB87BF0>]}
[0m00:08:02.927745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c36dd6ff-82a6-4be8-bda3-e98ed6acd76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3FE2C2C0>]}
[0m00:08:02.928822 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:08:02.930343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c36dd6ff-82a6-4be8-bda3-e98ed6acd76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B402D2210>]}
[0m00:08:02.932369 [warn ] [MainThread]: The selection criterion 'tag:link' does not match any enabled nodes
[0m00:08:02.935367 [info ] [MainThread]: 
[0m00:08:02.937442 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:08:02.942036 [debug] [MainThread]: Command end result
[0m00:08:03.005835 [debug] [MainThread]: Command `dbt run` succeeded at 00:08:03.004738 after 1.84 seconds
[0m00:08:03.007578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3E44A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3FE778C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012B3E4B9070>]}
[0m00:08:03.008596 [debug] [MainThread]: Flushing usage events
[0m00:08:13.976019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018338C559D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833AC1AAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833B1B1100>]}


============================== 00:08:13.983738 | b1b71cd6-e24a-47aa-9206-05a39c941700 ==============================
[0m00:08:13.983738 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:08:13.985936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:satellite', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:08:14.430089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833B0A2C00>]}
[0m00:08:14.547224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833B0A2870>]}
[0m00:08:14.550509 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:08:14.881611 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:08:15.304709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:15.305884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:15.356713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833C7F15B0>]}
[0m00:08:15.545320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833C920A40>]}
[0m00:08:15.547363 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:08:15.550380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833CC44320>]}
[0m00:08:15.558289 [info ] [MainThread]: 
[0m00:08:15.560459 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:08:15.567218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:08:16.233074 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:08:16.235080 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:08:16.237680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:16.299198 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.062 seconds
[0m00:08:16.301427 [debug] [ThreadPool]: On list_postgres: Close
[0m00:08:16.310271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m00:08:16.318661 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:08:16.319554 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m00:08:16.320575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:16.365618 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m00:08:16.367954 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:08:16.368944 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m00:08:16.396693 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.026 seconds
[0m00:08:16.400109 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m00:08:16.403363 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m00:08:16.415016 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:16.416017 [debug] [MainThread]: On master: BEGIN
[0m00:08:16.416017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:08:16.468898 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m00:08:16.470007 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:16.471066 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:08:16.544504 [debug] [MainThread]: SQL status: SELECT 16 in 0.072 seconds
[0m00:08:16.548406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833C920A10>]}
[0m00:08:16.549567 [debug] [MainThread]: On master: ROLLBACK
[0m00:08:16.552364 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:16.553047 [debug] [MainThread]: On master: BEGIN
[0m00:08:16.559067 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:08:16.560679 [debug] [MainThread]: On master: COMMIT
[0m00:08:16.561769 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:16.562310 [debug] [MainThread]: On master: COMMIT
[0m00:08:16.565655 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:08:16.566747 [debug] [MainThread]: On master: Close
[0m00:08:16.568520 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:08:16.570313 [info ] [MainThread]: 
[0m00:08:16.578258 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m00:08:16.579310 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m00:08:16.581533 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m00:08:16.582071 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m00:08:16.740418 [debug] [Thread-1 (]: Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
[0m00:08:16.744136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833ABEAED0>]}
[0m00:08:16.745973 [error] [Thread-1 (]: 1 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.16s]
[0m00:08:16.747623 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m00:08:16.748687 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m00:08:16.750266 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m00:08:16.752276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m00:08:16.753274 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m00:08:16.773495 [debug] [Thread-1 (]: Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_airports (models\raw_vault\sats\sat_airports.sql)
[0m00:08:16.775184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D1D8920>]}
[0m00:08:16.776801 [error] [Thread-1 (]: 2 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.02s]
[0m00:08:16.779172 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m00:08:16.779776 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m00:08:16.780830 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m00:08:16.783001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m00:08:16.783550 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m00:08:16.805468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m00:08:16.808836 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m00:08:16.889015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_boarding_passes"
[0m00:08:16.892445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m00:08:16.893670 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: BEGIN
[0m00:08:16.894208 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:08:16.948476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m00:08:16.949590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m00:08:16.949590 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:08:16.953062 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m00:08:16.954152 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: ROLLBACK
[0m00:08:16.956932 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m00:08:16.967945 [debug] [Thread-1 (]: Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m00:08:16.969014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D1DA060>]}
[0m00:08:16.970728 [error] [Thread-1 (]: 3 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.19s]
[0m00:08:16.972890 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m00:08:16.973990 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m00:08:16.975084 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m00:08:16.976712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m00:08:16.977850 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m00:08:16.995569 [debug] [Thread-1 (]: Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
[0m00:08:16.997331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D18D040>]}
[0m00:08:16.999281 [error] [Thread-1 (]: 4 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.02s]
[0m00:08:17.001451 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m00:08:17.003240 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m00:08:17.004333 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m00:08:17.005402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m00:08:17.006503 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m00:08:17.025689 [debug] [Thread-1 (]: Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_flights (models\raw_vault\sats\sat_flights.sql)
[0m00:08:17.026224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D2D54F0>]}
[0m00:08:17.027847 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.02s]
[0m00:08:17.030054 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m00:08:17.031221 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m00:08:17.032903 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m00:08:17.035063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m00:08:17.035571 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m00:08:17.049240 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m00:08:17.050249 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m00:08:17.058796 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_seats"
[0m00:08:17.061220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m00:08:17.061767 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: BEGIN
[0m00:08:17.062832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:17.120604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m00:08:17.121828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m00:08:17.122972 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_seats"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code, seat_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:08:17.126559 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                  ^

[0m00:08:17.128304 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: ROLLBACK
[0m00:08:17.131087 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m00:08:17.134930 [debug] [Thread-1 (]: Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m00:08:17.136012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D1F1C70>]}
[0m00:08:17.137683 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.10s]
[0m00:08:17.139896 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m00:08:17.140410 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m00:08:17.142420 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m00:08:17.144468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m00:08:17.145466 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m00:08:17.155148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m00:08:17.156950 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m00:08:17.162596 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_ticket_flights"
[0m00:08:17.164811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m00:08:17.166512 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: BEGIN
[0m00:08:17.168157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:08:17.219127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m00:08:17.220796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m00:08:17.222447 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:08:17.226413 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m00:08:17.227574 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: ROLLBACK
[0m00:08:17.230240 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m00:08:17.234461 [debug] [Thread-1 (]: Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m00:08:17.235461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D2F6300>]}
[0m00:08:17.238293 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.09s]
[0m00:08:17.240467 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m00:08:17.240467 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m00:08:17.242476 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m00:08:17.244482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m00:08:17.245566 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m00:08:17.264032 [debug] [Thread-1 (]: Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
[0m00:08:17.265944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1b71cd6-e24a-47aa-9206-05a39c941700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D311880>]}
[0m00:08:17.271844 [error] [Thread-1 (]: 8 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.02s]
[0m00:08:17.275479 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m00:08:17.278635 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:17.279672 [debug] [MainThread]: On master: BEGIN
[0m00:08:17.280865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:08:17.329572 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m00:08:17.330570 [debug] [MainThread]: On master: COMMIT
[0m00:08:17.332020 [debug] [MainThread]: Using postgres connection "master"
[0m00:08:17.333012 [debug] [MainThread]: On master: COMMIT
[0m00:08:17.335078 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:08:17.336076 [debug] [MainThread]: On master: Close
[0m00:08:17.338079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:17.339497 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:08:17.340095 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m00:08:17.341162 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m00:08:17.343136 [info ] [MainThread]: 
[0m00:08:17.345215 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m00:08:17.349329 [debug] [MainThread]: Command end result
[0m00:08:17.496708 [info ] [MainThread]: 
[0m00:08:17.498996 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m00:08:17.501171 [info ] [MainThread]: 
[0m00:08:17.502257 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
[0m00:08:17.503868 [info ] [MainThread]: 
[0m00:08:17.505608 [error] [MainThread]:   Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_airports (models\raw_vault\sats\sat_airports.sql)
[0m00:08:17.507721 [info ] [MainThread]: 
[0m00:08:17.509367 [error] [MainThread]:   Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m00:08:17.510432 [info ] [MainThread]: 
[0m00:08:17.512073 [error] [MainThread]:   Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
[0m00:08:17.513700 [info ] [MainThread]: 
[0m00:08:17.514707 [error] [MainThread]:   Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_flights (models\raw_vault\sats\sat_flights.sql)
[0m00:08:17.516818 [info ] [MainThread]: 
[0m00:08:17.519092 [error] [MainThread]:   Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m00:08:17.520160 [info ] [MainThread]: 
[0m00:08:17.521762 [error] [MainThread]:   Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m00:08:17.522876 [info ] [MainThread]: 
[0m00:08:17.525088 [error] [MainThread]:   Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
[0m00:08:17.527296 [info ] [MainThread]: 
[0m00:08:17.528700 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=0 TOTAL=8
[0m00:08:17.530783 [debug] [MainThread]: Command `dbt run` failed at 00:08:17.530783 after 3.83 seconds
[0m00:08:17.531922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833885E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018334E84DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018334E28C50>]}
[0m00:08:17.532924 [debug] [MainThread]: Flushing usage events
[0m00:09:50.009621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F06B3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F3083E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F3080A70>]}


============================== 00:09:50.019508 | aa7be14b-547b-4402-a427-f5182fd69a7b ==============================
[0m00:09:50.019508 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:09:50.021929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:satellite', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:09:50.406683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F28020C0>]}
[0m00:09:50.532136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F1DAE420>]}
[0m00:09:50.535146 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:09:50.836269 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:09:51.239021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:09:51.240643 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m00:09:51.241778 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m00:09:51.242300 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m00:09:51.789862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F4C45160>]}
[0m00:09:51.962697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F4717A70>]}
[0m00:09:51.963875 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:09:51.965599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F45F6BA0>]}
[0m00:09:51.970163 [info ] [MainThread]: 
[0m00:09:51.971304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:09:51.977859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:09:52.502037 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:09:52.503143 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:09:52.504300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:52.561065 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.057 seconds
[0m00:09:52.563304 [debug] [ThreadPool]: On list_postgres: Close
[0m00:09:52.569752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m00:09:52.578086 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:09:52.578600 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m00:09:52.580113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:09:52.625072 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m00:09:52.626060 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:09:52.627518 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m00:09:52.645251 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.016 seconds
[0m00:09:52.647969 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m00:09:52.650698 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m00:09:52.663708 [debug] [MainThread]: Using postgres connection "master"
[0m00:09:52.664847 [debug] [MainThread]: On master: BEGIN
[0m00:09:52.665461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:09:52.710954 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m00:09:52.711495 [debug] [MainThread]: Using postgres connection "master"
[0m00:09:52.712530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:09:52.775301 [debug] [MainThread]: SQL status: SELECT 16 in 0.062 seconds
[0m00:09:52.780104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F334C260>]}
[0m00:09:52.781469 [debug] [MainThread]: On master: ROLLBACK
[0m00:09:52.783575 [debug] [MainThread]: Using postgres connection "master"
[0m00:09:52.784812 [debug] [MainThread]: On master: BEGIN
[0m00:09:52.789143 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:09:52.790137 [debug] [MainThread]: On master: COMMIT
[0m00:09:52.791143 [debug] [MainThread]: Using postgres connection "master"
[0m00:09:52.792667 [debug] [MainThread]: On master: COMMIT
[0m00:09:52.794933 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:09:52.795941 [debug] [MainThread]: On master: Close
[0m00:09:52.796988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:09:52.799877 [info ] [MainThread]: 
[0m00:09:52.808724 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m00:09:52.810328 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m00:09:52.812868 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m00:09:52.813890 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m00:09:52.956694 [debug] [Thread-1 (]: Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
[0m00:09:52.959387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F25D34A0>]}
[0m00:09:52.961028 [error] [Thread-1 (]: 1 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.15s]
[0m00:09:52.963354 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m00:09:52.964437 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m00:09:52.966082 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m00:09:52.968344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m00:09:52.968911 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m00:09:52.990849 [debug] [Thread-1 (]: Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_airports (models\raw_vault\sats\sat_airports.sql)
[0m00:09:52.991917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F4BFD670>]}
[0m00:09:52.993784 [error] [Thread-1 (]: 2 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.02s]
[0m00:09:52.995993 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m00:09:52.997093 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m00:09:52.998246 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m00:09:53.000512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m00:09:53.001528 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m00:09:53.015375 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m00:09:53.018130 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m00:09:53.091572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_boarding_passes"
[0m00:09:53.093751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m00:09:53.094865 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: BEGIN
[0m00:09:53.095865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:09:53.166487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m00:09:53.167646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m00:09:53.168205 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.flight_id, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no IS NOT NULL
    AND a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.flight_id, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:09:53.216500 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.047 seconds
[0m00:09:53.238794 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: COMMIT
[0m00:09:53.240803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m00:09:53.241884 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: COMMIT
[0m00:09:53.260591 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m00:09:53.264288 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m00:09:53.265920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F474A5D0>]}
[0m00:09:53.268131 [info ] [Thread-1 (]: 3 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[32mSELECT 0[0m in 0.26s]
[0m00:09:53.270322 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m00:09:53.270875 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m00:09:53.272433 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m00:09:53.275748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m00:09:53.276768 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m00:09:53.296751 [debug] [Thread-1 (]: Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
[0m00:09:53.298753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F474B4A0>]}
[0m00:09:53.299751 [error] [Thread-1 (]: 4 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.02s]
[0m00:09:53.301754 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m00:09:53.301754 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m00:09:53.302750 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m00:09:53.305487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m00:09:53.306518 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m00:09:53.324318 [debug] [Thread-1 (]: Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_flights (models\raw_vault\sats\sat_flights.sql)
[0m00:09:53.325403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F4CBD670>]}
[0m00:09:53.326482 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.02s]
[0m00:09:53.328811 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m00:09:53.329907 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m00:09:53.331001 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m00:09:53.332519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m00:09:53.332519 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m00:09:53.350596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m00:09:53.353989 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m00:09:53.360755 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_seats"
[0m00:09:53.362865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m00:09:53.363402 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: BEGIN
[0m00:09:53.364497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:53.410373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m00:09:53.410923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m00:09:53.410923 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_seats"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code IS NOT NULL
    AND a.seat_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:09:53.450053 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m00:09:53.453125 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: COMMIT
[0m00:09:53.455318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m00:09:53.455883 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: COMMIT
[0m00:09:53.466835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m00:09:53.468779 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m00:09:53.471149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F4BFD4F0>]}
[0m00:09:53.472715 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_seats .... [[32mSELECT 0[0m in 0.14s]
[0m00:09:53.474672 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m00:09:53.476326 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m00:09:53.477346 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m00:09:53.479047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m00:09:53.480939 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m00:09:53.491613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m00:09:53.493708 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m00:09:53.502165 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_ticket_flights"
[0m00:09:53.504326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m00:09:53.505411 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: BEGIN
[0m00:09:53.506551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:09:53.553863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m00:09:53.555048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m00:09:53.556070 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.flight_id, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no IS NOT NULL
    AND a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.flight_id, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:09:53.604013 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m00:09:53.606227 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: COMMIT
[0m00:09:53.606760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m00:09:53.607823 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: COMMIT
[0m00:09:53.625911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m00:09:53.627519 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m00:09:53.628612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F474B230>]}
[0m00:09:53.630405 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[32mSELECT 0[0m in 0.15s]
[0m00:09:53.631514 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m00:09:53.633848 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m00:09:53.634948 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m00:09:53.637116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m00:09:53.638627 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m00:09:53.661391 [debug] [Thread-1 (]: Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
[0m00:09:53.662466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7be14b-547b-4402-a427-f5182fd69a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F5037620>]}
[0m00:09:53.664727 [error] [Thread-1 (]: 8 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.03s]
[0m00:09:53.666437 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m00:09:53.669204 [debug] [MainThread]: Using postgres connection "master"
[0m00:09:53.669739 [debug] [MainThread]: On master: BEGIN
[0m00:09:53.670807 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:09:53.716209 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m00:09:53.717206 [debug] [MainThread]: On master: COMMIT
[0m00:09:53.718719 [debug] [MainThread]: Using postgres connection "master"
[0m00:09:53.720057 [debug] [MainThread]: On master: COMMIT
[0m00:09:53.722765 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:09:53.724620 [debug] [MainThread]: On master: Close
[0m00:09:53.725730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:09:53.727537 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:09:53.728737 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m00:09:53.729892 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m00:09:53.731622 [info ] [MainThread]: 
[0m00:09:53.732632 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m00:09:53.735301 [debug] [MainThread]: Command end result
[0m00:09:53.803035 [info ] [MainThread]: 
[0m00:09:53.804708 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m00:09:53.806375 [info ] [MainThread]: 
[0m00:09:53.808563 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
[0m00:09:53.810287 [info ] [MainThread]: 
[0m00:09:53.810834 [error] [MainThread]:   Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_airports (models\raw_vault\sats\sat_airports.sql)
[0m00:09:53.814372 [info ] [MainThread]: 
[0m00:09:53.815440 [error] [MainThread]:   Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
[0m00:09:53.819176 [info ] [MainThread]: 
[0m00:09:53.822406 [error] [MainThread]:   Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_flights (models\raw_vault\sats\sat_flights.sql)
[0m00:09:53.824632 [info ] [MainThread]: 
[0m00:09:53.827368 [error] [MainThread]:   Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
[0m00:09:53.829070 [info ] [MainThread]: 
[0m00:09:53.830756 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=5 SKIP=0 TOTAL=8
[0m00:09:53.834171 [debug] [MainThread]: Command `dbt run` failed at 00:09:53.833628 after 4.19 seconds
[0m00:09:53.834701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F0889580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F46573E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F473C440>]}
[0m00:09:53.835728 [debug] [MainThread]: Flushing usage events
[0m00:21:55.635453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A34ACF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A5A54AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A61407D0>]}


============================== 00:21:55.642762 | 1ffb56f9-bb6e-411c-8564-a901408b8c3a ==============================
[0m00:21:55.642762 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:21:55.644431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:satellite', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:21:56.029746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A3CD1910>]}
[0m00:21:56.142896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A5DBC7A0>]}
[0m00:21:56.146011 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:21:56.452775 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:21:57.011136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:21:57.013143 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m00:21:57.014139 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m00:21:57.015788 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m00:21:57.016798 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m00:21:57.018321 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m00:21:57.019407 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m00:21:57.020463 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m00:21:57.021449 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m00:21:57.622227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7C80CE0>]}
[0m00:21:57.889406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7D90D10>]}
[0m00:21:57.890436 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:21:57.892440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7783080>]}
[0m00:21:57.896386 [info ] [MainThread]: 
[0m00:21:57.897909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:21:57.905443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:21:58.406327 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:21:58.407375 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:21:58.408394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:58.463401 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.055 seconds
[0m00:21:58.465120 [debug] [ThreadPool]: On list_postgres: Close
[0m00:21:58.473107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m00:21:58.480930 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:21:58.481986 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m00:21:58.483089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:58.526685 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m00:21:58.528408 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:21:58.529416 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m00:21:58.546580 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.016 seconds
[0m00:21:58.549090 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m00:21:58.551095 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m00:21:58.566425 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:58.567879 [debug] [MainThread]: On master: BEGIN
[0m00:21:58.568961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:21:58.616191 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m00:21:58.617247 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:58.618339 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:21:58.678749 [debug] [MainThread]: SQL status: SELECT 16 in 0.059 seconds
[0m00:21:58.681908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7F36690>]}
[0m00:21:58.683081 [debug] [MainThread]: On master: ROLLBACK
[0m00:21:58.685694 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:58.686707 [debug] [MainThread]: On master: BEGIN
[0m00:21:58.691689 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:21:58.691689 [debug] [MainThread]: On master: COMMIT
[0m00:21:58.693704 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:58.695072 [debug] [MainThread]: On master: COMMIT
[0m00:21:58.697829 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:21:58.698380 [debug] [MainThread]: On master: Close
[0m00:21:58.700173 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:21:58.701301 [info ] [MainThread]: 
[0m00:21:58.707681 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m00:21:58.709792 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m00:21:58.711523 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m00:21:58.713038 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m00:21:58.740548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_aircrafts"
[0m00:21:58.743229 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_aircrafts
[0m00:21:58.815396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m00:21:58.816441 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

    
  
    

  create temporary table "sat_aircrafts__dbt_tmp002158780882"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS a
    WHERE a.aircraft_code IS NOT NULL
),

latest_records AS (
    SELECT a.aircraft_code, a.aircrafts_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.aircraft_code, current_records.aircrafts_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.aircraft_code
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_aircrafts" AS current_records
            JOIN (
                SELECT DISTINCT source_data.aircraft_code
                FROM source_data
            ) AS source_records
                ON current_records.aircraft_code = source_records.aircraft_code
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.aircrafts_hashdiff, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.aircraft_code = stage.aircraft_code
        AND latest_records.aircrafts_hashdiff = stage.aircrafts_hashdiff
    WHERE latest_records.aircrafts_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:58.816985 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:58.877542 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.aircrafts_hashdiff does not exist
LINE 16:     SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a...
                                     ^
HINT:  Perhaps you meant to reference the column "a.aircraft_hashdiff".

[0m00:21:58.878655 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: Close
[0m00:21:58.896137 [debug] [Thread-1 (]: Database Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  column a.aircrafts_hashdiff does not exist
  LINE 16:     SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a...
                                       ^
  HINT:  Perhaps you meant to reference the column "a.aircraft_hashdiff".
[0m00:21:58.898403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7732FF0>]}
[0m00:21:58.900136 [error] [Thread-1 (]: 1 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.19s]
[0m00:21:58.901860 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m00:21:58.903537 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m00:21:58.905209 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m00:21:58.906741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m00:21:58.908363 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m00:21:58.926678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_airports"
[0m00:21:58.928896 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_airports
[0m00:21:58.935807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m00:21:58.937318 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

    
  
    

  create temporary table "sat_airports__dbt_tmp002158932822"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.airport_code, a.airports_hashdiff, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS a
    WHERE a.airport_code IS NOT NULL
),

latest_records AS (
    SELECT a.airport_code, a.airports_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.airport_code, current_records.airports_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.airport_code
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_airports" AS current_records
            JOIN (
                SELECT DISTINCT source_data.airport_code
                FROM source_data
            ) AS source_records
                ON current_records.airport_code = source_records.airport_code
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.airport_code, stage.airports_hashdiff, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.airport_code = stage.airport_code
        AND latest_records.airports_hashdiff = stage.airports_hashdiff
    WHERE latest_records.airports_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:58.938333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:58.985134 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.airports_hashdiff does not exist
LINE 16:     SELECT a.airport_code, a.airports_hashdiff, a.airport_na...
                                    ^
HINT:  Perhaps you meant to reference the column "a.airport_hashdiff".

[0m00:21:58.986655 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: Close
[0m00:21:58.991285 [debug] [Thread-1 (]: Database Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  column a.airports_hashdiff does not exist
  LINE 16:     SELECT a.airport_code, a.airports_hashdiff, a.airport_na...
                                      ^
  HINT:  Perhaps you meant to reference the column "a.airport_hashdiff".
[0m00:21:58.993135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7FB5220>]}
[0m00:21:58.995494 [error] [Thread-1 (]: 2 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.09s]
[0m00:21:58.998877 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m00:21:59.000004 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m00:21:59.002295 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m00:21:59.003964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m00:21:59.005088 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m00:21:59.023523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m00:21:59.026495 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m00:21:59.034728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m00:21:59.035242 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

    
  
    

  create temporary table "sat_boarding_passes__dbt_tmp002159030885"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.boarding_passes_hashdiff, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

latest_records AS (
    SELECT a.ticket_no, flight_id, a.boarding_passes_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.ticket_no, flight_id, current_records.boarding_passes_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ticket_no, flight_id
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ticket_no, flight_id
                FROM source_data
            ) AS source_records
                ON current_records.ticket_no, flight_id = source_records.ticket_no, flight_id
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.boarding_passes_hashdiff, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ticket_no, flight_id = stage.ticket_no, flight_id
        AND latest_records.boarding_passes_hashdiff = stage.boarding_passes_hashdiff
    WHERE latest_records.boarding_passes_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:59.035790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.090217 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m00:21:59.091572 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m00:21:59.097819 [debug] [Thread-1 (]: Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
[0m00:21:59.099995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7F2CAD0>]}
[0m00:21:59.100991 [error] [Thread-1 (]: 3 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.10s]
[0m00:21:59.104024 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m00:21:59.105016 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m00:21:59.106854 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m00:21:59.108557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m00:21:59.109116 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m00:21:59.126490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_bookings"
[0m00:21:59.128189 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_bookings
[0m00:21:59.134361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m00:21:59.135460 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

    
  
    

  create temporary table "sat_bookings__dbt_tmp002159132031"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS a
    WHERE a.book_ref IS NOT NULL
),

latest_records AS (
    SELECT a.book_ref, a.bookings_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.book_ref, current_records.bookings_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.book_ref
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_bookings" AS current_records
            JOIN (
                SELECT DISTINCT source_data.book_ref
                FROM source_data
            ) AS source_records
                ON current_records.book_ref = source_records.book_ref
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.book_ref, stage.bookings_hashdiff, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.book_ref = stage.book_ref
        AND latest_records.bookings_hashdiff = stage.bookings_hashdiff
    WHERE latest_records.bookings_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:59.136538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.184950 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.bookings_hashdiff does not exist
LINE 16:     SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.t...
                                ^
HINT:  Perhaps you meant to reference the column "a.booking_hashdiff".

[0m00:21:59.184950 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: Close
[0m00:21:59.190416 [debug] [Thread-1 (]: Database Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  column a.bookings_hashdiff does not exist
  LINE 16:     SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.t...
                                  ^
  HINT:  Perhaps you meant to reference the column "a.booking_hashdiff".
[0m00:21:59.191411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A806D460>]}
[0m00:21:59.192945 [error] [Thread-1 (]: 4 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.08s]
[0m00:21:59.195114 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m00:21:59.196252 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m00:21:59.206987 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m00:21:59.209179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m00:21:59.209732 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m00:21:59.233023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_flights"
[0m00:21:59.234712 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_flights
[0m00:21:59.241603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m00:21:59.242953 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

    
  
    

  create temporary table "sat_flights__dbt_tmp002159238715"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.departure_airport, a.arrival_airport, a.status, a.aircraft_code, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS a
    WHERE a.flight_id IS NOT NULL
),

latest_records AS (
    SELECT a.flight_id, a.flights_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.flight_id, current_records.flights_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.flight_id
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_flights" AS current_records
            JOIN (
                SELECT DISTINCT source_data.flight_id
                FROM source_data
            ) AS source_records
                ON current_records.flight_id = source_records.flight_id
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.flight_id, stage.flights_hashdiff, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.departure_airport, stage.arrival_airport, stage.status, stage.aircraft_code, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.flight_id = stage.flight_id
        AND latest_records.flights_hashdiff = stage.flights_hashdiff
    WHERE latest_records.flights_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:59.245025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.293751 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.flights_hashdiff does not exist
LINE 16:     SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.s...
                                 ^
HINT:  Perhaps you meant to reference the column "a.flight_hashdiff".

[0m00:21:59.294929 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: Close
[0m00:21:59.298916 [debug] [Thread-1 (]: Database Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  column a.flights_hashdiff does not exist
  LINE 16:     SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.s...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.flight_hashdiff".
[0m00:21:59.300039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7F0A4E0>]}
[0m00:21:59.302340 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.09s]
[0m00:21:59.304614 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m00:21:59.305153 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m00:21:59.306683 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m00:21:59.308086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m00:21:59.309414 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m00:21:59.328761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m00:21:59.330955 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m00:21:59.338942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m00:21:59.340161 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

    
  
    

  create temporary table "sat_seats__dbt_tmp002159335014"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, seat_no, a.seats_hashdiff, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code, seat_no IS NOT NULL
),

latest_records AS (
    SELECT a.aircraft_code, seat_no, a.seats_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.aircraft_code, seat_no, current_records.seats_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.aircraft_code, seat_no
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_seats" AS current_records
            JOIN (
                SELECT DISTINCT source_data.aircraft_code, seat_no
                FROM source_data
            ) AS source_records
                ON current_records.aircraft_code, seat_no = source_records.aircraft_code, seat_no
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, seat_no, stage.seats_hashdiff, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.aircraft_code, seat_no = stage.aircraft_code, seat_no
        AND latest_records.seats_hashdiff = stage.seats_hashdiff
    WHERE latest_records.seats_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:59.341155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.387947 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                  ^

[0m00:21:59.388947 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m00:21:59.394983 [debug] [Thread-1 (]: Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
[0m00:21:59.396077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A8059760>]}
[0m00:21:59.397195 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.09s]
[0m00:21:59.399807 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m00:21:59.401514 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m00:21:59.403280 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m00:21:59.405000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m00:21:59.405000 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m00:21:59.421063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m00:21:59.423145 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m00:21:59.431889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m00:21:59.431889 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

    
  
    

  create temporary table "sat_ticket_flights__dbt_tmp002159427873"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.ticket_flights_hashdiff, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

latest_records AS (
    SELECT a.ticket_no, flight_id, a.ticket_flights_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.ticket_no, flight_id, current_records.ticket_flights_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ticket_no, flight_id
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ticket_no, flight_id
                FROM source_data
            ) AS source_records
                ON current_records.ticket_no, flight_id = source_records.ticket_no, flight_id
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.ticket_flights_hashdiff, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ticket_no, flight_id = stage.ticket_no, flight_id
        AND latest_records.ticket_flights_hashdiff = stage.ticket_flights_hashdiff
    WHERE latest_records.ticket_flights_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:59.434714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.478429 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m00:21:59.480772 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m00:21:59.486637 [debug] [Thread-1 (]: Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
[0m00:21:59.487149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7F3ADE0>]}
[0m00:21:59.488163 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.08s]
[0m00:21:59.490360 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m00:21:59.491699 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m00:21:59.492834 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m00:21:59.494515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m00:21:59.494515 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m00:21:59.509621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_tickets"
[0m00:21:59.513464 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_tickets
[0m00:21:59.519547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m00:21:59.520628 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

    
  
    

  create temporary table "sat_tickets__dbt_tmp002159517366"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS a
    WHERE a.ticket_no IS NOT NULL
),

latest_records AS (
    SELECT a.ticket_no, a.tickets_hashdiff, a.LOAD_DATE
    FROM (
        SELECT current_records.ticket_no, current_records.tickets_hashdiff, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ticket_no
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_tickets" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ticket_no
                FROM source_data
            ) AS source_records
                ON current_records.ticket_no = source_records.ticket_no
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.tickets_hashdiff, stage.book_ref, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ticket_no = stage.ticket_no
        AND latest_records.tickets_hashdiff = stage.tickets_hashdiff
    WHERE latest_records.tickets_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m00:21:59.521184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:21:59.575914 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.tickets_hashdiff does not exist
LINE 16:     SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.pa...
                                 ^
HINT:  Perhaps you meant to reference the column "a.ticket_hashdiff".

[0m00:21:59.577010 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: Close
[0m00:21:59.581571 [debug] [Thread-1 (]: Database Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  column a.tickets_hashdiff does not exist
  LINE 16:     SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.pa...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.ticket_hashdiff".
[0m00:21:59.583272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffb56f9-bb6e-411c-8564-a901408b8c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A80590A0>]}
[0m00:21:59.583849 [error] [Thread-1 (]: 8 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.09s]
[0m00:21:59.586541 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m00:21:59.589087 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:59.589087 [debug] [MainThread]: On master: BEGIN
[0m00:21:59.591112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:21:59.637819 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m00:21:59.638893 [debug] [MainThread]: On master: COMMIT
[0m00:21:59.639490 [debug] [MainThread]: Using postgres connection "master"
[0m00:21:59.640615 [debug] [MainThread]: On master: COMMIT
[0m00:21:59.643398 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:21:59.644514 [debug] [MainThread]: On master: Close
[0m00:21:59.645618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:59.646725 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:21:59.647957 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m00:21:59.648514 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m00:21:59.649522 [info ] [MainThread]: 
[0m00:21:59.650549 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m00:21:59.654145 [debug] [MainThread]: Command end result
[0m00:21:59.716064 [info ] [MainThread]: 
[0m00:21:59.717716 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m00:21:59.718876 [info ] [MainThread]: 
[0m00:21:59.720566 [error] [MainThread]:   Database Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  column a.aircrafts_hashdiff does not exist
  LINE 16:     SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a...
                                       ^
  HINT:  Perhaps you meant to reference the column "a.aircraft_hashdiff".
[0m00:21:59.721671 [info ] [MainThread]: 
[0m00:21:59.723273 [error] [MainThread]:   Database Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  column a.airports_hashdiff does not exist
  LINE 16:     SELECT a.airport_code, a.airports_hashdiff, a.airport_na...
                                      ^
  HINT:  Perhaps you meant to reference the column "a.airport_hashdiff".
[0m00:21:59.724383 [info ] [MainThread]: 
[0m00:21:59.726224 [error] [MainThread]:   Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
[0m00:21:59.727286 [info ] [MainThread]: 
[0m00:21:59.729299 [error] [MainThread]:   Database Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  column a.bookings_hashdiff does not exist
  LINE 16:     SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.t...
                                  ^
  HINT:  Perhaps you meant to reference the column "a.booking_hashdiff".
[0m00:21:59.730297 [info ] [MainThread]: 
[0m00:21:59.731602 [error] [MainThread]:   Database Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  column a.flights_hashdiff does not exist
  LINE 16:     SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.s...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.flight_hashdiff".
[0m00:21:59.733637 [info ] [MainThread]: 
[0m00:21:59.735133 [error] [MainThread]:   Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
[0m00:21:59.736669 [info ] [MainThread]: 
[0m00:21:59.738016 [error] [MainThread]:   Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
[0m00:21:59.740137 [info ] [MainThread]: 
[0m00:21:59.741789 [error] [MainThread]:   Database Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  column a.tickets_hashdiff does not exist
  LINE 16:     SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.pa...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.ticket_hashdiff".
[0m00:21:59.743411 [info ] [MainThread]: 
[0m00:21:59.745065 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=0 TOTAL=8
[0m00:21:59.748027 [debug] [MainThread]: Command `dbt run` failed at 00:21:59.747476 after 4.49 seconds
[0m00:21:59.749845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A6087380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A7752A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257A774E300>]}
[0m00:21:59.750934 [debug] [MainThread]: Flushing usage events
[0m00:24:43.314357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C85CDB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8848A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C885F6D80>]}


============================== 00:24:43.321453 | 9a0a9dba-0a6b-4cbd-8693-6830d38c6a44 ==============================
[0m00:24:43.321453 [info ] [MainThread]: Running with dbt=1.8.9
[0m00:24:43.323659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:satellite', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:24:43.721745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C886B3E30>]}
[0m00:24:43.821372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C88835940>]}
[0m00:24:43.824868 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:24:44.138191 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m00:24:44.699082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:24:44.700392 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m00:24:44.701471 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m00:24:44.702584 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m00:24:44.704253 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m00:24:44.706021 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m00:24:44.707126 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m00:24:44.708217 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m00:24:44.708766 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m00:24:45.357493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C89CE8EC0>]}
[0m00:24:45.620722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C89CEC830>]}
[0m00:24:45.621297 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m00:24:45.623560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C89CD3740>]}
[0m00:24:45.627456 [info ] [MainThread]: 
[0m00:24:45.629092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:24:45.636019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m00:24:46.171068 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m00:24:46.172117 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m00:24:46.173113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:46.231121 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.059 seconds
[0m00:24:46.234128 [debug] [ThreadPool]: On list_postgres: Close
[0m00:24:46.240877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m00:24:46.248814 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:24:46.249357 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m00:24:46.250885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:46.294903 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m00:24:46.296423 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m00:24:46.297448 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m00:24:46.317189 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.018 seconds
[0m00:24:46.320433 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m00:24:46.322665 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m00:24:46.338370 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:46.339361 [debug] [MainThread]: On master: BEGIN
[0m00:24:46.340877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:24:46.387668 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m00:24:46.388796 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:46.390323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:24:46.463054 [debug] [MainThread]: SQL status: SELECT 16 in 0.072 seconds
[0m00:24:46.466583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A42DCA0>]}
[0m00:24:46.466583 [debug] [MainThread]: On master: ROLLBACK
[0m00:24:46.470077 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:46.472188 [debug] [MainThread]: On master: BEGIN
[0m00:24:46.476210 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:24:46.477230 [debug] [MainThread]: On master: COMMIT
[0m00:24:46.478235 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:46.479219 [debug] [MainThread]: On master: COMMIT
[0m00:24:46.482159 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:24:46.483257 [debug] [MainThread]: On master: Close
[0m00:24:46.484889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:46.486402 [info ] [MainThread]: 
[0m00:24:46.494468 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m00:24:46.495768 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m00:24:46.498375 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m00:24:46.499381 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m00:24:46.540788 [debug] [Thread-1 (]: Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
[0m00:24:46.544114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C89CFE960>]}
[0m00:24:46.545266 [error] [Thread-1 (]: 1 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.04s]
[0m00:24:46.547464 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m00:24:46.548593 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m00:24:46.551143 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m00:24:46.553300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m00:24:46.554308 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m00:24:46.576483 [debug] [Thread-1 (]: Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_airports (models\raw_vault\sats\sat_airports.sql)
[0m00:24:46.577504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A489070>]}
[0m00:24:46.579221 [error] [Thread-1 (]: 2 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.02s]
[0m00:24:46.581003 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m00:24:46.582638 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m00:24:46.584307 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m00:24:46.586615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m00:24:46.587744 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m00:24:46.612460 [debug] [Thread-1 (]: Compilation Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
[0m00:24:46.614111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A483A40>]}
[0m00:24:46.615241 [error] [Thread-1 (]: 3 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.03s]
[0m00:24:46.616893 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m00:24:46.618018 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m00:24:46.619673 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m00:24:46.621856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m00:24:46.622914 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m00:24:46.641286 [debug] [Thread-1 (]: Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
[0m00:24:46.643972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A55BC20>]}
[0m00:24:46.645679 [error] [Thread-1 (]: 4 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.02s]
[0m00:24:46.648238 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m00:24:46.648852 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m00:24:46.650401 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m00:24:46.652902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m00:24:46.654346 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m00:24:46.679165 [debug] [Thread-1 (]: Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_flights (models\raw_vault\sats\sat_flights.sql)
[0m00:24:46.680864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A48A000>]}
[0m00:24:46.682513 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.03s]
[0m00:24:46.684800 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m00:24:46.685952 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m00:24:46.687579 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m00:24:46.689355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m00:24:46.690886 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m00:24:46.708557 [debug] [Thread-1 (]: Compilation Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_seats (models\raw_vault\sats\sat_seats.sql)
[0m00:24:46.711115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A5DAB10>]}
[0m00:24:46.712127 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.02s]
[0m00:24:46.714126 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m00:24:46.715177 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m00:24:46.716182 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m00:24:46.718372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m00:24:46.719461 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m00:24:46.740012 [debug] [Thread-1 (]: Compilation Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
[0m00:24:46.741087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A6086B0>]}
[0m00:24:46.742267 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.02s]
[0m00:24:46.744415 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m00:24:46.745504 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m00:24:46.747296 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m00:24:46.748965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m00:24:46.750488 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m00:24:46.772324 [debug] [Thread-1 (]: Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
[0m00:24:46.773575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0a9dba-0a6b-4cbd-8693-6830d38c6a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A608770>]}
[0m00:24:46.775945 [error] [Thread-1 (]: 8 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.02s]
[0m00:24:46.780100 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m00:24:46.782828 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:46.783948 [debug] [MainThread]: On master: BEGIN
[0m00:24:46.784478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:24:46.851017 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m00:24:46.852015 [debug] [MainThread]: On master: COMMIT
[0m00:24:46.853012 [debug] [MainThread]: Using postgres connection "master"
[0m00:24:46.854013 [debug] [MainThread]: On master: COMMIT
[0m00:24:46.855371 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m00:24:46.857946 [debug] [MainThread]: On master: Close
[0m00:24:46.859600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:46.861283 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m00:24:46.862937 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m00:24:46.864057 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m00:24:46.864616 [info ] [MainThread]: 
[0m00:24:46.866886 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m00:24:46.868539 [debug] [MainThread]: Command end result
[0m00:24:46.931899 [info ] [MainThread]: 
[0m00:24:46.934225 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m00:24:46.935238 [info ] [MainThread]: 
[0m00:24:46.937255 [error] [MainThread]:   Compilation Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
[0m00:24:46.938964 [info ] [MainThread]: 
[0m00:24:46.940635 [error] [MainThread]:   Compilation Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_airports (models\raw_vault\sats\sat_airports.sql)
[0m00:24:46.942323 [info ] [MainThread]: 
[0m00:24:46.943435 [error] [MainThread]:   Compilation Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
[0m00:24:46.945104 [info ] [MainThread]: 
[0m00:24:46.946822 [error] [MainThread]:   Compilation Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
[0m00:24:46.948653 [info ] [MainThread]: 
[0m00:24:46.949965 [error] [MainThread]:   Compilation Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_flights (models\raw_vault\sats\sat_flights.sql)
[0m00:24:46.951979 [info ] [MainThread]: 
[0m00:24:46.952977 [error] [MainThread]:   Compilation Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_seats (models\raw_vault\sats\sat_seats.sql)
[0m00:24:46.955652 [info ] [MainThread]: 
[0m00:24:46.957807 [error] [MainThread]:   Compilation Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
[0m00:24:46.960013 [info ] [MainThread]: 
[0m00:24:46.961657 [error] [MainThread]:   Compilation Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  Invalid parameters provided to prefix macro. Expected: (columns [list/string], prefix_str [string]) got: (, latest_records)
  
  > in macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro default__prefix (macros\supporting\prefix.sql)
  > called by macro prefix (macros\supporting\prefix.sql)
  > called by macro postgres__sat (macros\tables\postgres\sat.sql)
  > called by macro sat (macros\tables\snowflake\sat.sql)
  > called by model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
[0m00:24:46.962795 [info ] [MainThread]: 
[0m00:24:46.963862 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=0 TOTAL=8
[0m00:24:46.969171 [debug] [MainThread]: Command `dbt run` failed at 00:24:46.969171 after 4.01 seconds
[0m00:24:46.970217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C85CDB800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C89CE8E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8A5524B0>]}
[0m00:24:46.971278 [debug] [MainThread]: Flushing usage events
[0m16:43:37.486766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E49E6CF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4B82A540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4CB02300>]}


============================== 16:43:37.494944 | 3adb69f5-063d-4771-acb5-0b751bbfb152 ==============================
[0m16:43:37.494944 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:43:37.496027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:raw', 'send_anonymous_usage_stats': 'True'}
[0m16:43:38.098066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4BC4B380>]}
[0m16:43:38.165131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4CC61F10>]}
[0m16:43:38.168026 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:43:38.449672 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:43:40.890530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 27 files changed.
[0m16:43:40.891695 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_aircrafts.sql
[0m16:43:40.892279 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_tickets.sql
[0m16:43:40.892279 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m16:43:40.892874 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_tickets_bookings.sql
[0m16:43:40.894071 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m16:43:40.894637 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_bookings.sql
[0m16:43:40.895165 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m16:43:40.895165 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m16:43:40.895715 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_aircrafts.sql
[0m16:43:40.896254 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_airports.sql
[0m16:43:40.896822 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_boarding_passes.sql
[0m16:43:40.897389 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m16:43:40.897935 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_ticket_flights.sql
[0m16:43:40.898479 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_flights.sql
[0m16:43:40.899056 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_airports.sql
[0m16:43:40.899056 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_tickets.sql
[0m16:43:40.899586 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m16:43:40.900136 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_ticket_flights.sql
[0m16:43:40.900136 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_aircrafts_seats.sql
[0m16:43:40.900675 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m16:43:40.901212 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_flights_airports.sql
[0m16:43:40.901796 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_flights.sql
[0m16:43:40.902374 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_boarding_passes.sql
[0m16:43:40.902916 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\hubs\hub_seats.sql
[0m16:43:40.903493 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m16:43:40.903493 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_seats.sql
[0m16:43:40.904031 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\stage\stg_bookings.sql
[0m16:43:41.771657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E75F4D0>]}
[0m16:43:41.938141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E72B830>]}
[0m16:43:41.939216 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m16:43:41.939756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E13FA10>]}
[0m16:43:41.941935 [info ] [MainThread]: 
[0m16:43:41.942481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:41.946773 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:43:42.403933 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:43:42.404934 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:43:42.405999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:42.692191 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.286 seconds
[0m16:43:42.693900 [debug] [ThreadPool]: On list_postgres: Close
[0m16:43:42.699115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m16:43:42.708527 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:43:42.709189 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m16:43:42.709189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:42.753614 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:43:42.753614 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:43:42.753614 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m16:43:42.913298 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.158 seconds
[0m16:43:42.915546 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m16:43:42.917734 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m16:43:42.930094 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:42.930646 [debug] [MainThread]: On master: BEGIN
[0m16:43:42.930646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:42.973168 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m16:43:42.973861 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:42.974401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:43.103529 [debug] [MainThread]: SQL status: SELECT 16 in 0.128 seconds
[0m16:43:43.106864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E2FF050>]}
[0m16:43:43.106864 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:43.112131 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:43.113635 [debug] [MainThread]: On master: BEGIN
[0m16:43:43.116182 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:43:43.117715 [debug] [MainThread]: On master: COMMIT
[0m16:43:43.118259 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:43.118801 [debug] [MainThread]: On master: COMMIT
[0m16:43:43.120630 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:43:43.121140 [debug] [MainThread]: On master: Close
[0m16:43:43.122171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:43.124170 [info ] [MainThread]: 
[0m16:43:43.138344 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m16:43:43.138889 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ............ [RUN]
[0m16:43:43.140171 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_aircrafts'
[0m16:43:43.140171 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m16:43:43.149618 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.150926 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m16:43:43.186426 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.190134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.190686 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m16:43:43.191225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:43.258176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m16:43:43.259371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.259988 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m16:43:43.453219 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.192 seconds
[0m16:43:43.461548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.462602 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts" rename to "raw_aircrafts__dbt_backup"
[0m16:43:43.466358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:43:43.471711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.472240 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp" rename to "raw_aircrafts"
[0m16:43:43.474414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:43.490260 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m16:43:43.491498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.492008 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m16:43:43.507296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m16:43:43.516685 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup"
[0m16:43:43.521413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m16:43:43.522499 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup" cascade
[0m16:43:43.595136 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.071 seconds
[0m16:43:43.598981 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m16:43:43.601720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4A690800>]}
[0m16:43:43.602829 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_aircrafts ....... [[32mCREATE VIEW[0m in 0.46s]
[0m16:43:43.604573 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m16:43:43.605108 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_airports
[0m16:43:43.606223 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.raw_airports ............. [RUN]
[0m16:43:43.607856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_airports)
[0m16:43:43.608413 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_airports
[0m16:43:43.611753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m16:43:43.614147 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_airports
[0m16:43:43.620725 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m16:43:43.621729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m16:43:43.622724 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m16:43:43.623739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:43.670314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m16:43:43.671459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m16:43:43.672010 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m16:43:43.689475 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m16:43:43.693036 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m16:43:43.693574 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports" rename to "raw_airports__dbt_backup"
[0m16:43:43.695162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:43.699875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m16:43:43.700886 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m16:43:43.701886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:43.703886 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m16:43:43.704883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m16:43:43.705388 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m16:43:43.709280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:43:43.712300 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup"
[0m16:43:43.713302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m16:43:43.713302 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup" cascade
[0m16:43:43.721196 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m16:43:43.722195 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: Close
[0m16:43:43.723193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E9992B0>]}
[0m16:43:43.724198 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_airports ........ [[32mCREATE VIEW[0m in 0.12s]
[0m16:43:43.725204 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_airports
[0m16:43:43.725204 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m16:43:43.726809 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ...... [RUN]
[0m16:43:43.728295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_boarding_passes)
[0m16:43:43.729234 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m16:43:43.734550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.736337 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m16:43:43.740186 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.741195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.742197 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m16:43:43.742197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:43.786295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:43:43.788262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.788846 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m16:43:43.806070 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m16:43:43.811033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.811579 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes" rename to "raw_boarding_passes__dbt_backup"
[0m16:43:43.814336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:43.818303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.818841 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp" rename to "raw_boarding_passes"
[0m16:43:43.819982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:43.822595 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m16:43:43.822595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.823592 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m16:43:43.829579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:43:43.832987 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup"
[0m16:43:43.833528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m16:43:43.834253 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup" cascade
[0m16:43:43.842537 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:43:43.843539 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m16:43:43.845046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E712750>]}
[0m16:43:43.847220 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_boarding_passes . [[32mCREATE VIEW[0m in 0.12s]
[0m16:43:43.849125 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m16:43:43.849719 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m16:43:43.850897 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............. [RUN]
[0m16:43:43.852112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_bookings)
[0m16:43:43.852790 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m16:43:43.858818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m16:43:43.859938 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m16:43:43.865733 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m16:43:43.867392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m16:43:43.868119 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m16:43:43.869209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:43.923051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m16:43:43.923051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m16:43:43.924273 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m16:43:43.940911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m16:43:43.943932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m16:43:43.944934 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings" rename to "raw_bookings__dbt_backup"
[0m16:43:43.950174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:43:43.955155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m16:43:43.955697 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp" rename to "raw_bookings"
[0m16:43:43.957911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:43.959628 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m16:43:43.960154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m16:43:43.960154 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m16:43:43.965253 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:43:43.968597 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup"
[0m16:43:43.969108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m16:43:43.969659 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup" cascade
[0m16:43:43.980316 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m16:43:43.982204 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m16:43:43.983483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4EADF050>]}
[0m16:43:43.984073 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_bookings ........ [[32mCREATE VIEW[0m in 0.13s]
[0m16:43:43.986113 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m16:43:43.986653 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_flights
[0m16:43:43.987204 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.raw_flights .............. [RUN]
[0m16:43:43.988322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_flights)
[0m16:43:43.988877 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_flights
[0m16:43:43.992440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m16:43:43.993573 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_flights
[0m16:43:43.998669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m16:43:43.999779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m16:43:43.999779 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m16:43:44.000845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.048337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m16:43:44.048924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m16:43:44.048924 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m16:43:44.086161 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.038 seconds
[0m16:43:44.091351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m16:43:44.091879 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights" rename to "raw_flights__dbt_backup"
[0m16:43:44.094180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:44.096685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m16:43:44.097696 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp" rename to "raw_flights"
[0m16:43:44.099863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:44.102280 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m16:43:44.102280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m16:43:44.102280 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m16:43:44.107294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:43:44.111962 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup"
[0m16:43:44.112961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m16:43:44.112961 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup" cascade
[0m16:43:44.121660 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:43:44.122651 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: Close
[0m16:43:44.123712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E999E20>]}
[0m16:43:44.125229 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_flights ......... [[32mCREATE VIEW[0m in 0.14s]
[0m16:43:44.126316 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_flights
[0m16:43:44.126316 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_seats
[0m16:43:44.126316 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.raw_seats ................ [RUN]
[0m16:43:44.128004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.raw_seats)
[0m16:43:44.129095 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_seats
[0m16:43:44.132510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m16:43:44.133646 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_seats
[0m16:43:44.139445 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m16:43:44.140999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m16:43:44.140999 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m16:43:44.142003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.201861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m16:43:44.203569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m16:43:44.204179 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m16:43:44.218576 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m16:43:44.223442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m16:43:44.224549 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats" rename to "raw_seats__dbt_backup"
[0m16:43:44.227300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:44.230718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m16:43:44.231317 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp" rename to "raw_seats"
[0m16:43:44.233414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:44.234935 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m16:43:44.235616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m16:43:44.235616 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m16:43:44.240141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:43:44.243288 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup"
[0m16:43:44.244360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m16:43:44.244360 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup" cascade
[0m16:43:44.250930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m16:43:44.252617 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: Close
[0m16:43:44.253916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4E99A120>]}
[0m16:43:44.255015 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_seats ........... [[32mCREATE VIEW[0m in 0.13s]
[0m16:43:44.255581 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_seats
[0m16:43:44.256123 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m16:43:44.257240 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ....... [RUN]
[0m16:43:44.257801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.raw_ticket_flights)
[0m16:43:44.258357 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m16:43:44.261509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.262827 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m16:43:44.267162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.268989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.270604 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m16:43:44.272537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.316396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:43:44.317904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.318409 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m16:43:44.331911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m16:43:44.336425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.336425 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights" rename to "raw_ticket_flights__dbt_backup"
[0m16:43:44.339306 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:44.344287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.344975 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp" rename to "raw_ticket_flights"
[0m16:43:44.347770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:44.349652 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m16:43:44.350252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.350807 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m16:43:44.356533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:43:44.360208 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup"
[0m16:43:44.361352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m16:43:44.361934 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup" cascade
[0m16:43:44.370209 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m16:43:44.371523 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m16:43:44.372077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4EB75250>]}
[0m16:43:44.373189 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_ticket_flights .. [[32mCREATE VIEW[0m in 0.11s]
[0m16:43:44.374320 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m16:43:44.374320 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m16:43:44.376543 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.raw_tickets .............. [RUN]
[0m16:43:44.377679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.raw_tickets)
[0m16:43:44.378411 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m16:43:44.382215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m16:43:44.383213 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m16:43:44.385722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m16:43:44.387233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m16:43:44.388379 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m16:43:44.388379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.430387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m16:43:44.431489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m16:43:44.432035 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m16:43:44.451413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m16:43:44.455631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m16:43:44.456183 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets" rename to "raw_tickets__dbt_backup"
[0m16:43:44.458379 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:44.461154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m16:43:44.462163 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp" rename to "raw_tickets"
[0m16:43:44.464164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:44.465674 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m16:43:44.465674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m16:43:44.466687 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m16:43:44.472196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:43:44.475424 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup"
[0m16:43:44.475998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m16:43:44.476599 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup" cascade
[0m16:43:44.484004 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m16:43:44.485512 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m16:43:44.485512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adb69f5-063d-4771-acb5-0b751bbfb152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4EB0DF70>]}
[0m16:43:44.486961 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_tickets ......... [[32mCREATE VIEW[0m in 0.11s]
[0m16:43:44.488730 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m16:43:44.489801 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:44.490561 [debug] [MainThread]: On master: BEGIN
[0m16:43:44.491158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:44.558802 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m16:43:44.560005 [debug] [MainThread]: On master: COMMIT
[0m16:43:44.561694 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:44.561694 [debug] [MainThread]: On master: COMMIT
[0m16:43:44.563697 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:43:44.564989 [debug] [MainThread]: On master: Close
[0m16:43:44.566094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:44.566094 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:43:44.566094 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m16:43:44.567602 [debug] [MainThread]: Connection 'model.dbt_dwh.raw_tickets' was properly closed.
[0m16:43:44.567602 [info ] [MainThread]: 
[0m16:43:44.569260 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.63 seconds (2.63s).
[0m16:43:44.571482 [debug] [MainThread]: Command end result
[0m16:43:44.733266 [info ] [MainThread]: 
[0m16:43:44.734355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:44.735477 [info ] [MainThread]: 
[0m16:43:44.736023 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:43:44.738187 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:44.737654 after 7.60 seconds
[0m16:43:44.738805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4C8648C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4C864170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E4CB43E60>]}
[0m16:43:44.739537 [debug] [MainThread]: Flushing usage events
[0m16:44:21.517962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADD018260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADD4D3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADCB29F70>]}


============================== 16:44:21.523541 | 629de919-f362-4f39-91e0-e7586eb1a53d ==============================
[0m16:44:21.523541 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:44:21.525200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:stage', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:21.805445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC8FC5C0>]}
[0m16:44:21.865161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC926E40>]}
[0m16:44:21.867270 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:44:22.068134 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:44:22.422622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:22.423631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:22.457924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADD914380>]}
[0m16:44:22.594189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADEE84B30>]}
[0m16:44:22.595288 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m16:44:22.596021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADD790A40>]}
[0m16:44:22.598224 [info ] [MainThread]: 
[0m16:44:22.599291 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:22.603039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:44:22.888412 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:44:22.889877 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:44:22.889877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:22.947712 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.057 seconds
[0m16:44:22.949888 [debug] [ThreadPool]: On list_postgres: Close
[0m16:44:22.953333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m16:44:22.960364 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:44:22.960889 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m16:44:22.960889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:23.004824 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m16:44:23.004824 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:44:23.006114 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m16:44:23.022599 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.016 seconds
[0m16:44:23.024924 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m16:44:23.026292 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m16:44:23.036231 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:23.036766 [debug] [MainThread]: On master: BEGIN
[0m16:44:23.036766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:23.077284 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m16:44:23.077823 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:23.078414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:23.127341 [debug] [MainThread]: SQL status: SELECT 8 in 0.049 seconds
[0m16:44:23.129524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADB385910>]}
[0m16:44:23.130062 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:23.131746 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:23.132298 [debug] [MainThread]: On master: BEGIN
[0m16:44:23.139413 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:44:23.140589 [debug] [MainThread]: On master: COMMIT
[0m16:44:23.141976 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:23.141976 [debug] [MainThread]: On master: COMMIT
[0m16:44:23.144782 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:44:23.144782 [debug] [MainThread]: On master: Close
[0m16:44:23.144782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:23.147187 [info ] [MainThread]: 
[0m16:44:23.151537 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m16:44:23.152661 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.stg_aircrafts ............ [RUN]
[0m16:44:23.153855 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.stg_aircrafts'
[0m16:44:23.154984 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_aircrafts
[0m16:44:23.206851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.206851 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: BEGIN
[0m16:44:23.206851 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:23.259446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m16:44:23.260131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.260131 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:23.437257 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.176 seconds
[0m16:44:23.489681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.490681 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:23.494681 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m16:44:23.551797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.553446 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_aircrafts
[0m16:44:23.585461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.587137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.587733 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'AIRCRAFTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS aircraft_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS aircraft_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    aircraft_pk,
    aircraft_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:23.651886 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.064 seconds
[0m16:44:23.658211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.659333 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m16:44:23.661885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:44:23.676428 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m16:44:23.676428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.677862 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m16:44:23.693206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m16:44:23.703009 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup"
[0m16:44:23.708013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m16:44:23.708545 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m16:44:23.710748 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:44:23.713487 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: Close
[0m16:44:23.716957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADB3207A0>]}
[0m16:44:23.718032 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_aircrafts ....... [[32mCREATE VIEW[0m in 0.56s]
[0m16:44:23.719105 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m16:44:23.719633 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_airports
[0m16:44:23.720723 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.stg_airports ............. [RUN]
[0m16:44:23.721271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_aircrafts, now model.dbt_dwh.stg_airports)
[0m16:44:23.721802 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_airports
[0m16:44:23.729662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m16:44:23.730778 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: BEGIN
[0m16:44:23.731315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:23.776083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m16:44:23.777095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m16:44:23.777095 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:23.815111 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.038 seconds
[0m16:44:23.821563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m16:44:23.822115 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:23.826152 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.003 seconds
[0m16:44:23.836287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_airports"
[0m16:44:23.837498 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_airports
[0m16:44:23.840767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_airports"
[0m16:44:23.841781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m16:44:23.841781 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_airports"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'AIRPORTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS airport_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS airport_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    airport_pk,
    airport_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:23.853739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:44:23.857074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m16:44:23.858204 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m16:44:23.860397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:44:23.861487 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m16:44:23.862085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m16:44:23.862632 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m16:44:23.865957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:44:23.868704 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup"
[0m16:44:23.869711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m16:44:23.869711 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup" cascade
[0m16:44:23.871810 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:44:23.872988 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: Close
[0m16:44:23.873988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADF60C350>]}
[0m16:44:23.874989 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_airports ........ [[32mCREATE VIEW[0m in 0.15s]
[0m16:44:23.876497 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_airports
[0m16:44:23.876497 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m16:44:23.877507 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.stg_boarding_passes ...... [RUN]
[0m16:44:23.878515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_airports, now model.dbt_dwh.stg_boarding_passes)
[0m16:44:23.878515 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_boarding_passes
[0m16:44:23.889006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m16:44:23.890204 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: BEGIN
[0m16:44:23.891268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:23.937157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m16:44:23.937157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m16:44:23.939140 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:23.981956 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.042 seconds
[0m16:44:23.986208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m16:44:23.987712 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:23.991117 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m16:44:24.072405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_boarding_passes"
[0m16:44:24.074500 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_boarding_passes
[0m16:44:24.076908 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_boarding_passes"
[0m16:44:24.078413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m16:44:24.079498 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'BOARDING_PASSES'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS boarding_pass_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    boarding_pass_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:24.091708 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m16:44:24.096120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m16:44:24.096120 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m16:44:24.098392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:44:24.098902 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m16:44:24.100261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m16:44:24.100261 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m16:44:24.105132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:44:24.107293 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m16:44:24.107293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m16:44:24.109387 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m16:44:24.110398 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:44:24.112452 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: Close
[0m16:44:24.113455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADF417290>]}
[0m16:44:24.114461 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_boarding_passes . [[32mCREATE VIEW[0m in 0.23s]
[0m16:44:24.115969 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m16:44:24.115969 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m16:44:24.117048 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.stg_bookings ............. [RUN]
[0m16:44:24.118505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_boarding_passes, now model.dbt_dwh.stg_bookings)
[0m16:44:24.118505 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_bookings
[0m16:44:24.126192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m16:44:24.126192 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: BEGIN
[0m16:44:24.127328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:24.171390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m16:44:24.172409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m16:44:24.172409 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.212815 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.040 seconds
[0m16:44:24.217671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m16:44:24.219393 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.222911 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:44:24.232131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_bookings"
[0m16:44:24.233820 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_bookings
[0m16:44:24.237036 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_bookings"
[0m16:44:24.238145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m16:44:24.238705 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'BOOKINGS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS booking_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    booking_pk,
    booking_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:24.252306 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m16:44:24.255583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m16:44:24.256139 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m16:44:24.258069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:44:24.259698 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m16:44:24.259698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m16:44:24.260245 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m16:44:24.264984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:44:24.267449 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup"
[0m16:44:24.267449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m16:44:24.267449 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m16:44:24.270639 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:44:24.271752 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: Close
[0m16:44:24.272750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADF47A690>]}
[0m16:44:24.273949 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_bookings ........ [[32mCREATE VIEW[0m in 0.16s]
[0m16:44:24.276013 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m16:44:24.276013 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_flights
[0m16:44:24.277324 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.stg_flights .............. [RUN]
[0m16:44:24.277324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_bookings, now model.dbt_dwh.stg_flights)
[0m16:44:24.277324 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_flights
[0m16:44:24.287106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m16:44:24.287106 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: BEGIN
[0m16:44:24.288539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:24.347424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m16:44:24.349385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m16:44:24.349385 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.398173 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.048 seconds
[0m16:44:24.404761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m16:44:24.404761 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.410286 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m16:44:24.420680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_flights"
[0m16:44:24.421679 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_flights
[0m16:44:24.425202 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_flights"
[0m16:44:24.426202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m16:44:24.427524 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    flight_pk,
    flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:24.440629 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m16:44:24.443834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m16:44:24.443834 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m16:44:24.446952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:44:24.448659 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m16:44:24.449194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m16:44:24.449194 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m16:44:24.454138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:44:24.456806 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup"
[0m16:44:24.457357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m16:44:24.457357 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup" cascade
[0m16:44:24.459623 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:44:24.460645 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: Close
[0m16:44:24.461638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADF5D5610>]}
[0m16:44:24.462658 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_flights ......... [[32mCREATE VIEW[0m in 0.18s]
[0m16:44:24.463660 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_flights
[0m16:44:24.464766 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_seats
[0m16:44:24.464766 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.stg_seats ................ [RUN]
[0m16:44:24.466277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_flights, now model.dbt_dwh.stg_seats)
[0m16:44:24.467289 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_seats
[0m16:44:24.474655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m16:44:24.474655 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: BEGIN
[0m16:44:24.476165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:24.527490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m16:44:24.528500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m16:44:24.528500 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.567349 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.039 seconds
[0m16:44:24.576244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m16:44:24.576244 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.580424 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:44:24.589334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_seats"
[0m16:44:24.590399 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_seats
[0m16:44:24.594426 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_seats"
[0m16:44:24.595415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m16:44:24.595415 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_seats"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'SEATS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS seat_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS seat_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    seat_pk,
    seat_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:24.609126 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m16:44:24.611878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m16:44:24.612393 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m16:44:24.614404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:44:24.615405 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m16:44:24.615405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m16:44:24.616404 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m16:44:24.620819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:44:24.623328 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup"
[0m16:44:24.624342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m16:44:24.625344 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup" cascade
[0m16:44:24.626342 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:44:24.627735 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: Close
[0m16:44:24.628734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADF58E810>]}
[0m16:44:24.630336 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_seats ........... [[32mCREATE VIEW[0m in 0.16s]
[0m16:44:24.631905 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_seats
[0m16:44:24.631905 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m16:44:24.633316 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.stg_ticket_flights ....... [RUN]
[0m16:44:24.634317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_seats, now model.dbt_dwh.stg_ticket_flights)
[0m16:44:24.635317 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_ticket_flights
[0m16:44:24.643909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.643909 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: BEGIN
[0m16:44:24.644913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:24.707202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m16:44:24.707202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.707202 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.759565 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.050 seconds
[0m16:44:24.766078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.767088 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.771456 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:44:24.780241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.781986 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_ticket_flights
[0m16:44:24.786501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.788509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.788509 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'TICKET_FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    ticket_flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:24.804951 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m16:44:24.808974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.809980 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m16:44:24.812038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:44:24.813189 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m16:44:24.814187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.815189 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m16:44:24.821130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:44:24.823646 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m16:44:24.824660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m16:44:24.825186 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m16:44:24.826196 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:44:24.827622 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: Close
[0m16:44:24.828618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADD914DD0>]}
[0m16:44:24.830068 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_ticket_flights .. [[32mCREATE VIEW[0m in 0.19s]
[0m16:44:24.831168 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m16:44:24.831745 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_tickets
[0m16:44:24.833400 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.stg_tickets .............. [RUN]
[0m16:44:24.834501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_ticket_flights, now model.dbt_dwh.stg_tickets)
[0m16:44:24.835643 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_tickets
[0m16:44:24.849299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m16:44:24.849299 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: BEGIN
[0m16:44:24.850310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:24.919938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m16:44:24.920930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m16:44:24.920930 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.966344 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.044 seconds
[0m16:44:24.975185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m16:44:24.976240 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:24.980647 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m16:44:24.990203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_tickets"
[0m16:44:24.991216 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_tickets
[0m16:44:24.995463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_tickets"
[0m16:44:24.996597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m16:44:24.997143 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'TICKETS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS ticket_pk,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_fk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    ticket_pk,
    booking_fk,
    ticket_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m16:44:25.009700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m16:44:25.012711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m16:44:25.013712 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m16:44:25.014720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:44:25.017268 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m16:44:25.018068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m16:44:25.018577 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m16:44:25.022130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:44:25.025181 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup"
[0m16:44:25.026177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m16:44:25.026177 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m16:44:25.027324 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:44:25.028830 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: Close
[0m16:44:25.030050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '629de919-f362-4f39-91e0-e7586eb1a53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADF68DA30>]}
[0m16:44:25.031178 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_tickets ......... [[32mCREATE VIEW[0m in 0.20s]
[0m16:44:25.032392 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_tickets
[0m16:44:25.034008 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:25.034559 [debug] [MainThread]: On master: BEGIN
[0m16:44:25.035109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:25.072455 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m16:44:25.073463 [debug] [MainThread]: On master: COMMIT
[0m16:44:25.073463 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:25.074179 [debug] [MainThread]: On master: COMMIT
[0m16:44:25.075189 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:44:25.076186 [debug] [MainThread]: On master: Close
[0m16:44:25.076186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:25.076186 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:44:25.076186 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m16:44:25.077489 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_tickets' was properly closed.
[0m16:44:25.078492 [info ] [MainThread]: 
[0m16:44:25.079503 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m16:44:25.081973 [debug] [MainThread]: Command end result
[0m16:44:25.127767 [info ] [MainThread]: 
[0m16:44:25.129316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:25.130364 [info ] [MainThread]: 
[0m16:44:25.130925 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:44:25.132595 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:25.132595 after 3.80 seconds
[0m16:44:25.133120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADF555AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADD6D7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADD6D6D20>]}
[0m16:44:25.133120 [debug] [MainThread]: Flushing usage events
[0m16:44:39.627834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9B43D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9B42840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9B438F0>]}


============================== 16:44:39.633980 | 547e1df4-ca1f-4d8b-8301-9b109a9dcf59 ==============================
[0m16:44:39.633980 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:44:39.635078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:hub', 'send_anonymous_usage_stats': 'True'}
[0m16:44:39.908412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9EDB8F0>]}
[0m16:44:39.971804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9918440>]}
[0m16:44:39.973454 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:44:40.180474 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:44:40.420460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:40.420460 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:40.455393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9EBA510>]}
[0m16:44:40.599672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB224590>]}
[0m16:44:40.600680 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m16:44:40.600680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9F77A10>]}
[0m16:44:40.603680 [info ] [MainThread]: 
[0m16:44:40.604679 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:40.608968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:44:40.849622 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:44:40.850383 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:44:40.850931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:40.929859 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.078 seconds
[0m16:44:40.932017 [debug] [ThreadPool]: On list_postgres: Close
[0m16:44:40.936460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m16:44:40.943620 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:44:40.944625 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m16:44:40.944625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:40.989297 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:44:40.990305 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:44:40.990989 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m16:44:41.007504 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.017 seconds
[0m16:44:41.011658 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m16:44:41.013873 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m16:44:41.028971 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:41.029980 [debug] [MainThread]: On master: BEGIN
[0m16:44:41.030822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:41.096884 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m16:44:41.098003 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:41.099103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:41.132820 [debug] [MainThread]: SQL status: SELECT 16 in 0.033 seconds
[0m16:44:41.135610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB073290>]}
[0m16:44:41.136127 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:41.137831 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:41.137831 [debug] [MainThread]: On master: BEGIN
[0m16:44:41.140607 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:44:41.141153 [debug] [MainThread]: On master: COMMIT
[0m16:44:41.141702 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:41.141702 [debug] [MainThread]: On master: COMMIT
[0m16:44:41.143479 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:44:41.145493 [debug] [MainThread]: On master: Close
[0m16:44:41.147761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:41.149302 [info ] [MainThread]: 
[0m16:44:41.155050 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m16:44:41.155586 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m16:44:41.157191 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m16:44:41.157705 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m16:44:41.189565 [info ] [Thread-1 (]: 16:44:41 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m16:44:41.281432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.283445 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m16:44:41.338392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.339721 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp164441313896"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:44:41.340825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:41.480865 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.140 seconds
[0m16:44:41.493379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.493937 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m16:44:41.495695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:44:41.497918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.498528 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp164441313896'
        
      order by ordinal_position

  
[0m16:44:41.544559 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.044 seconds
[0m16:44:41.550918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.551488 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:41.555909 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m16:44:41.563586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.564111 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:41.569473 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m16:44:41.581766 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.582823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.583832 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp164441313896"
    )


  
[0m16:44:41.587697 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m16:44:41.604786 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m16:44:41.606655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m16:44:41.606655 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m16:44:41.622762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m16:44:41.624480 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m16:44:41.626569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E76D06B0>]}
[0m16:44:41.626569 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mINSERT 0 0[0m in 0.47s]
[0m16:44:41.627608 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m16:44:41.627608 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m16:44:41.629612 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m16:44:41.630538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m16:44:41.631080 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m16:44:41.638270 [info ] [Thread-1 (]: 16:44:41 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m16:44:41.644711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m16:44:41.646696 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m16:44:41.652289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m16:44:41.653374 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp164441650081"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:44:41.653929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:41.782116 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.128 seconds
[0m16:44:41.786472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m16:44:41.787637 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m16:44:41.790322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:44:41.791676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m16:44:41.792247 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp164441650081'
        
      order by ordinal_position

  
[0m16:44:41.832310 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.040 seconds
[0m16:44:41.836470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m16:44:41.837042 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:41.840866 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m16:44:41.844663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m16:44:41.844663 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:41.848735 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:44:41.851381 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m16:44:41.853107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m16:44:41.853657 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp164441650081"
    )


  
[0m16:44:41.856558 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m16:44:41.858930 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m16:44:41.859476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m16:44:41.860059 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m16:44:41.874675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m16:44:41.875852 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m16:44:41.877161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB11DF70>]}
[0m16:44:41.878320 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mINSERT 0 0[0m in 0.25s]
[0m16:44:41.879532 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m16:44:41.880080 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m16:44:41.880624 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m16:44:41.881162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m16:44:41.881704 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m16:44:41.886626 [info ] [Thread-1 (]: 16:44:41 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m16:44:41.891682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m16:44:41.893380 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m16:44:41.899019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m16:44:41.900677 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp164441896837"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:44:41.901236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:41.994973 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.093 seconds
[0m16:44:41.998460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m16:44:41.999586 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m16:44:42.001849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m16:44:42.002446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m16:44:42.002446 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp164441896837'
        
      order by ordinal_position

  
[0m16:44:42.039425 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.036 seconds
[0m16:44:42.042744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m16:44:42.043748 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.047565 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m16:44:42.053432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m16:44:42.053987 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.057830 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:44:42.059491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m16:44:42.060816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m16:44:42.061398 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp164441896837"
    )


  
[0m16:44:42.064437 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m16:44:42.065010 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m16:44:42.066671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m16:44:42.067680 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m16:44:42.073767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:44:42.074905 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m16:44:42.076006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB9EEDE0>]}
[0m16:44:42.076587 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mINSERT 0 0[0m in 0.19s]
[0m16:44:42.077134 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m16:44:42.077837 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m16:44:42.078551 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m16:44:42.079278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m16:44:42.079829 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m16:44:42.085652 [info ] [Thread-1 (]: 16:44:42 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m16:44:42.089443 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m16:44:42.090519 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m16:44:42.096173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m16:44:42.097248 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp164442092735"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:44:42.097801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:42.179367 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.082 seconds
[0m16:44:42.259671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m16:44:42.260663 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m16:44:42.262673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:44:42.262673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m16:44:42.263660 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp164442092735'
        
      order by ordinal_position

  
[0m16:44:42.299054 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.035 seconds
[0m16:44:42.302562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m16:44:42.303664 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.307380 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m16:44:42.310252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m16:44:42.310822 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.314949 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m16:44:42.317180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m16:44:42.318842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m16:44:42.319303 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp164442092735"
    )


  
[0m16:44:42.322993 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m16:44:42.323979 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m16:44:42.324993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m16:44:42.324993 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m16:44:42.339087 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m16:44:42.340095 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m16:44:42.341101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EBA0D7F0>]}
[0m16:44:42.342382 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mINSERT 0 0[0m in 0.26s]
[0m16:44:42.343382 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m16:44:42.344875 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m16:44:42.344875 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m16:44:42.346871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m16:44:42.347379 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m16:44:42.354682 [info ] [Thread-1 (]: 16:44:42 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m16:44:42.361409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m16:44:42.363114 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m16:44:42.367577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m16:44:42.368664 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

    
  
    

  create temporary table "hub_seats__dbt_tmp164442365958"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, rr.seat_no) rr.aircraft_code, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, rr.seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_seats" AS d
    ON a.aircraft_code = d.aircraft_code AND a.seat_no = d.seat_no
    WHERE d.aircraft_code IS NULL
    AND d.seat_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:44:42.369242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:42.502746 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.133 seconds
[0m16:44:42.505806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m16:44:42.506800 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m16:44:42.507309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:44:42.508817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m16:44:42.508817 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats__dbt_tmp164442365958'
        
      order by ordinal_position

  
[0m16:44:42.546562 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.038 seconds
[0m16:44:42.553287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m16:44:42.554324 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.558653 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:44:42.562560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m16:44:42.562560 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.566477 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:44:42.569012 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m16:44:42.570058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m16:44:42.570623 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_seats" ("aircraft_code", "seat_no", "fare_conditions", "record_source")
    (
        select "aircraft_code", "seat_no", "fare_conditions", "record_source"
        from "hub_seats__dbt_tmp164442365958"
    )


  
[0m16:44:42.573940 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m16:44:42.575124 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m16:44:42.575666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m16:44:42.576197 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m16:44:42.595626 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m16:44:42.596628 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m16:44:42.597138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB9431D0>]}
[0m16:44:42.598653 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_seats .... [[32mINSERT 0 0[0m in 0.25s]
[0m16:44:42.600709 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m16:44:42.600709 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m16:44:42.601706 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m16:44:42.602710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m16:44:42.603799 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m16:44:42.611036 [info ] [Thread-1 (]: 16:44:42 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m16:44:42.615355 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m16:44:42.617567 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m16:44:42.623504 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m16:44:42.624604 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp164442621167"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:44:42.625606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:42.719880 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.094 seconds
[0m16:44:42.723281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m16:44:42.724291 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m16:44:42.725394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:44:42.725394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m16:44:42.726919 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp164442621167'
        
      order by ordinal_position

  
[0m16:44:42.775836 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.049 seconds
[0m16:44:42.780827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m16:44:42.781357 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.784672 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:44:42.787787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m16:44:42.789294 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m16:44:42.793678 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m16:44:42.796241 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m16:44:42.797867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m16:44:42.798417 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp164442621167"
    )


  
[0m16:44:42.801209 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m16:44:42.802814 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m16:44:42.803380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m16:44:42.803380 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m16:44:42.819643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m16:44:42.820237 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m16:44:42.821394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '547e1df4-ca1f-4d8b-8301-9b109a9dcf59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212EB824920>]}
[0m16:44:42.821394 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mINSERT 0 0[0m in 0.22s]
[0m16:44:42.822660 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m16:44:42.825864 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:42.825864 [debug] [MainThread]: On master: BEGIN
[0m16:44:42.826867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:42.871838 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m16:44:42.872852 [debug] [MainThread]: On master: COMMIT
[0m16:44:42.873848 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:42.873848 [debug] [MainThread]: On master: COMMIT
[0m16:44:42.875540 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:44:42.876590 [debug] [MainThread]: On master: Close
[0m16:44:42.877123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:42.877644 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:44:42.878193 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m16:44:42.878193 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m16:44:42.878736 [info ] [MainThread]: 
[0m16:44:42.879948 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m16:44:42.881587 [debug] [MainThread]: Command end result
[0m16:44:42.934321 [info ] [MainThread]: 
[0m16:44:42.935323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:42.936488 [info ] [MainThread]: 
[0m16:44:42.936901 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:44:42.939010 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:42.939010 after 3.50 seconds
[0m16:44:42.939010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E9B43D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E99CBEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212E99CAF60>]}
[0m16:44:42.939010 [debug] [MainThread]: Flushing usage events
[0m16:44:57.640099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFB5CB500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFAE06B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFAE06AE0>]}


============================== 16:44:57.645171 | b0205522-a876-4640-8f33-492985992b64 ==============================
[0m16:44:57.645171 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:44:57.647176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:link', 'send_anonymous_usage_stats': 'True'}
[0m16:44:57.904198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0205522-a876-4640-8f33-492985992b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFBF5D460>]}
[0m16:44:57.965535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0205522-a876-4640-8f33-492985992b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFB5848F0>]}
[0m16:44:57.968063 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:44:58.160756 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:44:58.387634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:58.387634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:58.437938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0205522-a876-4640-8f33-492985992b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFD1DC410>]}
[0m16:44:58.554908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0205522-a876-4640-8f33-492985992b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFD1DC6E0>]}
[0m16:44:58.555422 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m16:44:58.556776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0205522-a876-4640-8f33-492985992b64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFD3A2B10>]}
[0m16:44:58.558393 [warn ] [MainThread]: The selection criterion 'tag:link' does not match any enabled nodes
[0m16:44:58.560853 [info ] [MainThread]: 
[0m16:44:58.562630 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:44:58.567181 [debug] [MainThread]: Command end result
[0m16:44:58.633137 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:58.632601 after 1.20 seconds
[0m16:44:58.633694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFBAC7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EFD0B2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF97F9C10>]}
[0m16:44:58.634764 [debug] [MainThread]: Flushing usage events
[0m16:56:15.208012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB9178C440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8F52BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB91B5A2A0>]}


============================== 16:56:15.214518 | 8d959732-c2a3-46f5-bb33-da95546fc857 ==============================
[0m16:56:15.214518 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:56:15.215526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:links', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:56:15.500804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB920B74D0>]}
[0m16:56:15.564814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB91096960>]}
[0m16:56:15.567331 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:56:15.762950 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:56:16.001693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:16.002778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:16.035878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB92327BF0>]}
[0m16:56:16.153297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93A47AA0>]}
[0m16:56:16.154372 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m16:56:16.154893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB935E18B0>]}
[0m16:56:16.157621 [info ] [MainThread]: 
[0m16:56:16.158162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:56:16.162305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:56:16.451375 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:56:16.452562 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:56:16.452562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:16.507984 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.055 seconds
[0m16:56:16.509021 [debug] [ThreadPool]: On list_postgres: Close
[0m16:56:16.514723 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m16:56:16.520484 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:56:16.521490 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m16:56:16.521490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:16.565436 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m16:56:16.566548 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m16:56:16.566548 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m16:56:16.582923 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.016 seconds
[0m16:56:16.585515 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m16:56:16.587023 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m16:56:16.598674 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:16.599222 [debug] [MainThread]: On master: BEGIN
[0m16:56:16.599222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:16.640650 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m16:56:16.641710 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:16.641710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:56:16.695905 [debug] [MainThread]: SQL status: SELECT 16 in 0.053 seconds
[0m16:56:16.700156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB921BC080>]}
[0m16:56:16.700156 [debug] [MainThread]: On master: ROLLBACK
[0m16:56:16.702286 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:16.702286 [debug] [MainThread]: On master: BEGIN
[0m16:56:16.704816 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:56:16.704816 [debug] [MainThread]: On master: COMMIT
[0m16:56:16.706221 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:16.706221 [debug] [MainThread]: On master: COMMIT
[0m16:56:16.708635 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:56:16.709173 [debug] [MainThread]: On master: Close
[0m16:56:16.709717 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:16.710868 [info ] [MainThread]: 
[0m16:56:16.714826 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m16:56:16.715379 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m16:56:16.717078 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m16:56:16.718181 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m16:56:16.753252 [info ] [Thread-1 (]: 16:56:16 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m16:56:16.811467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m16:56:16.813153 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m16:56:16.874511 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m16:56:16.885791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m16:56:16.885791 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m16:56:16.885791 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:56:16.953100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m16:56:16.953649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m16:56:16.954184 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, seat_no, rr.fare_conditions, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, seat_no
               ORDER BY rr.fare_conditions
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code, seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:56:16.955888 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 25:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                   ^

[0m16:56:16.957000 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m16:56:16.958690 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m16:56:16.971897 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m16:56:16.974007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93CBA6C0>]}
[0m16:56:16.974533 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.26s]
[0m16:56:16.976446 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m16:56:16.976993 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m16:56:16.978629 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m16:56:16.978629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m16:56:16.979699 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m16:56:16.984613 [info ] [Thread-1 (]: 16:56:16 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m16:56:16.988714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m16:56:16.990192 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m16:56:16.995419 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m16:56:16.996936 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m16:56:16.998065 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m16:56:16.999096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:17.060366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m16:56:17.061503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m16:56:17.062114 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, flight_id, rr.boarding_no, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, flight_id
               ORDER BY rr.boarding_no
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no, flight_id IS NOT NULL
    AND rr.ticket_no, flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, flight_id, a.boarding_no, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:56:17.064311 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 25:     WHERE rr.ticket_no, flight_id IS NOT NULL
                               ^

[0m16:56:17.064830 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: ROLLBACK
[0m16:56:17.066141 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m16:56:17.069779 [debug] [Thread-1 (]: Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.ticket_no, flight_id IS NOT NULL
                                 ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_boarding_passes.sql
[0m16:56:17.070872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93D188F0>]}
[0m16:56:17.072085 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[31mERROR[0m in 0.09s]
[0m16:56:17.073175 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m16:56:17.073734 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m16:56:17.074798 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m16:56:17.075327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m16:56:17.076433 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m16:56:17.082163 [info ] [Thread-1 (]: 16:56:17 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m16:56:17.086257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m16:56:17.088391 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m16:56:17.094652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m16:56:17.096017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m16:56:17.097025 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m16:56:17.097025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:17.145520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m16:56:17.146626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m16:56:17.147177 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, departure_airport, arrival_airport, rr.departure_airport, arrival_airport, rr.scheduled_departure, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, departure_airport, arrival_airport
               ORDER BY rr.scheduled_departure
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id, departure_airport, arrival_airport IS NOT NULL
    AND rr.departure_airport, arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, departure_airport, arrival_airport, a.departure_airport, arrival_airport, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:56:17.149712 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 25:     WHERE rr.flight_id, departure_airport, arrival_airport I...
                               ^

[0m16:56:17.150628 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: ROLLBACK
[0m16:56:17.152830 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m16:56:17.155601 [debug] [Thread-1 (]: Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.flight_id, departure_airport, arrival_airport I...
                                 ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_flights_airports.sql
[0m16:56:17.156150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93C8D550>]}
[0m16:56:17.156712 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[31mERROR[0m in 0.08s]
[0m16:56:17.157803 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m16:56:17.158334 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m16:56:17.159442 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m16:56:17.160580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m16:56:17.161128 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m16:56:17.165792 [info ] [Thread-1 (]: 16:56:17 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m16:56:17.169309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m16:56:17.170325 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m16:56:17.175365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m16:56:17.175365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m16:56:17.177336 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m16:56:17.177336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:17.240546 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m16:56:17.241831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m16:56:17.242933 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, flight_id, rr.fare_conditions, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, flight_id
               ORDER BY rr.fare_conditions
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no, flight_id IS NOT NULL
    AND rr.ticket_no, flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, flight_id, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:56:17.245106 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 25:     WHERE rr.ticket_no, flight_id IS NOT NULL
                               ^

[0m16:56:17.245653 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: ROLLBACK
[0m16:56:17.247264 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m16:56:17.249495 [debug] [Thread-1 (]: Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.ticket_no, flight_id IS NOT NULL
                                 ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_ticket_flights.sql
[0m16:56:17.250048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93CBE000>]}
[0m16:56:17.251195 [error] [Thread-1 (]: 4 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[31mERROR[0m in 0.09s]
[0m16:56:17.252267 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m16:56:17.252822 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m16:56:17.253378 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m16:56:17.253905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m16:56:17.254442 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m16:56:17.259970 [info ] [Thread-1 (]: 16:56:17 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m16:56:17.264719 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m16:56:17.265803 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m16:56:17.270597 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m16:56:17.272416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m16:56:17.273425 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m16:56:17.273425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:17.315422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m16:56:17.316503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m16:56:17.317036 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, ticket_no, rr.passenger_id, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, ticket_no
               ORDER BY rr.passenger_id
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref, ticket_no IS NOT NULL
    AND rr.book_ref, ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, ticket_no, a.passenger_id, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m16:56:17.318677 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 25:     WHERE rr.book_ref, ticket_no IS NOT NULL
                              ^

[0m16:56:17.319311 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: ROLLBACK
[0m16:56:17.320986 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m16:56:17.323740 [debug] [Thread-1 (]: Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.book_ref, ticket_no IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_tickets_bookings.sql
[0m16:56:17.324750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d959732-c2a3-46f5-bb33-da95546fc857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93DD0200>]}
[0m16:56:17.326141 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[31mERROR[0m in 0.07s]
[0m16:56:17.326141 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m16:56:17.327978 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:17.327978 [debug] [MainThread]: On master: BEGIN
[0m16:56:17.329443 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:17.392948 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m16:56:17.394013 [debug] [MainThread]: On master: COMMIT
[0m16:56:17.394013 [debug] [MainThread]: Using postgres connection "master"
[0m16:56:17.394545 [debug] [MainThread]: On master: COMMIT
[0m16:56:17.396206 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:56:17.396735 [debug] [MainThread]: On master: Close
[0m16:56:17.397880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:17.398456 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m16:56:17.399031 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m16:56:17.399031 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m16:56:17.400088 [info ] [MainThread]: 
[0m16:56:17.400088 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m16:56:17.402097 [debug] [MainThread]: Command end result
[0m16:56:17.529270 [info ] [MainThread]: 
[0m16:56:17.530274 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m16:56:17.531267 [info ] [MainThread]: 
[0m16:56:17.531267 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.aircraft_code, seat_no IS NOT NULL
                                     ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m16:56:17.532269 [info ] [MainThread]: 
[0m16:56:17.533436 [error] [MainThread]:   Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.ticket_no, flight_id IS NOT NULL
                                 ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_boarding_passes.sql
[0m16:56:17.533436 [info ] [MainThread]: 
[0m16:56:17.534474 [error] [MainThread]:   Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.flight_id, departure_airport, arrival_airport I...
                                 ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_flights_airports.sql
[0m16:56:17.535506 [info ] [MainThread]: 
[0m16:56:17.535506 [error] [MainThread]:   Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.ticket_no, flight_id IS NOT NULL
                                 ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_ticket_flights.sql
[0m16:56:17.536514 [info ] [MainThread]: 
[0m16:56:17.537528 [error] [MainThread]:   Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  syntax error at or near ","
  LINE 25:     WHERE rr.book_ref, ticket_no IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_tickets_bookings.sql
[0m16:56:17.538540 [info ] [MainThread]: 
[0m16:56:17.539542 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m16:56:17.540543 [debug] [MainThread]: Command `dbt run` failed at 16:56:17.540543 after 2.63 seconds
[0m16:56:17.540543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93B82C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93B81D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB93B80EF0>]}
[0m16:56:17.541783 [debug] [MainThread]: Flushing usage events
[0m17:00:15.959230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB046E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB2275520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB43A9F70>]}


============================== 17:00:15.965304 | 3715bbcc-3225-4af5-b55d-22ddf9966117 ==============================
[0m17:00:15.965304 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:00:15.965809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:links', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:00:16.227653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB3D76FF0>]}
[0m17:00:16.300628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB4469280>]}
[0m17:00:16.303149 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:00:16.494345 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:00:16.778900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:00:16.779902 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_aircrafts_seats.sql
[0m17:00:16.780901 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_flights_airports.sql
[0m17:00:16.781408 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_ticket_flights.sql
[0m17:00:16.781804 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_boarding_passes.sql
[0m17:00:16.783315 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_tickets_bookings.sql
[0m17:00:17.151483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB62A4770>]}
[0m17:00:17.265664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB63CAD20>]}
[0m17:00:17.266670 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:00:17.267670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB42A1FD0>]}
[0m17:00:17.269670 [info ] [MainThread]: 
[0m17:00:17.269670 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:00:17.275021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:00:17.555671 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:00:17.556298 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:00:17.556862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:17.613357 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.056 seconds
[0m17:00:17.615527 [debug] [ThreadPool]: On list_postgres: Close
[0m17:00:17.621120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:00:17.627014 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:00:17.628013 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:00:17.628013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:17.670675 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m17:00:17.671681 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:00:17.671681 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:00:17.688435 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.017 seconds
[0m17:00:17.691949 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:00:17.694272 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:00:17.773104 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:17.774549 [debug] [MainThread]: On master: BEGIN
[0m17:00:17.775090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:00:17.826833 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m17:00:17.827833 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:17.827833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:00:17.884249 [debug] [MainThread]: SQL status: SELECT 16 in 0.055 seconds
[0m17:00:17.886570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB6959310>]}
[0m17:00:17.887576 [debug] [MainThread]: On master: ROLLBACK
[0m17:00:17.889576 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:17.889576 [debug] [MainThread]: On master: BEGIN
[0m17:00:17.893087 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:00:17.894088 [debug] [MainThread]: On master: COMMIT
[0m17:00:17.894088 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:17.895087 [debug] [MainThread]: On master: COMMIT
[0m17:00:17.896088 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:00:17.897087 [debug] [MainThread]: On master: Close
[0m17:00:17.897087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:00:17.899088 [info ] [MainThread]: 
[0m17:00:17.904466 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:00:17.905464 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:00:17.907465 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:00:17.908465 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:00:17.927050 [info ] [Thread-1 (]: 17:00:17 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:00:17.930918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:00:17.931938 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:00:17.990153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:00:17.991828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:00:17.992383 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:00:17.992921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:00:18.037966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m17:00:18.039049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:00:18.039594 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.fare_conditions
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:00:18.041714 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:   ) as l
           ^

[0m17:00:18.042278 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m17:00:18.043933 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:00:18.052049 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:00:18.054046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB628F560>]}
[0m17:00:18.054950 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.15s]
[0m17:00:18.056035 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:00:18.056597 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:00:18.057683 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:00:18.058211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:00:18.058755 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:00:18.063092 [info ] [Thread-1 (]: 17:00:18 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:00:18.066829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:00:18.067830 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:00:18.073036 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:00:18.074337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:00:18.074843 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:00:18.074843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:18.143636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m17:00:18.144709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:00:18.145256 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.boarding_no, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.boarding_no
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.boarding_no, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:00:18.211739 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.065 seconds
[0m17:00:18.231012 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:00:18.231587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:00:18.232143 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:00:18.247105 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:00:18.249291 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:00:18.249831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB4D61D90>]}
[0m17:00:18.250930 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[32mSELECT 0[0m in 0.19s]
[0m17:00:18.251992 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:00:18.252556 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:00:18.253798 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:00:18.255039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:00:18.256434 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:00:18.262610 [info ] [Thread-1 (]: 17:00:18 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:00:18.266523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:00:18.268193 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:00:18.274884 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:00:18.276507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:00:18.277066 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:00:18.277066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:18.321333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:00:18.321879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:00:18.322421 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.scheduled_departure, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.scheduled_departure
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:00:18.355827 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m17:00:18.357542 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:00:18.358635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:00:18.358635 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:00:18.373879 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m17:00:18.374963 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:00:18.376042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB68A4B90>]}
[0m17:00:18.377232 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[32mSELECT 0[0m in 0.12s]
[0m17:00:18.379401 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:00:18.379937 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:00:18.380999 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:00:18.381534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:00:18.382065 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:00:18.386982 [info ] [Thread-1 (]: 17:00:18 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:00:18.390451 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:00:18.391501 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:00:18.395573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:00:18.397579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:00:18.397579 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:00:18.398579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:18.439583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m17:00:18.439583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:00:18.441105 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.fare_conditions, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.fare_conditions
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:00:18.482162 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m17:00:18.486093 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:00:18.486630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:00:18.487165 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:00:18.492637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:00:18.493165 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:00:18.494247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB68289B0>]}
[0m17:00:18.495411 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[32mSELECT 0[0m in 0.11s]
[0m17:00:18.497008 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:00:18.497008 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:00:18.498019 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:00:18.499017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:00:18.499017 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:00:18.508529 [info ] [Thread-1 (]: 17:00:18 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:00:18.514646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:00:18.515688 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:00:18.520874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:00:18.521885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:00:18.521885 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:00:18.521885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:00:18.571258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m17:00:18.572261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:00:18.573766 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.passenger_id, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.passenger_id
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.passenger_id, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:00:18.607195 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m17:00:18.610132 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:00:18.610132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:00:18.611133 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:00:18.615705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:00:18.616843 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:00:18.617417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3715bbcc-3225-4af5-b55d-22ddf9966117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB50B5C40>]}
[0m17:00:18.618550 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[32mSELECT 0[0m in 0.12s]
[0m17:00:18.619623 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:00:18.621182 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:18.621715 [debug] [MainThread]: On master: BEGIN
[0m17:00:18.622251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:00:18.677082 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m17:00:18.677082 [debug] [MainThread]: On master: COMMIT
[0m17:00:18.678085 [debug] [MainThread]: Using postgres connection "master"
[0m17:00:18.678085 [debug] [MainThread]: On master: COMMIT
[0m17:00:18.680082 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:00:18.680082 [debug] [MainThread]: On master: Close
[0m17:00:18.681591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:18.681591 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:00:18.681591 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:00:18.683096 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:00:18.683864 [info ] [MainThread]: 
[0m17:00:18.684953 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m17:00:18.686572 [debug] [MainThread]: Command end result
[0m17:00:18.736401 [info ] [MainThread]: 
[0m17:00:18.737496 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:00:18.738030 [info ] [MainThread]: 
[0m17:00:18.739137 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:00:18.739687 [info ] [MainThread]: 
[0m17:00:18.740243 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:00:18.742361 [debug] [MainThread]: Command `dbt run` failed at 17:00:18.742361 after 3.07 seconds
[0m17:00:18.743436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB046E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB3CFC1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB4BCB440>]}
[0m17:00:18.743980 [debug] [MainThread]: Flushing usage events
[0m17:06:03.829145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B3AA3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B2F0A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B3A609E0>]}


============================== 17:06:03.834290 | 51695019-528d-49bc-9d4a-7624a2b1c0d9 ==============================
[0m17:06:03.834290 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:06:03.835360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:links', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:04.117901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B3E1A180>]}
[0m17:06:04.182479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B38E9D00>]}
[0m17:06:04.185714 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:06:04.383553 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:06:04.764491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:06:04.765106 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_flights_airports.sql
[0m17:06:04.766114 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_tickets_bookings.sql
[0m17:06:04.766114 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_ticket_flights.sql
[0m17:06:04.767129 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_aircrafts_seats.sql
[0m17:06:04.767129 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_boarding_passes.sql
[0m17:06:05.149262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B50A4FB0>]}
[0m17:06:05.260379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B5232C90>]}
[0m17:06:05.260933 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:06:05.262059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B50B4350>]}
[0m17:06:05.264268 [info ] [MainThread]: 
[0m17:06:05.265325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:06:05.268958 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:06:05.544445 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:06:05.544983 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:06:05.545525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:05.597552 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.053 seconds
[0m17:06:05.600052 [debug] [ThreadPool]: On list_postgres: Close
[0m17:06:05.605624 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:06:05.613521 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:06:05.613521 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:06:05.614644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:05.657682 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m17:06:05.658704 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:06:05.658704 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:06:05.677463 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.018 seconds
[0m17:06:05.751471 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:06:05.753475 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:06:05.764621 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:05.764621 [debug] [MainThread]: On master: BEGIN
[0m17:06:05.765619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:05.830006 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m17:06:05.830523 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:05.830523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:06:05.892577 [debug] [MainThread]: SQL status: SELECT 16 in 0.060 seconds
[0m17:06:05.895950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B59D1F40>]}
[0m17:06:05.895950 [debug] [MainThread]: On master: ROLLBACK
[0m17:06:05.897950 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:05.897950 [debug] [MainThread]: On master: BEGIN
[0m17:06:05.901723 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:06:05.901723 [debug] [MainThread]: On master: COMMIT
[0m17:06:05.902721 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:05.902721 [debug] [MainThread]: On master: COMMIT
[0m17:06:05.904023 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:06:05.905327 [debug] [MainThread]: On master: Close
[0m17:06:05.905327 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:06:05.907798 [info ] [MainThread]: 
[0m17:06:05.912384 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:06:05.913710 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:06:05.915079 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:06:05.916328 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:06:05.935802 [info ] [Thread-1 (]: 17:06:05 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:06:05.940389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:06:05.941435 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:06:06.001464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:06:06.002471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:06:06.002471 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:06:06.003478 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:06.070197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m17:06:06.071302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:06:06.071833 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:06:06.074076 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:   ) as l
           ^

[0m17:06:06.074630 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m17:06:06.075744 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:06:06.084071 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:06:06.085934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B50BEEA0>]}
[0m17:06:06.086997 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.17s]
[0m17:06:06.088070 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:06:06.088602 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:06:06.089755 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:06:06.090835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:06:06.091374 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:06:06.096304 [info ] [Thread-1 (]: 17:06:06 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:06:06.106623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.108131 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:06:06.115266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.116768 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

    
  
    

  create temporary table "link_boarding_passes__dbt_tmp170606110140"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:06:06.117280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:06.203283 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.085 seconds
[0m17:06:06.218872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.219470 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:06:06.221636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:06:06.222247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.222822 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes__dbt_tmp170606110140'
        
      order by ordinal_position

  
[0m17:06:06.256812 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.034 seconds
[0m17:06:06.262339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.263338 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.267423 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:06:06.274879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.275419 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.279460 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:06:06.289900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.291503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:06:06.292043 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "record_source")
    (
        select "ticket_no", "flight_id", "boarding_no", "record_source"
        from "link_boarding_passes__dbt_tmp170606110140"
    )


  
[0m17:06:06.302853 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "boarding_no" does not exist
LINE 5:         select "ticket_no", "flight_id", "boarding_no", "rec...
                                                 ^
HINT:  There is a column named "boarding_no" in table "link_boarding_passes", but it cannot be referenced from this part of the query.

[0m17:06:06.302853 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: ROLLBACK
[0m17:06:06.304461 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:06:06.308461 [debug] [Thread-1 (]: Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  column "boarding_no" does not exist
  LINE 5:         select "ticket_no", "flight_id", "boarding_no", "rec...
                                                   ^
  HINT:  There is a column named "boarding_no" in table "link_boarding_passes", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_boarding_passes.sql
[0m17:06:06.308461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B5A48470>]}
[0m17:06:06.309476 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[31mERROR[0m in 0.22s]
[0m17:06:06.310478 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:06:06.311806 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:06:06.311806 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:06:06.313267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:06:06.313267 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:06:06.320032 [info ] [Thread-1 (]: 17:06:06 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:06:06.324694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:06:06.327114 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:06:06.334137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:06:06.334678 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

    
  
    

  create temporary table "link_flights_airports__dbt_tmp170606331804"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" AS d
    ON a.flight_id = d.flight_id AND a.departure_airport = d.departure_airport AND a.arrival_airport = d.arrival_airport
    WHERE d.flight_id IS NULL
    AND d.departure_airport IS NULL
    AND d.arrival_airport IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:06:06.335213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:06.415190 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.080 seconds
[0m17:06:06.418342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:06:06.419339 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:06:06.420343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:06:06.421682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:06:06.421682 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports__dbt_tmp170606331804'
        
      order by ordinal_position

  
[0m17:06:06.460195 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.037 seconds
[0m17:06:06.464749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:06:06.465751 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.468748 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m17:06:06.472827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:06:06.473842 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.476276 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m17:06:06.478272 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:06:06.480276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:06:06.480788 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" ("flight_id", "departure_airport", "arrival_airport", "scheduled_departure", "record_source")
    (
        select "flight_id", "departure_airport", "arrival_airport", "scheduled_departure", "record_source"
        from "link_flights_airports__dbt_tmp170606331804"
    )


  
[0m17:06:06.493258 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "scheduled_departure" does not exist
LINE 5: ...ight_id", "departure_airport", "arrival_airport", "scheduled...
                                                             ^
HINT:  There is a column named "scheduled_departure" in table "link_flights_airports", but it cannot be referenced from this part of the query.

[0m17:06:06.493810 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: ROLLBACK
[0m17:06:06.495579 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:06:06.498571 [debug] [Thread-1 (]: Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  column "scheduled_departure" does not exist
  LINE 5: ...ight_id", "departure_airport", "arrival_airport", "scheduled...
                                                               ^
  HINT:  There is a column named "scheduled_departure" in table "link_flights_airports", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_flights_airports.sql
[0m17:06:06.499129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B4E509B0>]}
[0m17:06:06.500254 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[31mERROR[0m in 0.19s]
[0m17:06:06.500839 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:06:06.500839 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:06:06.502844 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:06:06.504517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:06:06.505549 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:06:06.511073 [info ] [Thread-1 (]: 17:06:06 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:06:06.516725 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.518323 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:06:06.524381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.525382 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp170606523387"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:06:06.526383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:06.598325 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.072 seconds
[0m17:06:06.604416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.604951 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:06:06.607163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:06:06.607163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.607708 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp170606523387'
        
      order by ordinal_position

  
[0m17:06:06.646367 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.038 seconds
[0m17:06:06.650520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.651059 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.654898 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:06:06.658125 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.658125 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.661361 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:06:06.663759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.663759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:06:06.665140 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" ("ticket_no", "flight_id", "fare_conditions", "record_source")
    (
        select "ticket_no", "flight_id", "fare_conditions", "record_source"
        from "link_ticket_flights__dbt_tmp170606523387"
    )


  
[0m17:06:06.673360 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fare_conditions" does not exist
LINE 5:         select "ticket_no", "flight_id", "fare_conditions", ...
                                                 ^
HINT:  There is a column named "fare_conditions" in table "link_ticket_flights", but it cannot be referenced from this part of the query.

[0m17:06:06.674370 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: ROLLBACK
[0m17:06:06.675365 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:06:06.677974 [debug] [Thread-1 (]: Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  column "fare_conditions" does not exist
  LINE 5:         select "ticket_no", "flight_id", "fare_conditions", ...
                                                   ^
  HINT:  There is a column named "fare_conditions" in table "link_ticket_flights", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_ticket_flights.sql
[0m17:06:06.679034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B5A66F60>]}
[0m17:06:06.680066 [error] [Thread-1 (]: 4 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[31mERROR[0m in 0.17s]
[0m17:06:06.681076 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:06:06.681076 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:06:06.682588 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:06:06.683829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:06:06.684390 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:06:06.689439 [info ] [Thread-1 (]: 17:06:06 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:06:06.695606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.697608 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:06:06.703480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.704570 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

    
  
    

  create temporary table "link_tickets_bookings__dbt_tmp170606701628"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" AS d
    ON a.book_ref = d.book_ref AND a.ticket_no = d.ticket_no
    WHERE d.book_ref IS NULL
    AND d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:06:06.704570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:06.792502 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.087 seconds
[0m17:06:06.796569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.797631 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:06:06.799233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:06:06.799897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.800421 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings__dbt_tmp170606701628'
        
      order by ordinal_position

  
[0m17:06:06.834918 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.034 seconds
[0m17:06:06.838802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.839349 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.843234 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:06:06.848196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.848196 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:06:06.852296 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:06:06.854296 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.855298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:06:06.856296 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" ("book_ref", "ticket_no", "passenger_id", "record_source")
    (
        select "book_ref", "ticket_no", "passenger_id", "record_source"
        from "link_tickets_bookings__dbt_tmp170606701628"
    )


  
[0m17:06:06.864432 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "passenger_id" does not exist
LINE 5:         select "book_ref", "ticket_no", "passenger_id", "rec...
                                                ^
HINT:  There is a column named "passenger_id" in table "link_tickets_bookings", but it cannot be referenced from this part of the query.

[0m17:06:06.864432 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: ROLLBACK
[0m17:06:06.866458 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:06:06.870174 [debug] [Thread-1 (]: Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  column "passenger_id" does not exist
  LINE 5:         select "book_ref", "ticket_no", "passenger_id", "rec...
                                                  ^
  HINT:  There is a column named "passenger_id" in table "link_tickets_bookings", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_tickets_bookings.sql
[0m17:06:06.870174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51695019-528d-49bc-9d4a-7624a2b1c0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B5A70140>]}
[0m17:06:06.871242 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[31mERROR[0m in 0.19s]
[0m17:06:06.873235 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:06:06.875145 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:06.875693 [debug] [MainThread]: On master: BEGIN
[0m17:06:06.876243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:06.934309 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m17:06:06.936263 [debug] [MainThread]: On master: COMMIT
[0m17:06:06.936263 [debug] [MainThread]: Using postgres connection "master"
[0m17:06:06.936263 [debug] [MainThread]: On master: COMMIT
[0m17:06:06.938549 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:06:06.938549 [debug] [MainThread]: On master: Close
[0m17:06:06.938549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:06.941263 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:06:06.942782 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:06:06.943794 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:06:06.944651 [info ] [MainThread]: 
[0m17:06:06.945773 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m17:06:06.947395 [debug] [MainThread]: Command end result
[0m17:06:06.993742 [info ] [MainThread]: 
[0m17:06:06.994306 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:06:06.994851 [info ] [MainThread]: 
[0m17:06:06.995905 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:06:06.995905 [info ] [MainThread]: 
[0m17:06:06.996905 [error] [MainThread]:   Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  column "boarding_no" does not exist
  LINE 5:         select "ticket_no", "flight_id", "boarding_no", "rec...
                                                   ^
  HINT:  There is a column named "boarding_no" in table "link_boarding_passes", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_boarding_passes.sql
[0m17:06:06.998117 [info ] [MainThread]: 
[0m17:06:06.998117 [error] [MainThread]:   Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  column "scheduled_departure" does not exist
  LINE 5: ...ight_id", "departure_airport", "arrival_airport", "scheduled...
                                                               ^
  HINT:  There is a column named "scheduled_departure" in table "link_flights_airports", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_flights_airports.sql
[0m17:06:06.999118 [info ] [MainThread]: 
[0m17:06:07.000176 [error] [MainThread]:   Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  column "fare_conditions" does not exist
  LINE 5:         select "ticket_no", "flight_id", "fare_conditions", ...
                                                   ^
  HINT:  There is a column named "fare_conditions" in table "link_ticket_flights", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_ticket_flights.sql
[0m17:06:07.001186 [info ] [MainThread]: 
[0m17:06:07.001186 [error] [MainThread]:   Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  column "passenger_id" does not exist
  LINE 5:         select "book_ref", "ticket_no", "passenger_id", "rec...
                                                  ^
  HINT:  There is a column named "passenger_id" in table "link_tickets_bookings", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_tickets_bookings.sql
[0m17:06:07.002697 [info ] [MainThread]: 
[0m17:06:07.004128 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m17:06:07.007075 [debug] [MainThread]: Command `dbt run` failed at 17:06:07.006512 after 3.46 seconds
[0m17:06:07.008151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B390E300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B31E6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292B507CA10>]}
[0m17:06:07.009243 [debug] [MainThread]: Flushing usage events
[0m17:08:01.402106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024188003260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024187EAC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024188002720>]}


============================== 17:08:01.408080 | 4505db87-d07e-4404-8532-fb4faf6505e2 ==============================
[0m17:08:01.408080 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:08:01.409243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:raw', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:08:01.667683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418828BFB0>]}
[0m17:08:01.728018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241882AC4D0>]}
[0m17:08:01.730268 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:08:01.919688 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:08:02.155776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:02.155776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:02.187028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002418939C320>]}
[0m17:08:02.303354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241896C4B60>]}
[0m17:08:02.303354 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:08:02.305005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189779EE0>]}
[0m17:08:02.307025 [info ] [MainThread]: 
[0m17:08:02.309179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:02.313686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:08:02.547353 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:08:02.547898 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:08:02.548466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:02.598828 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.050 seconds
[0m17:08:02.600201 [debug] [ThreadPool]: On list_postgres: Close
[0m17:08:02.605684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:08:02.612379 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:02.612379 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:08:02.613375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:02.676881 [debug] [ThreadPool]: SQL status: BEGIN in 0.064 seconds
[0m17:08:02.677930 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:02.677930 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:08:02.693505 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.014 seconds
[0m17:08:02.694954 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:08:02.696945 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:08:02.707834 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:02.708842 [debug] [MainThread]: On master: BEGIN
[0m17:08:02.708842 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:02.771742 [debug] [MainThread]: SQL status: BEGIN in 0.063 seconds
[0m17:08:02.771742 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:02.773249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:08:02.794962 [debug] [MainThread]: SQL status: SELECT 16 in 0.022 seconds
[0m17:08:02.798495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024185BF9880>]}
[0m17:08:02.798495 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:02.801483 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:02.801483 [debug] [MainThread]: On master: BEGIN
[0m17:08:02.804776 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:08:02.804776 [debug] [MainThread]: On master: COMMIT
[0m17:08:02.805330 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:02.805864 [debug] [MainThread]: On master: COMMIT
[0m17:08:02.807492 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:08:02.808018 [debug] [MainThread]: On master: Close
[0m17:08:02.808554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:02.810663 [info ] [MainThread]: 
[0m17:08:02.815835 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m17:08:02.815835 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ............ [RUN]
[0m17:08:02.816845 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_aircrafts'
[0m17:08:02.817953 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m17:08:02.827564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.829283 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m17:08:02.864940 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.865945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.866952 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m17:08:02.866952 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:02.914156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:08:02.915157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.915157 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m17:08:02.932583 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:08:02.939784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.939784 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts" rename to "raw_aircrafts__dbt_backup"
[0m17:08:02.942298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:02.945799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.945799 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp" rename to "raw_aircrafts"
[0m17:08:02.946789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:02.964850 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m17:08:02.965391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.965936 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m17:08:02.983629 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m17:08:02.991337 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup"
[0m17:08:02.999140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:08:02.999768 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup" cascade
[0m17:08:03.006945 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:08:03.009749 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m17:08:03.011850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024185B8C890>]}
[0m17:08:03.011850 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_aircrafts ....... [[32mCREATE VIEW[0m in 0.19s]
[0m17:08:03.013358 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m17:08:03.014397 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_airports
[0m17:08:03.015586 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.raw_airports ............. [RUN]
[0m17:08:03.016596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_airports)
[0m17:08:03.017606 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_airports
[0m17:08:03.022091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m17:08:03.022091 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_airports
[0m17:08:03.028898 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m17:08:03.029974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:08:03.030518 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m17:08:03.031235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:03.093456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m17:08:03.094341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:08:03.094846 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m17:08:03.110207 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:08:03.115652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:08:03.116186 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports" rename to "raw_airports__dbt_backup"
[0m17:08:03.117729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.120890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:08:03.120890 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m17:08:03.121959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.124476 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m17:08:03.124476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:08:03.125476 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m17:08:03.137248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m17:08:03.139189 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup"
[0m17:08:03.140336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:08:03.141335 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup" cascade
[0m17:08:03.147104 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:08:03.148108 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: Close
[0m17:08:03.149108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189CCB2C0>]}
[0m17:08:03.150166 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_airports ........ [[32mCREATE VIEW[0m in 0.13s]
[0m17:08:03.151413 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_airports
[0m17:08:03.152414 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m17:08:03.153408 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ...... [RUN]
[0m17:08:03.154438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_boarding_passes)
[0m17:08:03.154438 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m17:08:03.158451 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.160454 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m17:08:03.163960 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.163960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.165467 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m17:08:03.166475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:03.207879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m17:08:03.209092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.209092 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m17:08:03.223479 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:08:03.227680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.227680 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes" rename to "raw_boarding_passes__dbt_backup"
[0m17:08:03.229473 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.232761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.233279 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp" rename to "raw_boarding_passes"
[0m17:08:03.234920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.236016 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m17:08:03.236572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.237125 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m17:08:03.241032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:08:03.244115 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup"
[0m17:08:03.245726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:08:03.246691 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup" cascade
[0m17:08:03.253559 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:08:03.254700 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m17:08:03.255704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189C6B440>]}
[0m17:08:03.256867 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_boarding_passes . [[32mCREATE VIEW[0m in 0.10s]
[0m17:08:03.257919 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m17:08:03.257919 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m17:08:03.259075 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............. [RUN]
[0m17:08:03.260071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_bookings)
[0m17:08:03.261074 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m17:08:03.267835 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m17:08:03.268832 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m17:08:03.273340 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m17:08:03.274351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:08:03.274351 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m17:08:03.275860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:03.322744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:08:03.323252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:08:03.323252 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m17:08:03.333869 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:08:03.337958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:08:03.337958 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings" rename to "raw_bookings__dbt_backup"
[0m17:08:03.341353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:03.344552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:08:03.345550 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp" rename to "raw_bookings"
[0m17:08:03.346550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.348134 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m17:08:03.349140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:08:03.349140 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m17:08:03.353658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:08:03.356294 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup"
[0m17:08:03.357366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:08:03.357366 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup" cascade
[0m17:08:03.363354 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:08:03.365060 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m17:08:03.365587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189DDBDD0>]}
[0m17:08:03.366676 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_bookings ........ [[32mCREATE VIEW[0m in 0.11s]
[0m17:08:03.367228 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m17:08:03.368237 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_flights
[0m17:08:03.369441 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.raw_flights .............. [RUN]
[0m17:08:03.369441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_flights)
[0m17:08:03.370702 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_flights
[0m17:08:03.374462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m17:08:03.374462 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_flights
[0m17:08:03.379230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m17:08:03.380224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:08:03.381223 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m17:08:03.381223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:03.442969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m17:08:03.443477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:08:03.444537 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m17:08:03.459549 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:08:03.463594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:08:03.463594 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights" rename to "raw_flights__dbt_backup"
[0m17:08:03.466899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:03.471582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:08:03.472123 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp" rename to "raw_flights"
[0m17:08:03.474318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:03.477197 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m17:08:03.477935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:08:03.478586 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m17:08:03.558066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m17:08:03.561574 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup"
[0m17:08:03.561574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:08:03.562592 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup" cascade
[0m17:08:03.569100 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:08:03.570113 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: Close
[0m17:08:03.571111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189E93020>]}
[0m17:08:03.573115 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_flights ......... [[32mCREATE VIEW[0m in 0.20s]
[0m17:08:03.573633 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_flights
[0m17:08:03.574935 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_seats
[0m17:08:03.574935 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.raw_seats ................ [RUN]
[0m17:08:03.576745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.raw_seats)
[0m17:08:03.577285 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_seats
[0m17:08:03.580531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m17:08:03.582274 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_seats
[0m17:08:03.586056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m17:08:03.587166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:08:03.587710 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m17:08:03.588794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:03.644111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:08:03.645163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:08:03.645710 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m17:08:03.659425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:08:03.663446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:08:03.663984 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats" rename to "raw_seats__dbt_backup"
[0m17:08:03.666304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:03.670113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:08:03.670653 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp" rename to "raw_seats"
[0m17:08:03.671659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.674170 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m17:08:03.674170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:08:03.674170 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m17:08:03.687894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m17:08:03.691275 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup"
[0m17:08:03.692276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:08:03.693278 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup" cascade
[0m17:08:03.698342 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:08:03.700353 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: Close
[0m17:08:03.701395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189C6ACF0>]}
[0m17:08:03.702627 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_seats ........... [[32mCREATE VIEW[0m in 0.12s]
[0m17:08:03.703656 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_seats
[0m17:08:03.703656 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m17:08:03.704811 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ....... [RUN]
[0m17:08:03.705823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.raw_ticket_flights)
[0m17:08:03.705823 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m17:08:03.708841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.709842 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m17:08:03.715879 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.717410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.717410 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m17:08:03.718412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:03.760363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m17:08:03.760928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.761531 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m17:08:03.774746 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:08:03.779206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.779206 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights" rename to "raw_ticket_flights__dbt_backup"
[0m17:08:03.781322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.783414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.784855 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp" rename to "raw_ticket_flights"
[0m17:08:03.785846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.787844 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m17:08:03.787844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.788855 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m17:08:03.793446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:08:03.795488 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup"
[0m17:08:03.796501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:08:03.796501 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup" cascade
[0m17:08:03.803233 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:08:03.804304 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m17:08:03.805811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189C6B590>]}
[0m17:08:03.807191 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_ticket_flights .. [[32mCREATE VIEW[0m in 0.10s]
[0m17:08:03.808290 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m17:08:03.808290 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m17:08:03.809445 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.raw_tickets .............. [RUN]
[0m17:08:03.809445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.raw_tickets)
[0m17:08:03.810685 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m17:08:03.814473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m17:08:03.815475 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m17:08:03.823581 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m17:08:03.824895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:08:03.825901 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m17:08:03.825901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:03.869515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:08:03.870515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:08:03.871147 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m17:08:03.883470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:08:03.888325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:08:03.888325 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets" rename to "raw_tickets__dbt_backup"
[0m17:08:03.890689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:03.893886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:08:03.894460 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp" rename to "raw_tickets"
[0m17:08:03.896665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:03.898447 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m17:08:03.899122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:08:03.899661 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m17:08:03.905123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:03.909989 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup"
[0m17:08:03.910519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:08:03.911078 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup" cascade
[0m17:08:03.916909 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:08:03.918187 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m17:08:03.919186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4505db87-d07e-4404-8532-fb4faf6505e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024189B7E840>]}
[0m17:08:03.920188 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_tickets ......... [[32mCREATE VIEW[0m in 0.11s]
[0m17:08:03.921512 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m17:08:03.923507 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:03.924012 [debug] [MainThread]: On master: BEGIN
[0m17:08:03.924012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:03.979171 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m17:08:03.980407 [debug] [MainThread]: On master: COMMIT
[0m17:08:03.980407 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:03.980407 [debug] [MainThread]: On master: COMMIT
[0m17:08:03.982408 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:08:03.982408 [debug] [MainThread]: On master: Close
[0m17:08:03.983916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:03.983916 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:08:03.985421 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:08:03.986440 [debug] [MainThread]: Connection 'model.dbt_dwh.raw_tickets' was properly closed.
[0m17:08:03.986440 [info ] [MainThread]: 
[0m17:08:03.987508 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m17:08:03.988921 [debug] [MainThread]: Command end result
[0m17:08:04.039555 [info ] [MainThread]: 
[0m17:08:04.040701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:04.041242 [info ] [MainThread]: 
[0m17:08:04.041774 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:08:04.043398 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:04.042853 after 2.95 seconds
[0m17:08:04.043398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024187EAC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024188001F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024188003BF0>]}
[0m17:08:04.043957 [debug] [MainThread]: Flushing usage events
[0m17:08:19.542321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013342903470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013342217800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013342548EF0>]}


============================== 17:08:19.551436 | cc64e83a-b6e1-48c4-b754-b9b1ba68a14a ==============================
[0m17:08:19.551436 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:08:19.553139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:stage', 'send_anonymous_usage_stats': 'True'}
[0m17:08:19.816088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013342CAC440>]}
[0m17:08:19.883839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133427890D0>]}
[0m17:08:19.885869 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:08:20.077310 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:08:20.327604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:20.327604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:20.361572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133404916D0>]}
[0m17:08:20.471360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133444D77D0>]}
[0m17:08:20.472465 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:08:20.472465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001334412F500>]}
[0m17:08:20.475030 [info ] [MainThread]: 
[0m17:08:20.477505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:20.484977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:08:20.726522 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:08:20.727538 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:08:20.727538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:20.779711 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.052 seconds
[0m17:08:20.780706 [debug] [ThreadPool]: On list_postgres: Close
[0m17:08:20.787205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:08:20.792641 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:20.793640 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:08:20.793640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:20.835107 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m17:08:20.835639 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:20.836653 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:08:20.853566 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.017 seconds
[0m17:08:20.855618 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:08:20.856213 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:08:20.869015 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:20.869586 [debug] [MainThread]: On master: BEGIN
[0m17:08:20.869586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:20.928410 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m17:08:20.928942 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:20.929501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:08:20.951006 [debug] [MainThread]: SQL status: SELECT 8 in 0.022 seconds
[0m17:08:20.953513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001334451E5D0>]}
[0m17:08:20.953513 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:20.955558 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:20.956662 [debug] [MainThread]: On master: BEGIN
[0m17:08:20.959861 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:08:20.959861 [debug] [MainThread]: On master: COMMIT
[0m17:08:20.960851 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:20.960851 [debug] [MainThread]: On master: COMMIT
[0m17:08:20.962853 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:08:20.962853 [debug] [MainThread]: On master: Close
[0m17:08:20.963855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:20.965882 [info ] [MainThread]: 
[0m17:08:20.971717 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m17:08:20.973042 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.stg_aircrafts ............ [RUN]
[0m17:08:20.974794 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.stg_aircrafts'
[0m17:08:20.975890 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_aircrafts
[0m17:08:21.026079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.026493 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: BEGIN
[0m17:08:21.027025 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:21.079601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m17:08:21.080951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.081456 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.124933 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.043 seconds
[0m17:08:21.178479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.179966 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.185115 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:08:21.243791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.245907 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_aircrafts
[0m17:08:21.277943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.278947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.279943 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'AIRCRAFTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS aircraft_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS aircraft_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    aircraft_pk,
    aircraft_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:21.297178 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:08:21.303038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.304042 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m17:08:21.306909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:21.323292 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m17:08:21.323814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.324366 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m17:08:21.340592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m17:08:21.347338 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup"
[0m17:08:21.351399 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:08:21.352692 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m17:08:21.353772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:08:21.356758 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: Close
[0m17:08:21.360757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001334471D5B0>]}
[0m17:08:21.361781 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_aircrafts ....... [[32mCREATE VIEW[0m in 0.38s]
[0m17:08:21.363774 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m17:08:21.366761 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_airports
[0m17:08:21.367760 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.stg_airports ............. [RUN]
[0m17:08:21.368756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_aircrafts, now model.dbt_dwh.stg_airports)
[0m17:08:21.370177 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_airports
[0m17:08:21.382968 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:08:21.383964 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: BEGIN
[0m17:08:21.383964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:21.450158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m17:08:21.450158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:08:21.451152 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.495531 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.044 seconds
[0m17:08:21.502204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:08:21.503295 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.507907 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m17:08:21.517622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_airports"
[0m17:08:21.518681 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_airports
[0m17:08:21.521974 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_airports"
[0m17:08:21.523047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:08:21.523047 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_airports"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'AIRPORTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS airport_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS airport_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    airport_pk,
    airport_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:21.535546 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:08:21.539558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:08:21.539558 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m17:08:21.540557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:21.542951 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m17:08:21.542951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:08:21.543953 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m17:08:21.550200 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:08:21.552377 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup"
[0m17:08:21.552377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:08:21.553885 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup" cascade
[0m17:08:21.555902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:21.556412 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: Close
[0m17:08:21.557415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001334486F560>]}
[0m17:08:21.558423 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_airports ........ [[32mCREATE VIEW[0m in 0.19s]
[0m17:08:21.559844 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_airports
[0m17:08:21.561154 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m17:08:21.562157 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.stg_boarding_passes ...... [RUN]
[0m17:08:21.563284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_airports, now model.dbt_dwh.stg_boarding_passes)
[0m17:08:21.563815 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_boarding_passes
[0m17:08:21.571056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.572330 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: BEGIN
[0m17:08:21.572330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:21.638973 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m17:08:21.640141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.640678 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.682761 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.042 seconds
[0m17:08:21.688148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.689241 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.693770 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:21.776942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.777944 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_boarding_passes
[0m17:08:21.782323 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.783831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.783831 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'BOARDING_PASSES'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS boarding_pass_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    boarding_pass_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:21.795663 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:08:21.799423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.799941 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m17:08:21.801240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:21.802273 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m17:08:21.802273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.803785 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m17:08:21.816425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m17:08:21.819294 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m17:08:21.819294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:08:21.820308 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m17:08:21.821365 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:21.823405 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: Close
[0m17:08:21.823995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133448A37D0>]}
[0m17:08:21.825095 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_boarding_passes . [[32mCREATE VIEW[0m in 0.26s]
[0m17:08:21.827011 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m17:08:21.827553 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m17:08:21.828651 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.stg_bookings ............. [RUN]
[0m17:08:21.829209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_boarding_passes, now model.dbt_dwh.stg_bookings)
[0m17:08:21.829770 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_bookings
[0m17:08:21.837244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:08:21.838242 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: BEGIN
[0m17:08:21.838242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:21.898022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:08:21.898022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:08:21.899092 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.940325 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.041 seconds
[0m17:08:21.946378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:08:21.946378 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:21.950550 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:08:21.958999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_bookings"
[0m17:08:21.960038 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_bookings
[0m17:08:21.963948 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_bookings"
[0m17:08:21.964958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:08:21.964958 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'BOOKINGS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS booking_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    booking_pk,
    booking_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:21.979805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:08:21.985362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:08:21.986847 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m17:08:21.988732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:21.990744 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m17:08:21.990744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:08:21.991744 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m17:08:21.996297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:21.999321 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup"
[0m17:08:22.000490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:08:22.000490 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m17:08:22.001820 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:22.003953 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: Close
[0m17:08:22.004966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133447E77D0>]}
[0m17:08:22.005476 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_bookings ........ [[32mCREATE VIEW[0m in 0.17s]
[0m17:08:22.007126 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m17:08:22.007635 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_flights
[0m17:08:22.008183 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.stg_flights .............. [RUN]
[0m17:08:22.009268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_bookings, now model.dbt_dwh.stg_flights)
[0m17:08:22.009886 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_flights
[0m17:08:22.018260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:08:22.018260 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: BEGIN
[0m17:08:22.018260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:22.062155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:08:22.062155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:08:22.063157 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.100148 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.036 seconds
[0m17:08:22.104694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:08:22.106953 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.112687 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m17:08:22.124987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_flights"
[0m17:08:22.125988 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_flights
[0m17:08:22.129992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_flights"
[0m17:08:22.130995 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:08:22.131998 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    flight_pk,
    flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:22.146560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:08:22.150573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:08:22.150573 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m17:08:22.152901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:22.155496 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m17:08:22.156016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:08:22.156573 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m17:08:22.160996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:08:22.163733 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup"
[0m17:08:22.164291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:08:22.164869 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup" cascade
[0m17:08:22.166491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:22.167499 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: Close
[0m17:08:22.168498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001334477A360>]}
[0m17:08:22.169506 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_flights ......... [[32mCREATE VIEW[0m in 0.16s]
[0m17:08:22.170843 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_flights
[0m17:08:22.170843 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_seats
[0m17:08:22.171839 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.stg_seats ................ [RUN]
[0m17:08:22.172838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_flights, now model.dbt_dwh.stg_seats)
[0m17:08:22.172838 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_seats
[0m17:08:22.180953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:08:22.181958 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: BEGIN
[0m17:08:22.181958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:22.227468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:08:22.228802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:08:22.229603 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.274284 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.043 seconds
[0m17:08:22.281604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:08:22.282138 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.286375 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:08:22.295230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_seats"
[0m17:08:22.296388 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_seats
[0m17:08:22.300460 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_seats"
[0m17:08:22.302492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:08:22.303000 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_seats"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'SEATS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS seat_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS seat_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    seat_pk,
    seat_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:22.317618 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:08:22.321548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:08:22.322066 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m17:08:22.324471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:22.326140 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m17:08:22.326670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:08:22.327195 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m17:08:22.332049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:22.335291 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup"
[0m17:08:22.336335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:08:22.336335 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup" cascade
[0m17:08:22.338565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:08:22.340145 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: Close
[0m17:08:22.340663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133445F7E00>]}
[0m17:08:22.341209 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_seats ........... [[32mCREATE VIEW[0m in 0.17s]
[0m17:08:22.342972 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_seats
[0m17:08:22.343512 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m17:08:22.344576 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.stg_ticket_flights ....... [RUN]
[0m17:08:22.345693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_seats, now model.dbt_dwh.stg_ticket_flights)
[0m17:08:22.346227 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_ticket_flights
[0m17:08:22.355939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.356465 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: BEGIN
[0m17:08:22.357057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:22.399327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m17:08:22.399327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.400360 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.440825 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.040 seconds
[0m17:08:22.447776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.448778 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.453078 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:08:22.462702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.464749 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_ticket_flights
[0m17:08:22.470193 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.471198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.471198 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'TICKET_FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    ticket_flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:22.484325 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:08:22.487534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.488539 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m17:08:22.490536 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:08:22.491636 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m17:08:22.492951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.492951 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m17:08:22.497954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:22.500952 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m17:08:22.500952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:08:22.501952 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m17:08:22.502954 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:22.503953 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: Close
[0m17:08:22.507003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013342CC7770>]}
[0m17:08:22.509056 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_ticket_flights .. [[32mCREATE VIEW[0m in 0.16s]
[0m17:08:22.512066 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m17:08:22.513071 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_tickets
[0m17:08:22.514573 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.stg_tickets .............. [RUN]
[0m17:08:22.514573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_ticket_flights, now model.dbt_dwh.stg_tickets)
[0m17:08:22.516079 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_tickets
[0m17:08:22.526507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:08:22.527587 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: BEGIN
[0m17:08:22.528132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:22.595194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m17:08:22.596696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:08:22.596696 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.634982 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.038 seconds
[0m17:08:22.641974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:08:22.642508 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:22.646346 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m17:08:22.654929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_tickets"
[0m17:08:22.655996 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_tickets
[0m17:08:22.659255 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_tickets"
[0m17:08:22.660308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:08:22.661320 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'TICKETS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS ticket_pk,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_fk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    ticket_pk,
    booking_fk,
    ticket_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-11-11')::DATE AS LOAD_DATE
FROM staging
  );
[0m17:08:22.677138 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:08:22.681866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:08:22.682396 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m17:08:22.684037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:08:22.685697 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m17:08:22.686217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:08:22.686765 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m17:08:22.691153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:22.693716 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup"
[0m17:08:22.694990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:08:22.695992 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m17:08:22.697289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:08:22.698793 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: Close
[0m17:08:22.699642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64e83a-b6e1-48c4-b754-b9b1ba68a14a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013344840530>]}
[0m17:08:22.700157 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_tickets ......... [[32mCREATE VIEW[0m in 0.19s]
[0m17:08:22.701370 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_tickets
[0m17:08:22.702524 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:22.704038 [debug] [MainThread]: On master: BEGIN
[0m17:08:22.704038 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:22.744289 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m17:08:22.744877 [debug] [MainThread]: On master: COMMIT
[0m17:08:22.745421 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:22.745959 [debug] [MainThread]: On master: COMMIT
[0m17:08:22.747609 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:08:22.747609 [debug] [MainThread]: On master: Close
[0m17:08:22.747609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:22.749054 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:08:22.749054 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:08:22.750139 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_tickets' was properly closed.
[0m17:08:22.750139 [info ] [MainThread]: 
[0m17:08:22.750139 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m17:08:22.752870 [debug] [MainThread]: Command end result
[0m17:08:22.801764 [info ] [MainThread]: 
[0m17:08:22.803854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:22.803854 [info ] [MainThread]: 
[0m17:08:22.805401 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:08:22.807377 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:22.806413 after 3.44 seconds
[0m17:08:22.807377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013342217800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000133447E5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013344855EB0>]}
[0m17:08:22.807883 [debug] [MainThread]: Flushing usage events
[0m17:08:32.449003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E5E3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E5E2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56EA20C80>]}


============================== 17:08:32.454502 | e207977d-8fb9-464e-b84e-a506fe8b7c7a ==============================
[0m17:08:32.454502 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:08:32.455510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:hub', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:08:32.716409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56EB559A0>]}
[0m17:08:32.783807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56DCFA9F0>]}
[0m17:08:32.786351 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:08:32.976975 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:08:33.197687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:33.197687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:33.227612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56FC930E0>]}
[0m17:08:33.344226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56FFD36E0>]}
[0m17:08:33.345491 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:08:33.346489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56FCE7A10>]}
[0m17:08:33.348488 [info ] [MainThread]: 
[0m17:08:33.349493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:33.353595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:08:33.622434 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:08:33.622434 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:08:33.623950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:33.673646 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.049 seconds
[0m17:08:33.675834 [debug] [ThreadPool]: On list_postgres: Close
[0m17:08:33.680642 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:08:33.687441 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:33.687441 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:08:33.688509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:33.731308 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m17:08:33.732306 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:33.732306 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:08:33.747259 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.015 seconds
[0m17:08:33.750402 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:08:33.752093 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:08:33.764086 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:33.764086 [debug] [MainThread]: On master: BEGIN
[0m17:08:33.765096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:33.817844 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m17:08:33.817844 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:33.818893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:08:33.842138 [debug] [MainThread]: SQL status: SELECT 16 in 0.023 seconds
[0m17:08:33.844109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56EB54560>]}
[0m17:08:33.845120 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:33.846632 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:33.846632 [debug] [MainThread]: On master: BEGIN
[0m17:08:33.850216 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:08:33.850216 [debug] [MainThread]: On master: COMMIT
[0m17:08:33.851386 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:33.851386 [debug] [MainThread]: On master: COMMIT
[0m17:08:33.853139 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:08:33.853139 [debug] [MainThread]: On master: Close
[0m17:08:33.854139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:33.855899 [info ] [MainThread]: 
[0m17:08:33.859784 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m17:08:33.861559 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m17:08:33.862626 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m17:08:33.864249 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m17:08:33.895291 [info ] [Thread-1 (]: 17:08:33 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m17:08:33.978634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m17:08:33.979643 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m17:08:34.031842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.032947 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp170834007507"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.model, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.model
),

records_to_insert AS (
    SELECT a.aircraft_code, a.model, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:34.032947 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:34.127227 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.094 seconds
[0m17:08:34.140258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.141259 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m17:08:34.143263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:08:34.143263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.144264 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp170834007507'
        
      order by ordinal_position

  
[0m17:08:34.187477 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.042 seconds
[0m17:08:34.194177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.194177 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.199697 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:08:34.210265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.210265 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.215963 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m17:08:34.230126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.232135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.232135 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp170834007507"
    )


  
[0m17:08:34.236210 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:08:34.250061 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m17:08:34.250736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:08:34.250736 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m17:08:34.255345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:08:34.257341 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m17:08:34.259341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56E11ABD0>]}
[0m17:08:34.260342 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mINSERT 0 0[0m in 0.40s]
[0m17:08:34.261848 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m17:08:34.261848 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m17:08:34.262886 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m17:08:34.263888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m17:08:34.265094 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m17:08:34.270183 [info ] [Thread-1 (]: 17:08:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m17:08:34.276207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m17:08:34.277342 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m17:08:34.283894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:08:34.284972 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp170834280350"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.timezone, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.timezone
),

records_to_insert AS (
    SELECT a.airport_code, a.timezone, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:34.286481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:34.361890 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.076 seconds
[0m17:08:34.364745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:08:34.366258 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m17:08:34.368131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:08:34.368699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:08:34.369243 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp170834280350'
        
      order by ordinal_position

  
[0m17:08:34.404785 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.035 seconds
[0m17:08:34.408590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:08:34.409596 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.412615 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:08:34.416137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:08:34.417133 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.419637 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:08:34.421627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m17:08:34.422627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:08:34.422627 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp170834280350"
    )


  
[0m17:08:34.426444 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m17:08:34.427512 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m17:08:34.428511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:08:34.428511 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m17:08:34.432773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:08:34.434279 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m17:08:34.435287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E570747770>]}
[0m17:08:34.436757 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mINSERT 0 0[0m in 0.17s]
[0m17:08:34.438061 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m17:08:34.439062 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m17:08:34.439062 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m17:08:34.440060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m17:08:34.441130 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m17:08:34.445376 [info ] [Thread-1 (]: 17:08:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m17:08:34.452391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m17:08:34.455141 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m17:08:34.461947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:08:34.463005 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp170834460176"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.book_date, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.book_date
),

records_to_insert AS (
    SELECT a.book_ref, a.book_date, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:34.464013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:34.539317 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.075 seconds
[0m17:08:34.542373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:08:34.543879 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m17:08:34.546394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:08:34.547404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:08:34.547404 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp170834460176'
        
      order by ordinal_position

  
[0m17:08:34.588505 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.040 seconds
[0m17:08:34.591799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:08:34.592796 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.596313 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:08:34.599440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:08:34.600457 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.603963 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:08:34.604992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m17:08:34.606503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:08:34.607706 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp170834460176"
    )


  
[0m17:08:34.610771 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m17:08:34.611774 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m17:08:34.611774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:08:34.613275 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m17:08:34.617620 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:08:34.618628 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m17:08:34.620298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E57070B500>]}
[0m17:08:34.621471 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mINSERT 0 0[0m in 0.18s]
[0m17:08:34.622756 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m17:08:34.622756 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m17:08:34.625221 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m17:08:34.626904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m17:08:34.627460 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m17:08:34.633505 [info ] [Thread-1 (]: 17:08:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m17:08:34.639779 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m17:08:34.640776 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m17:08:34.648842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:08:34.648842 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp170834645032"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.scheduled_departure, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.scheduled_departure
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:34.649868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:34.733756 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.084 seconds
[0m17:08:34.807742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:08:34.808751 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m17:08:34.809798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:08:34.811131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:08:34.811131 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp170834645032'
        
      order by ordinal_position

  
[0m17:08:34.844188 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.032 seconds
[0m17:08:34.847937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:08:34.848937 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.851963 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:34.855114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:08:34.856620 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:34.860231 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:34.862861 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m17:08:34.862861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:08:34.864369 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp170834645032"
    )


  
[0m17:08:34.868191 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:08:34.870469 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m17:08:34.871001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:08:34.871545 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m17:08:34.875903 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:08:34.876544 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m17:08:34.877966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E570573E90>]}
[0m17:08:34.879243 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mINSERT 0 0[0m in 0.25s]
[0m17:08:34.879243 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m17:08:34.880552 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m17:08:34.881553 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m17:08:34.882842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m17:08:34.882842 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m17:08:34.891843 [info ] [Thread-1 (]: 17:08:34 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m17:08:34.902553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m17:08:34.904923 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m17:08:34.912160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:08:34.913159 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

    
  
    

  create temporary table "hub_seats__dbt_tmp170834908966"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, rr.seat_no) rr.aircraft_code, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, rr.seat_no, rr.fare_conditions
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_seats" AS d
    ON a.aircraft_code = d.aircraft_code AND a.seat_no = d.seat_no
    WHERE d.aircraft_code IS NULL
    AND d.seat_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:34.914163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.002183 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.088 seconds
[0m17:08:35.005452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:08:35.005997 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m17:08:35.007080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:08:35.008553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:08:35.008553 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats__dbt_tmp170834908966'
        
      order by ordinal_position

  
[0m17:08:35.045169 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.036 seconds
[0m17:08:35.050335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:08:35.051335 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:35.057963 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:08:35.061921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:08:35.062488 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:35.066260 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:08:35.069618 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m17:08:35.070617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:08:35.070617 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_seats" ("aircraft_code", "seat_no", "fare_conditions", "record_source")
    (
        select "aircraft_code", "seat_no", "fare_conditions", "record_source"
        from "hub_seats__dbt_tmp170834908966"
    )


  
[0m17:08:35.075137 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:08:35.078322 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m17:08:35.078322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:08:35.078322 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m17:08:35.085459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:08:35.086467 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m17:08:35.087790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5706D8260>]}
[0m17:08:35.088966 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_seats .... [[32mINSERT 0 0[0m in 0.21s]
[0m17:08:35.089962 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m17:08:35.090963 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m17:08:35.090963 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m17:08:35.092407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m17:08:35.093919 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m17:08:35.101064 [info ] [Thread-1 (]: 17:08:35 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m17:08:35.107740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m17:08:35.109433 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m17:08:35.115158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:08:35.115158 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp170835112179"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.book_ref, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.book_ref
),

records_to_insert AS (
    SELECT a.ticket_no, a.book_ref, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:35.116668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:35.198460 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.083 seconds
[0m17:08:35.203025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:08:35.203025 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m17:08:35.204541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:08:35.205555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:08:35.206556 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp170835112179'
        
      order by ordinal_position

  
[0m17:08:35.240290 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.034 seconds
[0m17:08:35.244813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:08:35.244813 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:35.249402 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:08:35.252405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:08:35.252405 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:35.256601 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:08:35.258829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m17:08:35.259829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:08:35.259829 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp170835112179"
    )


  
[0m17:08:35.263928 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:08:35.265079 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m17:08:35.266585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:08:35.266585 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m17:08:35.280546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:08:35.281636 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m17:08:35.282638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e207977d-8fb9-464e-b84e-a506fe8b7c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E570483D40>]}
[0m17:08:35.284144 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mINSERT 0 0[0m in 0.19s]
[0m17:08:35.284144 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m17:08:35.286601 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:35.287135 [debug] [MainThread]: On master: BEGIN
[0m17:08:35.287680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:35.323051 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m17:08:35.324053 [debug] [MainThread]: On master: COMMIT
[0m17:08:35.324053 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:35.324053 [debug] [MainThread]: On master: COMMIT
[0m17:08:35.326535 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:08:35.326535 [debug] [MainThread]: On master: Close
[0m17:08:35.327604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:35.328629 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:08:35.328629 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:08:35.329671 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m17:08:35.330673 [info ] [MainThread]: 
[0m17:08:35.330673 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m17:08:35.332669 [debug] [MainThread]: Command end result
[0m17:08:35.380947 [info ] [MainThread]: 
[0m17:08:35.381948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:08:35.382947 [info ] [MainThread]: 
[0m17:08:35.382947 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:08:35.385025 [debug] [MainThread]: Command `dbt run` succeeded at 17:08:35.385025 after 3.11 seconds
[0m17:08:35.386535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5707B35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56AB8E420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56DE56EA0>]}
[0m17:08:35.387571 [debug] [MainThread]: Flushing usage events
[0m17:08:43.760677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD4F0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD4F0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD4F0D10>]}


============================== 17:08:43.766853 | cec02124-c754-4970-ab14-be60e913e72d ==============================
[0m17:08:43.766853 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:08:43.767847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:links', 'send_anonymous_usage_stats': 'True'}
[0m17:08:44.021436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD64FF80>]}
[0m17:08:44.084485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFCCE16D0>]}
[0m17:08:44.087217 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:08:44.284339 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:08:44.505215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:08:44.505215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:08:44.534558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD6D9430>]}
[0m17:08:44.648078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFE93BEC0>]}
[0m17:08:44.649352 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:08:44.651665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFEAE5FD0>]}
[0m17:08:44.654172 [info ] [MainThread]: 
[0m17:08:44.655182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:08:44.658710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:08:44.874246 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:08:44.874754 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:08:44.875932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:44.942006 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.066 seconds
[0m17:08:44.943006 [debug] [ThreadPool]: On list_postgres: Close
[0m17:08:44.950646 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:08:44.957227 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:44.957227 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:08:44.957227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:45.015517 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m17:08:45.015517 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:08:45.017555 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:08:45.035934 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.018 seconds
[0m17:08:45.038217 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:08:45.040234 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:08:45.051873 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:45.052884 [debug] [MainThread]: On master: BEGIN
[0m17:08:45.052884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:08:45.118617 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m17:08:45.118617 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:45.119611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:08:45.142637 [debug] [MainThread]: SQL status: SELECT 16 in 0.022 seconds
[0m17:08:45.145165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFEADE840>]}
[0m17:08:45.145165 [debug] [MainThread]: On master: ROLLBACK
[0m17:08:45.146680 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:45.147690 [debug] [MainThread]: On master: BEGIN
[0m17:08:45.149697 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:08:45.150698 [debug] [MainThread]: On master: COMMIT
[0m17:08:45.150698 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:45.150698 [debug] [MainThread]: On master: COMMIT
[0m17:08:45.152699 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:08:45.152699 [debug] [MainThread]: On master: Close
[0m17:08:45.152699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:08:45.154207 [info ] [MainThread]: 
[0m17:08:45.159580 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:08:45.159580 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:08:45.160578 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:08:45.162578 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:08:45.190216 [info ] [Thread-1 (]: 17:08:45 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:08:45.251689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:08:45.254204 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:08:45.305823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:08:45.307569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:08:45.308630 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:08:45.308630 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:08:45.356339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:08:45.357468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:08:45.357468 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:45.359700 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:   ) as l
           ^

[0m17:08:45.360716 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m17:08:45.361719 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:08:45.371727 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:08:45.373907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFEBAE870>]}
[0m17:08:45.374421 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.21s]
[0m17:08:45.376039 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:08:45.376576 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:08:45.377625 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:08:45.378689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:08:45.379230 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:08:45.384257 [info ] [Thread-1 (]: 17:08:45 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:08:45.389824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.391398 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:08:45.400575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.401115 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

    
  
    

  create temporary table "link_boarding_passes__dbt_tmp170845393582"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:45.401677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:45.485665 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.084 seconds
[0m17:08:45.498698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.499807 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:08:45.502150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:08:45.502150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.503157 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes__dbt_tmp170845393582'
        
      order by ordinal_position

  
[0m17:08:45.539902 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.036 seconds
[0m17:08:45.545644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.546185 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:45.549982 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:45.556590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.557600 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:45.560606 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:45.571630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.572640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:08:45.572640 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "record_source")
    (
        select "ticket_no", "flight_id", "boarding_no", "record_source"
        from "link_boarding_passes__dbt_tmp170845393582"
    )


  
[0m17:08:45.582963 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "boarding_no" does not exist
LINE 5:         select "ticket_no", "flight_id", "boarding_no", "rec...
                                                 ^
HINT:  There is a column named "boarding_no" in table "link_boarding_passes", but it cannot be referenced from this part of the query.

[0m17:08:45.582963 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: ROLLBACK
[0m17:08:45.584199 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:08:45.588193 [debug] [Thread-1 (]: Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  column "boarding_no" does not exist
  LINE 5:         select "ticket_no", "flight_id", "boarding_no", "rec...
                                                   ^
  HINT:  There is a column named "boarding_no" in table "link_boarding_passes", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_boarding_passes.sql
[0m17:08:45.588747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFF2A3CB0>]}
[0m17:08:45.588747 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[31mERROR[0m in 0.21s]
[0m17:08:45.590254 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:08:45.591353 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:08:45.591353 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:08:45.592751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:08:45.592751 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:08:45.598332 [info ] [Thread-1 (]: 17:08:45 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:08:45.603922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:08:45.605513 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:08:45.610537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:08:45.610537 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

    
  
    

  create temporary table "link_flights_airports__dbt_tmp170845608531"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" AS d
    ON a.flight_id = d.flight_id AND a.departure_airport = d.departure_airport AND a.arrival_airport = d.arrival_airport
    WHERE d.flight_id IS NULL
    AND d.departure_airport IS NULL
    AND d.arrival_airport IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:45.611528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:45.682865 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.072 seconds
[0m17:08:45.688441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:08:45.688441 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:08:45.690496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:08:45.691497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:08:45.691497 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports__dbt_tmp170845608531'
        
      order by ordinal_position

  
[0m17:08:45.729981 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.038 seconds
[0m17:08:45.734482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:08:45.734482 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:45.738572 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m17:08:45.742123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:08:45.743134 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:45.747609 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m17:08:45.749604 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:08:45.750601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:08:45.751606 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" ("flight_id", "departure_airport", "arrival_airport", "scheduled_departure", "record_source")
    (
        select "flight_id", "departure_airport", "arrival_airport", "scheduled_departure", "record_source"
        from "link_flights_airports__dbt_tmp170845608531"
    )


  
[0m17:08:45.760039 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "scheduled_departure" does not exist
LINE 5: ...ight_id", "departure_airport", "arrival_airport", "scheduled...
                                                             ^
HINT:  There is a column named "scheduled_departure" in table "link_flights_airports", but it cannot be referenced from this part of the query.

[0m17:08:45.761038 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: ROLLBACK
[0m17:08:45.762048 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:08:45.764605 [debug] [Thread-1 (]: Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  column "scheduled_departure" does not exist
  LINE 5: ...ight_id", "departure_airport", "arrival_airport", "scheduled...
                                                               ^
  HINT:  There is a column named "scheduled_departure" in table "link_flights_airports", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_flights_airports.sql
[0m17:08:45.764605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFF16D940>]}
[0m17:08:45.765622 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[31mERROR[0m in 0.17s]
[0m17:08:45.766621 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:08:45.767615 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:08:45.767615 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:08:45.768617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:08:45.769627 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:08:45.775737 [info ] [Thread-1 (]: 17:08:45 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:08:45.782362 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.783522 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:08:45.788859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.789487 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp170845786735"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:45.790033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:45.860295 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.070 seconds
[0m17:08:45.864286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.865301 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:08:45.867872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:08:45.868874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.869875 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp170845786735'
        
      order by ordinal_position

  
[0m17:08:45.904643 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.035 seconds
[0m17:08:45.908791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.908791 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:45.913023 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:08:45.917815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.917815 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:45.922103 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:45.923105 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.924631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:08:45.924631 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" ("ticket_no", "flight_id", "fare_conditions", "record_source")
    (
        select "ticket_no", "flight_id", "fare_conditions", "record_source"
        from "link_ticket_flights__dbt_tmp170845786735"
    )


  
[0m17:08:45.934227 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fare_conditions" does not exist
LINE 5:         select "ticket_no", "flight_id", "fare_conditions", ...
                                                 ^
HINT:  There is a column named "fare_conditions" in table "link_ticket_flights", but it cannot be referenced from this part of the query.

[0m17:08:45.934770 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: ROLLBACK
[0m17:08:45.935791 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:08:45.939473 [debug] [Thread-1 (]: Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  column "fare_conditions" does not exist
  LINE 5:         select "ticket_no", "flight_id", "fare_conditions", ...
                                                   ^
  HINT:  There is a column named "fare_conditions" in table "link_ticket_flights", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_ticket_flights.sql
[0m17:08:45.939473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFF310830>]}
[0m17:08:45.940497 [error] [Thread-1 (]: 4 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[31mERROR[0m in 0.17s]
[0m17:08:45.941501 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:08:45.941501 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:08:45.942491 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:08:45.943784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:08:45.944302 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:08:46.029962 [info ] [Thread-1 (]: 17:08:46 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:08:46.035542 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.036544 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:08:46.040837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.040837 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

    
  
    

  create temporary table "link_tickets_bookings__dbt_tmp170846038815"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" AS d
    ON a.book_ref = d.book_ref AND a.ticket_no = d.ticket_no
    WHERE d.book_ref IS NULL
    AND d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:08:46.041851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:08:46.119380 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.078 seconds
[0m17:08:46.123380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.123380 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:08:46.125914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:08:46.126906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.126906 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings__dbt_tmp170846038815'
        
      order by ordinal_position

  
[0m17:08:46.159534 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.032 seconds
[0m17:08:46.162937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.162937 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:46.167498 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:46.170499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.171499 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:08:46.174546 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:08:46.176558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.177561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:08:46.178562 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" ("book_ref", "ticket_no", "passenger_id", "record_source")
    (
        select "book_ref", "ticket_no", "passenger_id", "record_source"
        from "link_tickets_bookings__dbt_tmp170846038815"
    )


  
[0m17:08:46.188484 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "passenger_id" does not exist
LINE 5:         select "book_ref", "ticket_no", "passenger_id", "rec...
                                                ^
HINT:  There is a column named "passenger_id" in table "link_tickets_bookings", but it cannot be referenced from this part of the query.

[0m17:08:46.189042 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: ROLLBACK
[0m17:08:46.190202 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:08:46.193630 [debug] [Thread-1 (]: Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  column "passenger_id" does not exist
  LINE 5:         select "book_ref", "ticket_no", "passenger_id", "rec...
                                                  ^
  HINT:  There is a column named "passenger_id" in table "link_tickets_bookings", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_tickets_bookings.sql
[0m17:08:46.194155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cec02124-c754-4970-ab14-be60e913e72d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFF2E3770>]}
[0m17:08:46.194701 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[31mERROR[0m in 0.25s]
[0m17:08:46.196328 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:08:46.198104 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:46.198104 [debug] [MainThread]: On master: BEGIN
[0m17:08:46.198656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:08:46.238553 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m17:08:46.239858 [debug] [MainThread]: On master: COMMIT
[0m17:08:46.240853 [debug] [MainThread]: Using postgres connection "master"
[0m17:08:46.241855 [debug] [MainThread]: On master: COMMIT
[0m17:08:46.241855 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:08:46.243676 [debug] [MainThread]: On master: Close
[0m17:08:46.244687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:46.244687 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:08:46.244687 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:08:46.245957 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:08:46.246476 [info ] [MainThread]: 
[0m17:08:46.247484 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m17:08:46.248482 [debug] [MainThread]: Command end result
[0m17:08:46.295466 [info ] [MainThread]: 
[0m17:08:46.296974 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:08:46.297983 [info ] [MainThread]: 
[0m17:08:46.297983 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:08:46.299079 [info ] [MainThread]: 
[0m17:08:46.299711 [error] [MainThread]:   Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  column "boarding_no" does not exist
  LINE 5:         select "ticket_no", "flight_id", "boarding_no", "rec...
                                                   ^
  HINT:  There is a column named "boarding_no" in table "link_boarding_passes", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_boarding_passes.sql
[0m17:08:46.300289 [info ] [MainThread]: 
[0m17:08:46.300825 [error] [MainThread]:   Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  column "scheduled_departure" does not exist
  LINE 5: ...ight_id", "departure_airport", "arrival_airport", "scheduled...
                                                               ^
  HINT:  There is a column named "scheduled_departure" in table "link_flights_airports", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_flights_airports.sql
[0m17:08:46.301833 [info ] [MainThread]: 
[0m17:08:46.302840 [error] [MainThread]:   Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  column "fare_conditions" does not exist
  LINE 5:         select "ticket_no", "flight_id", "fare_conditions", ...
                                                   ^
  HINT:  There is a column named "fare_conditions" in table "link_ticket_flights", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_ticket_flights.sql
[0m17:08:46.305360 [info ] [MainThread]: 
[0m17:08:46.305360 [error] [MainThread]:   Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  column "passenger_id" does not exist
  LINE 5:         select "book_ref", "ticket_no", "passenger_id", "rec...
                                                  ^
  HINT:  There is a column named "passenger_id" in table "link_tickets_bookings", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_tickets_bookings.sql
[0m17:08:46.307887 [info ] [MainThread]: 
[0m17:08:46.308904 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m17:08:46.311899 [debug] [MainThread]: Command `dbt run` failed at 17:08:46.311899 after 2.73 seconds
[0m17:08:46.312906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFCB23FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD0F8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FFD0F82F0>]}
[0m17:08:46.312906 [debug] [MainThread]: Flushing usage events
[0m17:10:03.035503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA90EA600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA90EA300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA9A220C0>]}


============================== 17:10:03.040837 | 531186c1-5755-4533-972a-29812d4f4543 ==============================
[0m17:10:03.040837 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:10:03.042351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:links', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:03.300139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA9BBF470>]}
[0m17:10:03.366538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAAC0BD70>]}
[0m17:10:03.367552 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:10:03.559211 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:10:03.792899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:10:03.793892 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_boarding_passes.sql
[0m17:10:03.793892 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_aircrafts_seats.sql
[0m17:10:03.795017 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_tickets_bookings.sql
[0m17:10:03.795017 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_flights_airports.sql
[0m17:10:03.795017 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_ticket_flights.sql
[0m17:10:04.151211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAAEA4980>]}
[0m17:10:04.260142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAB02ACC0>]}
[0m17:10:04.260664 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:10:04.260664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAAE2DEB0>]}
[0m17:10:04.263947 [info ] [MainThread]: 
[0m17:10:04.264941 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:04.267469 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:10:04.578013 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:10:04.578013 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:10:04.579234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:04.646425 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.067 seconds
[0m17:10:04.648058 [debug] [ThreadPool]: On list_postgres: Close
[0m17:10:04.651596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:10:04.659836 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:10:04.660374 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:10:04.660931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:04.700040 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m17:10:04.700040 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:10:04.701043 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:10:04.718417 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.017 seconds
[0m17:10:04.788037 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:10:04.790751 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:10:04.802232 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:04.802232 [debug] [MainThread]: On master: BEGIN
[0m17:10:04.803180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:04.842585 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m17:10:04.843666 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:04.843666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:04.869128 [debug] [MainThread]: SQL status: SELECT 16 in 0.024 seconds
[0m17:10:04.871128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA7564DD0>]}
[0m17:10:04.872129 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:04.874125 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:04.874125 [debug] [MainThread]: On master: BEGIN
[0m17:10:04.876525 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:10:04.877621 [debug] [MainThread]: On master: COMMIT
[0m17:10:04.878620 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:04.878620 [debug] [MainThread]: On master: COMMIT
[0m17:10:04.879625 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:10:04.879625 [debug] [MainThread]: On master: Close
[0m17:10:04.881351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:04.882716 [info ] [MainThread]: 
[0m17:10:04.887444 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:10:04.888537 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:10:04.889646 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:10:04.890766 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:10:04.911288 [info ] [Thread-1 (]: 17:10:04 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:10:04.915534 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:10:04.917641 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:10:04.971497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:10:04.972508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:10:04.972508 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:10:04.973878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:05.025275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m17:10:05.025845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:10:05.026858 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.fare_conditions, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.fare_conditions
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:10:05.029096 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:   ) as l
           ^

[0m17:10:05.030178 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m17:10:05.031316 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:10:05.040778 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:10:05.042398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAAEA4FE0>]}
[0m17:10:05.043524 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.15s]
[0m17:10:05.044614 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:10:05.045276 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:10:05.045816 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:10:05.047694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:10:05.047694 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:10:05.052736 [info ] [Thread-1 (]: 17:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:10:05.061881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.064075 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:10:05.073257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.074915 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

    
  
    

  create temporary table "link_boarding_passes__dbt_tmp171005067377"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.boarding_no, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.boarding_no
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.boarding_no, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:10:05.075774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:05.147380 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.072 seconds
[0m17:10:05.162261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.162261 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:10:05.164598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:10:05.165598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.165598 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes__dbt_tmp171005067377'
        
      order by ordinal_position

  
[0m17:10:05.203105 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.037 seconds
[0m17:10:05.209370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.210081 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.214261 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:10:05.221010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.222012 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.225015 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:10:05.235550 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.236598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.236598 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "record_source")
    (
        select "ticket_no", "flight_id", "boarding_no", "record_source"
        from "link_boarding_passes__dbt_tmp171005067377"
    )


  
[0m17:10:05.240459 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:10:05.259941 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:10:05.260471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:10:05.261007 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:10:05.286654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m17:10:05.288209 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:10:05.289956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA7450440>]}
[0m17:10:05.292377 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[32mINSERT 0 0[0m in 0.24s]
[0m17:10:05.293615 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:10:05.293615 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:10:05.294787 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:10:05.295786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:10:05.295786 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:10:05.301024 [info ] [Thread-1 (]: 17:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:10:05.311650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:10:05.313165 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:10:05.318972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:10:05.318972 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

    
  
    

  create temporary table "link_flights_airports__dbt_tmp171005315166"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.scheduled_departure, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.scheduled_departure
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.scheduled_departure, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" AS d
    ON a.flight_id = d.flight_id AND a.departure_airport = d.departure_airport AND a.arrival_airport = d.arrival_airport
    WHERE d.flight_id IS NULL
    AND d.departure_airport IS NULL
    AND d.arrival_airport IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:10:05.319973 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:05.390855 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.071 seconds
[0m17:10:05.394847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:10:05.394847 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:10:05.397360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:10:05.397360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:10:05.398870 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports__dbt_tmp171005315166'
        
      order by ordinal_position

  
[0m17:10:05.434706 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.036 seconds
[0m17:10:05.439123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:10:05.439678 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.444164 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m17:10:05.447466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:10:05.448026 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.451289 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.003 seconds
[0m17:10:05.453288 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:10:05.454285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:10:05.454285 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" ("flight_id", "departure_airport", "arrival_airport", "scheduled_departure", "record_source")
    (
        select "flight_id", "departure_airport", "arrival_airport", "scheduled_departure", "record_source"
        from "link_flights_airports__dbt_tmp171005315166"
    )


  
[0m17:10:05.458987 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:10:05.460989 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:10:05.462015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:10:05.462015 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:10:05.477312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m17:10:05.478822 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:10:05.478822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA9BBF4D0>]}
[0m17:10:05.480580 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[32mINSERT 0 0[0m in 0.18s]
[0m17:10:05.481686 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:10:05.481686 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:10:05.482768 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:10:05.483307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:10:05.483853 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:10:05.488691 [info ] [Thread-1 (]: 17:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:10:05.494548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.495549 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:10:05.502498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.504273 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp171005499108"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.fare_conditions, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.fare_conditions
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.fare_conditions, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:10:05.504817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:05.575507 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.071 seconds
[0m17:10:05.579568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.580074 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:10:05.582195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:10:05.582967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.583479 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp171005499108'
        
      order by ordinal_position

  
[0m17:10:05.620595 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.036 seconds
[0m17:10:05.623789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.625178 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.628734 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:10:05.634727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.635242 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.639362 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:10:05.641602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.642602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.642602 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" ("ticket_no", "flight_id", "fare_conditions", "record_source")
    (
        select "ticket_no", "flight_id", "fare_conditions", "record_source"
        from "link_ticket_flights__dbt_tmp171005499108"
    )


  
[0m17:10:05.646600 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:10:05.647652 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:10:05.648652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:10:05.649382 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:10:05.663350 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:10:05.664482 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:10:05.665058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA9B886E0>]}
[0m17:10:05.666749 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[32mINSERT 0 0[0m in 0.18s]
[0m17:10:05.667854 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:10:05.668419 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:10:05.668975 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:10:05.670011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:10:05.670011 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:10:05.675038 [info ] [Thread-1 (]: 17:10:05 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:10:05.682029 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.684144 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:10:05.689094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.690097 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

    
  
    

  create temporary table "link_tickets_bookings__dbt_tmp171005686509"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.passenger_id, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.passenger_id
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.passenger_id, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" AS d
    ON a.book_ref = d.book_ref AND a.ticket_no = d.ticket_no
    WHERE d.book_ref IS NULL
    AND d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:10:05.690097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:05.757429 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.066 seconds
[0m17:10:05.760709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.760709 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:10:05.762722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:10:05.763719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.763719 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings__dbt_tmp171005686509'
        
      order by ordinal_position

  
[0m17:10:05.802519 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.038 seconds
[0m17:10:05.807586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.808725 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.812473 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:10:05.817589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.818108 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:10:05.822125 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:10:05.824118 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.825118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.825118 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" ("book_ref", "ticket_no", "passenger_id", "record_source")
    (
        select "book_ref", "ticket_no", "passenger_id", "record_source"
        from "link_tickets_bookings__dbt_tmp171005686509"
    )


  
[0m17:10:05.828645 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:10:05.829806 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:10:05.830920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:10:05.830920 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:10:05.835417 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:10:05.836447 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:10:05.838075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '531186c1-5755-4533-972a-29812d4f4543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAB869D60>]}
[0m17:10:05.839263 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[32mINSERT 0 0[0m in 0.17s]
[0m17:10:05.840399 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:10:05.842061 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:05.842592 [debug] [MainThread]: On master: BEGIN
[0m17:10:05.843182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:05.879792 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m17:10:05.881166 [debug] [MainThread]: On master: COMMIT
[0m17:10:05.881166 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:05.881166 [debug] [MainThread]: On master: COMMIT
[0m17:10:05.883260 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:10:05.883841 [debug] [MainThread]: On master: Close
[0m17:10:05.884349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:05.884930 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:10:05.885589 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:10:05.886160 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:10:05.886694 [info ] [MainThread]: 
[0m17:10:05.887244 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m17:10:05.888890 [debug] [MainThread]: Command end result
[0m17:10:05.935019 [info ] [MainThread]: 
[0m17:10:05.937302 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:05.938656 [info ] [MainThread]: 
[0m17:10:05.940180 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:10:05.940690 [info ] [MainThread]: 
[0m17:10:05.941988 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:10:05.943652 [debug] [MainThread]: Command `dbt run` failed at 17:10:05.943652 after 3.19 seconds
[0m17:10:05.944204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCA90EA600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAAFC21B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCAAFC39E0>]}
[0m17:10:05.944739 [debug] [MainThread]: Flushing usage events
[0m17:18:46.143158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A1E9B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A46FA300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A45D98B0>]}


============================== 17:18:46.147780 | 167e7a73-6b65-4301-9b05-e082dd94ec5b ==============================
[0m17:18:46.147780 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:18:46.148784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:links', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:46.410082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A49F6870>]}
[0m17:18:46.472432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A3A07140>]}
[0m17:18:46.474450 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:18:46.685874 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:18:47.144435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 13 files changed.
[0m17:18:47.145449 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m17:18:47.146442 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m17:18:47.146442 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m17:18:47.147808 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_ticket_flights.sql
[0m17:18:47.147808 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m17:18:47.147808 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m17:18:47.148809 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m17:18:47.148809 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_boarding_passes.sql
[0m17:18:47.149810 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m17:18:47.150321 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_tickets_bookings.sql
[0m17:18:47.150321 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_aircrafts_seats.sql
[0m17:18:47.151325 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m17:18:47.151325 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_flights_airports.sql
[0m17:18:47.635313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5E5B170>]}
[0m17:18:47.826584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5E9FDD0>]}
[0m17:18:47.827591 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:18:47.827591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5F7ED20>]}
[0m17:18:47.830097 [info ] [MainThread]: 
[0m17:18:47.831109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:47.835424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:18:48.113596 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:18:48.114594 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:18:48.114594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:48.163222 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.049 seconds
[0m17:18:48.165218 [debug] [ThreadPool]: On list_postgres: Close
[0m17:18:48.169204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:18:48.175246 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:18:48.176248 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:18:48.176248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:48.218308 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m17:18:48.219307 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:18:48.219307 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:18:48.236793 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.017 seconds
[0m17:18:48.239291 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:18:48.240313 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:18:48.252734 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.253304 [debug] [MainThread]: On master: BEGIN
[0m17:18:48.253304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:48.294528 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m17:18:48.294528 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.295540 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:48.318713 [debug] [MainThread]: SQL status: SELECT 16 in 0.023 seconds
[0m17:18:48.322352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5E9E000>]}
[0m17:18:48.322352 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:48.324556 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.324556 [debug] [MainThread]: On master: BEGIN
[0m17:18:48.327145 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:18:48.327145 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.328630 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.328630 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.329934 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.329934 [debug] [MainThread]: On master: Close
[0m17:18:48.331426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:48.332427 [info ] [MainThread]: 
[0m17:18:48.337672 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:18:48.337672 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:18:48.338659 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:18:48.340166 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:18:48.375392 [info ] [Thread-1 (]: 17:18:48 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:18:48.381007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:18:48.384567 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:18:48.439983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:18:48.442515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:18:48.442515 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:18:48.443523 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:48.485987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:18:48.486973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:18:48.486973 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:18:48.487986 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:   ) as l
           ^

[0m17:18:48.489502 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m17:18:48.491067 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:18:48.501046 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:18:48.503271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5E569F0>]}
[0m17:18:48.504382 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.16s]
[0m17:18:48.505499 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:18:48.506072 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:18:48.507160 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:18:48.508310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:18:48.508310 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:18:48.513299 [info ] [Thread-1 (]: 17:18:48 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:18:48.518277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:18:48.519930 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:18:48.527682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:18:48.528713 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

    
  
    

  create temporary table "link_boarding_passes__dbt_tmp171848523233"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:18:48.528713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.572564 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.load_datetime does not exist
LINE 19:     SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr....
                                                ^

[0m17:18:48.573576 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:18:48.576713 [debug] [Thread-1 (]: Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  column rr.load_datetime does not exist
  LINE 19:     SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr....
                                                  ^
[0m17:18:48.576713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A673EBA0>]}
[0m17:18:48.578094 [error] [Thread-1 (]: 2 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[31mERROR[0m in 0.07s]
[0m17:18:48.579098 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:18:48.580091 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:18:48.580091 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:18:48.581334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:18:48.581334 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:18:48.588055 [info ] [Thread-1 (]: 17:18:48 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:18:48.594135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:18:48.594673 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:18:48.600126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:18:48.601142 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

    
  
    

  create temporary table "link_flights_airports__dbt_tmp171848598615"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" AS d
    ON a.flight_id = d.flight_id AND a.departure_airport = d.departure_airport AND a.arrival_airport = d.arrival_airport
    WHERE d.flight_id IS NULL
    AND d.departure_airport IS NULL
    AND d.arrival_airport IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:18:48.601142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.643176 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.load_datetime does not exist
LINE 19: ...ght_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DA...
                                                              ^

[0m17:18:48.644177 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:18:48.647248 [debug] [Thread-1 (]: Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  column rr.load_datetime does not exist
  LINE 19: ...ght_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DA...
                                                                ^
[0m17:18:48.648387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A673D8B0>]}
[0m17:18:48.648948 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[31mERROR[0m in 0.07s]
[0m17:18:48.650146 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:18:48.650687 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:18:48.651240 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:18:48.651770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:18:48.652308 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:18:48.657291 [info ] [Thread-1 (]: 17:18:48 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:18:48.661296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:18:48.663382 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:18:48.668815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:18:48.670323 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp171848666567"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:18:48.670323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.713861 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.load_datetime does not exist
LINE 19:     SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr....
                                                ^

[0m17:18:48.714973 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:18:48.717717 [debug] [Thread-1 (]: Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  column rr.load_datetime does not exist
  LINE 19:     SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr....
                                                  ^
[0m17:18:48.718246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A674D9D0>]}
[0m17:18:48.718246 [error] [Thread-1 (]: 4 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[31mERROR[0m in 0.07s]
[0m17:18:48.719946 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:18:48.719946 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:18:48.720964 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:18:48.722096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:18:48.722096 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:18:48.727429 [info ] [Thread-1 (]: 17:18:48 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:18:48.732335 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:18:48.733337 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:18:48.737332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:18:48.737332 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

    
  
    

  create temporary table "link_tickets_bookings__dbt_tmp171848735331"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" AS d
    ON a.book_ref = d.book_ref AND a.ticket_no = d.ticket_no
    WHERE d.book_ref IS NULL
    AND d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:18:48.738344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:48.782386 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column rr.load_datetime does not exist
LINE 19:     SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.R...
                                               ^

[0m17:18:48.783707 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:18:48.786516 [debug] [Thread-1 (]: Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  column rr.load_datetime does not exist
  LINE 19:     SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.R...
                                                 ^
[0m17:18:48.787095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '167e7a73-6b65-4301-9b05-e082dd94ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A6723CE0>]}
[0m17:18:48.788188 [error] [Thread-1 (]: 5 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[31mERROR[0m in 0.06s]
[0m17:18:48.788707 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:18:48.790483 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.791032 [debug] [MainThread]: On master: BEGIN
[0m17:18:48.791583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:48.834222 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m17:18:48.834788 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.836063 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:48.836063 [debug] [MainThread]: On master: COMMIT
[0m17:18:48.837758 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:18:48.837758 [debug] [MainThread]: On master: Close
[0m17:18:48.838754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:48.838754 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:18:48.840268 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:18:48.840268 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:18:48.840268 [info ] [MainThread]: 
[0m17:18:48.841280 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m17:18:48.843280 [debug] [MainThread]: Command end result
[0m17:18:48.889099 [info ] [MainThread]: 
[0m17:18:48.890185 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m17:18:48.890750 [info ] [MainThread]: 
[0m17:18:48.891876 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:18:48.892469 [info ] [MainThread]: 
[0m17:18:48.893019 [error] [MainThread]:   Database Error in model link_boarding_passes (models\raw_vault\links\link_boarding_passes.sql)
  column rr.load_datetime does not exist
  LINE 19:     SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr....
                                                  ^
[0m17:18:48.893592 [info ] [MainThread]: 
[0m17:18:48.894134 [error] [MainThread]:   Database Error in model link_flights_airports (models\raw_vault\links\link_flights_airports.sql)
  column rr.load_datetime does not exist
  LINE 19: ...ght_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DA...
                                                                ^
[0m17:18:48.895379 [info ] [MainThread]: 
[0m17:18:48.896383 [error] [MainThread]:   Database Error in model link_ticket_flights (models\raw_vault\links\link_ticket_flights.sql)
  column rr.load_datetime does not exist
  LINE 19:     SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr....
                                                  ^
[0m17:18:48.896383 [info ] [MainThread]: 
[0m17:18:48.897376 [error] [MainThread]:   Database Error in model link_tickets_bookings (models\raw_vault\links\link_tickets_bookings.sql)
  column rr.load_datetime does not exist
  LINE 19:     SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.R...
                                                 ^
[0m17:18:48.898379 [info ] [MainThread]: 
[0m17:18:48.908615 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m17:18:48.910188 [debug] [MainThread]: Command `dbt run` failed at 17:18:48.910188 after 3.06 seconds
[0m17:18:48.910888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A3D9BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A67547A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A49D12E0>]}
[0m17:18:48.911422 [debug] [MainThread]: Flushing usage events
[0m17:24:54.425453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C84BF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CAE90C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CAE921B0>]}


============================== 17:24:54.430233 | e15c8323-dbe1-4c43-9f07-8983a0a20b88 ==============================
[0m17:24:54.430233 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:24:54.431344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:raw', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:54.702901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CB074410>]}
[0m17:24:54.769538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CAD3C170>]}
[0m17:24:54.771551 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:24:54.975268 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:24:55.142353 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:24:55.143408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CA7099A0>]}
[0m17:24:57.860814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCC41370>]}
[0m17:24:57.998905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CC5A3CB0>]}
[0m17:24:58.000199 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:24:58.000856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C7166060>]}
[0m17:24:58.003744 [info ] [MainThread]: 
[0m17:24:58.004996 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:24:58.010209 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:24:58.255698 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:24:58.256266 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:24:58.256856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:58.305843 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.048 seconds
[0m17:24:58.306855 [debug] [ThreadPool]: On list_postgres: Close
[0m17:24:58.312338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:24:58.318450 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:24:58.319460 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:24:58.319460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:58.391652 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m17:24:58.392663 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:24:58.393600 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:24:58.413742 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.019 seconds
[0m17:24:58.415742 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:24:58.417739 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:24:58.427773 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:58.427773 [debug] [MainThread]: On master: BEGIN
[0m17:24:58.428773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:58.489914 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m17:24:58.491059 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:58.491059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:24:58.515621 [debug] [MainThread]: SQL status: SELECT 16 in 0.024 seconds
[0m17:24:58.517923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CC5A0740>]}
[0m17:24:58.519435 [debug] [MainThread]: On master: ROLLBACK
[0m17:24:58.520450 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:58.522046 [debug] [MainThread]: On master: BEGIN
[0m17:24:58.525500 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:24:58.526060 [debug] [MainThread]: On master: COMMIT
[0m17:24:58.526060 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:58.526607 [debug] [MainThread]: On master: COMMIT
[0m17:24:58.528337 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:24:58.529058 [debug] [MainThread]: On master: Close
[0m17:24:58.530142 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:58.531805 [info ] [MainThread]: 
[0m17:24:58.537587 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m17:24:58.538095 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ............ [RUN]
[0m17:24:58.540459 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_aircrafts'
[0m17:24:58.541601 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m17:24:58.549469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.552070 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m17:24:58.586810 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.588437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.589018 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m17:24:58.589531 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:58.636167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:24:58.636167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.637170 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m17:24:58.652160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:24:58.661357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.661901 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts" rename to "raw_aircrafts__dbt_backup"
[0m17:24:58.664688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:24:58.668503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.669062 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp" rename to "raw_aircrafts"
[0m17:24:58.670934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:24:58.686209 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m17:24:58.686209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.687237 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m17:24:58.705277 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m17:24:58.713310 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup"
[0m17:24:58.718347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:24:58.718347 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup" cascade
[0m17:24:58.725853 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:24:58.728169 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m17:24:58.730884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C8A209B0>]}
[0m17:24:58.732905 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_aircrafts ....... [[32mCREATE VIEW[0m in 0.19s]
[0m17:24:58.733903 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m17:24:58.735083 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_airports
[0m17:24:58.735083 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.raw_airports ............. [RUN]
[0m17:24:58.737080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_airports)
[0m17:24:58.737080 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_airports
[0m17:24:58.741165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m17:24:58.743198 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_airports
[0m17:24:58.748439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m17:24:58.749536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:24:58.750085 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m17:24:58.750632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:58.796465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m17:24:58.797033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:24:58.797573 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m17:24:58.809787 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:24:58.814579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:24:58.814579 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports" rename to "raw_airports__dbt_backup"
[0m17:24:58.818583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:24:58.821089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:24:58.822088 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m17:24:58.827230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:24:58.830270 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m17:24:58.830270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:24:58.832349 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m17:24:58.837742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:24:58.843411 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup"
[0m17:24:58.844604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:24:58.845205 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup" cascade
[0m17:24:58.853484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:24:58.855661 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: Close
[0m17:24:58.856260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCD80050>]}
[0m17:24:58.857948 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_airports ........ [[32mCREATE VIEW[0m in 0.12s]
[0m17:24:58.859416 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_airports
[0m17:24:58.859416 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m17:24:58.860428 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ...... [RUN]
[0m17:24:58.861933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_boarding_passes)
[0m17:24:58.861933 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m17:24:58.866942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.867940 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m17:24:58.870527 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.872094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.872094 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m17:24:58.873407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:58.932063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:24:58.933121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.933121 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m17:24:58.950752 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:24:58.955211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.955211 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes" rename to "raw_boarding_passes__dbt_backup"
[0m17:24:58.957213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:24:58.960762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.960762 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp" rename to "raw_boarding_passes"
[0m17:24:58.963286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:24:58.964285 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m17:24:58.965287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.966285 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m17:24:58.971793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:24:58.974942 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup"
[0m17:24:58.974942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:24:58.976453 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup" cascade
[0m17:24:58.982246 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:24:58.983406 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m17:24:58.984570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCE9F9B0>]}
[0m17:24:58.986575 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_boarding_passes . [[32mCREATE VIEW[0m in 0.12s]
[0m17:24:58.987962 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m17:24:58.988497 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m17:24:58.989035 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............. [RUN]
[0m17:24:58.990100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_bookings)
[0m17:24:58.990633 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m17:24:58.994458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m17:24:58.995543 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m17:24:58.999845 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m17:24:59.000888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:24:59.001431 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m17:24:59.002018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:59.073493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m17:24:59.074084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:24:59.074084 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m17:24:59.089766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m17:24:59.094744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:24:59.095252 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings" rename to "raw_bookings__dbt_backup"
[0m17:24:59.097336 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:24:59.101420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:24:59.102617 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp" rename to "raw_bookings"
[0m17:24:59.107358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m17:24:59.111402 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m17:24:59.111946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:24:59.112485 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m17:24:59.117619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:24:59.120301 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup"
[0m17:24:59.120964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:24:59.121537 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup" cascade
[0m17:24:59.127743 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:24:59.128740 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m17:24:59.129749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCECD5B0>]}
[0m17:24:59.131478 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_bookings ........ [[32mCREATE VIEW[0m in 0.14s]
[0m17:24:59.133083 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m17:24:59.133590 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_flights
[0m17:24:59.134732 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.raw_flights .............. [RUN]
[0m17:24:59.135836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_flights)
[0m17:24:59.136611 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_flights
[0m17:24:59.141294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m17:24:59.142388 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_flights
[0m17:24:59.146572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m17:24:59.147571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:24:59.147571 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m17:24:59.148575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:59.202616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m17:24:59.203728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:24:59.204266 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m17:24:59.218183 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:24:59.222568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:24:59.223107 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights" rename to "raw_flights__dbt_backup"
[0m17:24:59.225311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:24:59.228705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:24:59.228705 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp" rename to "raw_flights"
[0m17:24:59.232481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:24:59.234399 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m17:24:59.234950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:24:59.234950 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m17:24:59.249641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:24:59.253453 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup"
[0m17:24:59.254129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:24:59.254664 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup" cascade
[0m17:24:59.260763 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m17:24:59.263284 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: Close
[0m17:24:59.264476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCD80440>]}
[0m17:24:59.265594 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_flights ......... [[32mCREATE VIEW[0m in 0.13s]
[0m17:24:59.266754 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_flights
[0m17:24:59.267308 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_seats
[0m17:24:59.267861 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.raw_seats ................ [RUN]
[0m17:24:59.269036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.raw_seats)
[0m17:24:59.269619 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_seats
[0m17:24:59.273367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m17:24:59.273930 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_seats
[0m17:24:59.278508 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m17:24:59.280019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:24:59.281029 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m17:24:59.281029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:59.339467 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m17:24:59.340623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:24:59.341713 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m17:24:59.364625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m17:24:59.370802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:24:59.371931 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats" rename to "raw_seats__dbt_backup"
[0m17:24:59.375394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:24:59.380626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:24:59.381281 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp" rename to "raw_seats"
[0m17:24:59.384686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:24:59.387110 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m17:24:59.387694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:24:59.388984 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m17:24:59.395928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:24:59.400605 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup"
[0m17:24:59.401177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:24:59.402459 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup" cascade
[0m17:24:59.409790 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:24:59.411492 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: Close
[0m17:24:59.412041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCD80530>]}
[0m17:24:59.413173 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_seats ........... [[32mCREATE VIEW[0m in 0.14s]
[0m17:24:59.414266 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_seats
[0m17:24:59.414799 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m17:24:59.415435 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ....... [RUN]
[0m17:24:59.416563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.raw_ticket_flights)
[0m17:24:59.417109 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m17:24:59.420955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.422062 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m17:24:59.425876 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.426422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.426969 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m17:24:59.427507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:59.470879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:24:59.471415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.471961 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m17:24:59.485298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:24:59.489218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.490326 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights" rename to "raw_ticket_flights__dbt_backup"
[0m17:24:59.495699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m17:24:59.500626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.501176 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp" rename to "raw_ticket_flights"
[0m17:24:59.503351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:24:59.505035 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m17:24:59.505035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.505595 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m17:24:59.511439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:24:59.514628 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup"
[0m17:24:59.515185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:24:59.515715 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup" cascade
[0m17:24:59.523036 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:24:59.524145 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m17:24:59.525723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCEFC740>]}
[0m17:24:59.526822 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_ticket_flights .. [[32mCREATE VIEW[0m in 0.11s]
[0m17:24:59.527925 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m17:24:59.528472 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m17:24:59.529007 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.raw_tickets .............. [RUN]
[0m17:24:59.529581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.raw_tickets)
[0m17:24:59.530191 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m17:24:59.535236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m17:24:59.535771 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m17:24:59.541712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m17:24:59.543375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:24:59.543929 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m17:24:59.543929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:59.586184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m17:24:59.587949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:24:59.588675 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m17:24:59.602537 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:24:59.607329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:24:59.607955 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets" rename to "raw_tickets__dbt_backup"
[0m17:24:59.609711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:24:59.612987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:24:59.613504 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp" rename to "raw_tickets"
[0m17:24:59.615162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:24:59.617469 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m17:24:59.618627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:24:59.619175 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m17:24:59.624023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:24:59.626763 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup"
[0m17:24:59.627305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:24:59.627847 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup" cascade
[0m17:24:59.634350 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m17:24:59.635453 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m17:24:59.636565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e15c8323-dbe1-4c43-9f07-8983a0a20b88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCD807D0>]}
[0m17:24:59.637172 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_tickets ......... [[32mCREATE VIEW[0m in 0.11s]
[0m17:24:59.638859 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m17:24:59.642689 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:59.643459 [debug] [MainThread]: On master: BEGIN
[0m17:24:59.644474 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:59.703509 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m17:24:59.704620 [debug] [MainThread]: On master: COMMIT
[0m17:24:59.705175 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:59.705175 [debug] [MainThread]: On master: COMMIT
[0m17:24:59.706303 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:24:59.706890 [debug] [MainThread]: On master: Close
[0m17:24:59.708320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:59.708320 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:24:59.708320 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:24:59.709831 [debug] [MainThread]: Connection 'model.dbt_dwh.raw_tickets' was properly closed.
[0m17:24:59.710843 [info ] [MainThread]: 
[0m17:24:59.710843 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.70 seconds (1.70s).
[0m17:24:59.713570 [debug] [MainThread]: Command end result
[0m17:24:59.846782 [info ] [MainThread]: 
[0m17:24:59.847766 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:24:59.848766 [info ] [MainThread]: 
[0m17:24:59.849763 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:24:59.850831 [debug] [MainThread]: Command `dbt run` succeeded at 17:24:59.850831 after 5.74 seconds
[0m17:24:59.851899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C84BF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CCB1AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CABF86E0>]}
[0m17:24:59.851899 [debug] [MainThread]: Flushing usage events
[0m17:25:11.645268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9CF20980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9C7DAAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9CF23E60>]}


============================== 17:25:11.650442 | 339f5fdd-515c-41d4-b4be-512eeff9dc60 ==============================
[0m17:25:11.650442 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:25:11.652438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:stage', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:11.931056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9D0D37A0>]}
[0m17:25:12.001327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9AB157C0>]}
[0m17:25:12.002929 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:25:12.211955 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:25:12.555026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:12.555580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:12.586659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9C8516D0>]}
[0m17:25:12.704615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EA57FB0>]}
[0m17:25:12.704615 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:25:12.705624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9E72FB60>]}
[0m17:25:12.707623 [info ] [MainThread]: 
[0m17:25:12.708623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:12.713142 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:25:12.980236 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:25:12.981251 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:25:12.981251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:13.041687 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.059 seconds
[0m17:25:13.043407 [debug] [ThreadPool]: On list_postgres: Close
[0m17:25:13.047364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:25:13.053608 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:25:13.054154 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:25:13.054154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:13.097146 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m17:25:13.097708 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:25:13.098299 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:25:13.116032 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.017 seconds
[0m17:25:13.117680 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:25:13.119307 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:25:13.129917 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:13.130930 [debug] [MainThread]: On master: BEGIN
[0m17:25:13.130930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:13.191294 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m17:25:13.191856 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:13.192395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:13.215367 [debug] [MainThread]: SQL status: SELECT 8 in 0.022 seconds
[0m17:25:13.216852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9D337890>]}
[0m17:25:13.217860 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:13.219144 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:13.220136 [debug] [MainThread]: On master: BEGIN
[0m17:25:13.222604 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:25:13.223602 [debug] [MainThread]: On master: COMMIT
[0m17:25:13.223602 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:13.223602 [debug] [MainThread]: On master: COMMIT
[0m17:25:13.225605 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:25:13.225605 [debug] [MainThread]: On master: Close
[0m17:25:13.226603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:13.228077 [info ] [MainThread]: 
[0m17:25:13.232993 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m17:25:13.232993 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.stg_aircrafts ............ [RUN]
[0m17:25:13.234207 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.stg_aircrafts'
[0m17:25:13.235444 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_aircrafts
[0m17:25:13.279974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.279974 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: BEGIN
[0m17:25:13.280985 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:13.335185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m17:25:13.335185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.336216 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:13.379013 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.042 seconds
[0m17:25:13.432951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.434235 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:13.439265 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:25:13.537631 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.540139 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_aircrafts
[0m17:25:13.574573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.575587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.576586 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'AIRCRAFTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS aircraft_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS aircraft_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    aircraft_pk,
    aircraft_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:13.589140 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:25:13.596442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.597044 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m17:25:13.599865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:25:13.613137 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m17:25:13.613137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.614140 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m17:25:13.628016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:25:13.634525 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup"
[0m17:25:13.638533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:25:13.640044 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m17:25:13.641061 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:25:13.644585 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: Close
[0m17:25:13.645587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9AAB0950>]}
[0m17:25:13.647006 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_aircrafts ....... [[32mCREATE VIEW[0m in 0.41s]
[0m17:25:13.648027 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m17:25:13.649299 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_airports
[0m17:25:13.650303 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.stg_airports ............. [RUN]
[0m17:25:13.650303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_aircrafts, now model.dbt_dwh.stg_airports)
[0m17:25:13.650303 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_airports
[0m17:25:13.658573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:25:13.660084 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: BEGIN
[0m17:25:13.661109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:13.704489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:25:13.705565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:25:13.706564 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:13.749832 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.042 seconds
[0m17:25:13.755072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:25:13.755623 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:13.759829 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m17:25:13.770258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_airports"
[0m17:25:13.771270 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_airports
[0m17:25:13.776891 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_airports"
[0m17:25:13.778566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:25:13.779697 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_airports"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'AIRPORTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS airport_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS airport_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    airport_pk,
    airport_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:13.792375 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:25:13.795721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:25:13.796268 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m17:25:13.798497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:25:13.799594 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m17:25:13.800131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:25:13.800692 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m17:25:13.805307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:25:13.807603 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup"
[0m17:25:13.808654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:25:13.808654 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup" cascade
[0m17:25:13.810231 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:25:13.812333 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: Close
[0m17:25:13.813864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9ECEF410>]}
[0m17:25:13.814481 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_airports ........ [[32mCREATE VIEW[0m in 0.16s]
[0m17:25:13.815802 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_airports
[0m17:25:13.816810 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m17:25:13.817805 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.stg_boarding_passes ...... [RUN]
[0m17:25:13.818813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_airports, now model.dbt_dwh.stg_boarding_passes)
[0m17:25:13.819803 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_boarding_passes
[0m17:25:13.830294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:25:13.830294 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: BEGIN
[0m17:25:13.831759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:13.881672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m17:25:13.881672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:25:13.882939 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:13.920514 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.037 seconds
[0m17:25:13.925966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:25:13.926964 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:13.930795 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:25:14.015877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_boarding_passes"
[0m17:25:14.017021 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_boarding_passes
[0m17:25:14.021615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_boarding_passes"
[0m17:25:14.022672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:25:14.023226 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'BOARDING_PASSES'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS boarding_pass_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    boarding_pass_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:14.037656 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:25:14.041004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:25:14.041004 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m17:25:14.043602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:14.044617 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m17:25:14.045625 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:25:14.045625 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m17:25:14.048618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:25:14.051138 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m17:25:14.052645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:25:14.053445 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m17:25:14.055084 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:25:14.056168 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: Close
[0m17:25:14.056728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9ECCA300>]}
[0m17:25:14.057935 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_boarding_passes . [[32mCREATE VIEW[0m in 0.24s]
[0m17:25:14.059261 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m17:25:14.059784 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m17:25:14.060330 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.stg_bookings ............. [RUN]
[0m17:25:14.061411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_boarding_passes, now model.dbt_dwh.stg_bookings)
[0m17:25:14.062173 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_bookings
[0m17:25:14.071632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:25:14.072720 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: BEGIN
[0m17:25:14.073287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:14.117353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:25:14.117904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:25:14.118511 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.157006 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.038 seconds
[0m17:25:14.162842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:25:14.163425 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.167568 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:25:14.175304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_bookings"
[0m17:25:14.177131 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_bookings
[0m17:25:14.181575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_bookings"
[0m17:25:14.182700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:25:14.182700 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'BOOKINGS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS booking_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    booking_pk,
    booking_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:14.195425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:25:14.198757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:25:14.199304 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m17:25:14.200547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:14.202202 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m17:25:14.202758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:25:14.202758 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m17:25:14.207160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:25:14.209958 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup"
[0m17:25:14.209958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:25:14.210973 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m17:25:14.212997 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:25:14.214100 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: Close
[0m17:25:14.214100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EDA1820>]}
[0m17:25:14.215180 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_bookings ........ [[32mCREATE VIEW[0m in 0.15s]
[0m17:25:14.216181 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m17:25:14.217484 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_flights
[0m17:25:14.217484 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.stg_flights .............. [RUN]
[0m17:25:14.218766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_bookings, now model.dbt_dwh.stg_flights)
[0m17:25:14.218766 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_flights
[0m17:25:14.226553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:25:14.227552 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: BEGIN
[0m17:25:14.227552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:14.266740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m17:25:14.268146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:25:14.268146 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.308440 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.040 seconds
[0m17:25:14.315137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:25:14.316247 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.320058 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m17:25:14.330983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_flights"
[0m17:25:14.333255 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_flights
[0m17:25:14.337812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_flights"
[0m17:25:14.338812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:25:14.338812 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    flight_pk,
    flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:14.352470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:25:14.356631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:25:14.356631 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m17:25:14.358876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:25:14.359979 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m17:25:14.360534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:25:14.361127 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m17:25:14.365451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:25:14.368448 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup"
[0m17:25:14.368448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:25:14.368448 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup" cascade
[0m17:25:14.370979 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:25:14.372492 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: Close
[0m17:25:14.373440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EE255E0>]}
[0m17:25:14.374069 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_flights ......... [[32mCREATE VIEW[0m in 0.16s]
[0m17:25:14.375230 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_flights
[0m17:25:14.375771 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_seats
[0m17:25:14.376978 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.stg_seats ................ [RUN]
[0m17:25:14.377517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_flights, now model.dbt_dwh.stg_seats)
[0m17:25:14.378053 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_seats
[0m17:25:14.385151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:25:14.386163 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: BEGIN
[0m17:25:14.386163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:14.427789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m17:25:14.427789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:25:14.428791 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.466264 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.037 seconds
[0m17:25:14.473361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:25:14.473908 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.477954 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:25:14.485699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_seats"
[0m17:25:14.486712 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_seats
[0m17:25:14.491439 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_seats"
[0m17:25:14.491439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:25:14.492921 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_seats"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'SEATS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS seat_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS seat_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    seat_pk,
    seat_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:14.505298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:25:14.509012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:25:14.509012 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m17:25:14.511686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:25:14.513374 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m17:25:14.513922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:25:14.514491 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m17:25:14.518429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:25:14.521089 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup"
[0m17:25:14.521616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:25:14.522140 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup" cascade
[0m17:25:14.524278 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:25:14.525413 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: Close
[0m17:25:14.525954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EBE6180>]}
[0m17:25:14.527057 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_seats ........... [[32mCREATE VIEW[0m in 0.15s]
[0m17:25:14.528195 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_seats
[0m17:25:14.528737 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m17:25:14.529845 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.stg_ticket_flights ....... [RUN]
[0m17:25:14.530928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_seats, now model.dbt_dwh.stg_ticket_flights)
[0m17:25:14.531611 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_ticket_flights
[0m17:25:14.539216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.539755 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: BEGIN
[0m17:25:14.540277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:14.606145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m17:25:14.607249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.607817 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.648644 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.040 seconds
[0m17:25:14.657430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.658483 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.663230 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:25:14.671637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.672876 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_ticket_flights
[0m17:25:14.677415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.677934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.678496 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'TICKET_FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    ticket_flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:14.691513 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:25:14.694517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.695594 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m17:25:14.697629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:25:14.698622 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m17:25:14.698622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.700130 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m17:25:14.705245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:25:14.708245 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m17:25:14.709245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:25:14.709245 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m17:25:14.710933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:25:14.711443 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: Close
[0m17:25:14.713097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9ECB4A70>]}
[0m17:25:14.714251 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_ticket_flights .. [[32mCREATE VIEW[0m in 0.18s]
[0m17:25:14.716249 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m17:25:14.716249 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_tickets
[0m17:25:14.717247 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.stg_tickets .............. [RUN]
[0m17:25:14.718243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_ticket_flights, now model.dbt_dwh.stg_tickets)
[0m17:25:14.718243 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_tickets
[0m17:25:14.726274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:25:14.727273 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: BEGIN
[0m17:25:14.727273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:14.771303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:25:14.772301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:25:14.773296 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.816701 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.042 seconds
[0m17:25:14.823117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:25:14.824154 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:14.828151 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m17:25:14.839588 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_tickets"
[0m17:25:14.840648 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_tickets
[0m17:25:14.844624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_tickets"
[0m17:25:14.845706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:25:14.846250 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'TICKETS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS ticket_pk,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_fk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    ticket_pk,
    booking_fk,
    ticket_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:25:11.516850+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:25:14.858496 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:25:14.863570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:25:14.864619 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m17:25:14.866819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:25:14.867907 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m17:25:14.868446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:25:14.868976 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m17:25:14.873917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:25:14.876218 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup"
[0m17:25:14.877246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:25:14.877246 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m17:25:14.879312 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:25:14.880816 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: Close
[0m17:25:14.880816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '339f5fdd-515c-41d4-b4be-512eeff9dc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9EE30B00>]}
[0m17:25:14.882329 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_tickets ......... [[32mCREATE VIEW[0m in 0.16s]
[0m17:25:14.883017 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_tickets
[0m17:25:14.885544 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:14.885544 [debug] [MainThread]: On master: BEGIN
[0m17:25:14.885544 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:14.926690 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m17:25:14.926690 [debug] [MainThread]: On master: COMMIT
[0m17:25:14.927772 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:14.927772 [debug] [MainThread]: On master: COMMIT
[0m17:25:14.928774 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:25:14.930288 [debug] [MainThread]: On master: Close
[0m17:25:14.930288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:14.931310 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:25:14.932299 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:25:14.932299 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_tickets' was properly closed.
[0m17:25:14.932299 [info ] [MainThread]: 
[0m17:25:14.934229 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m17:25:14.936120 [debug] [MainThread]: Command end result
[0m17:25:14.987368 [info ] [MainThread]: 
[0m17:25:14.988368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:14.988368 [info ] [MainThread]: 
[0m17:25:14.991139 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:25:14.991648 [debug] [MainThread]: Command `dbt run` succeeded at 17:25:14.991648 after 3.53 seconds
[0m17:25:14.992874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9C6E84A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9D2796A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9C836540>]}
[0m17:25:14.992874 [debug] [MainThread]: Flushing usage events
[0m17:25:24.004266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEFDFE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF25A7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF25A5A60>]}


============================== 17:25:24.008962 | 031882ca-cd79-4004-be70-342e50c2bb20 ==============================
[0m17:25:24.008962 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:25:24.008962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:hub', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:24.270466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2AB3680>]}
[0m17:25:24.331558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2C4DF40>]}
[0m17:25:24.334364 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:25:24.546951 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:25:24.783671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:24.784677 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:24.816733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2D977A0>]}
[0m17:25:24.931381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF44B75F0>]}
[0m17:25:24.932591 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:25:24.933710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2CF9E20>]}
[0m17:25:24.935044 [info ] [MainThread]: 
[0m17:25:24.936404 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:24.940997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:25:25.217700 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:25:25.218244 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:25:25.219364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:25.276156 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.058 seconds
[0m17:25:25.278619 [debug] [ThreadPool]: On list_postgres: Close
[0m17:25:25.284788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:25:25.291174 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:25:25.291752 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:25:25.292972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:25.348507 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m17:25:25.349061 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:25:25.349595 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:25:25.367881 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.018 seconds
[0m17:25:25.368910 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:25:25.371461 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:25:25.384094 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:25.384639 [debug] [MainThread]: On master: BEGIN
[0m17:25:25.384639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:25.438846 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m17:25:25.439408 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:25.440537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:25.466382 [debug] [MainThread]: SQL status: SELECT 16 in 0.026 seconds
[0m17:25:25.469278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2CD8620>]}
[0m17:25:25.469969 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:25.472392 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:25.472927 [debug] [MainThread]: On master: BEGIN
[0m17:25:25.476496 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:25:25.477053 [debug] [MainThread]: On master: COMMIT
[0m17:25:25.477053 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:25.478144 [debug] [MainThread]: On master: COMMIT
[0m17:25:25.479815 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:25:25.480341 [debug] [MainThread]: On master: Close
[0m17:25:25.482323 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:25.483511 [info ] [MainThread]: 
[0m17:25:25.488676 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m17:25:25.490180 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m17:25:25.491429 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m17:25:25.492942 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m17:25:25.525690 [info ] [Thread-1 (]: 17:25:25 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m17:25:25.589764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.591282 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m17:25:25.640440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.641459 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

    
  
    

  create temporary table "hub_aircrafts__dbt_tmp172525617785"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.aircraft_code, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" AS d
    ON a.aircraft_code = d.aircraft_code
    WHERE d.aircraft_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:25:25.641459 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:25.716360 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.074 seconds
[0m17:25:25.729341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.730340 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m17:25:25.732855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:25:25.733348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.733854 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts__dbt_tmp172525617785'
        
      order by ordinal_position

  
[0m17:25:25.767392 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.033 seconds
[0m17:25:25.774084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.775185 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:25.779533 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:25:25.789073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.789073 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:25.793982 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:25:25.805545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.807547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:25:25.807547 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts" ("aircraft_code", "model", "record_source")
    (
        select "aircraft_code", "model", "record_source"
        from "hub_aircrafts__dbt_tmp172525617785"
    )


  
[0m17:25:25.819019 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "model" does not exist
LINE 5:         select "aircraft_code", "model", "record_source"
                                        ^
HINT:  There is a column named "model" in table "hub_aircrafts", but it cannot be referenced from this part of the query.

[0m17:25:25.819563 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: ROLLBACK
[0m17:25:25.821183 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m17:25:25.829734 [debug] [Thread-1 (]: Database Error in model hub_aircrafts (models\raw_vault\hubs\hub_aircrafts.sql)
  column "model" does not exist
  LINE 5:         select "aircraft_code", "model", "record_source"
                                          ^
  HINT:  There is a column named "model" in table "hub_aircrafts", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_aircrafts.sql
[0m17:25:25.831397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF218EBD0>]}
[0m17:25:25.831948 [error] [Thread-1 (]: 1 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[31mERROR[0m in 0.34s]
[0m17:25:25.833054 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m17:25:25.834247 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m17:25:25.835929 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m17:25:25.837034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m17:25:25.837611 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m17:25:25.842478 [info ] [Thread-1 (]: 17:25:25 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m17:25:25.847020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m17:25:25.848092 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m17:25:25.852828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:25:25.853747 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

    
  
    

  create temporary table "hub_airports__dbt_tmp172525850814"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.airport_code, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_airports" AS d
    ON a.airport_code = d.airport_code
    WHERE d.airport_code IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:25:25.854260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:25.953928 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.100 seconds
[0m17:25:25.957349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:25:25.958517 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m17:25:25.960774 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:25:25.961328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:25:25.961885 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports__dbt_tmp172525850814'
        
      order by ordinal_position

  
[0m17:25:25.999941 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.037 seconds
[0m17:25:26.003931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:25:26.004477 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.008585 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:25:26.011672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:25:26.013032 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.016632 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:25:26.018539 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m17:25:26.019608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:25:26.020183 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_airports" ("airport_code", "timezone", "record_source")
    (
        select "airport_code", "timezone", "record_source"
        from "hub_airports__dbt_tmp172525850814"
    )


  
[0m17:25:26.030213 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "timezone" does not exist
LINE 5:         select "airport_code", "timezone", "record_source"
                                       ^
HINT:  There is a column named "timezone" in table "hub_airports", but it cannot be referenced from this part of the query.

[0m17:25:26.031317 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: ROLLBACK
[0m17:25:26.033677 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m17:25:26.037124 [debug] [Thread-1 (]: Database Error in model hub_airports (models\raw_vault\hubs\hub_airports.sql)
  column "timezone" does not exist
  LINE 5:         select "airport_code", "timezone", "record_source"
                                         ^
  HINT:  There is a column named "timezone" in table "hub_airports", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_airports.sql
[0m17:25:26.038291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF48418B0>]}
[0m17:25:26.038844 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_airports  [[31mERROR[0m in 0.20s]
[0m17:25:26.039962 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m17:25:26.040502 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m17:25:26.041585 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m17:25:26.042733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m17:25:26.043279 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m17:25:26.047473 [info ] [Thread-1 (]: 17:25:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m17:25:26.054498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m17:25:26.056114 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m17:25:26.063798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:25:26.064984 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

    
  
    

  create temporary table "hub_bookings__dbt_tmp172526060145"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.book_ref, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" AS d
    ON a.book_ref = d.book_ref
    WHERE d.book_ref IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:25:26.066343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:26.144405 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.078 seconds
[0m17:25:26.147506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:25:26.147506 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m17:25:26.149508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:25:26.150512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:25:26.151021 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings__dbt_tmp172526060145'
        
      order by ordinal_position

  
[0m17:25:26.185006 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.033 seconds
[0m17:25:26.189018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:25:26.190528 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.194649 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:25:26.198445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:25:26.198982 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.203145 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:25:26.204769 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m17:25:26.205780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:25:26.205780 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_bookings" ("book_ref", "book_date", "record_source")
    (
        select "book_ref", "book_date", "record_source"
        from "hub_bookings__dbt_tmp172526060145"
    )


  
[0m17:25:26.215940 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "book_date" does not exist
LINE 5:         select "book_ref", "book_date", "record_source"
                                   ^
HINT:  There is a column named "book_date" in table "hub_bookings", but it cannot be referenced from this part of the query.

[0m17:25:26.215940 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: ROLLBACK
[0m17:25:26.218004 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m17:25:26.221565 [debug] [Thread-1 (]: Database Error in model hub_bookings (models\raw_vault\hubs\hub_bookings.sql)
  column "book_date" does not exist
  LINE 5:         select "book_ref", "book_date", "record_source"
                                     ^
  HINT:  There is a column named "book_date" in table "hub_bookings", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_bookings.sql
[0m17:25:26.222565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF483A2D0>]}
[0m17:25:26.223565 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_bookings  [[31mERROR[0m in 0.18s]
[0m17:25:26.224565 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m17:25:26.225567 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m17:25:26.225567 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m17:25:26.226565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m17:25:26.227565 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m17:25:26.231080 [info ] [Thread-1 (]: 17:25:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m17:25:26.237552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m17:25:26.238620 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m17:25:26.244684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:25:26.245229 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

    
  
    

  create temporary table "hub_flights__dbt_tmp172526242990"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_flights" AS d
    ON a.flight_id = d.flight_id
    WHERE d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:25:26.245776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:26.316524 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.071 seconds
[0m17:25:26.321453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:25:26.322002 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m17:25:26.324186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:25:26.324739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:25:26.324739 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights__dbt_tmp172526242990'
        
      order by ordinal_position

  
[0m17:25:26.368840 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.043 seconds
[0m17:25:26.443043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:25:26.444149 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.447723 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:25:26.451245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:25:26.451245 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.455402 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:25:26.457546 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m17:25:26.458650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:25:26.459193 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_flights" ("flight_id", "flight_no", "scheduled_departure", "record_source")
    (
        select "flight_id", "flight_no", "scheduled_departure", "record_source"
        from "hub_flights__dbt_tmp172526242990"
    )


  
[0m17:25:26.468551 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "scheduled_departure" does not exist
LINE 5:         select "flight_id", "flight_no", "scheduled_departur...
                                                 ^
HINT:  There is a column named "scheduled_departure" in table "hub_flights", but it cannot be referenced from this part of the query.

[0m17:25:26.468551 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: ROLLBACK
[0m17:25:26.470550 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m17:25:26.473746 [debug] [Thread-1 (]: Database Error in model hub_flights (models\raw_vault\hubs\hub_flights.sql)
  column "scheduled_departure" does not exist
  LINE 5:         select "flight_id", "flight_no", "scheduled_departur...
                                                   ^
  HINT:  There is a column named "scheduled_departure" in table "hub_flights", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_flights.sql
[0m17:25:26.474280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF4825B50>]}
[0m17:25:26.475351 [error] [Thread-1 (]: 4 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_flights  [[31mERROR[0m in 0.25s]
[0m17:25:26.476448 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m17:25:26.476980 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m17:25:26.478046 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m17:25:26.478580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m17:25:26.479131 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m17:25:26.484550 [info ] [Thread-1 (]: 17:25:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m17:25:26.491110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m17:25:26.493985 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m17:25:26.500499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:25:26.501553 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

    
  
    

  create temporary table "hub_seats__dbt_tmp172526497973"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, rr.seat_no) rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_seats" AS d
    ON a.aircraft_code = d.aircraft_code AND a.seat_no = d.seat_no
    WHERE d.aircraft_code IS NULL
    AND d.seat_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:25:26.501553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:26.597921 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.096 seconds
[0m17:25:26.601963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:25:26.602501 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m17:25:26.604860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:25:26.605411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:25:26.605411 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats__dbt_tmp172526497973'
        
      order by ordinal_position

  
[0m17:25:26.638793 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.033 seconds
[0m17:25:26.642603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:25:26.643126 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.647001 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:25:26.651400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:25:26.651400 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.656619 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.003 seconds
[0m17:25:26.658782 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m17:25:26.659884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:25:26.660412 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_seats" ("aircraft_code", "seat_no", "fare_conditions", "record_source")
    (
        select "aircraft_code", "seat_no", "fare_conditions", "record_source"
        from "hub_seats__dbt_tmp172526497973"
    )


  
[0m17:25:26.670286 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fare_conditions" does not exist
LINE 5:         select "aircraft_code", "seat_no", "fare_conditions"...
                                                   ^
HINT:  There is a column named "fare_conditions" in table "hub_seats", but it cannot be referenced from this part of the query.

[0m17:25:26.670286 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: ROLLBACK
[0m17:25:26.672848 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m17:25:26.676628 [debug] [Thread-1 (]: Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  column "fare_conditions" does not exist
  LINE 5:         select "aircraft_code", "seat_no", "fare_conditions"...
                                                     ^
  HINT:  There is a column named "fare_conditions" in table "hub_seats", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m17:25:26.677192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF47DD190>]}
[0m17:25:26.678322 [error] [Thread-1 (]: 5 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_seats  [[31mERROR[0m in 0.20s]
[0m17:25:26.679415 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m17:25:26.679947 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m17:25:26.681117 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m17:25:26.681665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m17:25:26.682235 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m17:25:26.687455 [info ] [Thread-1 (]: 17:25:26 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m17:25:26.691622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m17:25:26.693497 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m17:25:26.699202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:25:26.699747 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

    
  
    

  create temporary table "hub_tickets__dbt_tmp172526697573"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" AS d
    ON a.ticket_no = d.ticket_no
    WHERE d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:25:26.700262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:26.804081 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.104 seconds
[0m17:25:26.807140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:25:26.808159 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m17:25:26.810667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:25:26.810667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:25:26.811674 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets__dbt_tmp172526697573'
        
      order by ordinal_position

  
[0m17:25:26.846894 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.035 seconds
[0m17:25:26.851400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:25:26.851400 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.856437 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m17:25:26.859655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:25:26.860176 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'hub_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:25:26.863936 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:25:26.866081 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m17:25:26.867078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:25:26.868078 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."hub_tickets" ("ticket_no", "book_ref", "record_source")
    (
        select "ticket_no", "book_ref", "record_source"
        from "hub_tickets__dbt_tmp172526697573"
    )


  
[0m17:25:26.878047 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "book_ref" does not exist
LINE 5:         select "ticket_no", "book_ref", "record_source"
                                    ^
HINT:  There is a column named "book_ref" in table "hub_tickets", but it cannot be referenced from this part of the query.

[0m17:25:26.878618 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: ROLLBACK
[0m17:25:26.880918 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m17:25:26.884207 [debug] [Thread-1 (]: Database Error in model hub_tickets (models\raw_vault\hubs\hub_tickets.sql)
  column "book_ref" does not exist
  LINE 5:         select "ticket_no", "book_ref", "record_source"
                                      ^
  HINT:  There is a column named "book_ref" in table "hub_tickets", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_tickets.sql
[0m17:25:26.884734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '031882ca-cd79-4004-be70-342e50c2bb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2C95B50>]}
[0m17:25:26.885255 [error] [Thread-1 (]: 6 of 6 ERROR creating sql incremental model dwh_detailed_dwh_detailed.hub_tickets  [[31mERROR[0m in 0.20s]
[0m17:25:26.886466 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m17:25:26.888678 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:26.889229 [debug] [MainThread]: On master: BEGIN
[0m17:25:26.889229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:26.935215 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m17:25:26.935761 [debug] [MainThread]: On master: COMMIT
[0m17:25:26.936300 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:26.936830 [debug] [MainThread]: On master: COMMIT
[0m17:25:26.938453 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:25:26.938453 [debug] [MainThread]: On master: Close
[0m17:25:26.939587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:26.940143 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:25:26.940670 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:25:26.941228 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m17:25:26.941767 [info ] [MainThread]: 
[0m17:25:26.942978 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m17:25:26.944670 [debug] [MainThread]: Command end result
[0m17:25:26.994242 [info ] [MainThread]: 
[0m17:25:26.995574 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m17:25:26.996106 [info ] [MainThread]: 
[0m17:25:26.997190 [error] [MainThread]:   Database Error in model hub_aircrafts (models\raw_vault\hubs\hub_aircrafts.sql)
  column "model" does not exist
  LINE 5:         select "aircraft_code", "model", "record_source"
                                          ^
  HINT:  There is a column named "model" in table "hub_aircrafts", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_aircrafts.sql
[0m17:25:26.997747 [info ] [MainThread]: 
[0m17:25:26.998819 [error] [MainThread]:   Database Error in model hub_airports (models\raw_vault\hubs\hub_airports.sql)
  column "timezone" does not exist
  LINE 5:         select "airport_code", "timezone", "record_source"
                                         ^
  HINT:  There is a column named "timezone" in table "hub_airports", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_airports.sql
[0m17:25:26.999935 [info ] [MainThread]: 
[0m17:25:27.001017 [error] [MainThread]:   Database Error in model hub_bookings (models\raw_vault\hubs\hub_bookings.sql)
  column "book_date" does not exist
  LINE 5:         select "book_ref", "book_date", "record_source"
                                     ^
  HINT:  There is a column named "book_date" in table "hub_bookings", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_bookings.sql
[0m17:25:27.001570 [info ] [MainThread]: 
[0m17:25:27.002711 [error] [MainThread]:   Database Error in model hub_flights (models\raw_vault\hubs\hub_flights.sql)
  column "scheduled_departure" does not exist
  LINE 5:         select "flight_id", "flight_no", "scheduled_departur...
                                                   ^
  HINT:  There is a column named "scheduled_departure" in table "hub_flights", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_flights.sql
[0m17:25:27.003268 [info ] [MainThread]: 
[0m17:25:27.004967 [error] [MainThread]:   Database Error in model hub_seats (models\raw_vault\hubs\hub_seats.sql)
  column "fare_conditions" does not exist
  LINE 5:         select "aircraft_code", "seat_no", "fare_conditions"...
                                                     ^
  HINT:  There is a column named "fare_conditions" in table "hub_seats", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_seats.sql
[0m17:25:27.004967 [info ] [MainThread]: 
[0m17:25:27.005974 [error] [MainThread]:   Database Error in model hub_tickets (models\raw_vault\hubs\hub_tickets.sql)
  column "book_ref" does not exist
  LINE 5:         select "ticket_no", "book_ref", "record_source"
                                      ^
  HINT:  There is a column named "book_ref" in table "hub_tickets", but it cannot be referenced from this part of the query.
  compiled code at target\run\dbt_dwh\models\raw_vault\hubs\hub_tickets.sql
[0m17:25:27.005974 [info ] [MainThread]: 
[0m17:25:27.007320 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=6 SKIP=0 TOTAL=6
[0m17:25:27.008320 [debug] [MainThread]: Command `dbt run` failed at 17:25:27.008320 after 3.20 seconds
[0m17:25:27.009321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CEFDFE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2C7E6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CF2668260>]}
[0m17:25:27.009321 [debug] [MainThread]: Flushing usage events
[0m17:31:12.970934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210879D3E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021087A122A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021084FFF740>]}


============================== 17:31:12.978102 | 644e36ca-d021-44d3-93df-f500cb40ab67 ==============================
[0m17:31:12.978102 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:31:12.979233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:raw', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:31:13.291500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210879D0A10>]}
[0m17:31:13.351116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021086B66FF0>]}
[0m17:31:13.353330 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:31:13.563600 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:31:13.565771 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:31:13.566980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021087E26270>]}
[0m17:31:16.332543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021087CD52E0>]}
[0m17:31:16.523210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210893D9100>]}
[0m17:31:16.523777 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:31:16.524870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210891BB740>]}
[0m17:31:16.527140 [info ] [MainThread]: 
[0m17:31:16.528816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:31:16.533116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:31:16.834770 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:31:16.835782 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:31:16.836376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:16.944978 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.108 seconds
[0m17:31:16.947179 [debug] [ThreadPool]: On list_postgres: Close
[0m17:31:16.948838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_dwh_detailed_dwh_detailed)
[0m17:31:16.950732 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "dwh_detailed_dwh_detailed"
"
[0m17:31:16.960046 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m17:31:16.961973 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:31:16.963783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:17.029178 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m17:31:17.030248 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m17:31:17.030793 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "create_postgres_dwh_detailed_dwh_detailed"} */
create schema if not exists "dwh_detailed_dwh_detailed"
[0m17:31:17.038763 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.008 seconds
[0m17:31:17.040268 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m17:31:17.041773 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m17:31:17.041773 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m17:31:17.056233 [debug] [ThreadPool]: SQL status: COMMIT in 0.014 seconds
[0m17:31:17.056799 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: Close
[0m17:31:17.061610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:31:17.071558 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:31:17.072644 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:31:17.072644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:17.116959 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m17:31:17.117960 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:31:17.117960 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:31:17.164575 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.046 seconds
[0m17:31:17.166623 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:31:17.168710 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:31:17.174413 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:17.175504 [debug] [MainThread]: On master: BEGIN
[0m17:31:17.175504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:17.219821 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:31:17.221830 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:17.222838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:31:17.283248 [debug] [MainThread]: SQL status: SELECT 0 in 0.059 seconds
[0m17:31:17.284854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021089386BA0>]}
[0m17:31:17.285912 [debug] [MainThread]: On master: ROLLBACK
[0m17:31:17.287532 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:17.288074 [debug] [MainThread]: On master: BEGIN
[0m17:31:17.291393 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:31:17.291919 [debug] [MainThread]: On master: COMMIT
[0m17:31:17.292475 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:17.292475 [debug] [MainThread]: On master: COMMIT
[0m17:31:17.294179 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:31:17.294179 [debug] [MainThread]: On master: Close
[0m17:31:17.295385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:17.296398 [info ] [MainThread]: 
[0m17:31:17.305094 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m17:31:17.306201 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ............ [RUN]
[0m17:31:17.308375 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_aircrafts'
[0m17:31:17.308914 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m17:31:17.317055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m17:31:17.319800 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m17:31:17.362075 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m17:31:17.366506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:31:17.367614 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m17:31:17.368163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:17.410969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m17:31:17.412268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:31:17.412939 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m17:31:17.441678 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.028 seconds
[0m17:31:17.448288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:31:17.448288 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp" rename to "raw_aircrafts"
[0m17:31:17.450817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:31:17.464493 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m17:31:17.465021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:31:17.465736 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m17:31:17.477597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m17:31:17.486538 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup"
[0m17:31:17.490925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m17:31:17.491464 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup" cascade
[0m17:31:17.493216 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:31:17.495840 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m17:31:17.496846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210898755B0>]}
[0m17:31:17.497846 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_aircrafts ....... [[32mCREATE VIEW[0m in 0.19s]
[0m17:31:17.498923 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m17:31:17.499996 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_airports
[0m17:31:17.501009 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.raw_airports ............. [RUN]
[0m17:31:17.502027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_airports)
[0m17:31:17.502531 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_airports
[0m17:31:17.506352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m17:31:17.507434 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_airports
[0m17:31:17.510204 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m17:31:17.511315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:31:17.512590 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m17:31:17.512590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:17.561817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m17:31:17.563009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:31:17.563009 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m17:31:17.578101 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:31:17.582075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:31:17.582592 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m17:31:17.583876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:31:17.584896 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m17:31:17.586376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:31:17.586376 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m17:31:17.592217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:31:17.595234 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup"
[0m17:31:17.596232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m17:31:17.596232 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup" cascade
[0m17:31:17.598301 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:31:17.599848 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: Close
[0m17:31:17.599848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210896688F0>]}
[0m17:31:17.600863 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_airports ........ [[32mCREATE VIEW[0m in 0.10s]
[0m17:31:17.603436 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_airports
[0m17:31:17.603436 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m17:31:17.603994 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ...... [RUN]
[0m17:31:17.605005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_boarding_passes)
[0m17:31:17.606241 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m17:31:17.608625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m17:31:17.610684 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m17:31:17.613699 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m17:31:17.614694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:31:17.615694 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m17:31:17.615694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:17.662855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:31:17.664276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:31:17.665288 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m17:31:17.679068 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:31:17.684015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:31:17.684590 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp" rename to "raw_boarding_passes"
[0m17:31:17.686107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:31:17.688105 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m17:31:17.688105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:31:17.688105 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m17:31:17.693621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:31:17.696071 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup"
[0m17:31:17.697111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m17:31:17.698108 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup" cascade
[0m17:31:17.699616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:31:17.700623 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m17:31:17.702667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210898CC4D0>]}
[0m17:31:17.703840 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_boarding_passes . [[32mCREATE VIEW[0m in 0.10s]
[0m17:31:17.704935 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m17:31:17.705488 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m17:31:17.706046 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............. [RUN]
[0m17:31:17.706589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_bookings)
[0m17:31:17.707132 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m17:31:17.710368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m17:31:17.712006 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m17:31:17.715786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m17:31:17.716785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:31:17.717579 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m17:31:17.718086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:17.783553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m17:31:17.784636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:31:17.785186 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m17:31:17.797315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:31:17.801300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:31:17.801300 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp" rename to "raw_bookings"
[0m17:31:17.804908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:31:17.806988 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m17:31:17.806988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:31:17.807532 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m17:31:17.812958 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:31:17.816300 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup"
[0m17:31:17.817318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m17:31:17.817318 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup" cascade
[0m17:31:17.819141 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:31:17.820758 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m17:31:17.822011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210893C98B0>]}
[0m17:31:17.823151 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_bookings ........ [[32mCREATE VIEW[0m in 0.11s]
[0m17:31:17.824795 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m17:31:17.825304 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_flights
[0m17:31:17.826418 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.raw_flights .............. [RUN]
[0m17:31:17.827520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_flights)
[0m17:31:17.828052 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_flights
[0m17:31:17.831724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m17:31:17.832729 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_flights
[0m17:31:17.838905 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m17:31:17.840161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:31:17.840710 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m17:31:17.841251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:17.910736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m17:31:17.912247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:31:17.912247 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m17:31:17.932290 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m17:31:17.935422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:31:17.935422 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp" rename to "raw_flights"
[0m17:31:17.937776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:31:17.939900 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m17:31:17.939900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:31:17.939900 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m17:31:17.946332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:31:17.949514 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup"
[0m17:31:17.950063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m17:31:17.950595 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup" cascade
[0m17:31:17.952773 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:31:17.953903 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: Close
[0m17:31:17.954910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210895EF290>]}
[0m17:31:17.955911 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_flights ......... [[32mCREATE VIEW[0m in 0.13s]
[0m17:31:17.956909 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_flights
[0m17:31:17.958017 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_seats
[0m17:31:17.958526 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.raw_seats ................ [RUN]
[0m17:31:17.959562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.raw_seats)
[0m17:31:17.960211 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_seats
[0m17:31:17.964302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m17:31:17.965400 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_seats
[0m17:31:17.968599 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m17:31:17.970224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:31:17.970776 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m17:31:17.970776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:18.017826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:31:18.018384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:31:18.018996 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m17:31:18.036083 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:31:18.040929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:31:18.040929 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp" rename to "raw_seats"
[0m17:31:18.043633 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:31:18.045826 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m17:31:18.046363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:31:18.046363 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m17:31:18.057153 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m17:31:18.059666 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup"
[0m17:31:18.063067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m17:31:18.064197 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup" cascade
[0m17:31:18.066683 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:31:18.069242 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: Close
[0m17:31:18.070863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108948ECC0>]}
[0m17:31:18.072039 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_seats ........... [[32mCREATE VIEW[0m in 0.11s]
[0m17:31:18.073737 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_seats
[0m17:31:18.074863 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m17:31:18.075395 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ....... [RUN]
[0m17:31:18.076406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.raw_ticket_flights)
[0m17:31:18.077407 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m17:31:18.080844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m17:31:18.084001 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m17:31:18.092036 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m17:31:18.094048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:31:18.095052 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m17:31:18.095052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:18.153675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m17:31:18.154776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:31:18.155312 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m17:31:18.171047 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m17:31:18.174237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:31:18.174237 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp" rename to "raw_ticket_flights"
[0m17:31:18.177179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:31:18.178174 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m17:31:18.179681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:31:18.180382 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m17:31:18.185810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:31:18.191206 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup"
[0m17:31:18.192903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m17:31:18.192903 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup" cascade
[0m17:31:18.195903 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:31:18.197903 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m17:31:18.199482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210899337D0>]}
[0m17:31:18.200541 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_ticket_flights .. [[32mCREATE VIEW[0m in 0.12s]
[0m17:31:18.202047 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m17:31:18.204116 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m17:31:18.205228 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.raw_tickets .............. [RUN]
[0m17:31:18.206320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.raw_tickets)
[0m17:31:18.206866 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m17:31:18.210497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m17:31:18.212084 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m17:31:18.218264 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m17:31:18.219769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:31:18.220775 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m17:31:18.221777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:18.274098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m17:31:18.275740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:31:18.275740 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m17:31:18.292903 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:31:18.295970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:31:18.296973 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp" rename to "raw_tickets"
[0m17:31:18.297974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:31:18.299644 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m17:31:18.300775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:31:18.300775 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m17:31:18.307353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:31:18.310873 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup"
[0m17:31:18.311872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m17:31:18.311872 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup" cascade
[0m17:31:18.313877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:31:18.314878 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m17:31:18.315875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644e36ca-d021-44d3-93df-f500cb40ab67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108990ABD0>]}
[0m17:31:18.316873 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_tickets ......... [[32mCREATE VIEW[0m in 0.11s]
[0m17:31:18.318873 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m17:31:18.320378 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:18.320378 [debug] [MainThread]: On master: BEGIN
[0m17:31:18.321884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:18.365643 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:31:18.366203 [debug] [MainThread]: On master: COMMIT
[0m17:31:18.366730 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:18.367274 [debug] [MainThread]: On master: COMMIT
[0m17:31:18.368927 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:31:18.368927 [debug] [MainThread]: On master: Close
[0m17:31:18.370154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:18.370735 [debug] [MainThread]: Connection 'create_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:31:18.371285 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:31:18.371834 [debug] [MainThread]: Connection 'model.dbt_dwh.raw_tickets' was properly closed.
[0m17:31:18.372377 [info ] [MainThread]: 
[0m17:31:18.373476 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m17:31:18.376050 [debug] [MainThread]: Command end result
[0m17:31:18.431685 [info ] [MainThread]: 
[0m17:31:18.432800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:18.433352 [info ] [MainThread]: 
[0m17:31:18.433884 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:31:18.435552 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:18.435552 after 5.77 seconds
[0m17:31:18.436087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002108785AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210892BB110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210879D39E0>]}
[0m17:31:18.436626 [debug] [MainThread]: Flushing usage events
[0m17:32:04.878880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D647BE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6876D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6876E690>]}


============================== 17:32:04.887113 | 3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd ==============================
[0m17:32:04.887113 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:32:04.889253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:stage', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:32:05.280773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D69103440>]}
[0m17:32:05.388359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D688AA870>]}
[0m17:32:05.391801 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:32:05.716610 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:32:06.219329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:06.219329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:06.260866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D67E06C00>]}
[0m17:32:06.427155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6AAE7B60>]}
[0m17:32:06.428159 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:32:06.430152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6A67B140>]}
[0m17:32:06.433182 [info ] [MainThread]: 
[0m17:32:06.435609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:32:06.445205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:32:06.992339 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:32:06.993336 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:32:06.994343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:07.062489 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.068 seconds
[0m17:32:07.065501 [debug] [ThreadPool]: On list_postgres: Close
[0m17:32:07.071874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:32:07.081134 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:32:07.081134 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:32:07.082303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:07.138305 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m17:32:07.139303 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:32:07.139303 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:32:07.163598 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.022 seconds
[0m17:32:07.165622 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:32:07.170052 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:32:07.182585 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.183807 [debug] [MainThread]: On master: BEGIN
[0m17:32:07.184416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:07.238155 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m17:32:07.238705 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.239883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:32:07.293079 [debug] [MainThread]: SQL status: SELECT 8 in 0.052 seconds
[0m17:32:07.295699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6A4C5F10>]}
[0m17:32:07.296720 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:07.299127 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.300326 [debug] [MainThread]: On master: BEGIN
[0m17:32:07.304623 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:32:07.306243 [debug] [MainThread]: On master: COMMIT
[0m17:32:07.307256 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.307256 [debug] [MainThread]: On master: COMMIT
[0m17:32:07.310958 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:32:07.311999 [debug] [MainThread]: On master: Close
[0m17:32:07.314186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:07.316256 [info ] [MainThread]: 
[0m17:32:07.324708 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m17:32:07.326712 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.stg_aircrafts ............ [RUN]
[0m17:32:07.328896 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.stg_aircrafts'
[0m17:32:07.329889 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_aircrafts
[0m17:32:07.390003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.391022 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: BEGIN
[0m17:32:07.391542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:07.454991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m17:32:07.455553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.456558 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:07.547142 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.089 seconds
[0m17:32:07.615212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.616213 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:07.622263 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m17:32:07.713461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.716489 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_aircrafts
[0m17:32:07.765598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.770055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.771144 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'AIRCRAFTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS aircraft_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS aircraft_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    aircraft_pk,
    aircraft_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:07.804606 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.032 seconds
[0m17:32:07.817309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.818307 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m17:32:07.823243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:32:07.842637 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m17:32:07.843736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.845405 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m17:32:07.865823 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m17:32:07.875138 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup"
[0m17:32:07.882280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m17:32:07.884213 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m17:32:07.886456 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:07.889811 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: Close
[0m17:32:07.893344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6A4C4E90>]}
[0m17:32:07.894345 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_aircrafts ....... [[32mCREATE VIEW[0m in 0.56s]
[0m17:32:07.896333 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m17:32:07.897331 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_airports
[0m17:32:07.899401 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.stg_airports ............. [RUN]
[0m17:32:07.901213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_aircrafts, now model.dbt_dwh.stg_airports)
[0m17:32:07.902316 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_airports
[0m17:32:07.915311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:32:07.916309 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: BEGIN
[0m17:32:07.918414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:07.979722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m17:32:07.980927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:32:07.982509 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.038166 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.054 seconds
[0m17:32:08.044792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:32:08.046124 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.052289 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m17:32:08.065585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_airports"
[0m17:32:08.067285 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_airports
[0m17:32:08.073052 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_airports"
[0m17:32:08.074093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:32:08.075555 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_airports"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'AIRPORTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS airport_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS airport_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    airport_pk,
    airport_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:08.093842 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:32:08.098861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:32:08.099862 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m17:32:08.103271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:32:08.113625 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m17:32:08.115391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:32:08.117242 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m17:32:08.124116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:32:08.127120 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup"
[0m17:32:08.129235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m17:32:08.130406 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup" cascade
[0m17:32:08.132034 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:08.135710 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: Close
[0m17:32:08.136706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D687CAC30>]}
[0m17:32:08.138708 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_airports ........ [[32mCREATE VIEW[0m in 0.24s]
[0m17:32:08.141227 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_airports
[0m17:32:08.143246 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m17:32:08.145454 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.stg_boarding_passes ...... [RUN]
[0m17:32:08.148040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_airports, now model.dbt_dwh.stg_boarding_passes)
[0m17:32:08.151126 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_boarding_passes
[0m17:32:08.166523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.168717 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: BEGIN
[0m17:32:08.170139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:08.229747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m17:32:08.231268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.232695 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.291020 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.057 seconds
[0m17:32:08.297591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.299118 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.306071 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:32:08.402648 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.414231 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_boarding_passes
[0m17:32:08.418244 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.421248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.422674 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'BOARDING_PASSES'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS boarding_pass_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    boarding_pass_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:08.440213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m17:32:08.445292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.446312 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m17:32:08.448627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:32:08.451454 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m17:32:08.452467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.453482 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m17:32:08.460433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:32:08.466659 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m17:32:08.468339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m17:32:08.469457 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m17:32:08.471707 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:08.475211 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: Close
[0m17:32:08.476955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6AD68290>]}
[0m17:32:08.478132 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_boarding_passes . [[32mCREATE VIEW[0m in 0.33s]
[0m17:32:08.480580 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m17:32:08.481094 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m17:32:08.484448 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.stg_bookings ............. [RUN]
[0m17:32:08.485996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_boarding_passes, now model.dbt_dwh.stg_bookings)
[0m17:32:08.488455 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_bookings
[0m17:32:08.501075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:32:08.503104 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: BEGIN
[0m17:32:08.504128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:08.563224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:32:08.564311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:32:08.565382 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.624054 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.057 seconds
[0m17:32:08.630088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:32:08.631209 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.636929 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m17:32:08.650982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_bookings"
[0m17:32:08.653859 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_bookings
[0m17:32:08.658530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_bookings"
[0m17:32:08.661042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:32:08.662286 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'BOOKINGS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS booking_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    booking_pk,
    booking_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:08.685247 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m17:32:08.689798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:32:08.691312 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m17:32:08.695038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:32:08.698032 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m17:32:08.699032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:32:08.700033 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m17:32:08.706208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:32:08.709292 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup"
[0m17:32:08.711097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m17:32:08.712111 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m17:32:08.715108 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:08.717110 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: Close
[0m17:32:08.719121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6AE09490>]}
[0m17:32:08.721207 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_bookings ........ [[32mCREATE VIEW[0m in 0.23s]
[0m17:32:08.724254 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m17:32:08.725665 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_flights
[0m17:32:08.727369 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.stg_flights .............. [RUN]
[0m17:32:08.729638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_bookings, now model.dbt_dwh.stg_flights)
[0m17:32:08.730839 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_flights
[0m17:32:08.746765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:32:08.747877 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: BEGIN
[0m17:32:08.748983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:08.807108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:32:08.808677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:32:08.809692 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.861191 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.051 seconds
[0m17:32:08.870689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:32:08.871762 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:08.878573 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m17:32:08.895486 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_flights"
[0m17:32:08.898958 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_flights
[0m17:32:08.903024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_flights"
[0m17:32:08.905687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:32:08.906790 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    flight_pk,
    flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:08.928656 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m17:32:08.933284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:32:08.934412 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m17:32:08.937538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:32:08.939856 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m17:32:08.941385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:32:08.941385 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m17:32:08.949069 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:32:08.952916 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup"
[0m17:32:08.954079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m17:32:08.955219 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup" cascade
[0m17:32:08.958003 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:08.960249 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: Close
[0m17:32:08.961246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6ADD3410>]}
[0m17:32:08.963112 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_flights ......... [[32mCREATE VIEW[0m in 0.23s]
[0m17:32:08.965980 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_flights
[0m17:32:08.967006 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_seats
[0m17:32:08.968337 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.stg_seats ................ [RUN]
[0m17:32:08.969364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_flights, now model.dbt_dwh.stg_seats)
[0m17:32:08.970888 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_seats
[0m17:32:08.985130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:32:08.985689 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: BEGIN
[0m17:32:08.987968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:09.045266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m17:32:09.046405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:32:09.046972 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:09.104072 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.056 seconds
[0m17:32:09.113716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:32:09.115393 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:09.121618 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m17:32:09.132090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_seats"
[0m17:32:09.134329 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_seats
[0m17:32:09.139195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_seats"
[0m17:32:09.141319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:32:09.142424 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_seats"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'SEATS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS seat_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS seat_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    seat_pk,
    seat_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:09.163316 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m17:32:09.167774 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:32:09.168917 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m17:32:09.172314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:32:09.175126 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m17:32:09.176910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:32:09.177925 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m17:32:09.184286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:32:09.187850 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup"
[0m17:32:09.189374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m17:32:09.190375 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup" cascade
[0m17:32:09.193885 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:09.195931 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: Close
[0m17:32:09.198623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6AE51880>]}
[0m17:32:09.199630 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_seats ........... [[32mCREATE VIEW[0m in 0.23s]
[0m17:32:09.202178 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_seats
[0m17:32:09.205013 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m17:32:09.207087 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.stg_ticket_flights ....... [RUN]
[0m17:32:09.209636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_seats, now model.dbt_dwh.stg_ticket_flights)
[0m17:32:09.211156 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_ticket_flights
[0m17:32:09.225301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.226772 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: BEGIN
[0m17:32:09.227968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:09.304535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m17:32:09.306258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.306855 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:09.362671 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.055 seconds
[0m17:32:09.371864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.373526 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:09.379424 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:32:09.390206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.395317 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_ticket_flights
[0m17:32:09.399311 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.401827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.403343 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'TICKET_FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    ticket_flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:09.419891 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m17:32:09.427695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.429066 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m17:32:09.434534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:32:09.442405 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m17:32:09.445162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.446258 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m17:32:09.454058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:32:09.461293 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m17:32:09.463408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m17:32:09.466197 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m17:32:09.470198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:09.473082 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: Close
[0m17:32:09.475716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6AE51880>]}
[0m17:32:09.477953 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_ticket_flights .. [[32mCREATE VIEW[0m in 0.27s]
[0m17:32:09.481253 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m17:32:09.482531 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_tickets
[0m17:32:09.485429 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.stg_tickets .............. [RUN]
[0m17:32:09.487835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_ticket_flights, now model.dbt_dwh.stg_tickets)
[0m17:32:09.488950 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_tickets
[0m17:32:09.507691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:32:09.509923 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: BEGIN
[0m17:32:09.511588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:09.570773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:32:09.572503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:32:09.573672 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:09.631701 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.057 seconds
[0m17:32:09.642831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:32:09.643879 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:32:09.649782 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m17:32:09.663445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_tickets"
[0m17:32:09.674015 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_tickets
[0m17:32:09.680157 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_tickets"
[0m17:32:09.682393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:32:09.683543 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'TICKETS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS ticket_pk,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_fk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    ticket_pk,
    booking_fk,
    ticket_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 14:32:04.712324+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m17:32:09.707989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m17:32:09.714137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:32:09.715988 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m17:32:09.720544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:32:09.723361 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m17:32:09.724483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:32:09.725626 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m17:32:09.731595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:32:09.736681 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup"
[0m17:32:09.737782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m17:32:09.738794 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m17:32:09.742055 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:32:09.745226 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: Close
[0m17:32:09.748292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d98fc0d-dc8e-45ae-97ca-ac44a3ec42dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6AE528D0>]}
[0m17:32:09.750578 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_tickets ......... [[32mCREATE VIEW[0m in 0.26s]
[0m17:32:09.752224 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_tickets
[0m17:32:09.755084 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:09.756191 [debug] [MainThread]: On master: BEGIN
[0m17:32:09.757343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:09.826824 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m17:32:09.827379 [debug] [MainThread]: On master: COMMIT
[0m17:32:09.829070 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:09.829610 [debug] [MainThread]: On master: COMMIT
[0m17:32:09.831808 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:32:09.832941 [debug] [MainThread]: On master: Close
[0m17:32:09.834031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:09.835174 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:32:09.835765 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:32:09.835765 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_tickets' was properly closed.
[0m17:32:09.838576 [info ] [MainThread]: 
[0m17:32:09.839572 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m17:32:09.843195 [debug] [MainThread]: Command end result
[0m17:32:09.908618 [info ] [MainThread]: 
[0m17:32:09.910942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:09.912292 [info ] [MainThread]: 
[0m17:32:09.914712 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:32:09.918436 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:09.917440 after 5.28 seconds
[0m17:32:09.919443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D62A61820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D6AC13FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D67ED9100>]}
[0m17:32:09.919443 [debug] [MainThread]: Flushing usage events
[0m17:32:41.580485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE3C3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE042EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE3C09B0>]}


============================== 17:32:41.588014 | bdf90c40-d9ba-4a89-a81c-934a97bb59b4 ==============================
[0m17:32:41.588014 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:32:41.589006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:hub', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:32:41.985175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE5738F0>]}
[0m17:32:42.101595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE706600>]}
[0m17:32:42.104125 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:32:42.398148 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:32:42.762367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:32:42.763883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:32:42.805459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE7BB170>]}
[0m17:32:42.972968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DFACF0E0>]}
[0m17:32:42.974673 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:32:42.976459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DFF9DEB0>]}
[0m17:32:42.979747 [info ] [MainThread]: 
[0m17:32:42.981438 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:32:42.988780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:32:43.538598 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:32:43.539600 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:32:43.540602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:43.614820 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.074 seconds
[0m17:32:43.617012 [debug] [ThreadPool]: On list_postgres: Close
[0m17:32:43.622836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:32:43.632791 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:32:43.633947 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:32:43.634504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:43.701990 [debug] [ThreadPool]: SQL status: BEGIN in 0.068 seconds
[0m17:32:43.704129 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:32:43.704129 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:32:43.725771 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.020 seconds
[0m17:32:43.728343 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:32:43.730458 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:32:43.742141 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:43.743184 [debug] [MainThread]: On master: BEGIN
[0m17:32:43.745021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:43.799070 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m17:32:43.801152 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:43.802172 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:32:43.854987 [debug] [MainThread]: SQL status: SELECT 16 in 0.052 seconds
[0m17:32:43.859376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE857950>]}
[0m17:32:43.860410 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:43.862814 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:43.863321 [debug] [MainThread]: On master: BEGIN
[0m17:32:43.868055 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:32:43.869172 [debug] [MainThread]: On master: COMMIT
[0m17:32:43.869716 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:43.870867 [debug] [MainThread]: On master: COMMIT
[0m17:32:43.873579 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:32:43.874664 [debug] [MainThread]: On master: Close
[0m17:32:43.875746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:43.876878 [info ] [MainThread]: 
[0m17:32:43.886505 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m17:32:43.888768 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m17:32:43.891066 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m17:32:43.892694 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m17:32:43.938038 [info ] [Thread-1 (]: 17:32:43 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m17:32:44.019117 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m17:32:44.022912 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m17:32:44.086928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m17:32:44.092122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:32:44.093238 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m17:32:44.094325 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:44.150577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m17:32:44.150577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:32:44.152085 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.aircraft_code, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:32:44.202370 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.049 seconds
[0m17:32:44.227706 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m17:32:44.228786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m17:32:44.229380 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m17:32:44.246725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m17:32:44.250019 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m17:32:44.253823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DBF50980>]}
[0m17:32:44.255441 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mSELECT 0[0m in 0.36s]
[0m17:32:44.257476 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m17:32:44.259158 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m17:32:44.260809 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m17:32:44.262938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m17:32:44.264599 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m17:32:44.272627 [info ] [Thread-1 (]: 17:32:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m17:32:44.276908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m17:32:44.279201 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m17:32:44.284645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m17:32:44.289077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:32:44.290086 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m17:32:44.291087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:44.347339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m17:32:44.348338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:32:44.349368 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.airport_code, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:32:44.396100 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m17:32:44.399100 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m17:32:44.399100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m17:32:44.400100 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m17:32:44.417342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m17:32:44.419012 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m17:32:44.420029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5E025B440>]}
[0m17:32:44.421025 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mSELECT 0[0m in 0.16s]
[0m17:32:44.424047 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m17:32:44.425059 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m17:32:44.426525 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m17:32:44.429597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m17:32:44.431324 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m17:32:44.438088 [info ] [Thread-1 (]: 17:32:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m17:32:44.441863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m17:32:44.445061 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m17:32:44.450504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m17:32:44.453215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:32:44.454313 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m17:32:44.455412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:44.521754 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m17:32:44.522293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:32:44.523342 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.book_ref, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:32:44.566052 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m17:32:44.567736 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m17:32:44.569223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m17:32:44.569807 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m17:32:44.576732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:32:44.578458 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m17:32:44.579474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5E027D250>]}
[0m17:32:44.582006 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mSELECT 0[0m in 0.15s]
[0m17:32:44.585386 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m17:32:44.586458 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m17:32:44.587551 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m17:32:44.589784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m17:32:44.591498 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m17:32:44.599077 [info ] [Thread-1 (]: 17:32:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m17:32:44.605798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m17:32:44.608067 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m17:32:44.614180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m17:32:44.617429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:32:44.618430 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m17:32:44.618430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:44.676376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m17:32:44.677422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:32:44.678460 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:32:44.726163 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m17:32:44.728555 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m17:32:44.729752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m17:32:44.730319 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m17:32:44.749809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m17:32:44.750939 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m17:32:44.752941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5E02A7AD0>]}
[0m17:32:44.754580 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mSELECT 0[0m in 0.16s]
[0m17:32:44.756198 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m17:32:44.757364 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m17:32:44.758444 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m17:32:44.760137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m17:32:44.761312 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m17:32:44.767951 [info ] [Thread-1 (]: 17:32:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m17:32:44.772947 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m17:32:44.775680 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m17:32:44.784522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m17:32:44.786840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:32:44.788009 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m17:32:44.789152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:44.842021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m17:32:44.843124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:32:44.844630 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, rr.seat_no) rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:32:44.887414 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m17:32:44.890261 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m17:32:44.890823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m17:32:44.891894 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m17:32:44.898424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:32:44.899927 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m17:32:44.901942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5E02A7AD0>]}
[0m17:32:44.904304 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_seats .... [[32mSELECT 0[0m in 0.14s]
[0m17:32:44.906898 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m17:32:44.908909 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m17:32:44.910915 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m17:32:44.912425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m17:32:44.914451 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m17:32:44.922698 [info ] [Thread-1 (]: 17:32:44 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m17:32:44.927691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m17:32:44.930439 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m17:32:44.936595 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m17:32:44.938725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:32:44.939722 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m17:32:44.940729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:44.995428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:32:44.996533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:32:44.997691 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_tickets"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:32:45.042238 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m17:32:45.044261 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m17:32:45.045962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m17:32:45.047516 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m17:32:45.055038 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:32:45.056038 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m17:32:45.057148 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdf90c40-d9ba-4a89-a81c-934a97bb59b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5E0293320>]}
[0m17:32:45.060217 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mSELECT 0[0m in 0.14s]
[0m17:32:45.062767 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m17:32:45.065656 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:45.066189 [debug] [MainThread]: On master: BEGIN
[0m17:32:45.067561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:45.142361 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m17:32:45.142361 [debug] [MainThread]: On master: COMMIT
[0m17:32:45.143386 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:45.144450 [debug] [MainThread]: On master: COMMIT
[0m17:32:45.147542 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:32:45.148128 [debug] [MainThread]: On master: Close
[0m17:32:45.149235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:45.150426 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:32:45.151680 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:32:45.153273 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m17:32:45.154492 [info ] [MainThread]: 
[0m17:32:45.156125 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m17:32:45.157883 [debug] [MainThread]: Command end result
[0m17:32:45.306168 [info ] [MainThread]: 
[0m17:32:45.308463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:45.309534 [info ] [MainThread]: 
[0m17:32:45.312058 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:32:45.316342 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:45.316342 after 4.02 seconds
[0m17:32:45.317339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DBB8F800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE44C590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DE6EF6B0>]}
[0m17:32:45.318673 [debug] [MainThread]: Flushing usage events
[0m17:33:00.617946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF500739B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4D69B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4F66A2A0>]}


============================== 17:33:00.625935 | 9938644f-1d08-475a-9f1f-031ccac5b6f8 ==============================
[0m17:33:00.625935 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:33:00.628230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m tag:links', 'send_anonymous_usage_stats': 'True'}
[0m17:33:01.087835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4F926960>]}
[0m17:33:01.205198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4F5196D0>]}
[0m17:33:01.208478 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:33:01.522445 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:33:01.878000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:01.878000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:01.918322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF505389B0>]}
[0m17:33:02.107848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF51C67CE0>]}
[0m17:33:02.109130 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:33:02.110865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4F1BE3F0>]}
[0m17:33:02.115384 [info ] [MainThread]: 
[0m17:33:02.117794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:02.122446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:33:02.656812 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:33:02.658237 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:33:02.660432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:02.726746 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.066 seconds
[0m17:33:02.728889 [debug] [ThreadPool]: On list_postgres: Close
[0m17:33:02.733542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:33:02.743390 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:33:02.743390 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:33:02.745584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:02.799075 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m17:33:02.800103 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:33:02.801093 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:33:02.821089 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.020 seconds
[0m17:33:02.825631 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:33:02.828072 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:33:02.842510 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:02.842510 [debug] [MainThread]: On master: BEGIN
[0m17:33:02.843566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:02.896414 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m17:33:02.896967 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:02.897990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:33:02.968355 [debug] [MainThread]: SQL status: SELECT 16 in 0.069 seconds
[0m17:33:02.975398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF5040E900>]}
[0m17:33:02.977184 [debug] [MainThread]: On master: ROLLBACK
[0m17:33:02.980030 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:02.981135 [debug] [MainThread]: On master: BEGIN
[0m17:33:02.986929 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m17:33:02.987989 [debug] [MainThread]: On master: COMMIT
[0m17:33:02.987989 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:02.988986 [debug] [MainThread]: On master: COMMIT
[0m17:33:02.991355 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:33:02.992473 [debug] [MainThread]: On master: Close
[0m17:33:02.994136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:02.996501 [info ] [MainThread]: 
[0m17:33:03.004467 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:33:03.006731 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:33:03.008995 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:33:03.010163 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:33:03.053092 [info ] [Thread-1 (]: 17:33:03 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:33:03.133428 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:33:03.136743 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:33:03.206205 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:33:03.210006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:33:03.211123 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:33:03.211679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:03.263799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m17:33:03.264815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:33:03.265639 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:33:03.268945 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:   ) as l
           ^

[0m17:33:03.270046 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m17:33:03.272863 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:33:03.289522 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:33:03.292268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4F8FEB10>]}
[0m17:33:03.293362 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.28s]
[0m17:33:03.295695 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:33:03.297379 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:33:03.299620 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:33:03.301316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:33:03.302852 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:33:03.311306 [info ] [Thread-1 (]: 17:33:03 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:33:03.316897 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:33:03.318914 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:33:03.327829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:33:03.330646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:33:03.331800 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:33:03.333484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:03.391003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m17:33:03.392662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:33:03.393229 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:33:03.442620 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.048 seconds
[0m17:33:03.469908 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:33:03.470909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:33:03.470909 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:33:03.489230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m17:33:03.492568 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:33:03.494816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF51FAAED0>]}
[0m17:33:03.498670 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[32mSELECT 0[0m in 0.19s]
[0m17:33:03.502931 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:33:03.505466 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:33:03.507731 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:33:03.511074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:33:03.512429 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:33:03.523532 [info ] [Thread-1 (]: 17:33:03 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:33:03.530313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:33:03.533873 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:33:03.540533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:33:03.544603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:33:03.545712 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:33:03.546810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:03.605670 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:33:03.607347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:33:03.607887 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:33:03.654804 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m17:33:03.657882 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:33:03.657882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:33:03.658969 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:33:03.667045 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m17:33:03.669752 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:33:03.672073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF51ED6870>]}
[0m17:33:03.673799 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[32mSELECT 0[0m in 0.16s]
[0m17:33:03.675375 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:33:03.676562 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:33:03.677560 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:33:03.679657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:33:03.680929 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:33:03.689247 [info ] [Thread-1 (]: 17:33:03 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:33:03.693248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:33:03.696153 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:33:03.702560 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:33:03.705376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:33:03.706518 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:33:03.707069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:03.762583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:33:03.762583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:33:03.764561 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:33:03.805059 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m17:33:03.807821 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:33:03.808910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:33:03.809510 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:33:03.817618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m17:33:03.819614 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:33:03.820628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF51EDBDA0>]}
[0m17:33:03.823826 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[32mSELECT 0[0m in 0.14s]
[0m17:33:03.826857 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:33:03.827853 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:33:03.829882 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:33:03.832565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:33:03.833616 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:33:03.840584 [info ] [Thread-1 (]: 17:33:03 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:33:03.846921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:33:03.849778 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:33:03.856939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:33:03.858947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:33:03.859948 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:33:03.860946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:03.923935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m17:33:03.925026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:33:03.926066 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:33:03.972593 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.046 seconds
[0m17:33:03.976339 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:33:03.977354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:33:03.978354 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:33:03.998758 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m17:33:04.002618 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:33:04.005382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9938644f-1d08-475a-9f1f-031ccac5b6f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF51EFBB60>]}
[0m17:33:04.007313 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[32mSELECT 0[0m in 0.17s]
[0m17:33:04.010100 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:33:04.013630 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:04.015640 [debug] [MainThread]: On master: BEGIN
[0m17:33:04.016639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:04.075617 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m17:33:04.076754 [debug] [MainThread]: On master: COMMIT
[0m17:33:04.077315 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:04.077870 [debug] [MainThread]: On master: COMMIT
[0m17:33:04.079887 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:33:04.080887 [debug] [MainThread]: On master: Close
[0m17:33:04.082395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:04.084439 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:33:04.084947 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:33:04.087030 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:33:04.088151 [info ] [MainThread]: 
[0m17:33:04.089842 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m17:33:04.092050 [debug] [MainThread]: Command end result
[0m17:33:04.244532 [info ] [MainThread]: 
[0m17:33:04.246550 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:33:04.248267 [info ] [MainThread]: 
[0m17:33:04.249861 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:33:04.251493 [info ] [MainThread]: 
[0m17:33:04.253114 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:33:04.256544 [debug] [MainThread]: Command `dbt run` failed at 17:33:04.255986 after 3.89 seconds
[0m17:33:04.257645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF4D69B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF51F39610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF51F399D0>]}
[0m17:33:04.258748 [debug] [MainThread]: Flushing usage events
[0m17:40:40.531455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EC283830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EB109130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EBBD5E80>]}


============================== 17:40:40.538472 | 03cb52a8-1f25-464a-b044-17c6464ed4af ==============================
[0m17:40:40.538472 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:40:40.540939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:links', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:40.990455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EC436ED0>]}
[0m17:40:41.101123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EB819040>]}
[0m17:40:41.104659 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:40:41.403708 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:40:41.798865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:41.799874 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_aircrafts_seats.sql
[0m17:40:42.342164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EC692AE0>]}
[0m17:40:42.540526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198ED9144D0>]}
[0m17:40:42.541526 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:40:42.542525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198ED8B67B0>]}
[0m17:40:42.548457 [info ] [MainThread]: 
[0m17:40:42.550006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:42.556858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:40:43.089548 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:40:43.090561 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:40:43.091887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:43.163037 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.071 seconds
[0m17:40:43.165199 [debug] [ThreadPool]: On list_postgres: Close
[0m17:40:43.171808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:40:43.180696 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:40:43.180696 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:40:43.182216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:43.236575 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m17:40:43.237582 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:40:43.238578 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:40:43.257806 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.019 seconds
[0m17:40:43.260944 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:40:43.264407 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:40:43.278868 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:43.280146 [debug] [MainThread]: On master: BEGIN
[0m17:40:43.281244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:43.335821 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m17:40:43.336861 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:43.336861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:40:43.410438 [debug] [MainThread]: SQL status: SELECT 16 in 0.072 seconds
[0m17:40:43.414929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198ED8B66F0>]}
[0m17:40:43.415475 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:43.418655 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:43.419653 [debug] [MainThread]: On master: BEGIN
[0m17:40:43.424162 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:40:43.425165 [debug] [MainThread]: On master: COMMIT
[0m17:40:43.426164 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:43.426164 [debug] [MainThread]: On master: COMMIT
[0m17:40:43.429259 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:40:43.429259 [debug] [MainThread]: On master: Close
[0m17:40:43.431608 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:43.434391 [info ] [MainThread]: 
[0m17:40:43.442153 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:40:43.445204 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:40:43.447470 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:40:43.448673 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:40:43.474828 [info ] [Thread-1 (]: 17:40:43 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:40:43.480430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:40:43.483720 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:40:43.560271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:40:43.562354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:40:43.563524 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:40:43.564527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:43.621523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m17:40:43.622592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:40:43.622592 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND 
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:40:43.625607 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 28:   ) as l
           ^

[0m17:40:43.626934 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: ROLLBACK
[0m17:40:43.630525 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:40:43.646590 [debug] [Thread-1 (]: Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:40:43.648741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EBB0AED0>]}
[0m17:40:43.650161 [error] [Thread-1 (]: 1 of 5 ERROR creating sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[31mERROR[0m in 0.20s]
[0m17:40:43.651166 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:40:43.652950 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:40:43.655090 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:40:43.657572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:40:43.658581 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:40:43.764360 [info ] [Thread-1 (]: 17:40:43 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:40:43.769556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:40:43.771566 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:40:43.779547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:40:43.780553 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

    
  
    

  create temporary table "link_boarding_passes__dbt_tmp174043775238"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:40:43.781554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:43.887492 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.105 seconds
[0m17:40:43.902430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:40:43.903917 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:40:43.907589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:40:43.908598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:40:43.909247 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes__dbt_tmp174043775238'
        
      order by ordinal_position

  
[0m17:40:43.953705 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.044 seconds
[0m17:40:43.962468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:40:43.962981 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:43.969174 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:40:43.981664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:40:43.983174 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:43.988922 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:40:44.007208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:40:44.009263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:40:44.011640 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" ("ticket_no", "flight_id", "load_datetime", "record_source")
    (
        select "ticket_no", "flight_id", "load_datetime", "record_source"
        from "link_boarding_passes__dbt_tmp174043775238"
    )


  
[0m17:40:44.017611 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m17:40:44.043894 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:40:44.045572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:40:44.046138 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:40:44.064782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m17:40:44.068380 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:40:44.069985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EE232930>]}
[0m17:40:44.071985 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[32mINSERT 0 0[0m in 0.41s]
[0m17:40:44.074164 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:40:44.076060 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:40:44.078349 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:40:44.081279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:40:44.082948 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:40:44.093076 [info ] [Thread-1 (]: 17:40:44 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:40:44.100500 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:40:44.102653 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:40:44.109918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:40:44.111720 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

    
  
    

  create temporary table "link_flights_airports__dbt_tmp174044106555"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" AS d
    ON a.flight_id = d.flight_id AND a.departure_airport = d.departure_airport AND a.arrival_airport = d.arrival_airport
    WHERE d.flight_id IS NULL
    AND d.departure_airport IS NULL
    AND d.arrival_airport IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:40:44.113363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:44.207173 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.094 seconds
[0m17:40:44.211152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:40:44.211708 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:40:44.215062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:40:44.216184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:40:44.216741 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports__dbt_tmp174044106555'
        
      order by ordinal_position

  
[0m17:40:44.261695 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.044 seconds
[0m17:40:44.266803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:40:44.267338 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:44.272645 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m17:40:44.277743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:40:44.278752 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:44.282967 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m17:40:44.286859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:40:44.288889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:40:44.289890 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" ("flight_id", "departure_airport", "arrival_airport", "load_datetime", "record_source")
    (
        select "flight_id", "departure_airport", "arrival_airport", "load_datetime", "record_source"
        from "link_flights_airports__dbt_tmp174044106555"
    )


  
[0m17:40:44.293468 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:40:44.296784 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:40:44.297810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:40:44.298826 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:40:44.317461 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m17:40:44.318484 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:40:44.319476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198ED8F48F0>]}
[0m17:40:44.320986 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[32mINSERT 0 0[0m in 0.24s]
[0m17:40:44.323525 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:40:44.323525 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:40:44.325912 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:40:44.328017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:40:44.329152 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:40:44.337360 [info ] [Thread-1 (]: 17:40:44 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:40:44.345545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.347249 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:40:44.355670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.356686 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp174044352821"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:40:44.359069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:44.451773 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.093 seconds
[0m17:40:44.456500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.457630 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:40:44.460402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:40:44.461000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.462104 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp174044352821'
        
      order by ordinal_position

  
[0m17:40:44.506547 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.044 seconds
[0m17:40:44.510081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.511082 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:44.518194 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:40:44.522358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.522866 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:44.528508 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:40:44.531454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.533528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.533528 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" ("ticket_no", "flight_id", "load_datetime", "record_source")
    (
        select "ticket_no", "flight_id", "load_datetime", "record_source"
        from "link_ticket_flights__dbt_tmp174044352821"
    )


  
[0m17:40:44.539220 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:40:44.542237 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:40:44.544447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:40:44.545537 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:40:44.562445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m17:40:44.563903 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:40:44.565059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198ED8D3B30>]}
[0m17:40:44.567356 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[32mINSERT 0 0[0m in 0.24s]
[0m17:40:44.569705 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:40:44.570708 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:40:44.570708 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:40:44.573313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:40:44.576178 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:40:44.582982 [info ] [Thread-1 (]: 17:40:44 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:40:44.590305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.594126 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:40:44.600761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.601898 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

    
  
    

  create temporary table "link_tickets_bookings__dbt_tmp174044598647"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" AS d
    ON a.book_ref = d.book_ref AND a.ticket_no = d.ticket_no
    WHERE d.book_ref IS NULL
    AND d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:40:44.602427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:44.703599 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.101 seconds
[0m17:40:44.710139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.711269 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:40:44.714634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:40:44.716147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.716659 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings__dbt_tmp174044598647'
        
      order by ordinal_position

  
[0m17:40:44.762379 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.045 seconds
[0m17:40:44.766948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.768142 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:44.775128 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:40:44.781028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.783553 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:40:44.789025 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:40:44.791703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.794484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.795559 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" ("book_ref", "ticket_no", "load_datetime", "record_source")
    (
        select "book_ref", "ticket_no", "load_datetime", "record_source"
        from "link_tickets_bookings__dbt_tmp174044598647"
    )


  
[0m17:40:44.800832 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:40:44.802962 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:40:44.803983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:40:44.803983 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:40:44.812606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:40:44.814624 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:40:44.816687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03cb52a8-1f25-464a-b044-17c6464ed4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EDDEE9F0>]}
[0m17:40:44.818804 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[32mINSERT 0 0[0m in 0.24s]
[0m17:40:44.820270 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:40:44.822572 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:44.825046 [debug] [MainThread]: On master: BEGIN
[0m17:40:44.826048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:44.879260 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m17:40:44.880343 [debug] [MainThread]: On master: COMMIT
[0m17:40:44.881337 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:44.882851 [debug] [MainThread]: On master: COMMIT
[0m17:40:44.885039 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:40:44.886683 [debug] [MainThread]: On master: Close
[0m17:40:44.887768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:44.890257 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:40:44.891878 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:40:44.893048 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:40:44.894164 [info ] [MainThread]: 
[0m17:40:44.895785 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m17:40:44.899643 [debug] [MainThread]: Command end result
[0m17:40:44.968498 [info ] [MainThread]: 
[0m17:40:44.970125 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:40:44.971734 [info ] [MainThread]: 
[0m17:40:44.975077 [error] [MainThread]:   Database Error in model link_aircrafts_seats (models\raw_vault\links\link_aircrafts_seats.sql)
  syntax error at or near ")"
  LINE 28:   ) as l
             ^
  compiled code at target\run\dbt_dwh\models\raw_vault\links\link_aircrafts_seats.sql
[0m17:40:44.976964 [info ] [MainThread]: 
[0m17:40:44.979324 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:40:44.983183 [debug] [MainThread]: Command `dbt run` failed at 17:40:44.983183 after 4.80 seconds
[0m17:40:44.984867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EAF82750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EBFE80E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198EBFE8830>]}
[0m17:40:44.986075 [debug] [MainThread]: Flushing usage events
[0m17:43:26.532142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285E0698E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022861160C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022861163530>]}


============================== 17:43:26.538848 | 38f3e9ac-4431-430f-8095-23bfff60aec8 ==============================
[0m17:43:26.538848 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:43:26.539871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:links', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:26.925969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022861418470>]}
[0m17:43:27.042985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002286083F200>]}
[0m17:43:27.046485 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:43:27.293799 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:43:27.807588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:27.810089 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_aircrafts_seats.sql
[0m17:43:28.327733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022862808500>]}
[0m17:43:28.520353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022862865550>]}
[0m17:43:28.521488 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:43:28.523188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228629531D0>]}
[0m17:43:28.525901 [info ] [MainThread]: 
[0m17:43:28.528593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:43:28.533983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:43:29.070196 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:43:29.071268 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:43:29.071799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:29.134799 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.063 seconds
[0m17:43:29.137035 [debug] [ThreadPool]: On list_postgres: Close
[0m17:43:29.142453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:43:29.150250 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:43:29.151253 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:43:29.152256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:29.202167 [debug] [ThreadPool]: SQL status: BEGIN in 0.049 seconds
[0m17:43:29.203172 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:43:29.204235 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:43:29.230626 [debug] [ThreadPool]: SQL status: SELECT 26 in 0.025 seconds
[0m17:43:29.233347 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:43:29.236081 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:43:29.248202 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:29.249214 [debug] [MainThread]: On master: BEGIN
[0m17:43:29.250222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:29.309162 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m17:43:29.310161 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:29.311160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:43:29.381792 [debug] [MainThread]: SQL status: SELECT 16 in 0.070 seconds
[0m17:43:29.384787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228630B0590>]}
[0m17:43:29.386292 [debug] [MainThread]: On master: ROLLBACK
[0m17:43:29.389831 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:29.390987 [debug] [MainThread]: On master: BEGIN
[0m17:43:29.395152 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:43:29.395152 [debug] [MainThread]: On master: COMMIT
[0m17:43:29.396658 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:29.397671 [debug] [MainThread]: On master: COMMIT
[0m17:43:29.400194 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:43:29.401187 [debug] [MainThread]: On master: Close
[0m17:43:29.402192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:29.404393 [info ] [MainThread]: 
[0m17:43:29.412353 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:43:29.414452 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:43:29.416960 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:43:29.418713 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:43:29.443287 [info ] [Thread-1 (]: 17:43:29 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:43:29.448818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:43:29.450814 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:43:29.523339 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:43:29.525335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:43:29.526850 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:43:29.528211 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:29.586648 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m17:43:29.586648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:43:29.587656 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:43:29.639876 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.050 seconds
[0m17:43:29.671923 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: COMMIT
[0m17:43:29.672943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:43:29.674442 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: COMMIT
[0m17:43:29.691627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m17:43:29.694621 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:43:29.698176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228609DADE0>]}
[0m17:43:29.700218 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[32mSELECT 0[0m in 0.28s]
[0m17:43:29.702383 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:43:29.703442 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:43:29.704921 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:43:29.707628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:43:29.709211 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:43:29.812129 [info ] [Thread-1 (]: 17:43:29 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:43:29.819348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:43:29.820989 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:43:29.833562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:43:29.835307 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

    
  
    

  create temporary table "link_boarding_passes__dbt_tmp174329824381"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:43:29.836600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:29.942293 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.106 seconds
[0m17:43:29.960105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:43:29.961109 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:43:29.964107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:43:29.965406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:43:29.966609 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes__dbt_tmp174329824381'
        
      order by ordinal_position

  
[0m17:43:30.017649 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.050 seconds
[0m17:43:30.026502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:43:30.027637 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.034686 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:43:30.045011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:43:30.045558 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.052819 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:43:30.073781 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:43:30.077295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:43:30.078924 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" ("ticket_no", "flight_id", "load_datetime", "record_source")
    (
        select "ticket_no", "flight_id", "load_datetime", "record_source"
        from "link_boarding_passes__dbt_tmp174329824381"
    )


  
[0m17:43:30.083302 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:43:30.085495 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:43:30.086579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:43:30.086579 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:43:30.094338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:43:30.095438 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:43:30.097164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228609A67B0>]}
[0m17:43:30.098858 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[32mINSERT 0 0[0m in 0.39s]
[0m17:43:30.101122 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:43:30.101675 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:43:30.103433 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:43:30.105456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:43:30.106924 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:43:30.125065 [info ] [Thread-1 (]: 17:43:30 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:43:30.135343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:43:30.138214 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:43:30.144832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:43:30.145893 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

    
  
    

  create temporary table "link_flights_airports__dbt_tmp174330143165"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" AS d
    ON a.flight_id = d.flight_id AND a.departure_airport = d.departure_airport AND a.arrival_airport = d.arrival_airport
    WHERE d.flight_id IS NULL
    AND d.departure_airport IS NULL
    AND d.arrival_airport IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:43:30.146980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:30.241674 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.095 seconds
[0m17:43:30.246287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:43:30.247464 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:43:30.250643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:43:30.251778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:43:30.253010 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports__dbt_tmp174330143165'
        
      order by ordinal_position

  
[0m17:43:30.296594 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.043 seconds
[0m17:43:30.300699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:43:30.301719 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.307226 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m17:43:30.311830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:43:30.312828 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.318034 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.004 seconds
[0m17:43:30.321448 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:43:30.323216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:43:30.324322 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" ("flight_id", "departure_airport", "arrival_airport", "load_datetime", "record_source")
    (
        select "flight_id", "departure_airport", "arrival_airport", "load_datetime", "record_source"
        from "link_flights_airports__dbt_tmp174330143165"
    )


  
[0m17:43:30.329529 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:43:30.331303 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:43:30.332396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:43:30.333503 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:43:30.348121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:43:30.350123 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:43:30.351119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022862867C80>]}
[0m17:43:30.353981 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[32mINSERT 0 0[0m in 0.25s]
[0m17:43:30.355704 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:43:30.356780 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:43:30.357869 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:43:30.359718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:43:30.360900 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:43:30.366610 [info ] [Thread-1 (]: 17:43:30 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:43:30.373607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.374986 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:43:30.386763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.387781 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp174330384038"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:43:30.389752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:30.484699 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.095 seconds
[0m17:43:30.489221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.490222 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:43:30.493225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:43:30.494563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.495658 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp174330384038'
        
      order by ordinal_position

  
[0m17:43:30.541683 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.046 seconds
[0m17:43:30.546628 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.547652 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.553831 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:43:30.558992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.559990 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.565085 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:43:30.568812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.570822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.571821 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" ("ticket_no", "flight_id", "load_datetime", "record_source")
    (
        select "ticket_no", "flight_id", "load_datetime", "record_source"
        from "link_ticket_flights__dbt_tmp174330384038"
    )


  
[0m17:43:30.576826 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:43:30.578847 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:43:30.579859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:43:30.580857 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:43:30.595679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:43:30.596693 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:43:30.599708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022862D1B0E0>]}
[0m17:43:30.601179 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[32mINSERT 0 0[0m in 0.24s]
[0m17:43:30.604560 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:43:30.605215 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:43:30.606476 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:43:30.609518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:43:30.610534 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:43:30.620296 [info ] [Thread-1 (]: 17:43:30 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:43:30.631814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.634971 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:43:30.641858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.642966 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

    
  
    

  create temporary table "link_tickets_bookings__dbt_tmp174330639643"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" AS d
    ON a.book_ref = d.book_ref AND a.ticket_no = d.ticket_no
    WHERE d.book_ref IS NULL
    AND d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:43:30.643532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:30.740571 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.097 seconds
[0m17:43:30.750628 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.751729 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:43:30.755514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:43:30.756624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.757186 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings__dbt_tmp174330639643'
        
      order by ordinal_position

  
[0m17:43:30.797012 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.040 seconds
[0m17:43:30.802870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.803869 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.808259 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:43:30.814321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.814852 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:43:30.820657 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:43:30.823322 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.825325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.825325 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" ("book_ref", "ticket_no", "load_datetime", "record_source")
    (
        select "book_ref", "ticket_no", "load_datetime", "record_source"
        from "link_tickets_bookings__dbt_tmp174330639643"
    )


  
[0m17:43:30.831220 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:43:30.833417 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:43:30.834568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:43:30.835116 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:43:30.841396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:43:30.843411 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:43:30.844419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38f3e9ac-4431-430f-8095-23bfff60aec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002286141B830>]}
[0m17:43:30.845883 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[32mINSERT 0 0[0m in 0.24s]
[0m17:43:30.849667 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:43:30.852614 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:30.853694 [debug] [MainThread]: On master: BEGIN
[0m17:43:30.854249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:30.910080 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m17:43:30.910815 [debug] [MainThread]: On master: COMMIT
[0m17:43:30.911359 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:30.912483 [debug] [MainThread]: On master: COMMIT
[0m17:43:30.914889 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:43:30.915439 [debug] [MainThread]: On master: Close
[0m17:43:30.917184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:30.918970 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:43:30.920761 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:43:30.922099 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:43:30.923107 [info ] [MainThread]: 
[0m17:43:30.925108 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m17:43:30.927632 [debug] [MainThread]: Command end result
[0m17:43:30.991782 [info ] [MainThread]: 
[0m17:43:30.993793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:30.995796 [info ] [MainThread]: 
[0m17:43:30.997312 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:43:30.999832 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:30.999832 after 4.81 seconds
[0m17:43:31.000832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285E0698E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022860EC4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022860F5DE80>]}
[0m17:43:31.001847 [debug] [MainThread]: Flushing usage events
[0m17:44:29.826168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878D5C25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878D5C3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878D5C1310>]}


============================== 17:44:29.834344 | a1adffee-a11b-4218-bd9b-f4567b858fb0 ==============================
[0m17:44:29.834344 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:44:29.836771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:links', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:44:30.277505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878AFF18B0>]}
[0m17:44:30.383803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878D6DBCE0>]}
[0m17:44:30.388001 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:44:30.683406 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:44:31.207182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:44:31.208289 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\links\link_boarding_passes.sql
[0m17:44:31.705272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878D7674D0>]}
[0m17:44:31.888304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878EBA0EF0>]}
[0m17:44:31.889422 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:44:31.891524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878EAD1D00>]}
[0m17:44:31.894584 [info ] [MainThread]: 
[0m17:44:31.895970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:31.903434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:44:32.484949 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:44:32.486033 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:44:32.486568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:32.553986 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.068 seconds
[0m17:44:32.557045 [debug] [ThreadPool]: On list_postgres: Close
[0m17:44:32.562480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:44:32.571987 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:44:32.573095 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:44:32.573635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:32.625546 [debug] [ThreadPool]: SQL status: BEGIN in 0.052 seconds
[0m17:44:32.626533 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:44:32.627740 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:44:32.656592 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.027 seconds
[0m17:44:32.658619 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:44:32.660995 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:44:32.674080 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.674755 [debug] [MainThread]: On master: BEGIN
[0m17:44:32.675897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:32.734064 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m17:44:32.735140 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.736052 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:32.809276 [debug] [MainThread]: SQL status: SELECT 16 in 0.072 seconds
[0m17:44:32.813316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878B0599A0>]}
[0m17:44:32.814386 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:32.817233 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.818338 [debug] [MainThread]: On master: BEGIN
[0m17:44:32.823659 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:44:32.824737 [debug] [MainThread]: On master: COMMIT
[0m17:44:32.825312 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.825866 [debug] [MainThread]: On master: COMMIT
[0m17:44:32.828678 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:44:32.830115 [debug] [MainThread]: On master: Close
[0m17:44:32.831194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:32.833794 [info ] [MainThread]: 
[0m17:44:32.840881 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m17:44:32.841885 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m17:44:32.845101 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m17:44:32.846407 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m17:44:32.870780 [info ] [Thread-1 (]: 17:44:32 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m17:44:32.882798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:32.884800 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m17:44:32.955433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:32.956787 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

    
  
    

  create temporary table "link_aircrafts_seats__dbt_tmp174432920558"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats" AS d
    ON a.aircraft_code = d.aircraft_code AND a.seat_no = d.seat_no
    WHERE d.aircraft_code IS NULL
    AND d.seat_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:44:32.958365 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:44:33.058727 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.100 seconds
[0m17:44:33.178848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:33.181183 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m17:44:33.185010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:44:33.186108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:33.187257 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_aircrafts_seats__dbt_tmp174432920558'
        
      order by ordinal_position

  
[0m17:44:33.238020 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.050 seconds
[0m17:44:33.245155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:33.246160 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_aircrafts_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:33.251585 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:44:33.261945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:33.262453 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_aircrafts_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:33.268476 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:44:33.285777 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:33.288032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:33.289657 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats" ("aircraft_code", "seat_no", "load_datetime", "record_source")
    (
        select "aircraft_code", "seat_no", "load_datetime", "record_source"
        from "link_aircrafts_seats__dbt_tmp174432920558"
    )


  
[0m17:44:33.294927 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:44:33.323060 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: COMMIT
[0m17:44:33.323678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m17:44:33.325420 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: COMMIT
[0m17:44:33.343175 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m17:44:33.346749 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m17:44:33.350074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878AFF08C0>]}
[0m17:44:33.351785 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[32mINSERT 0 0[0m in 0.50s]
[0m17:44:33.354778 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m17:44:33.357621 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m17:44:33.359828 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m17:44:33.361523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m17:44:33.362615 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m17:44:33.370608 [info ] [Thread-1 (]: 17:44:33 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m17:44:33.376293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.378298 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m17:44:33.384476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.385501 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

    
  
    

  create temporary table "link_boarding_passes__dbt_tmp174433381834"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:44:33.387695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:33.485202 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.098 seconds
[0m17:44:33.489009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.489009 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m17:44:33.492539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:44:33.493535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.494546 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes__dbt_tmp174433381834'
        
      order by ordinal_position

  
[0m17:44:33.545008 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.049 seconds
[0m17:44:33.551587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.552166 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:33.556709 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:44:33.561787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.562799 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:33.566830 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:44:33.569629 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.572537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.573530 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes" ("ticket_no", "flight_id", "load_datetime", "record_source")
    (
        select "ticket_no", "flight_id", "load_datetime", "record_source"
        from "link_boarding_passes__dbt_tmp174433381834"
    )


  
[0m17:44:33.578159 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:44:33.580738 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:44:33.581726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m17:44:33.582733 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m17:44:33.604838 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m17:44:33.605952 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m17:44:33.606952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878F1D38C0>]}
[0m17:44:33.610461 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[32mINSERT 0 0[0m in 0.25s]
[0m17:44:33.613060 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m17:44:33.614072 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m17:44:33.615075 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m17:44:33.617073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m17:44:33.619158 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m17:44:33.629476 [info ] [Thread-1 (]: 17:44:33 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m17:44:33.638951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m17:44:33.643935 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m17:44:33.654276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:44:33.655326 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

    
  
    

  create temporary table "link_flights_airports__dbt_tmp174433650913"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" AS d
    ON a.flight_id = d.flight_id AND a.departure_airport = d.departure_airport AND a.arrival_airport = d.arrival_airport
    WHERE d.flight_id IS NULL
    AND d.departure_airport IS NULL
    AND d.arrival_airport IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:44:33.656424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:33.752943 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.096 seconds
[0m17:44:33.757514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:44:33.758520 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m17:44:33.761764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:44:33.762868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:44:33.763412 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports__dbt_tmp174433650913'
        
      order by ordinal_position

  
[0m17:44:33.806823 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.043 seconds
[0m17:44:33.812658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:44:33.813693 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:33.819312 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m17:44:33.825825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:44:33.827073 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_flights_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:33.833352 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m17:44:33.836092 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m17:44:33.838269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:44:33.838823 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports" ("flight_id", "departure_airport", "arrival_airport", "load_datetime", "record_source")
    (
        select "flight_id", "departure_airport", "arrival_airport", "load_datetime", "record_source"
        from "link_flights_airports__dbt_tmp174433650913"
    )


  
[0m17:44:33.843972 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:44:33.846384 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:44:33.846948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m17:44:33.848151 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m17:44:33.865362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m17:44:33.867480 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m17:44:33.868475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878F0FDD60>]}
[0m17:44:33.870785 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[32mINSERT 0 0[0m in 0.25s]
[0m17:44:33.872807 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m17:44:33.874355 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m17:44:33.875389 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m17:44:33.876483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m17:44:33.877579 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m17:44:33.889341 [info ] [Thread-1 (]: 17:44:33 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m17:44:33.902954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m17:44:33.905025 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m17:44:33.912606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:44:33.914603 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

    
  
    

  create temporary table "link_ticket_flights__dbt_tmp174433908361"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" AS d
    ON a.ticket_no = d.ticket_no AND a.flight_id = d.flight_id
    WHERE d.ticket_no IS NULL
    AND d.flight_id IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:44:33.915829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:34.014555 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.098 seconds
[0m17:44:34.019034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:44:34.020126 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m17:44:34.023562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:44:34.024698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:44:34.025250 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights__dbt_tmp174433908361'
        
      order by ordinal_position

  
[0m17:44:34.072695 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.047 seconds
[0m17:44:34.077421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:44:34.078535 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:34.084638 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:44:34.089389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:44:34.089389 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:34.094930 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m17:44:34.098262 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m17:44:34.100569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:44:34.100569 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights" ("ticket_no", "flight_id", "load_datetime", "record_source")
    (
        select "ticket_no", "flight_id", "load_datetime", "record_source"
        from "link_ticket_flights__dbt_tmp174433908361"
    )


  
[0m17:44:34.105972 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:44:34.107071 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:44:34.108582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m17:44:34.110601 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m17:44:34.118409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m17:44:34.120437 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m17:44:34.121449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878F478650>]}
[0m17:44:34.123454 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[32mINSERT 0 0[0m in 0.24s]
[0m17:44:34.125632 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m17:44:34.126629 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m17:44:34.127632 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m17:44:34.128534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m17:44:34.130697 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m17:44:34.139719 [info ] [Thread-1 (]: 17:44:34 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m17:44:34.151169 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.154667 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m17:44:34.162367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.163815 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

    
  
    

  create temporary table "link_tickets_bookings__dbt_tmp174434159841"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" AS d
    ON a.book_ref = d.book_ref AND a.ticket_no = d.ticket_no
    WHERE d.book_ref IS NULL
    AND d.ticket_no IS NULL
)

SELECT * FROM records_to_insert
  );
  
  
[0m17:44:34.163815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:34.255904 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.091 seconds
[0m17:44:34.260778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.261313 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m17:44:34.264159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:44:34.265188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.266211 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings__dbt_tmp174434159841'
        
      order by ordinal_position

  
[0m17:44:34.309590 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.041 seconds
[0m17:44:34.313845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.314871 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:34.320956 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:44:34.324950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.326055 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'link_tickets_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:44:34.331778 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:44:34.334503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.336189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.337286 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings" ("book_ref", "ticket_no", "load_datetime", "record_source")
    (
        select "book_ref", "ticket_no", "load_datetime", "record_source"
        from "link_tickets_bookings__dbt_tmp174434159841"
    )


  
[0m17:44:34.342346 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.004 seconds
[0m17:44:34.345078 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:44:34.346177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m17:44:34.347207 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m17:44:34.363567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m17:44:34.365093 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m17:44:34.367092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1adffee-a11b-4218-bd9b-f4567b858fb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878F4AC350>]}
[0m17:44:34.368606 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[32mINSERT 0 0[0m in 0.24s]
[0m17:44:34.371827 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m17:44:34.373917 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:34.375853 [debug] [MainThread]: On master: BEGIN
[0m17:44:34.377014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:34.425163 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:44:34.425163 [debug] [MainThread]: On master: COMMIT
[0m17:44:34.426218 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:34.427221 [debug] [MainThread]: On master: COMMIT
[0m17:44:34.429888 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:44:34.430904 [debug] [MainThread]: On master: Close
[0m17:44:34.432815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:34.434156 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:44:34.435289 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:44:34.436444 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m17:44:34.438244 [info ] [MainThread]: 
[0m17:44:34.439932 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m17:44:34.442123 [debug] [MainThread]: Command end result
[0m17:44:34.508564 [info ] [MainThread]: 
[0m17:44:34.510784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:34.511862 [info ] [MainThread]: 
[0m17:44:34.513567 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:44:34.517507 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:34.516948 after 4.97 seconds
[0m17:44:34.519174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878EAC24B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878D1C8770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002878D1C80E0>]}
[0m17:44:34.520290 [debug] [MainThread]: Flushing usage events
[0m17:45:22.338012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C487ABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C40BD940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C5163AA0>]}


============================== 17:45:22.343867 | 94f49968-a99e-4139-8bc3-c0f0f8ab11ab ==============================
[0m17:45:22.343867 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:45:22.345027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:satellite', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:22.608984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C50A7290>]}
[0m17:45:22.685023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C4A372F0>]}
[0m17:45:22.687026 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:45:22.871915 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:45:23.237547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:23.237547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:23.268834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C4F60380>]}
[0m17:45:23.393931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C6863E90>]}
[0m17:45:23.395003 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:45:23.395536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C53FE900>]}
[0m17:45:23.398872 [info ] [MainThread]: 
[0m17:45:23.399938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:23.404379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:45:23.664509 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:45:23.664509 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:45:23.665504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:23.721397 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.056 seconds
[0m17:45:23.723638 [debug] [ThreadPool]: On list_postgres: Close
[0m17:45:23.728056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:45:23.736508 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:45:23.736508 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:45:23.737162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:23.777612 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m17:45:23.778670 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:45:23.779220 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:45:23.796537 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.017 seconds
[0m17:45:23.798693 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:45:23.799753 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:45:23.813354 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:23.814425 [debug] [MainThread]: On master: BEGIN
[0m17:45:23.814425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:23.853340 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m17:45:23.854355 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:23.854355 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:23.913741 [debug] [MainThread]: SQL status: SELECT 16 in 0.059 seconds
[0m17:45:23.916753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C2D55AF0>]}
[0m17:45:23.916753 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:23.919689 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:23.919689 [debug] [MainThread]: On master: BEGIN
[0m17:45:23.922856 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:45:23.922856 [debug] [MainThread]: On master: COMMIT
[0m17:45:23.922856 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:23.923933 [debug] [MainThread]: On master: COMMIT
[0m17:45:23.924931 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:45:23.926050 [debug] [MainThread]: On master: Close
[0m17:45:23.926050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:23.927110 [info ] [MainThread]: 
[0m17:45:23.931834 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m17:45:23.932656 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m17:45:23.933703 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m17:45:23.934237 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m17:45:24.034293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_aircrafts"
[0m17:45:24.035955 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_aircrafts
[0m17:45:24.085891 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_aircrafts"
[0m17:45:24.088111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:45:24.088111 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: BEGIN
[0m17:45:24.089786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:45:24.139439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m17:45:24.139439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:45:24.140485 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_aircrafts"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS a
    WHERE a.aircraft_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.aircrafts_hashdiff, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.144010 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.aircrafts_hashdiff does not exist
LINE 16:     SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a...
                                     ^
HINT:  Perhaps you meant to reference the column "a.aircraft_hashdiff".

[0m17:45:24.145009 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: ROLLBACK
[0m17:45:24.147012 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: Close
[0m17:45:24.155129 [debug] [Thread-1 (]: Database Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  column a.aircrafts_hashdiff does not exist
  LINE 16:     SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a...
                                       ^
  HINT:  Perhaps you meant to reference the column "a.aircraft_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_aircrafts.sql
[0m17:45:24.157298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C45887A0>]}
[0m17:45:24.157825 [error] [Thread-1 (]: 1 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[31mERROR[0m in 0.22s]
[0m17:45:24.158911 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m17:45:24.159429 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m17:45:24.161052 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m17:45:24.161589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m17:45:24.162127 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m17:45:24.176268 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_airports"
[0m17:45:24.179010 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_airports
[0m17:45:24.183944 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_airports"
[0m17:45:24.185955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:45:24.185955 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: BEGIN
[0m17:45:24.186949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:24.250756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m17:45:24.250756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:45:24.252344 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_airports"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.airport_code, a.airports_hashdiff, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS a
    WHERE a.airport_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.airport_code, stage.airports_hashdiff, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.254568 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.airports_hashdiff does not exist
LINE 16:     SELECT a.airport_code, a.airports_hashdiff, a.airport_na...
                                    ^
HINT:  Perhaps you meant to reference the column "a.airport_hashdiff".

[0m17:45:24.255120 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: ROLLBACK
[0m17:45:24.256726 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: Close
[0m17:45:24.260152 [debug] [Thread-1 (]: Database Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  column a.airports_hashdiff does not exist
  LINE 16:     SELECT a.airport_code, a.airports_hashdiff, a.airport_na...
                                      ^
  HINT:  Perhaps you meant to reference the column "a.airport_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_airports.sql
[0m17:45:24.260692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C6FBE960>]}
[0m17:45:24.262210 [error] [Thread-1 (]: 2 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_airports  [[31mERROR[0m in 0.10s]
[0m17:45:24.263282 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m17:45:24.263817 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m17:45:24.264923 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m17:45:24.265465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m17:45:24.266004 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m17:45:24.275913 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m17:45:24.277505 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m17:45:24.281938 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_boarding_passes"
[0m17:45:24.283029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m17:45:24.283592 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: BEGIN
[0m17:45:24.284152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:24.343677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:45:24.344225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m17:45:24.344225 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.boarding_passes_hashdiff, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.boarding_passes_hashdiff, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.346260 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m17:45:24.346260 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: ROLLBACK
[0m17:45:24.348647 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m17:45:24.350958 [debug] [Thread-1 (]: Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m17:45:24.351964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C7011A60>]}
[0m17:45:24.352980 [error] [Thread-1 (]: 3 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.09s]
[0m17:45:24.354021 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m17:45:24.354547 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m17:45:24.355080 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m17:45:24.356161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m17:45:24.356707 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m17:45:24.365236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_bookings"
[0m17:45:24.366831 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_bookings
[0m17:45:24.370864 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_bookings"
[0m17:45:24.372928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:45:24.373435 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: BEGIN
[0m17:45:24.374021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:24.419468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:45:24.420540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:45:24.420540 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_bookings"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS a
    WHERE a.book_ref IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.book_ref, stage.bookings_hashdiff, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.425728 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.bookings_hashdiff does not exist
LINE 16:     SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.t...
                                ^
HINT:  Perhaps you meant to reference the column "a.booking_hashdiff".

[0m17:45:24.425728 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: ROLLBACK
[0m17:45:24.428645 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: Close
[0m17:45:24.432965 [debug] [Thread-1 (]: Database Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  column a.bookings_hashdiff does not exist
  LINE 16:     SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.t...
                                  ^
  HINT:  Perhaps you meant to reference the column "a.booking_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_bookings.sql
[0m17:45:24.434220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C7045A90>]}
[0m17:45:24.434753 [error] [Thread-1 (]: 4 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_bookings  [[31mERROR[0m in 0.08s]
[0m17:45:24.435811 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m17:45:24.436384 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m17:45:24.436927 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m17:45:24.438011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m17:45:24.438011 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m17:45:24.449812 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_flights"
[0m17:45:24.452986 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_flights
[0m17:45:24.458472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_flights"
[0m17:45:24.460189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:45:24.460798 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: BEGIN
[0m17:45:24.461350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:24.525758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m17:45:24.527100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:45:24.528206 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.departure_airport, a.arrival_airport, a.status, a.aircraft_code, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS a
    WHERE a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.flight_id, stage.flights_hashdiff, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.departure_airport, stage.arrival_airport, stage.status, stage.aircraft_code, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.534359 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.flights_hashdiff does not exist
LINE 16:     SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.s...
                                 ^
HINT:  Perhaps you meant to reference the column "a.flight_hashdiff".

[0m17:45:24.535465 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: ROLLBACK
[0m17:45:24.537799 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: Close
[0m17:45:24.542686 [debug] [Thread-1 (]: Database Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  column a.flights_hashdiff does not exist
  LINE 16:     SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.s...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.flight_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_flights.sql
[0m17:45:24.543788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C6EA7230>]}
[0m17:45:24.544940 [error] [Thread-1 (]: 5 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_flights  [[31mERROR[0m in 0.11s]
[0m17:45:24.547257 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m17:45:24.548372 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m17:45:24.549439 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m17:45:24.550545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m17:45:24.551119 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m17:45:24.564952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m17:45:24.566951 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m17:45:24.571971 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_seats"
[0m17:45:24.573885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m17:45:24.574455 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: BEGIN
[0m17:45:24.574991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:24.616911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m17:45:24.617907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m17:45:24.617907 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_seats"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, seat_no, a.seats_hashdiff, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code, seat_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, seat_no, stage.seats_hashdiff, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.619450 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                  ^

[0m17:45:24.620719 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: ROLLBACK
[0m17:45:24.622773 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m17:45:24.625954 [debug] [Thread-1 (]: Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m17:45:24.627035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C7018D40>]}
[0m17:45:24.628057 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.08s]
[0m17:45:24.628057 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m17:45:24.629567 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m17:45:24.630577 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m17:45:24.632085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m17:45:24.632593 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m17:45:24.722390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m17:45:24.724137 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m17:45:24.728144 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_ticket_flights"
[0m17:45:24.729650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m17:45:24.730679 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: BEGIN
[0m17:45:24.730679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:24.792280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m17:45:24.792822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m17:45:24.793404 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.ticket_flights_hashdiff, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.ticket_flights_hashdiff, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.794570 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m17:45:24.795144 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: ROLLBACK
[0m17:45:24.796807 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m17:45:24.798990 [debug] [Thread-1 (]: Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m17:45:24.800137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C6FFE390>]}
[0m17:45:24.800858 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.17s]
[0m17:45:24.801938 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m17:45:24.802481 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m17:45:24.803032 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m17:45:24.803571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m17:45:24.804322 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m17:45:24.813115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_tickets"
[0m17:45:24.814198 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_tickets
[0m17:45:24.818622 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_tickets"
[0m17:45:24.820781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:45:24.821927 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: BEGIN
[0m17:45:24.822463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:24.869445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:45:24.869992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:45:24.870528 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_tickets"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS a
    WHERE a.ticket_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.tickets_hashdiff, stage.book_ref, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:45:24.874900 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.tickets_hashdiff does not exist
LINE 16:     SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.pa...
                                 ^
HINT:  Perhaps you meant to reference the column "a.ticket_hashdiff".

[0m17:45:24.875456 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: ROLLBACK
[0m17:45:24.877104 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: Close
[0m17:45:24.879378 [debug] [Thread-1 (]: Database Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  column a.tickets_hashdiff does not exist
  LINE 16:     SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.pa...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.ticket_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_tickets.sql
[0m17:45:24.879921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f49968-a99e-4139-8bc3-c0f0f8ab11ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C689E4B0>]}
[0m17:45:24.881018 [error] [Thread-1 (]: 8 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_tickets  [[31mERROR[0m in 0.08s]
[0m17:45:24.882113 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m17:45:24.883698 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:24.884245 [debug] [MainThread]: On master: BEGIN
[0m17:45:24.884245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:24.949448 [debug] [MainThread]: SQL status: BEGIN in 0.066 seconds
[0m17:45:24.951173 [debug] [MainThread]: On master: COMMIT
[0m17:45:24.951173 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:24.952298 [debug] [MainThread]: On master: COMMIT
[0m17:45:24.953359 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:45:24.953979 [debug] [MainThread]: On master: Close
[0m17:45:24.955241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:24.956332 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:45:24.956878 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:45:24.957966 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m17:45:24.957966 [info ] [MainThread]: 
[0m17:45:24.959057 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m17:45:24.960693 [debug] [MainThread]: Command end result
[0m17:45:25.024989 [info ] [MainThread]: 
[0m17:45:25.026987 [info ] [MainThread]: [31mCompleted with 8 errors and 0 warnings:[0m
[0m17:45:25.027988 [info ] [MainThread]: 
[0m17:45:25.029498 [error] [MainThread]:   Database Error in model sat_aircrafts (models\raw_vault\sats\sat_aircrafts.sql)
  column a.aircrafts_hashdiff does not exist
  LINE 16:     SELECT a.aircraft_code, a.aircrafts_hashdiff, a.model, a...
                                       ^
  HINT:  Perhaps you meant to reference the column "a.aircraft_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_aircrafts.sql
[0m17:45:25.031593 [info ] [MainThread]: 
[0m17:45:25.033881 [error] [MainThread]:   Database Error in model sat_airports (models\raw_vault\sats\sat_airports.sql)
  column a.airports_hashdiff does not exist
  LINE 16:     SELECT a.airport_code, a.airports_hashdiff, a.airport_na...
                                      ^
  HINT:  Perhaps you meant to reference the column "a.airport_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_airports.sql
[0m17:45:25.035533 [info ] [MainThread]: 
[0m17:45:25.037168 [error] [MainThread]:   Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m17:45:25.038891 [info ] [MainThread]: 
[0m17:45:25.040519 [error] [MainThread]:   Database Error in model sat_bookings (models\raw_vault\sats\sat_bookings.sql)
  column a.bookings_hashdiff does not exist
  LINE 16:     SELECT a.book_ref, a.bookings_hashdiff, a.book_date, a.t...
                                  ^
  HINT:  Perhaps you meant to reference the column "a.booking_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_bookings.sql
[0m17:45:25.042138 [info ] [MainThread]: 
[0m17:45:25.043764 [error] [MainThread]:   Database Error in model sat_flights (models\raw_vault\sats\sat_flights.sql)
  column a.flights_hashdiff does not exist
  LINE 16:     SELECT a.flight_id, a.flights_hashdiff, a.flight_no, a.s...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.flight_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_flights.sql
[0m17:45:25.044831 [info ] [MainThread]: 
[0m17:45:25.045948 [error] [MainThread]:   Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m17:45:25.047263 [info ] [MainThread]: 
[0m17:45:25.048272 [error] [MainThread]:   Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m17:45:25.049784 [info ] [MainThread]: 
[0m17:45:25.050859 [error] [MainThread]:   Database Error in model sat_tickets (models\raw_vault\sats\sat_tickets.sql)
  column a.tickets_hashdiff does not exist
  LINE 16:     SELECT a.ticket_no, a.tickets_hashdiff, a.book_ref, a.pa...
                                   ^
  HINT:  Perhaps you meant to reference the column "a.ticket_hashdiff".
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_tickets.sql
[0m17:45:25.050859 [info ] [MainThread]: 
[0m17:45:25.052877 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=8 SKIP=0 TOTAL=8
[0m17:45:25.055231 [debug] [MainThread]: Command `dbt run` failed at 17:45:25.055231 after 2.90 seconds
[0m17:45:25.055776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C511A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C4278E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C52C1A30>]}
[0m17:45:25.056305 [debug] [MainThread]: Flushing usage events
[0m17:52:49.591262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA62E66870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA62E66960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA63CBE090>]}


============================== 17:52:49.596638 | 0b96dabb-6601-4d3e-bebd-89a4ff0547f7 ==============================
[0m17:52:49.596638 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:52:49.597702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:satellite', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:49.857523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA640371D0>]}
[0m17:52:49.935025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA63D10560>]}
[0m17:52:49.936603 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:52:50.146237 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:52:50.524043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m17:52:50.525140 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_airports.sql
[0m17:52:50.525684 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_tickets.sql
[0m17:52:50.526243 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m17:52:50.527373 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_bookings.sql
[0m17:52:50.528163 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_aircrafts.sql
[0m17:52:50.529361 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m17:52:50.529924 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m17:52:50.529924 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_flights.sql
[0m17:52:50.989340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA6592C1A0>]}
[0m17:52:51.203495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA63E54F80>]}
[0m17:52:51.204035 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:52:51.204580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA653216A0>]}
[0m17:52:51.206778 [info ] [MainThread]: 
[0m17:52:51.207902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:52:51.212312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:52:51.508883 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:52:51.510004 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:52:51.510004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:51.574677 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.064 seconds
[0m17:52:51.575687 [debug] [ThreadPool]: On list_postgres: Close
[0m17:52:51.579828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:52:51.587119 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:52:51.587680 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:52:51.587680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:51.624969 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m17:52:51.626364 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:52:51.626364 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:52:51.645805 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.018 seconds
[0m17:52:51.647984 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:52:51.649033 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:52:51.661456 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:51.662477 [debug] [MainThread]: On master: BEGIN
[0m17:52:51.662477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:51.723750 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m17:52:51.724870 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:51.725399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:52:51.781831 [debug] [MainThread]: SQL status: SELECT 16 in 0.056 seconds
[0m17:52:51.785442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA618C5BE0>]}
[0m17:52:51.785986 [debug] [MainThread]: On master: ROLLBACK
[0m17:52:51.787461 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:51.787461 [debug] [MainThread]: On master: BEGIN
[0m17:52:51.792227 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m17:52:51.793738 [debug] [MainThread]: On master: COMMIT
[0m17:52:51.794790 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:51.795932 [debug] [MainThread]: On master: COMMIT
[0m17:52:51.797776 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:52:51.798285 [debug] [MainThread]: On master: Close
[0m17:52:51.799301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:51.800295 [info ] [MainThread]: 
[0m17:52:51.806812 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m17:52:51.808225 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m17:52:51.809879 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m17:52:51.810427 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m17:52:51.828513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_aircrafts"
[0m17:52:51.830142 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_aircrafts
[0m17:52:51.885292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_aircrafts"
[0m17:52:51.886313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:52:51.886313 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: BEGIN
[0m17:52:51.887303 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:52:51.940403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m17:52:51.940971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:52:51.942058 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_aircrafts"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.aircraft_hashdiff, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS a
    WHERE a.aircraft_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.aircraft_hashdiff, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:51.985808 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m17:52:52.004440 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m17:52:52.004960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:52:52.005504 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m17:52:52.025017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m17:52:52.028042 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: Close
[0m17:52:52.030193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65B7DCD0>]}
[0m17:52:52.031328 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[32mSELECT 0[0m in 0.22s]
[0m17:52:52.032439 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m17:52:52.033597 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m17:52:52.034188 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m17:52:52.035318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m17:52:52.035861 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m17:52:52.046754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_airports"
[0m17:52:52.049131 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_airports
[0m17:52:52.053868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_airports"
[0m17:52:52.055538 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:52:52.056638 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: BEGIN
[0m17:52:52.057177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.109796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m17:52:52.110902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:52:52.111428 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_airports"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.airport_code, a.airport_hashdiff, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS a
    WHERE a.airport_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.airport_code, stage.airport_hashdiff, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:52.149159 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.037 seconds
[0m17:52:52.151299 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m17:52:52.151840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:52:52.152378 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m17:52:52.167782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m17:52:52.168999 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: Close
[0m17:52:52.168999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65B97A40>]}
[0m17:52:52.169999 [info ] [Thread-1 (]: 2 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_airports . [[32mSELECT 0[0m in 0.13s]
[0m17:52:52.171249 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m17:52:52.172376 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m17:52:52.173374 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m17:52:52.174385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m17:52:52.175386 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m17:52:52.189628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m17:52:52.191685 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m17:52:52.197834 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_boarding_passes"
[0m17:52:52.199001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m17:52:52.199542 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: BEGIN
[0m17:52:52.200086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.247343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m17:52:52.247883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m17:52:52.248418 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.boarding_pass_hashdiff, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.boarding_pass_hashdiff, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:52.250145 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m17:52:52.250770 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: ROLLBACK
[0m17:52:52.251869 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m17:52:52.266205 [debug] [Thread-1 (]: Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m17:52:52.266752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65B999A0>]}
[0m17:52:52.268055 [error] [Thread-1 (]: 3 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[31mERROR[0m in 0.09s]
[0m17:52:52.269864 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m17:52:52.270499 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m17:52:52.272134 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m17:52:52.273943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m17:52:52.273943 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m17:52:52.288305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_bookings"
[0m17:52:52.290031 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_bookings
[0m17:52:52.295851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_bookings"
[0m17:52:52.297422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:52:52.298418 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: BEGIN
[0m17:52:52.299745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.347229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:52:52.348789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:52:52.348789 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_bookings"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.book_ref, a.booking_hashdiff, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS a
    WHERE a.book_ref IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.book_ref, stage.booking_hashdiff, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:52.382083 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m17:52:52.384372 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m17:52:52.385496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:52:52.386032 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m17:52:52.391237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:52:52.392294 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: Close
[0m17:52:52.393311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65BF6600>]}
[0m17:52:52.394328 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_bookings . [[32mSELECT 0[0m in 0.12s]
[0m17:52:52.395329 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m17:52:52.395329 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m17:52:52.396326 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m17:52:52.397331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m17:52:52.398242 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m17:52:52.425051 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_flights"
[0m17:52:52.426980 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_flights
[0m17:52:52.438464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_flights"
[0m17:52:52.441278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:52:52.443029 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: BEGIN
[0m17:52:52.443029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.484464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m17:52:52.485018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:52:52.486033 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.flight_id, a.flight_hashdiff, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.departure_airport, a.arrival_airport, a.status, a.aircraft_code, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS a
    WHERE a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.flight_id, stage.flight_hashdiff, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.departure_airport, stage.arrival_airport, stage.status, stage.aircraft_code, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:52.519367 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m17:52:52.522062 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m17:52:52.522062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:52:52.523073 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m17:52:52.534391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m17:52:52.535484 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: Close
[0m17:52:52.536040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65C0F3E0>]}
[0m17:52:52.537219 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_flights .. [[32mSELECT 0[0m in 0.14s]
[0m17:52:52.538349 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m17:52:52.538941 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m17:52:52.539492 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m17:52:52.540634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m17:52:52.540634 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m17:52:52.551289 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m17:52:52.552306 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m17:52:52.557649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_seats"
[0m17:52:52.558656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m17:52:52.559651 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: BEGIN
[0m17:52:52.559651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.614843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:52:52.615391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m17:52:52.615961 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_seats"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, seat_no, a.seat_hashdiff, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code, seat_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, seat_no, stage.seat_hashdiff, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:52.616985 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                  ^

[0m17:52:52.617988 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: ROLLBACK
[0m17:52:52.619003 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m17:52:52.622086 [debug] [Thread-1 (]: Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m17:52:52.623604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65C2A7B0>]}
[0m17:52:52.624968 [error] [Thread-1 (]: 6 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_seats  [[31mERROR[0m in 0.08s]
[0m17:52:52.626066 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m17:52:52.626606 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m17:52:52.627143 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m17:52:52.628308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m17:52:52.628861 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m17:52:52.637658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m17:52:52.639649 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m17:52:52.643578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_ticket_flights"
[0m17:52:52.644697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m17:52:52.645297 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: BEGIN
[0m17:52:52.645297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.705739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m17:52:52.706293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m17:52:52.707431 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, flight_id, a.ticket_flight_hashdiff, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no, flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, flight_id, stage.ticket_flight_hashdiff, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:52.708545 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                              ^

[0m17:52:52.709132 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: ROLLBACK
[0m17:52:52.710502 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m17:52:52.714701 [debug] [Thread-1 (]: Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m17:52:52.715256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65C408C0>]}
[0m17:52:52.715798 [error] [Thread-1 (]: 7 of 8 ERROR creating sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[31mERROR[0m in 0.09s]
[0m17:52:52.716340 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m17:52:52.717361 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m17:52:52.717880 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m17:52:52.718901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m17:52:52.718901 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m17:52:52.730286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_tickets"
[0m17:52:52.731285 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_tickets
[0m17:52:52.737328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_tickets"
[0m17:52:52.738627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:52:52.739634 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: BEGIN
[0m17:52:52.739634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:52.808940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m17:52:52.810149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:52:52.811257 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_tickets"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.ticket_hashdiff, a.book_ref, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS a
    WHERE a.ticket_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.ticket_hashdiff, stage.book_ref, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:52:52.855225 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.043 seconds
[0m17:52:52.858394 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m17:52:52.858394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:52:52.859336 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m17:52:52.864783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:52:52.865833 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: Close
[0m17:52:52.866897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b96dabb-6601-4d3e-bebd-89a4ff0547f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA65ABDD60>]}
[0m17:52:52.867973 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_tickets .. [[32mSELECT 0[0m in 0.15s]
[0m17:52:52.869599 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m17:52:52.872422 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:52.873540 [debug] [MainThread]: On master: BEGIN
[0m17:52:52.874113 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:52:52.931436 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m17:52:52.933796 [debug] [MainThread]: On master: COMMIT
[0m17:52:52.934364 [debug] [MainThread]: Using postgres connection "master"
[0m17:52:52.935079 [debug] [MainThread]: On master: COMMIT
[0m17:52:52.936821 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:52:52.937349 [debug] [MainThread]: On master: Close
[0m17:52:52.938417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:52.938972 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:52:52.939530 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:52:52.940079 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m17:52:52.940655 [info ] [MainThread]: 
[0m17:52:52.941716 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m17:52:52.943460 [debug] [MainThread]: Command end result
[0m17:52:52.995223 [info ] [MainThread]: 
[0m17:52:52.996240 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:52:52.997440 [info ] [MainThread]: 
[0m17:52:52.997440 [error] [MainThread]:   Database Error in model sat_boarding_passes (models\raw_vault\sats\sat_boarding_passes.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_boarding_passes.sql
[0m17:52:52.998442 [info ] [MainThread]: 
[0m17:52:52.999439 [error] [MainThread]:   Database Error in model sat_seats (models\raw_vault\sats\sat_seats.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.aircraft_code, seat_no IS NOT NULL
                                    ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_seats.sql
[0m17:52:52.999439 [info ] [MainThread]: 
[0m17:52:53.000432 [error] [MainThread]:   Database Error in model sat_ticket_flights (models\raw_vault\sats\sat_ticket_flights.sql)
  syntax error at or near ","
  LINE 18:     WHERE a.ticket_no, flight_id IS NOT NULL
                                ^
  compiled code at target\run\dbt_dwh\models\raw_vault\sats\sat_ticket_flights.sql
[0m17:52:53.001446 [info ] [MainThread]: 
[0m17:52:53.002585 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=3 SKIP=0 TOTAL=8
[0m17:52:53.004242 [debug] [MainThread]: Command `dbt run` failed at 17:52:53.004242 after 3.73 seconds
[0m17:52:53.004786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA63E31FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA633AE960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA633AC890>]}
[0m17:52:53.005343 [debug] [MainThread]: Flushing usage events
[0m17:54:47.541965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318F910B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318CF3F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318F70D040>]}


============================== 17:54:47.547174 | 3e946208-70a1-46ca-b6d4-0a1161d8deac ==============================
[0m17:54:47.547174 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:54:47.548292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:satellite', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:47.815669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318FA95460>]}
[0m17:54:47.877345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318EAE8800>]}
[0m17:54:47.879484 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:54:48.079886 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:54:48.438435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m17:54:48.439429 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_seats.sql
[0m17:54:48.439429 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_ticket_flights.sql
[0m17:54:48.440514 [debug] [MainThread]: Partial parsing: updated file: dbt_dwh://models\raw_vault\sats\sat_boarding_passes.sql
[0m17:54:48.815537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023190F70830>]}
[0m17:54:48.948932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231910637D0>]}
[0m17:54:48.949481 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m17:54:48.950112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023190F32630>]}
[0m17:54:48.952475 [info ] [MainThread]: 
[0m17:54:48.953472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:48.957247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:54:49.210984 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:54:49.211536 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:54:49.212083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:49.263367 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.051 seconds
[0m17:54:49.264365 [debug] [ThreadPool]: On list_postgres: Close
[0m17:54:49.269842 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m17:54:49.275225 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:54:49.276734 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m17:54:49.276734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:49.327590 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m17:54:49.328661 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m17:54:49.329236 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m17:54:49.344706 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.016 seconds
[0m17:54:49.346981 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m17:54:49.349093 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m17:54:49.362571 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:49.362571 [debug] [MainThread]: On master: BEGIN
[0m17:54:49.364076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:49.421232 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m17:54:49.422296 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:49.422889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:49.478037 [debug] [MainThread]: SQL status: SELECT 16 in 0.055 seconds
[0m17:54:49.481055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318FBC41D0>]}
[0m17:54:49.482056 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:49.483062 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:49.483062 [debug] [MainThread]: On master: BEGIN
[0m17:54:49.487412 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:54:49.487412 [debug] [MainThread]: On master: COMMIT
[0m17:54:49.488468 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:49.488468 [debug] [MainThread]: On master: COMMIT
[0m17:54:49.489482 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:54:49.490472 [debug] [MainThread]: On master: Close
[0m17:54:49.491475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:49.493046 [info ] [MainThread]: 
[0m17:54:49.499052 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m17:54:49.500058 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m17:54:49.501129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m17:54:49.502533 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m17:54:49.603242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.605281 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_aircrafts
[0m17:54:49.654130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.654130 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

    
  
    

  create temporary table "sat_aircrafts__dbt_tmp175449631868"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.aircraft_hashdiff, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS a
    WHERE a.aircraft_code IS NOT NULL
),

latest_records AS (
    SELECT a.aircraft_code, a.aircraft_hashdiff, a.LOAD_DATETIME
    FROM (
        SELECT current_records.aircraft_code, current_records.aircraft_hashdiff, current_records.LOAD_DATETIME,
            RANK() OVER (
                PARTITION BY current_records.aircraft_code
                ORDER BY current_records.LOAD_DATETIME DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_aircrafts" AS current_records
            JOIN (
                SELECT DISTINCT source_data.aircraft_code
                FROM source_data
            ) AS source_records
                ON current_records.aircraft_code = source_records.aircraft_code
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.aircraft_hashdiff, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.aircraft_code = stage.aircraft_code
        AND latest_records.aircraft_hashdiff = stage.aircraft_hashdiff
    WHERE latest_records.aircraft_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:49.655148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:49.755134 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.100 seconds
[0m17:54:49.768491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.769033 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: BEGIN
[0m17:54:49.771274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:54:49.771826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.772437 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_aircrafts__dbt_tmp175449631868'
        
      order by ordinal_position

  
[0m17:54:49.811938 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.039 seconds
[0m17:54:49.818319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.818858 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:49.822997 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m17:54:49.831100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.832414 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:49.836986 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m17:54:49.848156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.849446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.849994 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."sat_aircrafts" ("aircraft_code", "aircraft_hashdiff", "model", "range", "effective_from", "load_datetime", "record_source")
    (
        select "aircraft_code", "aircraft_hashdiff", "model", "range", "effective_from", "load_datetime", "record_source"
        from "sat_aircrafts__dbt_tmp175449631868"
    )


  
[0m17:54:49.853841 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:54:49.867712 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m17:54:49.867712 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m17:54:49.868278 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m17:54:49.882250 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:54:49.884363 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: Close
[0m17:54:49.887374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318F19EC00>]}
[0m17:54:49.888386 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[32mINSERT 0 0[0m in 0.38s]
[0m17:54:49.889503 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m17:54:49.889503 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m17:54:49.890599 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m17:54:49.891689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m17:54:49.892265 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m17:54:49.907494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_airports"
[0m17:54:49.909873 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_airports
[0m17:54:49.916488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:54:49.917629 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

    
  
    

  create temporary table "sat_airports__dbt_tmp175449913714"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.airport_code, a.airport_hashdiff, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS a
    WHERE a.airport_code IS NOT NULL
),

latest_records AS (
    SELECT a.airport_code, a.airport_hashdiff, a.LOAD_DATETIME
    FROM (
        SELECT current_records.airport_code, current_records.airport_hashdiff, current_records.LOAD_DATETIME,
            RANK() OVER (
                PARTITION BY current_records.airport_code
                ORDER BY current_records.LOAD_DATETIME DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_airports" AS current_records
            JOIN (
                SELECT DISTINCT source_data.airport_code
                FROM source_data
            ) AS source_records
                ON current_records.airport_code = source_records.airport_code
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.airport_code, stage.airport_hashdiff, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.airport_code = stage.airport_code
        AND latest_records.airport_hashdiff = stage.airport_hashdiff
    WHERE latest_records.airport_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:49.918171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.017160 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.099 seconds
[0m17:54:50.021768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:54:50.022318 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: BEGIN
[0m17:54:50.024328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:54:50.024836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:54:50.024836 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports__dbt_tmp175449913714'
        
      order by ordinal_position

  
[0m17:54:50.060561 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.035 seconds
[0m17:54:50.064564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:54:50.065082 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:50.069005 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m17:54:50.073513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:54:50.074085 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:50.077974 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.003 seconds
[0m17:54:50.079811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_airports"
[0m17:54:50.080821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:54:50.081820 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."sat_airports" ("airport_code", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_datetime", "record_source")
    (
        select "airport_code", "airport_hashdiff", "airport_name", "city", "coordinates_lon", "coordinates_lat", "timezone", "effective_from", "load_datetime", "record_source"
        from "sat_airports__dbt_tmp175449913714"
    )


  
[0m17:54:50.085409 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:54:50.087316 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m17:54:50.087827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m17:54:50.088388 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m17:54:50.102745 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m17:54:50.104252 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: Close
[0m17:54:50.105262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231914F0EC0>]}
[0m17:54:50.107295 [info ] [Thread-1 (]: 2 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_airports . [[32mINSERT 0 0[0m in 0.21s]
[0m17:54:50.109220 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m17:54:50.109784 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m17:54:50.110519 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m17:54:50.111589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m17:54:50.112135 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m17:54:50.121373 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m17:54:50.122381 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m17:54:50.128710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_boarding_passes"
[0m17:54:50.129851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m17:54:50.130392 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: BEGIN
[0m17:54:50.130982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.174727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m17:54:50.175822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m17:54:50.176371 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.flight_id, a.boarding_pass_hashdiff, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no IS NOT NULL
    AND a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.flight_id, stage.boarding_pass_hashdiff, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:50.207961 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.031 seconds
[0m17:54:50.213072 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: COMMIT
[0m17:54:50.213647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m17:54:50.214190 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: COMMIT
[0m17:54:50.219400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:54:50.220799 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m17:54:50.220799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231915BBEF0>]}
[0m17:54:50.222834 [info ] [Thread-1 (]: 3 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[32mSELECT 0[0m in 0.11s]
[0m17:54:50.222834 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m17:54:50.224351 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m17:54:50.225431 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m17:54:50.225431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m17:54:50.226941 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m17:54:50.238046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_bookings"
[0m17:54:50.239078 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_bookings
[0m17:54:50.244246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:54:50.245258 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

    
  
    

  create temporary table "sat_bookings__dbt_tmp175450242087"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.book_ref, a.booking_hashdiff, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS a
    WHERE a.book_ref IS NOT NULL
),

latest_records AS (
    SELECT a.book_ref, a.booking_hashdiff, a.LOAD_DATETIME
    FROM (
        SELECT current_records.book_ref, current_records.booking_hashdiff, current_records.LOAD_DATETIME,
            RANK() OVER (
                PARTITION BY current_records.book_ref
                ORDER BY current_records.LOAD_DATETIME DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_bookings" AS current_records
            JOIN (
                SELECT DISTINCT source_data.book_ref
                FROM source_data
            ) AS source_records
                ON current_records.book_ref = source_records.book_ref
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.book_ref, stage.booking_hashdiff, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.book_ref = stage.book_ref
        AND latest_records.booking_hashdiff = stage.booking_hashdiff
    WHERE latest_records.booking_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:50.245258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.338579 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.093 seconds
[0m17:54:50.341610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:54:50.342608 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: BEGIN
[0m17:54:50.345449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:54:50.345958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:54:50.347172 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_bookings__dbt_tmp175450242087'
        
      order by ordinal_position

  
[0m17:54:50.383402 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.036 seconds
[0m17:54:50.388083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:54:50.389390 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:50.394250 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.004 seconds
[0m17:54:50.398157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:54:50.398729 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:50.402488 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.003 seconds
[0m17:54:50.404480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_bookings"
[0m17:54:50.404992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:54:50.404992 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."sat_bookings" ("book_ref", "booking_hashdiff", "book_date", "total_amount", "effective_from", "load_datetime", "record_source")
    (
        select "book_ref", "booking_hashdiff", "book_date", "total_amount", "effective_from", "load_datetime", "record_source"
        from "sat_bookings__dbt_tmp175450242087"
    )


  
[0m17:54:50.410019 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:54:50.411718 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m17:54:50.412272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m17:54:50.412812 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m17:54:50.426746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:54:50.427809 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: Close
[0m17:54:50.428346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319192FC50>]}
[0m17:54:50.429517 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_bookings . [[32mINSERT 0 0[0m in 0.20s]
[0m17:54:50.431168 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m17:54:50.431751 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m17:54:50.432308 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m17:54:50.432867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m17:54:50.433431 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m17:54:50.448435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_flights"
[0m17:54:50.450029 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_flights
[0m17:54:50.454601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:54:50.454601 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

    
  
    

  create temporary table "sat_flights__dbt_tmp175450452577"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.flight_id, a.flight_hashdiff, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.departure_airport, a.arrival_airport, a.status, a.aircraft_code, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS a
    WHERE a.flight_id IS NOT NULL
),

latest_records AS (
    SELECT a.flight_id, a.flight_hashdiff, a.LOAD_DATETIME
    FROM (
        SELECT current_records.flight_id, current_records.flight_hashdiff, current_records.LOAD_DATETIME,
            RANK() OVER (
                PARTITION BY current_records.flight_id
                ORDER BY current_records.LOAD_DATETIME DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_flights" AS current_records
            JOIN (
                SELECT DISTINCT source_data.flight_id
                FROM source_data
            ) AS source_records
                ON current_records.flight_id = source_records.flight_id
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.flight_id, stage.flight_hashdiff, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.departure_airport, stage.arrival_airport, stage.status, stage.aircraft_code, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.flight_id = stage.flight_id
        AND latest_records.flight_hashdiff = stage.flight_hashdiff
    WHERE latest_records.flight_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:50.456128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.552029 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.095 seconds
[0m17:54:50.558091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:54:50.559176 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: BEGIN
[0m17:54:50.560762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:54:50.562148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:54:50.563139 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_flights__dbt_tmp175450452577'
        
      order by ordinal_position

  
[0m17:54:50.605284 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.042 seconds
[0m17:54:50.609030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:54:50.610124 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:50.614794 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.004 seconds
[0m17:54:50.620564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:54:50.621686 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:50.626794 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.004 seconds
[0m17:54:50.629069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_flights"
[0m17:54:50.630780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:54:50.631366 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."sat_flights" ("flight_id", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "effective_from", "load_datetime", "record_source")
    (
        select "flight_id", "flight_hashdiff", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "effective_from", "load_datetime", "record_source"
        from "sat_flights__dbt_tmp175450452577"
    )


  
[0m17:54:50.639257 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m17:54:50.640919 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m17:54:50.641466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m17:54:50.642047 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m17:54:50.658189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m17:54:50.659282 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: Close
[0m17:54:50.659822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002319161A0C0>]}
[0m17:54:50.660352 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_flights .. [[32mINSERT 0 0[0m in 0.23s]
[0m17:54:50.661516 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m17:54:50.662058 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m17:54:50.662608 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m17:54:50.663161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m17:54:50.663697 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m17:54:50.673503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m17:54:50.674519 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m17:54:50.679486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_seats"
[0m17:54:50.680027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m17:54:50.681550 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: BEGIN
[0m17:54:50.682645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.728558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:54:50.729147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m17:54:50.730227 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_seats"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.seat_no, a.seat_hashdiff, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code IS NOT NULL
    AND a.seat_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.seat_no, stage.seat_hashdiff, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:50.766594 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m17:54:50.768829 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: COMMIT
[0m17:54:50.769381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m17:54:50.769911 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: COMMIT
[0m17:54:50.784462 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m17:54:50.785602 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m17:54:50.786737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231915C2A50>]}
[0m17:54:50.787919 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_seats .... [[32mSELECT 0[0m in 0.12s]
[0m17:54:50.789059 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m17:54:50.789688 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m17:54:50.790271 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m17:54:50.791903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m17:54:50.792455 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m17:54:50.803251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m17:54:50.804260 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m17:54:50.808929 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_ticket_flights"
[0m17:54:50.810571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m17:54:50.811121 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: BEGIN
[0m17:54:50.811684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:50.859304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:54:50.859894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m17:54:50.860443 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.flight_id, a.ticket_flight_hashdiff, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no IS NOT NULL
    AND a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.flight_id, stage.ticket_flight_hashdiff, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:50.894036 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m17:54:50.896300 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: COMMIT
[0m17:54:50.896889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m17:54:50.896889 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: COMMIT
[0m17:54:50.903220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:54:50.904294 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m17:54:50.905374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023191942A20>]}
[0m17:54:50.906766 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[32mSELECT 0[0m in 0.11s]
[0m17:54:50.907980 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m17:54:50.909151 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m17:54:50.909699 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m17:54:50.910257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m17:54:50.910804 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m17:54:50.926617 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_tickets"
[0m17:54:50.928243 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_tickets
[0m17:54:50.932268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:54:50.932873 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

    
  
    

  create temporary table "sat_tickets__dbt_tmp175450930644"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.ticket_hashdiff, a.book_ref, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS a
    WHERE a.ticket_no IS NOT NULL
),

latest_records AS (
    SELECT a.ticket_no, a.ticket_hashdiff, a.LOAD_DATETIME
    FROM (
        SELECT current_records.ticket_no, current_records.ticket_hashdiff, current_records.LOAD_DATETIME,
            RANK() OVER (
                PARTITION BY current_records.ticket_no
                ORDER BY current_records.LOAD_DATETIME DESC
            ) AS rank
        FROM "postgres"."dwh_detailed_dwh_detailed"."sat_tickets" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ticket_no
                FROM source_data
            ) AS source_records
                ON current_records.ticket_no = source_records.ticket_no
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.ticket_hashdiff, stage.book_ref, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ticket_no = stage.ticket_no
        AND latest_records.ticket_hashdiff = stage.ticket_hashdiff
    WHERE latest_records.ticket_hashdiff IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m17:54:50.933503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:54:51.006562 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.074 seconds
[0m17:54:51.011389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:54:51.012049 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: BEGIN
[0m17:54:51.014656 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m17:54:51.015224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:54:51.015768 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_tickets__dbt_tmp175450930644'
        
      order by ordinal_position

  
[0m17:54:51.053539 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.037 seconds
[0m17:54:51.058571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:54:51.058571 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:51.062580 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.003 seconds
[0m17:54:51.065092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:54:51.066610 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m17:54:51.070481 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.004 seconds
[0m17:54:51.073477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_tickets"
[0m17:54:51.075006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:54:51.075765 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      insert into "postgres"."dwh_detailed_dwh_detailed"."sat_tickets" ("ticket_no", "ticket_hashdiff", "book_ref", "passenger_id", "passenger_name", "contact_data", "effective_from", "load_datetime", "record_source")
    (
        select "ticket_no", "ticket_hashdiff", "book_ref", "passenger_id", "passenger_name", "contact_data", "effective_from", "load_datetime", "record_source"
        from "sat_tickets__dbt_tmp175450930644"
    )


  
[0m17:54:51.078827 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m17:54:51.079836 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m17:54:51.080838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m17:54:51.080838 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m17:54:51.085664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:54:51.085664 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: Close
[0m17:54:51.087667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e946208-70a1-46ca-b6d4-0a1161d8deac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318FC14350>]}
[0m17:54:51.088807 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_tickets .. [[32mINSERT 0 0[0m in 0.18s]
[0m17:54:51.089923 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m17:54:51.091575 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:51.092130 [debug] [MainThread]: On master: BEGIN
[0m17:54:51.092724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:51.128754 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m17:54:51.129312 [debug] [MainThread]: On master: COMMIT
[0m17:54:51.129902 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:51.130469 [debug] [MainThread]: On master: COMMIT
[0m17:54:51.132754 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:54:51.133842 [debug] [MainThread]: On master: Close
[0m17:54:51.134366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:51.135478 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m17:54:51.136024 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m17:54:51.136584 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m17:54:51.137150 [info ] [MainThread]: 
[0m17:54:51.138259 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m17:54:51.139272 [debug] [MainThread]: Command end result
[0m17:54:51.190841 [info ] [MainThread]: 
[0m17:54:51.191985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:51.192538 [info ] [MainThread]: 
[0m17:54:51.193512 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m17:54:51.195324 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:51.195324 after 3.96 seconds
[0m17:54:51.195871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318D5B7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231914ED430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002318F269100>]}
[0m17:54:51.196407 [debug] [MainThread]: Flushing usage events
[0m18:13:22.881781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B911F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BBB306E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BBB33D70>]}


============================== 18:13:22.887153 | afc9a25e-83fa-4d10-9264-2b17abb03ace ==============================
[0m18:13:22.887153 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:13:22.888764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:raw', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:23.146636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BBEAB8F0>]}
[0m18:13:23.212438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BB2E2870>]}
[0m18:13:23.214869 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:13:23.416851 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:13:23.423176 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:13:23.424185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BB421640>]}
[0m18:13:26.143301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD5D2D20>]}
[0m18:13:26.400531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD599880>]}
[0m18:13:26.401102 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m18:13:26.401687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD573E90>]}
[0m18:13:26.403904 [info ] [MainThread]: 
[0m18:13:26.405021 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:26.408521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:13:26.682016 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:13:26.682016 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:13:26.683529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:26.766986 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.084 seconds
[0m18:13:26.768673 [debug] [ThreadPool]: On list_postgres: Close
[0m18:13:26.770403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_postgres, now create_postgres_dwh_detailed_dwh_detailed)
[0m18:13:26.771536 [debug] [ThreadPool]: Creating schema "database: "postgres"
schema: "dwh_detailed_dwh_detailed"
"
[0m18:13:26.778241 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m18:13:26.778879 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m18:13:26.778879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:26.832228 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m18:13:26.833412 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m18:13:26.834609 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "create_postgres_dwh_detailed_dwh_detailed"} */
create schema if not exists "dwh_detailed_dwh_detailed"
[0m18:13:26.847544 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.012 seconds
[0m18:13:26.848561 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m18:13:26.849567 [debug] [ThreadPool]: Using postgres connection "create_postgres_dwh_detailed_dwh_detailed"
[0m18:13:26.849567 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: COMMIT
[0m18:13:26.870252 [debug] [ThreadPool]: SQL status: COMMIT in 0.020 seconds
[0m18:13:26.871873 [debug] [ThreadPool]: On create_postgres_dwh_detailed_dwh_detailed: Close
[0m18:13:26.874494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m18:13:26.883742 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:13:26.884342 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m18:13:26.884905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:26.945600 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m18:13:26.946698 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:13:26.946698 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m18:13:26.990154 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.043 seconds
[0m18:13:26.991144 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m18:13:26.993310 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m18:13:27.002604 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:27.003738 [debug] [MainThread]: On master: BEGIN
[0m18:13:27.003738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:27.046653 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m18:13:27.047795 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:27.047795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:13:27.105629 [debug] [MainThread]: SQL status: SELECT 0 in 0.057 seconds
[0m18:13:27.106641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD568950>]}
[0m18:13:27.108089 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:27.109612 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:27.110618 [debug] [MainThread]: On master: BEGIN
[0m18:13:27.113617 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:13:27.114136 [debug] [MainThread]: On master: COMMIT
[0m18:13:27.114136 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:27.114136 [debug] [MainThread]: On master: COMMIT
[0m18:13:27.116488 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:13:27.116488 [debug] [MainThread]: On master: Close
[0m18:13:27.117481 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:27.119747 [info ] [MainThread]: 
[0m18:13:27.123587 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_aircrafts
[0m18:13:27.124179 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.raw_aircrafts ............ [RUN]
[0m18:13:27.125857 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.raw_aircrafts'
[0m18:13:27.126956 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_aircrafts
[0m18:13:27.136552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_aircrafts"
[0m18:13:27.138569 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_aircrafts
[0m18:13:27.174452 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_aircrafts"
[0m18:13:27.177356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m18:13:27.177895 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: BEGIN
[0m18:13:27.178436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:27.224552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:13:27.224552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m18:13:27.225551 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            model,
            range
        FROM "postgres"."system"."aircrafts"
  );
[0m18:13:27.268647 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m18:13:27.276067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m18:13:27.276805 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_tmp" rename to "raw_aircrafts"
[0m18:13:27.278399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:27.294847 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m18:13:27.295924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m18:13:27.296447 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: COMMIT
[0m18:13:27.314810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m18:13:27.323684 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup"
[0m18:13:27.327864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_aircrafts"
[0m18:13:27.328874 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts__dbt_backup" cascade
[0m18:13:27.330955 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:27.333551 [debug] [Thread-1 (]: On model.dbt_dwh.raw_aircrafts: Close
[0m18:13:27.334575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B9680980>]}
[0m18:13:27.336390 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_aircrafts ....... [[32mCREATE VIEW[0m in 0.21s]
[0m18:13:27.340493 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_aircrafts
[0m18:13:27.342165 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_airports
[0m18:13:27.342735 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.raw_airports ............. [RUN]
[0m18:13:27.343827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_aircrafts, now model.dbt_dwh.raw_airports)
[0m18:13:27.344386 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_airports
[0m18:13:27.347698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_airports"
[0m18:13:27.348807 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_airports
[0m18:13:27.352497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_airports"
[0m18:13:27.353496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m18:13:27.354004 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: BEGIN
[0m18:13:27.354004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:27.403558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m18:13:27.404673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m18:13:27.405213 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp"
    
    
  as (
    SELECT
            airport_code,
            airport_name,
            city,
            coordinates_lon,
            coordinates_lat,
            timezone
        FROM "postgres"."system"."airports"
  );
[0m18:13:27.425760 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m18:13:27.428986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m18:13:27.429986 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_tmp" rename to "raw_airports"
[0m18:13:27.431990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:27.433490 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m18:13:27.434564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m18:13:27.434564 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: COMMIT
[0m18:13:27.439909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:27.441911 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup"
[0m18:13:27.443421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_airports"
[0m18:13:27.443421 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_airports__dbt_backup" cascade
[0m18:13:27.446039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:13:27.447378 [debug] [Thread-1 (]: On model.dbt_dwh.raw_airports: Close
[0m18:13:27.449535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BDA4B950>]}
[0m18:13:27.450691 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_airports ........ [[32mCREATE VIEW[0m in 0.10s]
[0m18:13:27.450691 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_airports
[0m18:13:27.452119 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_boarding_passes
[0m18:13:27.453412 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.raw_boarding_passes ...... [RUN]
[0m18:13:27.454503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_airports, now model.dbt_dwh.raw_boarding_passes)
[0m18:13:27.455043 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_boarding_passes
[0m18:13:27.458408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_boarding_passes"
[0m18:13:27.460038 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_boarding_passes
[0m18:13:27.463571 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_boarding_passes"
[0m18:13:27.466619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m18:13:27.467674 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: BEGIN
[0m18:13:27.468182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:27.511923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m18:13:27.513008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m18:13:27.513008 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            boarding_no,
            seat_no
        FROM "postgres"."system"."boarding_passes"
  );
[0m18:13:27.527213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m18:13:27.531478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m18:13:27.532503 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_tmp" rename to "raw_boarding_passes"
[0m18:13:27.534618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:27.536246 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m18:13:27.537257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m18:13:27.537257 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: COMMIT
[0m18:13:27.542111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:13:27.544430 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup"
[0m18:13:27.545940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_boarding_passes"
[0m18:13:27.545940 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes__dbt_backup" cascade
[0m18:13:27.548221 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:27.549635 [debug] [Thread-1 (]: On model.dbt_dwh.raw_boarding_passes: Close
[0m18:13:27.550697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BDA4B1D0>]}
[0m18:13:27.551695 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_boarding_passes . [[32mCREATE VIEW[0m in 0.10s]
[0m18:13:27.551695 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_boarding_passes
[0m18:13:27.553189 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_bookings
[0m18:13:27.553696 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.raw_bookings ............. [RUN]
[0m18:13:27.554819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_boarding_passes, now model.dbt_dwh.raw_bookings)
[0m18:13:27.555926 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_bookings
[0m18:13:27.558414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_bookings"
[0m18:13:27.559488 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_bookings
[0m18:13:27.563450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_bookings"
[0m18:13:27.565482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m18:13:27.566481 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: BEGIN
[0m18:13:27.566481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:27.626931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m18:13:27.628050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m18:13:27.628050 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp"
    
    
  as (
    SELECT
            book_ref,
            book_date,
            total_amount
        FROM "postgres"."system"."bookings"
  );
[0m18:13:27.644008 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m18:13:27.648912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m18:13:27.649917 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_tmp" rename to "raw_bookings"
[0m18:13:27.651910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:27.653421 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m18:13:27.654435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m18:13:27.654435 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: COMMIT
[0m18:13:27.659331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:27.661788 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup"
[0m18:13:27.663317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_bookings"
[0m18:13:27.664334 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_bookings__dbt_backup" cascade
[0m18:13:27.669791 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:13:27.671534 [debug] [Thread-1 (]: On model.dbt_dwh.raw_bookings: Close
[0m18:13:27.672620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BD35FBF0>]}
[0m18:13:27.673715 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_bookings ........ [[32mCREATE VIEW[0m in 0.12s]
[0m18:13:27.675446 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_bookings
[0m18:13:27.675999 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_flights
[0m18:13:27.676598 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.raw_flights .............. [RUN]
[0m18:13:27.677693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_bookings, now model.dbt_dwh.raw_flights)
[0m18:13:27.678876 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_flights
[0m18:13:27.683913 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_flights"
[0m18:13:27.685587 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_flights
[0m18:13:27.691564 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_flights"
[0m18:13:27.692634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m18:13:27.693167 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: BEGIN
[0m18:13:27.693684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:27.740106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:13:27.741004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m18:13:27.742253 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp"
    
    
  as (
    SELECT
            flight_id,
            flight_no,
            scheduled_departure,
            scheduled_arrival,
            departure_airport,
            arrival_airport,
            status,
            aircraft_code,
            actual_departure,
            actual_arrival
        FROM "postgres"."system"."flights"
  );
[0m18:13:27.759969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m18:13:27.764022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m18:13:27.764567 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_tmp" rename to "raw_flights"
[0m18:13:27.766754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:27.767876 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m18:13:27.768432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m18:13:27.769538 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: COMMIT
[0m18:13:27.774919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:27.778333 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup"
[0m18:13:27.779341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_flights"
[0m18:13:27.779341 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_flights__dbt_backup" cascade
[0m18:13:27.781336 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:27.782336 [debug] [Thread-1 (]: On model.dbt_dwh.raw_flights: Close
[0m18:13:27.783339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BDACA480>]}
[0m18:13:27.784593 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_flights ......... [[32mCREATE VIEW[0m in 0.11s]
[0m18:13:27.786523 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_flights
[0m18:13:27.786523 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_seats
[0m18:13:27.788032 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.raw_seats ................ [RUN]
[0m18:13:27.789202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_flights, now model.dbt_dwh.raw_seats)
[0m18:13:27.789202 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_seats
[0m18:13:27.794286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_seats"
[0m18:13:27.796990 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_seats
[0m18:13:27.800983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_seats"
[0m18:13:27.802822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m18:13:27.803360 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: BEGIN
[0m18:13:27.803360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:27.847947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m18:13:27.848523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m18:13:27.849077 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp"
    
    
  as (
    SELECT
            aircraft_code,
            seat_no,
            fare_conditions
        FROM "postgres"."system"."seats"
  );
[0m18:13:27.861871 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m18:13:27.866955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m18:13:27.867960 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_tmp" rename to "raw_seats"
[0m18:13:27.871213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:27.872390 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m18:13:27.872390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m18:13:27.873684 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: COMMIT
[0m18:13:27.888889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m18:13:27.891965 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup"
[0m18:13:27.893058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_seats"
[0m18:13:27.893572 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_seats__dbt_backup" cascade
[0m18:13:27.895804 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:13:27.898077 [debug] [Thread-1 (]: On model.dbt_dwh.raw_seats: Close
[0m18:13:27.899159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BDA89820>]}
[0m18:13:27.900260 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_seats ........... [[32mCREATE VIEW[0m in 0.11s]
[0m18:13:27.901361 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_seats
[0m18:13:27.901901 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_ticket_flights
[0m18:13:27.902476 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.raw_ticket_flights ....... [RUN]
[0m18:13:27.903012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_seats, now model.dbt_dwh.raw_ticket_flights)
[0m18:13:27.903540 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_ticket_flights
[0m18:13:27.907430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_ticket_flights"
[0m18:13:27.907974 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_ticket_flights
[0m18:13:27.913399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_ticket_flights"
[0m18:13:27.914407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m18:13:27.914407 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: BEGIN
[0m18:13:27.915912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:27.959149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:13:27.960210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m18:13:27.960210 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            flight_id,
            fare_conditions,
            amount
        FROM "postgres"."system"."ticket_flights"
  );
[0m18:13:27.975155 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m18:13:27.980945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m18:13:27.982137 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_tmp" rename to "raw_ticket_flights"
[0m18:13:27.983646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:27.985671 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m18:13:27.985671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m18:13:27.986673 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: COMMIT
[0m18:13:27.993707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m18:13:27.996935 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup"
[0m18:13:27.997939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_ticket_flights"
[0m18:13:27.997939 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights__dbt_backup" cascade
[0m18:13:27.999940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:28.001070 [debug] [Thread-1 (]: On model.dbt_dwh.raw_ticket_flights: Close
[0m18:13:28.002108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BDADE000>]}
[0m18:13:28.003623 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_ticket_flights .. [[32mCREATE VIEW[0m in 0.10s]
[0m18:13:28.004638 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_ticket_flights
[0m18:13:28.005638 [debug] [Thread-1 (]: Began running node model.dbt_dwh.raw_tickets
[0m18:13:28.006647 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.raw_tickets .............. [RUN]
[0m18:13:28.008041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.raw_ticket_flights, now model.dbt_dwh.raw_tickets)
[0m18:13:28.008586 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.raw_tickets
[0m18:13:28.013340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.raw_tickets"
[0m18:13:28.014368 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.raw_tickets
[0m18:13:28.018064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.raw_tickets"
[0m18:13:28.020233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m18:13:28.020826 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: BEGIN
[0m18:13:28.021838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:28.071797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:13:28.073353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m18:13:28.073886 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp"
    
    
  as (
    SELECT
            ticket_no,
            book_ref,
            passenger_id,
            passenger_name,
            contact_data
        FROM "postgres"."system"."tickets"
  );
[0m18:13:28.087020 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m18:13:28.092478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m18:13:28.093510 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_tmp" rename to "raw_tickets"
[0m18:13:28.096063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:28.097079 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m18:13:28.097079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m18:13:28.098327 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: COMMIT
[0m18:13:28.104785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m18:13:28.108722 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup"
[0m18:13:28.109728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.raw_tickets"
[0m18:13:28.110238 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.raw_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."raw_tickets__dbt_backup" cascade
[0m18:13:28.112251 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:13:28.113762 [debug] [Thread-1 (]: On model.dbt_dwh.raw_tickets: Close
[0m18:13:28.114775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc9a25e-83fa-4d10-9264-2b17abb03ace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BAA4D160>]}
[0m18:13:28.116789 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.raw_tickets ......... [[32mCREATE VIEW[0m in 0.11s]
[0m18:13:28.118309 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.raw_tickets
[0m18:13:28.120665 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:28.121224 [debug] [MainThread]: On master: BEGIN
[0m18:13:28.121785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:28.188776 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m18:13:28.189349 [debug] [MainThread]: On master: COMMIT
[0m18:13:28.189881 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:28.190409 [debug] [MainThread]: On master: COMMIT
[0m18:13:28.191684 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:13:28.191684 [debug] [MainThread]: On master: Close
[0m18:13:28.192755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:28.193329 [debug] [MainThread]: Connection 'create_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m18:13:28.193902 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m18:13:28.193902 [debug] [MainThread]: Connection 'model.dbt_dwh.raw_tickets' was properly closed.
[0m18:13:28.194460 [info ] [MainThread]: 
[0m18:13:28.195532 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m18:13:28.197724 [debug] [MainThread]: Command end result
[0m18:13:28.250273 [info ] [MainThread]: 
[0m18:13:28.251272 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:28.252268 [info ] [MainThread]: 
[0m18:13:28.252268 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:13:28.253774 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:28.253774 after 5.67 seconds
[0m18:13:28.255960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BB0403E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BBF3BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4BBA36E40>]}
[0m18:13:28.256961 [debug] [MainThread]: Flushing usage events
[0m18:13:34.959458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D3260980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFF14F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D32A22A0>]}


============================== 18:13:34.965413 | d3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a ==============================
[0m18:13:34.965413 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:13:34.966639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m tag:stage', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:35.238501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D310E9C0>]}
[0m18:13:35.316426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D25F7170>]}
[0m18:13:35.318627 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:13:35.506132 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:13:35.859046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:35.860047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:35.892927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D3417620>]}
[0m18:13:36.038228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D4993170>]}
[0m18:13:36.039229 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m18:13:36.039229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D4A2B7A0>]}
[0m18:13:36.042605 [info ] [MainThread]: 
[0m18:13:36.043615 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:36.049014 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:13:36.360251 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:13:36.361357 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:13:36.361357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:36.415110 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.054 seconds
[0m18:13:36.416108 [debug] [ThreadPool]: On list_postgres: Close
[0m18:13:36.420598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m18:13:36.428947 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:13:36.428947 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m18:13:36.428947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:36.490061 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m18:13:36.490591 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:13:36.491130 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m18:13:36.508798 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.017 seconds
[0m18:13:36.510466 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m18:13:36.512061 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m18:13:36.521394 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:36.521941 [debug] [MainThread]: On master: BEGIN
[0m18:13:36.522490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:36.560707 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m18:13:36.561214 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:36.561753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:13:36.598038 [debug] [MainThread]: SQL status: SELECT 8 in 0.036 seconds
[0m18:13:36.600235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D3416DB0>]}
[0m18:13:36.600785 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:36.602446 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:36.602446 [debug] [MainThread]: On master: BEGIN
[0m18:13:36.605211 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:13:36.605211 [debug] [MainThread]: On master: COMMIT
[0m18:13:36.605762 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:36.606354 [debug] [MainThread]: On master: COMMIT
[0m18:13:36.607478 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:13:36.608486 [debug] [MainThread]: On master: Close
[0m18:13:36.608486 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:36.609486 [info ] [MainThread]: 
[0m18:13:36.613531 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_aircrafts
[0m18:13:36.614574 [info ] [Thread-1 (]: 1 of 8 START sql view model dwh_detailed_dwh_detailed.stg_aircrafts ............ [RUN]
[0m18:13:36.616081 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.stg_aircrafts'
[0m18:13:36.616587 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_aircrafts
[0m18:13:36.664897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.665899 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: BEGIN
[0m18:13:36.665899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:36.711305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m18:13:36.712325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.712325 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:36.780497 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.068 seconds
[0m18:13:36.836790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.838053 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_aircrafts'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:36.842863 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m18:13:36.906436 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.908055 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_aircrafts
[0m18:13:36.941481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.944114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.944656 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    model,
    range

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_aircrafts"
),

derived_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    'AIRCRAFTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), '')), 'hex') AS aircraft_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(model AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(range AS VARCHAR))), ''), '^^')
    )), 'hex') AS aircraft_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    model,
    range,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    aircraft_pk,
    aircraft_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:36.968041 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.023 seconds
[0m18:13:36.974746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.975749 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_tmp" rename to "stg_aircrafts"
[0m18:13:36.977851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:36.992229 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m18:13:36.992787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m18:13:36.993388 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: COMMIT
[0m18:13:36.999501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:37.005908 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup"
[0m18:13:37.010898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_aircrafts"
[0m18:13:37.011431 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_aircrafts"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts__dbt_backup" cascade
[0m18:13:37.013101 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:37.015855 [debug] [Thread-1 (]: On model.dbt_dwh.stg_aircrafts: Close
[0m18:13:37.016883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D0DF09E0>]}
[0m18:13:37.018157 [info ] [Thread-1 (]: 1 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_aircrafts ....... [[32mCREATE VIEW[0m in 0.40s]
[0m18:13:37.019466 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_aircrafts
[0m18:13:37.020464 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_airports
[0m18:13:37.020464 [info ] [Thread-1 (]: 2 of 8 START sql view model dwh_detailed_dwh_detailed.stg_airports ............. [RUN]
[0m18:13:37.022426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_aircrafts, now model.dbt_dwh.stg_airports)
[0m18:13:37.022426 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_airports
[0m18:13:37.032554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m18:13:37.033555 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: BEGIN
[0m18:13:37.033555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:37.082624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:13:37.083621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m18:13:37.084127 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.127583 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.043 seconds
[0m18:13:37.132581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m18:13:37.133587 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_airports'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.138122 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.004 seconds
[0m18:13:37.148066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_airports"
[0m18:13:37.149066 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_airports
[0m18:13:37.153067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_airports"
[0m18:13:37.155248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m18:13:37.156309 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_airports"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_airports"
),

derived_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    'AIRPORTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), '')), 'hex') AS airport_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(airport_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(city AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lat AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(coordinates_lon AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(timezone AS VARCHAR))), ''), '^^')
    )), 'hex') AS airport_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    airport_code,
    airport_name,
    city,
    coordinates_lon,
    coordinates_lat,
    timezone,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    airport_pk,
    airport_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:37.176186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m18:13:37.179639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m18:13:37.180711 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_tmp" rename to "stg_airports"
[0m18:13:37.182969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:37.185986 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m18:13:37.186938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m18:13:37.187446 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: COMMIT
[0m18:13:37.192618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:37.195357 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup"
[0m18:13:37.195899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_airports"
[0m18:13:37.196570 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_airports"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_airports__dbt_backup" cascade
[0m18:13:37.198378 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:37.199995 [debug] [Thread-1 (]: On model.dbt_dwh.stg_airports: Close
[0m18:13:37.200558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D51C80B0>]}
[0m18:13:37.201095 [info ] [Thread-1 (]: 2 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_airports ........ [[32mCREATE VIEW[0m in 0.18s]
[0m18:13:37.202787 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_airports
[0m18:13:37.202787 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_boarding_passes
[0m18:13:37.203832 [info ] [Thread-1 (]: 3 of 8 START sql view model dwh_detailed_dwh_detailed.stg_boarding_passes ...... [RUN]
[0m18:13:37.204923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_airports, now model.dbt_dwh.stg_boarding_passes)
[0m18:13:37.205463 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_boarding_passes
[0m18:13:37.213486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.214004 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: BEGIN
[0m18:13:37.215012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:37.264653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:13:37.266157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.266157 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.305935 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.039 seconds
[0m18:13:37.312085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.313592 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_boarding_passes'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.319309 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m18:13:37.412052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.423114 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_boarding_passes
[0m18:13:37.427394 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.428471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.429016 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_boarding_passes"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    'BOARDING_PASSES'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(boarding_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS boarding_pass_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    boarding_no,
    seat_no,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    boarding_pass_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:37.443515 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m18:13:37.446777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.447778 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_tmp" rename to "stg_boarding_passes"
[0m18:13:37.449243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:37.451656 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m18:13:37.451656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.451656 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: COMMIT
[0m18:13:37.455864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:13:37.458394 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup"
[0m18:13:37.459397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_boarding_passes"
[0m18:13:37.459397 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_boarding_passes"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes__dbt_backup" cascade
[0m18:13:37.461286 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:37.462946 [debug] [Thread-1 (]: On model.dbt_dwh.stg_boarding_passes: Close
[0m18:13:37.463579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D508DCA0>]}
[0m18:13:37.465235 [info ] [Thread-1 (]: 3 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_boarding_passes . [[32mCREATE VIEW[0m in 0.26s]
[0m18:13:37.466321 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_boarding_passes
[0m18:13:37.466885 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_bookings
[0m18:13:37.467454 [info ] [Thread-1 (]: 4 of 8 START sql view model dwh_detailed_dwh_detailed.stg_bookings ............. [RUN]
[0m18:13:37.468542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_boarding_passes, now model.dbt_dwh.stg_bookings)
[0m18:13:37.469097 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_bookings
[0m18:13:37.479289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m18:13:37.479796 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: BEGIN
[0m18:13:37.480809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:37.532863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m18:13:37.533861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m18:13:37.533861 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.571860 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.036 seconds
[0m18:13:37.577116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m18:13:37.578123 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_bookings'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.581153 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.003 seconds
[0m18:13:37.590257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_bookings"
[0m18:13:37.592688 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_bookings
[0m18:13:37.596459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_bookings"
[0m18:13:37.598663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m18:13:37.599199 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    book_ref,
    book_date,
    total_amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_bookings"
),

derived_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    'BOOKINGS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(total_amount AS VARCHAR))), ''), '^^')
    )), 'hex') AS booking_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    book_ref,
    book_date,
    total_amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    booking_pk,
    booking_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:37.613579 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m18:13:37.617999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m18:13:37.618590 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_tmp" rename to "stg_bookings"
[0m18:13:37.620266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:13:37.621912 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m18:13:37.622455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m18:13:37.622986 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: COMMIT
[0m18:13:37.626797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:13:37.628819 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup"
[0m18:13:37.629877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_bookings"
[0m18:13:37.629877 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_bookings"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_bookings__dbt_backup" cascade
[0m18:13:37.631877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:37.632880 [debug] [Thread-1 (]: On model.dbt_dwh.stg_bookings: Close
[0m18:13:37.633878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D5171A30>]}
[0m18:13:37.635686 [info ] [Thread-1 (]: 4 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_bookings ........ [[32mCREATE VIEW[0m in 0.17s]
[0m18:13:37.636700 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_bookings
[0m18:13:37.636700 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_flights
[0m18:13:37.638211 [info ] [Thread-1 (]: 5 of 8 START sql view model dwh_detailed_dwh_detailed.stg_flights .............. [RUN]
[0m18:13:37.638211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_bookings, now model.dbt_dwh.stg_flights)
[0m18:13:37.639259 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_flights
[0m18:13:37.648060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m18:13:37.648060 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: BEGIN
[0m18:13:37.649175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:37.696848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:13:37.698060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m18:13:37.699162 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.737017 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.038 seconds
[0m18:13:37.744000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m18:13:37.745430 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.749324 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.004 seconds
[0m18:13:37.762652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_flights"
[0m18:13:37.764255 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_flights
[0m18:13:37.767536 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_flights"
[0m18:13:37.769320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m18:13:37.770399 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_flights"
),

derived_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    'FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), '')), 'hex') AS flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(actual_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(arrival_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(departure_airport AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_arrival AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(scheduled_departure AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(status AS VARCHAR))), ''), '^^')
    )), 'hex') AS flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    flight_id,
    flight_no,
    scheduled_departure,
    scheduled_arrival,
    departure_airport,
    arrival_airport,
    status,
    aircraft_code,
    actual_departure,
    actual_arrival,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    flight_pk,
    flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:37.786139 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m18:13:37.790147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m18:13:37.791148 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_tmp" rename to "stg_flights"
[0m18:13:37.793654 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:37.796657 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m18:13:37.797731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m18:13:37.797731 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: COMMIT
[0m18:13:37.801741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:13:37.804435 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup"
[0m18:13:37.805957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_flights"
[0m18:13:37.806964 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_flights__dbt_backup" cascade
[0m18:13:37.808051 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:13:37.809402 [debug] [Thread-1 (]: On model.dbt_dwh.stg_flights: Close
[0m18:13:37.810401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D50A6FF0>]}
[0m18:13:37.811402 [info ] [Thread-1 (]: 5 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_flights ......... [[32mCREATE VIEW[0m in 0.17s]
[0m18:13:37.812402 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_flights
[0m18:13:37.812402 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_seats
[0m18:13:37.813915 [info ] [Thread-1 (]: 6 of 8 START sql view model dwh_detailed_dwh_detailed.stg_seats ................ [RUN]
[0m18:13:37.815080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_flights, now model.dbt_dwh.stg_seats)
[0m18:13:37.815080 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_seats
[0m18:13:37.827772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m18:13:37.828829 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: BEGIN
[0m18:13:37.829371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:37.880319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m18:13:37.880852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m18:13:37.880852 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.921536 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.039 seconds
[0m18:13:37.929248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m18:13:37.929248 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_seats'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:37.934764 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.004 seconds
[0m18:13:37.946247 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_seats"
[0m18:13:37.947859 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_seats
[0m18:13:37.952851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_seats"
[0m18:13:37.955003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m18:13:37.955552 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_seats"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_seats"
),

derived_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    'SEATS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS seat_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(aircraft_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(seat_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS seat_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    aircraft_code,
    seat_no,
    fare_conditions,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    seat_pk,
    seat_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:37.972756 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m18:13:37.978241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m18:13:37.979324 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_tmp" rename to "stg_seats"
[0m18:13:37.983613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m18:13:37.987710 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m18:13:37.988709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m18:13:37.989710 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: COMMIT
[0m18:13:37.997177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m18:13:38.001993 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup"
[0m18:13:38.003155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_seats"
[0m18:13:38.004331 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_seats"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_seats__dbt_backup" cascade
[0m18:13:38.006510 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:13:38.008708 [debug] [Thread-1 (]: On model.dbt_dwh.stg_seats: Close
[0m18:13:38.008708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CCDC1820>]}
[0m18:13:38.009910 [info ] [Thread-1 (]: 6 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_seats ........... [[32mCREATE VIEW[0m in 0.19s]
[0m18:13:38.011098 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_seats
[0m18:13:38.012092 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_ticket_flights
[0m18:13:38.012092 [info ] [Thread-1 (]: 7 of 8 START sql view model dwh_detailed_dwh_detailed.stg_ticket_flights ....... [RUN]
[0m18:13:38.012092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_seats, now model.dbt_dwh.stg_ticket_flights)
[0m18:13:38.013599 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_ticket_flights
[0m18:13:38.022448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.022958 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: BEGIN
[0m18:13:38.023497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:38.087368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m18:13:38.088534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.089532 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:38.129943 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.040 seconds
[0m18:13:38.137724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.138792 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_ticket_flights'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:38.143755 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.004 seconds
[0m18:13:38.153920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.155540 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_ticket_flights
[0m18:13:38.160125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.162355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.162898 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_ticket_flights"
),

derived_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    'TICKET_FLIGHTS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS link_ticket_flight_pk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(amount AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(fare_conditions AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(flight_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_flight_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    flight_id,
    fare_conditions,
    amount,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    link_ticket_flight_pk,
    ticket_flight_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:38.176401 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m18:13:38.180577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.181155 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_tmp" rename to "stg_ticket_flights"
[0m18:13:38.183345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:38.184963 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m18:13:38.185511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.185511 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: COMMIT
[0m18:13:38.191204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:38.194528 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup"
[0m18:13:38.195582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_ticket_flights"
[0m18:13:38.196120 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_ticket_flights"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights__dbt_backup" cascade
[0m18:13:38.198328 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:13:38.199969 [debug] [Thread-1 (]: On model.dbt_dwh.stg_ticket_flights: Close
[0m18:13:38.201051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D366AB40>]}
[0m18:13:38.202181 [info ] [Thread-1 (]: 7 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_ticket_flights .. [[32mCREATE VIEW[0m in 0.19s]
[0m18:13:38.203796 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_ticket_flights
[0m18:13:38.204343 [debug] [Thread-1 (]: Began running node model.dbt_dwh.stg_tickets
[0m18:13:38.205434 [info ] [Thread-1 (]: 8 of 8 START sql view model dwh_detailed_dwh_detailed.stg_tickets .............. [RUN]
[0m18:13:38.205977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.stg_ticket_flights, now model.dbt_dwh.stg_tickets)
[0m18:13:38.206629 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.stg_tickets
[0m18:13:38.213112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m18:13:38.213618 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: BEGIN
[0m18:13:38.213618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:38.273974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m18:13:38.275147 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m18:13:38.275147 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:38.315864 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.040 seconds
[0m18:13:38.322724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m18:13:38.323722 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'raw_tickets'
        
        and table_schema = 'dwh_detailed_dwh_detailed'
        
      order by ordinal_position

  
[0m18:13:38.328692 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m18:13:38.337254 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.stg_tickets"
[0m18:13:38.339752 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.stg_tickets
[0m18:13:38.343563 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.stg_tickets"
[0m18:13:38.345226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m18:13:38.345865 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */

  create view "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp"
    
    
  as (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"




WITH staging AS (-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data

    FROM "postgres"."dwh_detailed_dwh_detailed"."raw_tickets"
),

derived_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    'TICKETS'::TEXT AS RECORD_SOURCE,
    CURRENT_TIMESTAMP AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), '')), 'hex') AS ticket_pk,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), '')), 'hex') AS booking_fk,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(book_ref AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(contact_data AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(passenger_name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ticket_no AS VARCHAR))), ''), '^^')
    )), 'hex') AS ticket_hashdiff

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ticket_no,
    book_ref,
    passenger_id,
    passenger_name,
    contact_data,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    ticket_pk,
    booking_fk,
    ticket_hashdiff

    FROM hashed_columns
)

SELECT * FROM columns_to_select)

SELECT *,
       ('2024-12-15 15:13:34.811294+00:00')::DATE AS LOAD_DATETIME
FROM staging
  );
[0m18:13:38.362528 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m18:13:38.367060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m18:13:38.367060 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
alter table "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m18:13:38.369484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:13:38.370681 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m18:13:38.371699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m18:13:38.371699 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: COMMIT
[0m18:13:38.375985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:13:38.379411 [debug] [Thread-1 (]: Applying DROP to: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup"
[0m18:13:38.380672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.stg_tickets"
[0m18:13:38.381198 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.stg_tickets"} */
drop view if exists "postgres"."dwh_detailed_dwh_detailed"."stg_tickets__dbt_backup" cascade
[0m18:13:38.383672 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:13:38.385436 [debug] [Thread-1 (]: On model.dbt_dwh.stg_tickets: Close
[0m18:13:38.385986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d2c9e6-610b-4e9b-b76d-85ecb0e6b46a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D5116CC0>]}
[0m18:13:38.386577 [info ] [Thread-1 (]: 8 of 8 OK created sql view model dwh_detailed_dwh_detailed.stg_tickets ......... [[32mCREATE VIEW[0m in 0.18s]
[0m18:13:38.388313 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.stg_tickets
[0m18:13:38.390086 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:38.390667 [debug] [MainThread]: On master: BEGIN
[0m18:13:38.391206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:38.443871 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m18:13:38.443871 [debug] [MainThread]: On master: COMMIT
[0m18:13:38.444925 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:38.444925 [debug] [MainThread]: On master: COMMIT
[0m18:13:38.446048 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:13:38.447058 [debug] [MainThread]: On master: Close
[0m18:13:38.448056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:38.448056 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:13:38.448822 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m18:13:38.448822 [debug] [MainThread]: Connection 'model.dbt_dwh.stg_tickets' was properly closed.
[0m18:13:38.448822 [info ] [MainThread]: 
[0m18:13:38.449883 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m18:13:38.451887 [debug] [MainThread]: Command end result
[0m18:13:38.503617 [info ] [MainThread]: 
[0m18:13:38.504728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:38.506878 [info ] [MainThread]: 
[0m18:13:38.507385 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:13:38.509194 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:38.509194 after 3.76 seconds
[0m18:13:38.509730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D4A2B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D27F9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D3136570>]}
[0m18:13:38.510268 [debug] [MainThread]: Flushing usage events
[0m18:13:44.748721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB67DC38F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB67D3C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6753A060>]}


============================== 18:13:44.753933 | 9a1c4684-7522-4619-91ce-060a22204a04 ==============================
[0m18:13:44.753933 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:13:44.755434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m tag:hub', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:13:45.023234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB6809B8F0>]}
[0m18:13:45.090484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB67A18A70>]}
[0m18:13:45.092151 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:13:45.287552 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:13:45.543681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:45.544198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:45.574328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69323170>]}
[0m18:13:45.700232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB694CE1B0>]}
[0m18:13:45.701232 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m18:13:45.704712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69638650>]}
[0m18:13:45.708645 [info ] [MainThread]: 
[0m18:13:45.710270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:45.714550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:13:45.977774 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:13:45.978876 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:13:45.988477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:46.057850 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.069 seconds
[0m18:13:46.058852 [debug] [ThreadPool]: On list_postgres: Close
[0m18:13:46.065440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m18:13:46.072544 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:13:46.074057 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m18:13:46.074648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:46.133885 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m18:13:46.134463 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:13:46.135008 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m18:13:46.151971 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.016 seconds
[0m18:13:46.153970 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m18:13:46.155182 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m18:13:46.163266 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:46.163266 [debug] [MainThread]: On master: BEGIN
[0m18:13:46.164266 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:46.225119 [debug] [MainThread]: SQL status: BEGIN in 0.061 seconds
[0m18:13:46.225119 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:46.226120 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:13:46.265154 [debug] [MainThread]: SQL status: SELECT 16 in 0.038 seconds
[0m18:13:46.273533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB694A7AA0>]}
[0m18:13:46.275232 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:46.277739 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:46.278343 [debug] [MainThread]: On master: BEGIN
[0m18:13:46.281962 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m18:13:46.283130 [debug] [MainThread]: On master: COMMIT
[0m18:13:46.284246 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:46.284805 [debug] [MainThread]: On master: COMMIT
[0m18:13:46.288370 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m18:13:46.288998 [debug] [MainThread]: On master: Close
[0m18:13:46.290734 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:46.291877 [info ] [MainThread]: 
[0m18:13:46.300528 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_aircrafts
[0m18:13:46.302767 [info ] [Thread-1 (]: 1 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts ..... [RUN]
[0m18:13:46.304472 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.hub_aircrafts'
[0m18:13:46.305022 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_aircrafts
[0m18:13:46.333076 [info ] [Thread-1 (]: 18:13:46 + Loading postgres.dwh_detailed_dwh_detailed.hub_aircrafts from 1 source(s)
[0m18:13:46.394229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_aircrafts"
[0m18:13:46.396248 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_aircrafts
[0m18:13:46.444940 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_aircrafts"
[0m18:13:46.448456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m18:13:46.449457 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: BEGIN
[0m18:13:46.449457 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:46.506725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m18:13:46.507267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m18:13:46.508301 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_aircrafts"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code) rr.aircraft_code, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    ORDER BY rr.aircraft_code, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.aircraft_code, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:13:46.550990 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m18:13:46.572369 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m18:13:46.572898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_aircrafts"
[0m18:13:46.573987 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: COMMIT
[0m18:13:46.594021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m18:13:46.596496 [debug] [Thread-1 (]: On model.dbt_dwh.hub_aircrafts: Close
[0m18:13:46.598680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69BBADB0>]}
[0m18:13:46.599240 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_aircrafts  [[32mSELECT 0[0m in 0.29s]
[0m18:13:46.600514 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_aircrafts
[0m18:13:46.601081 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_airports
[0m18:13:46.601628 [info ] [Thread-1 (]: 2 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_airports ...... [RUN]
[0m18:13:46.602802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_aircrafts, now model.dbt_dwh.hub_airports)
[0m18:13:46.603352 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_airports
[0m18:13:46.609308 [info ] [Thread-1 (]: 18:13:46 + Loading postgres.dwh_detailed_dwh_detailed.hub_airports from 1 source(s)
[0m18:13:46.612516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_airports"
[0m18:13:46.614138 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_airports
[0m18:13:46.619248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_airports"
[0m18:13:46.622658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m18:13:46.623426 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: BEGIN
[0m18:13:46.623426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:46.692693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m18:13:46.692693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m18:13:46.694201 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_airports"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.airport_code) rr.airport_code, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS rr
    WHERE rr.airport_code IS NOT NULL
    ORDER BY rr.airport_code, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.airport_code, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:13:46.728180 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m18:13:46.730284 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m18:13:46.730284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_airports"
[0m18:13:46.731298 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: COMMIT
[0m18:13:46.734834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:13:46.736345 [debug] [Thread-1 (]: On model.dbt_dwh.hub_airports: Close
[0m18:13:46.737365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69C3B320>]}
[0m18:13:46.738702 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_airports . [[32mSELECT 0[0m in 0.14s]
[0m18:13:46.740290 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_airports
[0m18:13:46.740290 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_bookings
[0m18:13:46.741368 [info ] [Thread-1 (]: 3 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_bookings ...... [RUN]
[0m18:13:46.742365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_airports, now model.dbt_dwh.hub_bookings)
[0m18:13:46.742365 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_bookings
[0m18:13:46.751340 [info ] [Thread-1 (]: 18:13:46 + Loading postgres.dwh_detailed_dwh_detailed.hub_bookings from 1 source(s)
[0m18:13:46.754401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_bookings"
[0m18:13:46.755667 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_bookings
[0m18:13:46.759579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_bookings"
[0m18:13:46.761765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m18:13:46.761765 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: BEGIN
[0m18:13:46.763054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:46.806690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:13:46.807231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m18:13:46.807767 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_bookings"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.book_ref) rr.book_ref, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS rr
    WHERE rr.book_ref IS NOT NULL
    ORDER BY rr.book_ref, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.book_ref, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:13:46.846455 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m18:13:46.848215 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m18:13:46.848763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_bookings"
[0m18:13:46.848763 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: COMMIT
[0m18:13:46.854630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:46.855810 [debug] [Thread-1 (]: On model.dbt_dwh.hub_bookings: Close
[0m18:13:46.857058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69BB9370>]}
[0m18:13:46.858314 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_bookings . [[32mSELECT 0[0m in 0.11s]
[0m18:13:46.859339 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_bookings
[0m18:13:46.859850 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_flights
[0m18:13:46.859850 [info ] [Thread-1 (]: 4 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_flights ....... [RUN]
[0m18:13:46.860860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_bookings, now model.dbt_dwh.hub_flights)
[0m18:13:46.860860 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_flights
[0m18:13:46.867935 [info ] [Thread-1 (]: 18:13:46 + Loading postgres.dwh_detailed_dwh_detailed.hub_flights from 1 source(s)
[0m18:13:46.871933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_flights"
[0m18:13:46.873956 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_flights
[0m18:13:46.877901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_flights"
[0m18:13:46.878909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m18:13:46.879910 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: BEGIN
[0m18:13:46.879910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:46.940500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m18:13:46.941787 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m18:13:46.941787 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.flight_id) rr.flight_id, rr.flight_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    ORDER BY rr.flight_id, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.flight_id, a.flight_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:13:46.981806 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m18:13:46.983873 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m18:13:46.983873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_flights"
[0m18:13:46.985343 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: COMMIT
[0m18:13:46.991909 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m18:13:46.993048 [debug] [Thread-1 (]: On model.dbt_dwh.hub_flights: Close
[0m18:13:46.993726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69BCD880>]}
[0m18:13:46.994918 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_flights .. [[32mSELECT 0[0m in 0.13s]
[0m18:13:46.996377 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_flights
[0m18:13:46.996943 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_seats
[0m18:13:46.997511 [info ] [Thread-1 (]: 5 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_seats ......... [RUN]
[0m18:13:46.999458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_flights, now model.dbt_dwh.hub_seats)
[0m18:13:47.000092 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_seats
[0m18:13:47.007972 [info ] [Thread-1 (]: 18:13:47 + Loading postgres.dwh_detailed_dwh_detailed.hub_seats from 1 source(s)
[0m18:13:47.011862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_seats"
[0m18:13:47.013556 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_seats
[0m18:13:47.019149 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_seats"
[0m18:13:47.020822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m18:13:47.021431 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: BEGIN
[0m18:13:47.022633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:47.070864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:13:47.071454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m18:13:47.071993 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.aircraft_code, rr.seat_no) rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    ORDER BY rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:13:47.107502 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.035 seconds
[0m18:13:47.109517 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m18:13:47.109517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_seats"
[0m18:13:47.110512 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: COMMIT
[0m18:13:47.115614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:13:47.116734 [debug] [Thread-1 (]: On model.dbt_dwh.hub_seats: Close
[0m18:13:47.117768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69C85B80>]}
[0m18:13:47.119043 [info ] [Thread-1 (]: 5 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_seats .... [[32mSELECT 0[0m in 0.12s]
[0m18:13:47.120049 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_seats
[0m18:13:47.120049 [debug] [Thread-1 (]: Began running node model.dbt_dwh.hub_tickets
[0m18:13:47.121100 [info ] [Thread-1 (]: 6 of 6 START sql incremental model dwh_detailed_dwh_detailed.hub_tickets ....... [RUN]
[0m18:13:47.122098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.hub_seats, now model.dbt_dwh.hub_tickets)
[0m18:13:47.123108 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.hub_tickets
[0m18:13:47.127631 [info ] [Thread-1 (]: 18:13:47 + Loading postgres.dwh_detailed_dwh_detailed.hub_tickets from 1 source(s)
[0m18:13:47.133092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.hub_tickets"
[0m18:13:47.135269 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.hub_tickets
[0m18:13:47.141595 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.hub_tickets"
[0m18:13:47.142783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m18:13:47.143370 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: BEGIN
[0m18:13:47.143901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:47.202609 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m18:13:47.204192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m18:13:47.204192 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.hub_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."hub_tickets"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ticket_no) rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.ticket_no IS NOT NULL
    ORDER BY rr.ticket_no, rr.LOAD_DATETIME
),

records_to_insert AS (
    SELECT a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:13:47.239641 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m18:13:47.241822 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m18:13:47.242373 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.hub_tickets"
[0m18:13:47.242915 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: COMMIT
[0m18:13:47.248061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:13:47.249068 [debug] [Thread-1 (]: On model.dbt_dwh.hub_tickets: Close
[0m18:13:47.249068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a1c4684-7522-4619-91ce-060a22204a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69C37230>]}
[0m18:13:47.250071 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model dwh_detailed_dwh_detailed.hub_tickets .. [[32mSELECT 0[0m in 0.13s]
[0m18:13:47.251063 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.hub_tickets
[0m18:13:47.253828 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:47.255537 [debug] [MainThread]: On master: BEGIN
[0m18:13:47.256547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:47.301052 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m18:13:47.303533 [debug] [MainThread]: On master: COMMIT
[0m18:13:47.304065 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:47.304065 [debug] [MainThread]: On master: COMMIT
[0m18:13:47.306073 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:13:47.307074 [debug] [MainThread]: On master: Close
[0m18:13:47.307585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:47.308606 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:13:47.308606 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m18:13:47.308606 [debug] [MainThread]: Connection 'model.dbt_dwh.hub_tickets' was properly closed.
[0m18:13:47.310370 [info ] [MainThread]: 
[0m18:13:47.311387 [info ] [MainThread]: Finished running 6 incremental models in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m18:13:47.312724 [debug] [MainThread]: Command end result
[0m18:13:47.447186 [info ] [MainThread]: 
[0m18:13:47.448383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:47.448917 [info ] [MainThread]: 
[0m18:13:47.450008 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:13:47.451093 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:47.451093 after 2.89 seconds
[0m18:13:47.451629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB67BEB500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69CA3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB69CA11C0>]}
[0m18:13:47.452182 [debug] [MainThread]: Flushing usage events
[0m18:13:53.285798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001898FC20980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001898F412AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001898F89C770>]}


============================== 18:13:53.290051 | e42e3680-58d9-4af4-b630-46b7ca185384 ==============================
[0m18:13:53.290051 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:13:53.291121 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m tag:link', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:13:53.560307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e42e3680-58d9-4af4-b630-46b7ca185384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001898FFECC20>]}
[0m18:13:53.631439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e42e3680-58d9-4af4-b630-46b7ca185384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001898FFEF500>]}
[0m18:13:53.633027 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:13:53.845526 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:13:54.085909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:54.086479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:54.119149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e42e3680-58d9-4af4-b630-46b7ca185384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189900EAA80>]}
[0m18:13:54.237407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e42e3680-58d9-4af4-b630-46b7ca185384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189913AFE00>]}
[0m18:13:54.238494 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m18:13:54.239069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e42e3680-58d9-4af4-b630-46b7ca185384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018991461B20>]}
[0m18:13:54.240156 [warn ] [MainThread]: The selection criterion 'tag:link' does not match any enabled nodes
[0m18:13:54.241281 [info ] [MainThread]: 
[0m18:13:54.242726 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:13:54.244238 [debug] [MainThread]: Command end result
[0m18:13:54.286877 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:54.286877 after 1.20 seconds
[0m18:13:54.288000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001898F412AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189900C73B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189913847D0>]}
[0m18:13:54.288808 [debug] [MainThread]: Flushing usage events
[0m18:14:06.006740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FAAF99850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FABBB22A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FABA1EB40>]}


============================== 18:14:06.015446 | f8260523-3d5c-4d4c-943d-9555752e7a96 ==============================
[0m18:14:06.015446 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:14:06.017381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:links', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:14:06.330731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FABE3C500>]}
[0m18:14:06.389616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FABE8D5B0>]}
[0m18:14:06.391280 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:14:06.610535 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:14:06.851164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:06.851164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:06.884888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FABFA5B50>]}
[0m18:14:07.010310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FAD0B8680>]}
[0m18:14:07.010843 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m18:14:07.011954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FABF52570>]}
[0m18:14:07.013040 [info ] [MainThread]: 
[0m18:14:07.014567 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:14:07.018489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:14:07.293504 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:14:07.294012 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:14:07.294523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:07.354510 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.060 seconds
[0m18:14:07.356537 [debug] [ThreadPool]: On list_postgres: Close
[0m18:14:07.362755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m18:14:07.369783 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:14:07.370396 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m18:14:07.370396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:07.418030 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m18:14:07.418575 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:14:07.419119 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m18:14:07.438695 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.018 seconds
[0m18:14:07.439882 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m18:14:07.441973 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m18:14:07.451605 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:07.451605 [debug] [MainThread]: On master: BEGIN
[0m18:14:07.452824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:07.500565 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m18:14:07.501759 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:07.502336 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:14:07.551863 [debug] [MainThread]: SQL status: SELECT 16 in 0.049 seconds
[0m18:14:07.555153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FA97811C0>]}
[0m18:14:07.555687 [debug] [MainThread]: On master: ROLLBACK
[0m18:14:07.557867 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:07.558951 [debug] [MainThread]: On master: BEGIN
[0m18:14:07.561370 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:14:07.561927 [debug] [MainThread]: On master: COMMIT
[0m18:14:07.562462 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:07.562462 [debug] [MainThread]: On master: COMMIT
[0m18:14:07.564135 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:14:07.564761 [debug] [MainThread]: On master: Close
[0m18:14:07.565312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:07.567031 [info ] [MainThread]: 
[0m18:14:07.572871 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_aircrafts_seats
[0m18:14:07.573961 [info ] [Thread-1 (]: 1 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [RUN]
[0m18:14:07.575113 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.link_aircrafts_seats'
[0m18:14:07.575113 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_aircrafts_seats
[0m18:14:07.614435 [info ] [Thread-1 (]: 18:14:07 + Loading postgres.dwh_detailed_dwh_detailed.link_aircrafts_seats from 1 source(s)
[0m18:14:07.680944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_aircrafts_seats"
[0m18:14:07.683067 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_aircrafts_seats
[0m18:14:07.730323 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_aircrafts_seats"
[0m18:14:07.732327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m18:14:07.732327 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: BEGIN
[0m18:14:07.733838 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:07.775617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m18:14:07.777468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m18:14:07.777468 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_aircrafts_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_aircrafts_seats"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_seats"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.aircraft_code, rr.seat_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.aircraft_code, rr.seat_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS rr
    WHERE rr.aircraft_code IS NOT NULL
    AND rr.seat_no IS NOT NULL
    AND rr.aircraft_code IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.aircraft_code, a.seat_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:07.820153 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.042 seconds
[0m18:14:07.836697 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: COMMIT
[0m18:14:07.837701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_aircrafts_seats"
[0m18:14:07.837701 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: COMMIT
[0m18:14:07.853805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m18:14:07.857183 [debug] [Thread-1 (]: On model.dbt_dwh.link_aircrafts_seats: Close
[0m18:14:07.859360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FA9700560>]}
[0m18:14:07.860636 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_aircrafts_seats  [[32mSELECT 0[0m in 0.28s]
[0m18:14:07.861672 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_aircrafts_seats
[0m18:14:07.862709 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_boarding_passes
[0m18:14:07.863745 [info ] [Thread-1 (]: 2 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [RUN]
[0m18:14:07.864258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_aircrafts_seats, now model.dbt_dwh.link_boarding_passes)
[0m18:14:07.865613 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_boarding_passes
[0m18:14:07.872738 [info ] [Thread-1 (]: 18:14:07 + Loading postgres.dwh_detailed_dwh_detailed.link_boarding_passes from 1 source(s)
[0m18:14:07.879157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_boarding_passes"
[0m18:14:07.881158 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_boarding_passes
[0m18:14:07.886853 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_boarding_passes"
[0m18:14:07.888862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m18:14:07.889875 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: BEGIN
[0m18:14:07.890867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:07.928612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m18:14:07.929627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m18:14:07.929627 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_boarding_passes"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:07.960546 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.029 seconds
[0m18:14:07.962181 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m18:14:07.962717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_boarding_passes"
[0m18:14:07.963276 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: COMMIT
[0m18:14:07.968963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:14:07.970124 [debug] [Thread-1 (]: On model.dbt_dwh.link_boarding_passes: Close
[0m18:14:07.970664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FAD9DBC20>]}
[0m18:14:07.972093 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_boarding_passes  [[32mSELECT 0[0m in 0.11s]
[0m18:14:07.975499 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_boarding_passes
[0m18:14:07.976090 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_flights_airports
[0m18:14:07.977323 [info ] [Thread-1 (]: 3 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [RUN]
[0m18:14:07.979033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_boarding_passes, now model.dbt_dwh.link_flights_airports)
[0m18:14:07.979616 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_flights_airports
[0m18:14:07.987014 [info ] [Thread-1 (]: 18:14:07 + Loading postgres.dwh_detailed_dwh_detailed.link_flights_airports from 1 source(s)
[0m18:14:07.993270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_flights_airports"
[0m18:14:07.995156 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_flights_airports
[0m18:14:08.000606 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_flights_airports"
[0m18:14:08.002005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m18:14:08.003386 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: BEGIN
[0m18:14:08.003386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:08.053064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m18:14:08.054205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m18:14:08.054747 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_flights_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_flights_airports"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.flight_id, rr.departure_airport, rr.arrival_airport, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.flight_id, rr.departure_airport, rr.arrival_airport
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS rr
    WHERE rr.flight_id IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
    AND rr.departure_airport IS NOT NULL
    AND rr.arrival_airport IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.flight_id, a.departure_airport, a.arrival_airport, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:08.091456 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m18:14:08.093449 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m18:14:08.094455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_flights_airports"
[0m18:14:08.094455 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: COMMIT
[0m18:14:08.099007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:14:08.100445 [debug] [Thread-1 (]: On model.dbt_dwh.link_flights_airports: Close
[0m18:14:08.101457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FAD9BAB40>]}
[0m18:14:08.102463 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_flights_airports  [[32mSELECT 0[0m in 0.12s]
[0m18:14:08.103457 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_flights_airports
[0m18:14:08.103457 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_ticket_flights
[0m18:14:08.104995 [info ] [Thread-1 (]: 4 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [RUN]
[0m18:14:08.105516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_flights_airports, now model.dbt_dwh.link_ticket_flights)
[0m18:14:08.105516 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_ticket_flights
[0m18:14:08.113686 [info ] [Thread-1 (]: 18:14:08 + Loading postgres.dwh_detailed_dwh_detailed.link_ticket_flights from 1 source(s)
[0m18:14:08.118715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_ticket_flights"
[0m18:14:08.121156 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_ticket_flights
[0m18:14:08.127346 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_ticket_flights"
[0m18:14:08.129008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m18:14:08.130004 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: BEGIN
[0m18:14:08.130004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:08.178012 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:14:08.179015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m18:14:08.180012 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_ticket_flights"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.ticket_no, rr.flight_id, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ticket_no, rr.flight_id
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS rr
    WHERE rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.flight_id IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.ticket_no, a.flight_id, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:08.218642 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.038 seconds
[0m18:14:08.221199 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m18:14:08.221199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_ticket_flights"
[0m18:14:08.222204 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: COMMIT
[0m18:14:08.226757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:14:08.228757 [debug] [Thread-1 (]: On model.dbt_dwh.link_ticket_flights: Close
[0m18:14:08.229760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FADA0BA40>]}
[0m18:14:08.230759 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_ticket_flights  [[32mSELECT 0[0m in 0.12s]
[0m18:14:08.232754 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_ticket_flights
[0m18:14:08.234126 [debug] [Thread-1 (]: Began running node model.dbt_dwh.link_tickets_bookings
[0m18:14:08.234639 [info ] [Thread-1 (]: 5 of 5 START sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [RUN]
[0m18:14:08.235686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.link_ticket_flights, now model.dbt_dwh.link_tickets_bookings)
[0m18:14:08.235686 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.link_tickets_bookings
[0m18:14:08.242339 [info ] [Thread-1 (]: 18:14:08 + Loading postgres.dwh_detailed_dwh_detailed.link_tickets_bookings from 1 source(s)
[0m18:14:08.249228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.link_tickets_bookings"
[0m18:14:08.250858 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.link_tickets_bookings
[0m18:14:08.255195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.link_tickets_bookings"
[0m18:14:08.256836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m18:14:08.256836 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: BEGIN
[0m18:14:08.257882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:08.314489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m18:14:08.315506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m18:14:08.316500 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.link_tickets_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."link_tickets_bookings"
  
  
    as
  
  (
    -- depends_on: "postgres"."dwh_detailed_dwh_detailed"."stg_tickets"-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.book_ref, rr.ticket_no, rr.LOAD_DATETIME, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.book_ref, rr.ticket_no
               ORDER BY rr.LOAD_DATETIME
           ) AS row_number
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS rr
    WHERE rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
    AND rr.book_ref IS NOT NULL
    AND rr.ticket_no IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.book_ref, a.ticket_no, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:08.353378 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.037 seconds
[0m18:14:08.355896 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m18:14:08.355896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.link_tickets_bookings"
[0m18:14:08.355896 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: COMMIT
[0m18:14:08.373041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m18:14:08.374635 [debug] [Thread-1 (]: On model.dbt_dwh.link_tickets_bookings: Close
[0m18:14:08.375799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8260523-3d5c-4d4c-943d-9555752e7a96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FADA0FDA0>]}
[0m18:14:08.376900 [info ] [Thread-1 (]: 5 of 5 OK created sql incremental model dwh_detailed_dwh_detailed.link_tickets_bookings  [[32mSELECT 0[0m in 0.14s]
[0m18:14:08.378018 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.link_tickets_bookings
[0m18:14:08.379660 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:08.380761 [debug] [MainThread]: On master: BEGIN
[0m18:14:08.381303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:08.438651 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m18:14:08.439341 [debug] [MainThread]: On master: COMMIT
[0m18:14:08.439341 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:08.440350 [debug] [MainThread]: On master: COMMIT
[0m18:14:08.441350 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:14:08.442718 [debug] [MainThread]: On master: Close
[0m18:14:08.442718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:08.444403 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:14:08.444403 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m18:14:08.445051 [debug] [MainThread]: Connection 'model.dbt_dwh.link_tickets_bookings' was properly closed.
[0m18:14:08.445597 [info ] [MainThread]: 
[0m18:14:08.446754 [info ] [MainThread]: Finished running 5 incremental models in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m18:14:08.448425 [debug] [MainThread]: Command end result
[0m18:14:08.582875 [info ] [MainThread]: 
[0m18:14:08.583676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:08.584695 [info ] [MainThread]: 
[0m18:14:08.586394 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:14:08.588450 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:08.587406 after 2.79 seconds
[0m18:14:08.588450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FAAF99850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FAD954EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FAD957E00>]}
[0m18:14:08.588450 [debug] [MainThread]: Flushing usage events
[0m18:14:14.672201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002243517FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002243461A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002243432FA40>]}


============================== 18:14:14.678141 | 986e5973-2f1e-4d6f-aee2-72d538cb003a ==============================
[0m18:14:14.678141 [info ] [MainThread]: Running with dbt=1.8.9
[0m18:14:14.678689 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\d_tru\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\d_tru\\Downloads\\D\\gruzi_suda_uchebu\\FTIAD_true\\DWH\\DWH_hw02-main_LAST\\dbt_dwh\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m tag:satellite', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:14:14.949446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224350B68A0>]}
[0m18:14:15.034723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022434E83140>]}
[0m18:14:15.037766 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:14:15.237848 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m18:14:15.493399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:15.493399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:15.529090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022434AA0B30>]}
[0m18:14:15.650219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022436917DA0>]}
[0m18:14:15.650219 [info ] [MainThread]: Found 35 models, 8 sources, 786 macros
[0m18:14:15.651219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022431CC6330>]}
[0m18:14:15.653217 [info ] [MainThread]: 
[0m18:14:15.654723 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:14:15.658702 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m18:14:15.911116 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m18:14:15.912116 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m18:14:15.912116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:15.977063 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.064 seconds
[0m18:14:15.978848 [debug] [ThreadPool]: On list_postgres: Close
[0m18:14:15.983237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dwh_detailed_dwh_detailed'
[0m18:14:15.991282 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:14:15.991282 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: BEGIN
[0m18:14:15.992282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:16.055245 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m18:14:16.055245 [debug] [ThreadPool]: Using postgres connection "list_postgres_dwh_detailed_dwh_detailed"
[0m18:14:16.055245 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "list_postgres_dwh_detailed_dwh_detailed"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dwh_detailed_dwh_detailed'
    union all
    select
      'postgres' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dwh_detailed_dwh_detailed'
  
[0m18:14:16.074735 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.017 seconds
[0m18:14:16.076911 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: ROLLBACK
[0m18:14:16.079377 [debug] [ThreadPool]: On list_postgres_dwh_detailed_dwh_detailed: Close
[0m18:14:16.089678 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:16.090209 [debug] [MainThread]: On master: BEGIN
[0m18:14:16.090739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:16.154824 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m18:14:16.155468 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:16.155468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:14:16.208778 [debug] [MainThread]: SQL status: SELECT 16 in 0.052 seconds
[0m18:14:16.211780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022432D6D7C0>]}
[0m18:14:16.211780 [debug] [MainThread]: On master: ROLLBACK
[0m18:14:16.212782 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:16.214292 [debug] [MainThread]: On master: BEGIN
[0m18:14:16.216832 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m18:14:16.217831 [debug] [MainThread]: On master: COMMIT
[0m18:14:16.218832 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:16.219895 [debug] [MainThread]: On master: COMMIT
[0m18:14:16.221017 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:14:16.222123 [debug] [MainThread]: On master: Close
[0m18:14:16.222729 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:16.223297 [info ] [MainThread]: 
[0m18:14:16.227668 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_aircrafts
[0m18:14:16.228200 [info ] [Thread-1 (]: 1 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts ..... [RUN]
[0m18:14:16.228785 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_dwh.sat_aircrafts'
[0m18:14:16.229338 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_aircrafts
[0m18:14:16.359603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_aircrafts"
[0m18:14:16.360693 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_aircrafts
[0m18:14:16.413965 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_aircrafts"
[0m18:14:16.415473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m18:14:16.416979 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: BEGIN
[0m18:14:16.416979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:16.471242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m18:14:16.472241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m18:14:16.472241 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_aircrafts"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_aircrafts"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.aircraft_hashdiff, a.model, a.range, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_aircrafts" AS a
    WHERE a.aircraft_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.aircraft_hashdiff, stage.model, stage.range, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:16.509005 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m18:14:16.527304 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m18:14:16.527841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_aircrafts"
[0m18:14:16.528371 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: COMMIT
[0m18:14:16.543132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m18:14:16.545316 [debug] [Thread-1 (]: On model.dbt_dwh.sat_aircrafts: Close
[0m18:14:16.548070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022432D00680>]}
[0m18:14:16.549193 [info ] [Thread-1 (]: 1 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_aircrafts  [[32mSELECT 0[0m in 0.32s]
[0m18:14:16.550803 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_aircrafts
[0m18:14:16.551898 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_airports
[0m18:14:16.552442 [info ] [Thread-1 (]: 2 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_airports ...... [RUN]
[0m18:14:16.553778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_aircrafts, now model.dbt_dwh.sat_airports)
[0m18:14:16.555293 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_airports
[0m18:14:16.566649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_airports"
[0m18:14:16.568380 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_airports
[0m18:14:16.572461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_airports"
[0m18:14:16.573461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m18:14:16.574968 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: BEGIN
[0m18:14:16.574968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:16.640309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m18:14:16.641461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m18:14:16.641461 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_airports"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_airports"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.airport_code, a.airport_hashdiff, a.airport_name, a.city, a.coordinates_lon, a.coordinates_lat, a.timezone, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_airports" AS a
    WHERE a.airport_code IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.airport_code, stage.airport_hashdiff, stage.airport_name, stage.city, stage.coordinates_lon, stage.coordinates_lat, stage.timezone, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:16.679132 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.037 seconds
[0m18:14:16.681329 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m18:14:16.681879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_airports"
[0m18:14:16.682434 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: COMMIT
[0m18:14:16.687368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:14:16.688473 [debug] [Thread-1 (]: On model.dbt_dwh.sat_airports: Close
[0m18:14:16.689034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022436DFA360>]}
[0m18:14:16.689707 [info ] [Thread-1 (]: 2 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_airports . [[32mSELECT 0[0m in 0.13s]
[0m18:14:16.690715 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_airports
[0m18:14:16.691716 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_boarding_passes
[0m18:14:16.692716 [info ] [Thread-1 (]: 3 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [RUN]
[0m18:14:16.693715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_airports, now model.dbt_dwh.sat_boarding_passes)
[0m18:14:16.694716 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_boarding_passes
[0m18:14:16.703783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_boarding_passes"
[0m18:14:16.705569 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_boarding_passes
[0m18:14:16.710334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_boarding_passes"
[0m18:14:16.711335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m18:14:16.712334 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: BEGIN
[0m18:14:16.713335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:16.759125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:14:16.759666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m18:14:16.760208 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_boarding_passes"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_boarding_passes"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.flight_id, a.boarding_pass_hashdiff, a.boarding_no, a.seat_no, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_boarding_passes" AS a
    WHERE a.ticket_no IS NOT NULL
    AND a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.flight_id, stage.boarding_pass_hashdiff, stage.boarding_no, stage.seat_no, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:16.794929 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.034 seconds
[0m18:14:16.796943 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: COMMIT
[0m18:14:16.797550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_boarding_passes"
[0m18:14:16.798163 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: COMMIT
[0m18:14:16.803023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:14:16.803570 [debug] [Thread-1 (]: On model.dbt_dwh.sat_boarding_passes: Close
[0m18:14:16.804636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224370AE7B0>]}
[0m18:14:16.805724 [info ] [Thread-1 (]: 3 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_boarding_passes  [[32mSELECT 0[0m in 0.11s]
[0m18:14:16.806788 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_boarding_passes
[0m18:14:16.807317 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_bookings
[0m18:14:16.808424 [info ] [Thread-1 (]: 4 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_bookings ...... [RUN]
[0m18:14:16.808960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_boarding_passes, now model.dbt_dwh.sat_bookings)
[0m18:14:16.808960 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_bookings
[0m18:14:16.823219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_bookings"
[0m18:14:16.824725 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_bookings
[0m18:14:16.831732 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_bookings"
[0m18:14:16.834734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m18:14:16.835782 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: BEGIN
[0m18:14:16.836789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:16.903980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.067 seconds
[0m18:14:16.905032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m18:14:16.905574 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_bookings"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_bookings"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.book_ref, a.booking_hashdiff, a.book_date, a.total_amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_bookings" AS a
    WHERE a.book_ref IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.book_ref, stage.booking_hashdiff, stage.book_date, stage.total_amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:16.945533 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.039 seconds
[0m18:14:16.948316 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m18:14:16.948859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_bookings"
[0m18:14:16.949394 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: COMMIT
[0m18:14:16.953988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:14:16.955563 [debug] [Thread-1 (]: On model.dbt_dwh.sat_bookings: Close
[0m18:14:16.956824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224370C5E20>]}
[0m18:14:16.958601 [info ] [Thread-1 (]: 4 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_bookings . [[32mSELECT 0[0m in 0.15s]
[0m18:14:16.959691 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_bookings
[0m18:14:16.960783 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_flights
[0m18:14:16.961326 [info ] [Thread-1 (]: 5 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_flights ....... [RUN]
[0m18:14:16.962400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_bookings, now model.dbt_dwh.sat_flights)
[0m18:14:16.962959 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_flights
[0m18:14:16.975611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_flights"
[0m18:14:16.978123 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_flights
[0m18:14:16.983123 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_flights"
[0m18:14:16.984629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m18:14:16.985636 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: BEGIN
[0m18:14:16.987142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:17.055278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.068 seconds
[0m18:14:17.056394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m18:14:17.057461 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.flight_id, a.flight_hashdiff, a.flight_no, a.scheduled_departure, a.scheduled_arrival, a.departure_airport, a.arrival_airport, a.status, a.aircraft_code, a.actual_departure, a.actual_arrival, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_flights" AS a
    WHERE a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.flight_id, stage.flight_hashdiff, stage.flight_no, stage.scheduled_departure, stage.scheduled_arrival, stage.departure_airport, stage.arrival_airport, stage.status, stage.aircraft_code, stage.actual_departure, stage.actual_arrival, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:17.090332 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.032 seconds
[0m18:14:17.092598 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m18:14:17.093127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_flights"
[0m18:14:17.093127 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: COMMIT
[0m18:14:17.098685 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:14:17.100357 [debug] [Thread-1 (]: On model.dbt_dwh.sat_flights: Close
[0m18:14:17.101423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002243702F380>]}
[0m18:14:17.102535 [info ] [Thread-1 (]: 5 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_flights .. [[32mSELECT 0[0m in 0.14s]
[0m18:14:17.103624 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_flights
[0m18:14:17.104143 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_seats
[0m18:14:17.104675 [info ] [Thread-1 (]: 6 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_seats ......... [RUN]
[0m18:14:17.105756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_flights, now model.dbt_dwh.sat_seats)
[0m18:14:17.106291 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_seats
[0m18:14:17.119746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_seats"
[0m18:14:17.121761 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_seats
[0m18:14:17.125790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_seats"
[0m18:14:17.127289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m18:14:17.128377 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: BEGIN
[0m18:14:17.128377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:17.195178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m18:14:17.196242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m18:14:17.196815 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_seats"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_seats"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.aircraft_code, a.seat_no, a.seat_hashdiff, a.fare_conditions, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_seats" AS a
    WHERE a.aircraft_code IS NOT NULL
    AND a.seat_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.aircraft_code, stage.seat_no, stage.seat_hashdiff, stage.fare_conditions, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:17.230716 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:14:17.233968 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: COMMIT
[0m18:14:17.234536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_seats"
[0m18:14:17.234536 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: COMMIT
[0m18:14:17.240742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:14:17.241739 [debug] [Thread-1 (]: On model.dbt_dwh.sat_seats: Close
[0m18:14:17.243078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002243708EE40>]}
[0m18:14:17.244568 [info ] [Thread-1 (]: 6 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_seats .... [[32mSELECT 0[0m in 0.14s]
[0m18:14:17.245960 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_seats
[0m18:14:17.247028 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_ticket_flights
[0m18:14:17.248136 [info ] [Thread-1 (]: 7 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [RUN]
[0m18:14:17.249222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_seats, now model.dbt_dwh.sat_ticket_flights)
[0m18:14:17.249787 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_ticket_flights
[0m18:14:17.345033 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_ticket_flights"
[0m18:14:17.347843 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_ticket_flights
[0m18:14:17.354451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_ticket_flights"
[0m18:14:17.355511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m18:14:17.356119 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: BEGIN
[0m18:14:17.356758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:17.405745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m18:14:17.406290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m18:14:17.406887 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_ticket_flights"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_ticket_flights"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.flight_id, a.ticket_flight_hashdiff, a.fare_conditions, a.amount, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_ticket_flights" AS a
    WHERE a.ticket_no IS NOT NULL
    AND a.flight_id IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.flight_id, stage.ticket_flight_hashdiff, stage.fare_conditions, stage.amount, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:17.440810 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.033 seconds
[0m18:14:17.443813 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: COMMIT
[0m18:14:17.445912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_ticket_flights"
[0m18:14:17.446572 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: COMMIT
[0m18:14:17.459950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m18:14:17.461579 [debug] [Thread-1 (]: On model.dbt_dwh.sat_ticket_flights: Close
[0m18:14:17.462248 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022434FF9340>]}
[0m18:14:17.463915 [info ] [Thread-1 (]: 7 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_ticket_flights  [[32mSELECT 0[0m in 0.21s]
[0m18:14:17.465086 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_ticket_flights
[0m18:14:17.466182 [debug] [Thread-1 (]: Began running node model.dbt_dwh.sat_tickets
[0m18:14:17.466712 [info ] [Thread-1 (]: 8 of 8 START sql incremental model dwh_detailed_dwh_detailed.sat_tickets ....... [RUN]
[0m18:14:17.467772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dwh.sat_ticket_flights, now model.dbt_dwh.sat_tickets)
[0m18:14:17.468318 [debug] [Thread-1 (]: Began compiling node model.dbt_dwh.sat_tickets
[0m18:14:17.480397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dwh.sat_tickets"
[0m18:14:17.481796 [debug] [Thread-1 (]: Began executing node model.dbt_dwh.sat_tickets
[0m18:14:17.485644 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dwh.sat_tickets"
[0m18:14:17.487277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m18:14:17.487818 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: BEGIN
[0m18:14:17.488361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:17.553345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m18:14:17.553345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m18:14:17.554852 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "dbt_dwh", "target_name": "dev", "node_id": "model.dbt_dwh.sat_tickets"} */

      
  
    

  create  table "postgres"."dwh_detailed_dwh_detailed"."sat_tickets"
  
  
    as
  
  (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ticket_no, a.ticket_hashdiff, a.book_ref, a.passenger_id, a.passenger_name, a.contact_data, a.EFFECTIVE_FROM, a.LOAD_DATETIME, a.RECORD_SOURCE
    FROM "postgres"."dwh_detailed_dwh_detailed"."stg_tickets" AS a
    WHERE a.ticket_no IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ticket_no, stage.ticket_hashdiff, stage.book_ref, stage.passenger_id, stage.passenger_name, stage.contact_data, stage.EFFECTIVE_FROM, stage.LOAD_DATETIME, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m18:14:17.591933 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.036 seconds
[0m18:14:17.594141 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m18:14:17.594652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_dwh.sat_tickets"
[0m18:14:17.595187 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: COMMIT
[0m18:14:17.600839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:14:17.601917 [debug] [Thread-1 (]: On model.dbt_dwh.sat_tickets: Close
[0m18:14:17.602458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986e5973-2f1e-4d6f-aee2-72d538cb003a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022436F0BFE0>]}
[0m18:14:17.604803 [info ] [Thread-1 (]: 8 of 8 OK created sql incremental model dwh_detailed_dwh_detailed.sat_tickets .. [[32mSELECT 0[0m in 0.13s]
[0m18:14:17.605898 [debug] [Thread-1 (]: Finished running node model.dbt_dwh.sat_tickets
[0m18:14:17.607526 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:17.608621 [debug] [MainThread]: On master: BEGIN
[0m18:14:17.608621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:17.673669 [debug] [MainThread]: SQL status: BEGIN in 0.065 seconds
[0m18:14:17.674214 [debug] [MainThread]: On master: COMMIT
[0m18:14:17.674733 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:17.674733 [debug] [MainThread]: On master: COMMIT
[0m18:14:17.676380 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:14:17.677078 [debug] [MainThread]: On master: Close
[0m18:14:17.677616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:17.678163 [debug] [MainThread]: Connection 'list_postgres' was properly closed.
[0m18:14:17.678720 [debug] [MainThread]: Connection 'list_postgres_dwh_detailed_dwh_detailed' was properly closed.
[0m18:14:17.678720 [debug] [MainThread]: Connection 'model.dbt_dwh.sat_tickets' was properly closed.
[0m18:14:17.678720 [info ] [MainThread]: 
[0m18:14:17.680734 [info ] [MainThread]: Finished running 8 incremental models in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m18:14:17.682496 [debug] [MainThread]: Command end result
[0m18:14:17.737593 [info ] [MainThread]: 
[0m18:14:17.738678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:17.739488 [info ] [MainThread]: 
[0m18:14:17.740654 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:14:17.743776 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:17.743776 after 3.27 seconds
[0m18:14:17.744336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022434ED85C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022434ED8230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022434F71B80>]}
[0m18:14:17.744863 [debug] [MainThread]: Flushing usage events
